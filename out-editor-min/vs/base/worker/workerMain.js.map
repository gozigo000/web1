{"version":3,"sources":["out-editor/vs/base/worker/fake","out-editor/vs/base/worker/vs/loader.js","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/nls.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/worker/workerMain.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/arrays.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/cache.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/collections.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/color.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/diff/diffChange.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/errors.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/assert.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/functional.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/iterator.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/keyCodes.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/lazy.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/lifecycle.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/linkedList.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/stopwatch.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/event.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/cancellation.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/strings.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/hash.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/diff/diff.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/types.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/codicons.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/objects.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/uint.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/characterClassifier.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/offsetRange.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/position.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/range.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/lineRange.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/selection.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/wordCharacterClassifier.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/core/wordHelper.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/algorithms/diffAlgorithm.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/algorithms/joinSequenceDiffs.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/algorithms/myersDiffAlgorithm.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/algorithms/utils.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/algorithms/dynamicProgrammingDiffing.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/linesDiffComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/advancedLinesDiffComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/legacyLinesDiffComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/diff/linesDiffComputers.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/languages/defaultDocumentColorsComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/languages/linkComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/languages/supports/inplaceReplaceSupport.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/model.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/model/prefixSumComputer.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/model/mirrorTextModel.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/model/textModelSearch.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/services/unicodeTextModelHighlighter.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/standalone/standaloneEnums.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/tokenizationRegistry.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/platform.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/process.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/path.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/uri.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/base/common/worker/simpleWorker.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/languages.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/services/editorBaseApi.ts","out-editor/vs/base/worker/file:/C:/Users/gozig/Documents/git/vscode/out-editor-src/vs/editor/common/services/editorSimpleWorker.ts"],"sourcesContent":["}).call(this);","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n/*---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n * Please make sure to make edits in the .ts file at https://github.com/microsoft/vscode-loader/\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *---------------------------------------------------------------------------------------------\n *--------------------------------------------------------------------------------------------*/\nconst _amdLoaderGlobal = this;\nconst _commonjsGlobal = typeof global === 'object' ? global : {};\nvar AMDLoader;\n(function (AMDLoader) {\n\tAMDLoader.global = _amdLoaderGlobal;\n\tclass Environment {\n\t\tget isWindows() {\n\t\t\tthis._detect();\n\t\t\treturn this._isWindows;\n\t\t}\n\t\tget isNode() {\n\t\t\tthis._detect();\n\t\t\treturn this._isNode;\n\t\t}\n\t\tget isElectronRenderer() {\n\t\t\tthis._detect();\n\t\t\treturn this._isElectronRenderer;\n\t\t}\n\t\tget isWebWorker() {\n\t\t\tthis._detect();\n\t\t\treturn this._isWebWorker;\n\t\t}\n\t\tget isElectronNodeIntegrationWebWorker() {\n\t\t\tthis._detect();\n\t\t\treturn this._isElectronNodeIntegrationWebWorker;\n\t\t}\n\t\tconstructor() {\n\t\t\tthis._detected = false;\n\t\t\tthis._isWindows = false;\n\t\t\tthis._isNode = false;\n\t\t\tthis._isElectronRenderer = false;\n\t\t\tthis._isWebWorker = false;\n\t\t\tthis._isElectronNodeIntegrationWebWorker = false;\n\t\t}\n\t\t_detect() {\n\t\t\tif (this._detected) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._detected = true;\n\t\t\tthis._isWindows = Environment._isWindows();\n\t\t\tthis._isNode = (typeof module !== 'undefined' && !!module.exports);\n\t\t\tthis._isElectronRenderer = (typeof process !== 'undefined' && typeof process.versions !== 'undefined' && typeof process.versions.electron !== 'undefined' && process.type === 'renderer');\n\t\t\tthis._isWebWorker = (typeof AMDLoader.global.importScripts === 'function');\n\t\t\tthis._isElectronNodeIntegrationWebWorker = this._isWebWorker && (typeof process !== 'undefined' && typeof process.versions !== 'undefined' && typeof process.versions.electron !== 'undefined' && process.type === 'worker');\n\t\t}\n\t\tstatic _isWindows() {\n\t\t\tif (typeof navigator !== 'undefined') {\n\t\t\t\tif (navigator.userAgent && navigator.userAgent.indexOf('Windows') >= 0) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof process !== 'undefined') {\n\t\t\t\treturn (process.platform === 'win32');\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\tAMDLoader.Environment = Environment;\n})(AMDLoader || (AMDLoader = {}));\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar AMDLoader;\n(function (AMDLoader) {\n\tclass LoaderEvent {\n\t\tconstructor(type, detail, timestamp) {\n\t\t\tthis.type = type;\n\t\t\tthis.detail = detail;\n\t\t\tthis.timestamp = timestamp;\n\t\t}\n\t}\n\tAMDLoader.LoaderEvent = LoaderEvent;\n\tclass LoaderEventRecorder {\n\t\tconstructor(loaderAvailableTimestamp) {\n\t\t\tthis._events = [new LoaderEvent(1 /* LoaderEventType.LoaderAvailable */, '', loaderAvailableTimestamp)];\n\t\t}\n\t\trecord(type, detail) {\n\t\t\tthis._events.push(new LoaderEvent(type, detail, AMDLoader.Utilities.getHighPerformanceTimestamp()));\n\t\t}\n\t\tgetEvents() {\n\t\t\treturn this._events;\n\t\t}\n\t}\n\tAMDLoader.LoaderEventRecorder = LoaderEventRecorder;\n\tclass NullLoaderEventRecorder {\n\t\trecord(type, detail) {\n\t\t\t// Nothing to do\n\t\t}\n\t\tgetEvents() {\n\t\t\treturn [];\n\t\t}\n\t}\n\tNullLoaderEventRecorder.INSTANCE = new NullLoaderEventRecorder();\n\tAMDLoader.NullLoaderEventRecorder = NullLoaderEventRecorder;\n})(AMDLoader || (AMDLoader = {}));\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar AMDLoader;\n(function (AMDLoader) {\n\tclass Utilities {\n\t\t/**\n\t\t * This method does not take care of / vs \\\n\t\t */\n\t\tstatic fileUriToFilePath(isWindows, uri) {\n\t\t\turi = decodeURI(uri).replace(/%23/g, '#');\n\t\t\tif (isWindows) {\n\t\t\t\tif (/^file:\\/\\/\\//.test(uri)) {\n\t\t\t\t\t// This is a URI without a hostname => return only the path segment\n\t\t\t\t\treturn uri.substr(8);\n\t\t\t\t}\n\t\t\t\tif (/^file:\\/\\//.test(uri)) {\n\t\t\t\t\treturn uri.substr(5);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (/^file:\\/\\//.test(uri)) {\n\t\t\t\t\treturn uri.substr(7);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Not sure...\n\t\t\treturn uri;\n\t\t}\n\t\tstatic startsWith(haystack, needle) {\n\t\t\treturn haystack.length >= needle.length && haystack.substr(0, needle.length) === needle;\n\t\t}\n\t\tstatic endsWith(haystack, needle) {\n\t\t\treturn haystack.length >= needle.length && haystack.substr(haystack.length - needle.length) === needle;\n\t\t}\n\t\t// only check for \"?\" before \"#\" to ensure that there is a real Query-String\n\t\tstatic containsQueryString(url) {\n\t\t\treturn /^[^\\#]*\\?/gi.test(url);\n\t\t}\n\t\t/**\n\t\t * Does `url` start with http:// or https:// or file:// or / ?\n\t\t */\n\t\tstatic isAbsolutePath(url) {\n\t\t\treturn /^((http:\\/\\/)|(https:\\/\\/)|(file:\\/\\/)|(\\/))/.test(url);\n\t\t}\n\t\tstatic forEachProperty(obj, callback) {\n\t\t\tif (obj) {\n\t\t\t\tlet key;\n\t\t\t\tfor (key in obj) {\n\t\t\t\t\tif (obj.hasOwnProperty(key)) {\n\t\t\t\t\t\tcallback(key, obj[key]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tstatic isEmpty(obj) {\n\t\t\tlet isEmpty = true;\n\t\t\tUtilities.forEachProperty(obj, () => {\n\t\t\t\tisEmpty = false;\n\t\t\t});\n\t\t\treturn isEmpty;\n\t\t}\n\t\tstatic recursiveClone(obj) {\n\t\t\tif (!obj || typeof obj !== 'object' || obj instanceof RegExp) {\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t\tif (!Array.isArray(obj) && Object.getPrototypeOf(obj) !== Object.prototype) {\n\t\t\t\t// only clone \"simple\" objects\n\t\t\t\treturn obj;\n\t\t\t}\n\t\t\tlet result = Array.isArray(obj) ? [] : {};\n\t\t\tUtilities.forEachProperty(obj, (key, value) => {\n\t\t\t\tif (value && typeof value === 'object') {\n\t\t\t\t\tresult[key] = Utilities.recursiveClone(value);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult[key] = value;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\tstatic generateAnonymousModule() {\n\t\t\treturn '===anonymous' + (Utilities.NEXT_ANONYMOUS_ID++) + '===';\n\t\t}\n\t\tstatic isAnonymousModule(id) {\n\t\t\treturn Utilities.startsWith(id, '===anonymous');\n\t\t}\n\t\tstatic getHighPerformanceTimestamp() {\n\t\t\tif (!this.PERFORMANCE_NOW_PROBED) {\n\t\t\t\tthis.PERFORMANCE_NOW_PROBED = true;\n\t\t\t\tthis.HAS_PERFORMANCE_NOW = (AMDLoader.global.performance && typeof AMDLoader.global.performance.now === 'function');\n\t\t\t}\n\t\t\treturn (this.HAS_PERFORMANCE_NOW ? AMDLoader.global.performance.now() : Date.now());\n\t\t}\n\t}\n\tUtilities.NEXT_ANONYMOUS_ID = 1;\n\tUtilities.PERFORMANCE_NOW_PROBED = false;\n\tUtilities.HAS_PERFORMANCE_NOW = false;\n\tAMDLoader.Utilities = Utilities;\n})(AMDLoader || (AMDLoader = {}));\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar AMDLoader;\n(function (AMDLoader) {\n\tfunction ensureError(err) {\n\t\tif (err instanceof Error) {\n\t\t\treturn err;\n\t\t}\n\t\tconst result = new Error(err.message || String(err) || 'Unknown Error');\n\t\tif (err.stack) {\n\t\t\tresult.stack = err.stack;\n\t\t}\n\t\treturn result;\n\t}\n\tAMDLoader.ensureError = ensureError;\n\t;\n\tclass ConfigurationOptionsUtil {\n\t\t/**\n\t\t * Ensure configuration options make sense\n\t\t */\n\t\tstatic validateConfigurationOptions(options) {\n\t\t\tfunction defaultOnError(err) {\n\t\t\t\tif (err.phase === 'loading') {\n\t\t\t\t\tconsole.error('Loading \"' + err.moduleId + '\" failed');\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\tconsole.error('Here are the modules that depend on it:');\n\t\t\t\t\tconsole.error(err.neededBy);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (err.phase === 'factory') {\n\t\t\t\t\tconsole.error('The factory function of \"' + err.moduleId + '\" has thrown an exception');\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\tconsole.error('Here are the modules that depend on it:');\n\t\t\t\t\tconsole.error(err.neededBy);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\toptions = options || {};\n\t\t\tif (typeof options.baseUrl !== 'string') {\n\t\t\t\toptions.baseUrl = '';\n\t\t\t}\n\t\t\tif (typeof options.isBuild !== 'boolean') {\n\t\t\t\toptions.isBuild = false;\n\t\t\t}\n\t\t\tif (typeof options.paths !== 'object') {\n\t\t\t\toptions.paths = {};\n\t\t\t}\n\t\t\tif (typeof options.config !== 'object') {\n\t\t\t\toptions.config = {};\n\t\t\t}\n\t\t\tif (typeof options.catchError === 'undefined') {\n\t\t\t\toptions.catchError = false;\n\t\t\t}\n\t\t\tif (typeof options.recordStats === 'undefined') {\n\t\t\t\toptions.recordStats = false;\n\t\t\t}\n\t\t\tif (typeof options.urlArgs !== 'string') {\n\t\t\t\toptions.urlArgs = '';\n\t\t\t}\n\t\t\tif (typeof options.onError !== 'function') {\n\t\t\t\toptions.onError = defaultOnError;\n\t\t\t}\n\t\t\tif (!Array.isArray(options.ignoreDuplicateModules)) {\n\t\t\t\toptions.ignoreDuplicateModules = [];\n\t\t\t}\n\t\t\tif (options.baseUrl.length > 0) {\n\t\t\t\tif (!AMDLoader.Utilities.endsWith(options.baseUrl, '/')) {\n\t\t\t\t\toptions.baseUrl += '/';\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (typeof options.cspNonce !== 'string') {\n\t\t\t\toptions.cspNonce = '';\n\t\t\t}\n\t\t\tif (typeof options.preferScriptTags === 'undefined') {\n\t\t\t\toptions.preferScriptTags = false;\n\t\t\t}\n\t\t\tif (options.nodeCachedData && typeof options.nodeCachedData === 'object') {\n\t\t\t\tif (typeof options.nodeCachedData.seed !== 'string') {\n\t\t\t\t\toptions.nodeCachedData.seed = 'seed';\n\t\t\t\t}\n\t\t\t\tif (typeof options.nodeCachedData.writeDelay !== 'number' || options.nodeCachedData.writeDelay < 0) {\n\t\t\t\t\toptions.nodeCachedData.writeDelay = 1000 * 7;\n\t\t\t\t}\n\t\t\t\tif (!options.nodeCachedData.path || typeof options.nodeCachedData.path !== 'string') {\n\t\t\t\t\tconst err = ensureError(new Error('INVALID cached data configuration, \\'path\\' MUST be set'));\n\t\t\t\t\terr.phase = 'configuration';\n\t\t\t\t\toptions.onError(err);\n\t\t\t\t\toptions.nodeCachedData = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tstatic mergeConfigurationOptions(overwrite = null, base = null) {\n\t\t\tlet result = AMDLoader.Utilities.recursiveClone(base || {});\n\t\t\t// Merge known properties and overwrite the unknown ones\n\t\t\tAMDLoader.Utilities.forEachProperty(overwrite, (key, value) => {\n\t\t\t\tif (key === 'ignoreDuplicateModules' && typeof result.ignoreDuplicateModules !== 'undefined') {\n\t\t\t\t\tresult.ignoreDuplicateModules = result.ignoreDuplicateModules.concat(value);\n\t\t\t\t}\n\t\t\t\telse if (key === 'paths' && typeof result.paths !== 'undefined') {\n\t\t\t\t\tAMDLoader.Utilities.forEachProperty(value, (key2, value2) => result.paths[key2] = value2);\n\t\t\t\t}\n\t\t\t\telse if (key === 'config' && typeof result.config !== 'undefined') {\n\t\t\t\t\tAMDLoader.Utilities.forEachProperty(value, (key2, value2) => result.config[key2] = value2);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tresult[key] = AMDLoader.Utilities.recursiveClone(value);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn ConfigurationOptionsUtil.validateConfigurationOptions(result);\n\t\t}\n\t}\n\tAMDLoader.ConfigurationOptionsUtil = ConfigurationOptionsUtil;\n\tclass Configuration {\n\t\tconstructor(env, options) {\n\t\t\tthis._env = env;\n\t\t\tthis.options = ConfigurationOptionsUtil.mergeConfigurationOptions(options);\n\t\t\tthis._createIgnoreDuplicateModulesMap();\n\t\t\tthis._createSortedPathsRules();\n\t\t\tif (this.options.baseUrl === '') {\n\t\t\t\tif (this.options.nodeRequire && this.options.nodeRequire.main && this.options.nodeRequire.main.filename && this._env.isNode) {\n\t\t\t\t\tlet nodeMain = this.options.nodeRequire.main.filename;\n\t\t\t\t\tlet dirnameIndex = Math.max(nodeMain.lastIndexOf('/'), nodeMain.lastIndexOf('\\\\'));\n\t\t\t\t\tthis.options.baseUrl = nodeMain.substring(0, dirnameIndex + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_createIgnoreDuplicateModulesMap() {\n\t\t\t// Build a map out of the ignoreDuplicateModules array\n\t\t\tthis.ignoreDuplicateModulesMap = {};\n\t\t\tfor (let i = 0; i < this.options.ignoreDuplicateModules.length; i++) {\n\t\t\t\tthis.ignoreDuplicateModulesMap[this.options.ignoreDuplicateModules[i]] = true;\n\t\t\t}\n\t\t}\n\t\t_createSortedPathsRules() {\n\t\t\t// Create an array our of the paths rules, sorted descending by length to\n\t\t\t// result in a more specific -> less specific order\n\t\t\tthis.sortedPathsRules = [];\n\t\t\tAMDLoader.Utilities.forEachProperty(this.options.paths, (from, to) => {\n\t\t\t\tif (!Array.isArray(to)) {\n\t\t\t\t\tthis.sortedPathsRules.push({\n\t\t\t\t\t\tfrom: from,\n\t\t\t\t\t\tto: [to]\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.sortedPathsRules.push({\n\t\t\t\t\t\tfrom: from,\n\t\t\t\t\t\tto: to\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.sortedPathsRules.sort((a, b) => {\n\t\t\t\treturn b.from.length - a.from.length;\n\t\t\t});\n\t\t}\n\t\t/**\n\t\t * Clone current configuration and overwrite options selectively.\n\t\t * @param options The selective options to overwrite with.\n\t\t * @result A new configuration\n\t\t */\n\t\tcloneAndMerge(options) {\n\t\t\treturn new Configuration(this._env, ConfigurationOptionsUtil.mergeConfigurationOptions(options, this.options));\n\t\t}\n\t\t/**\n\t\t * Get current options bag. Useful for passing it forward to plugins.\n\t\t */\n\t\tgetOptionsLiteral() {\n\t\t\treturn this.options;\n\t\t}\n\t\t_applyPaths(moduleId) {\n\t\t\tlet pathRule;\n\t\t\tfor (let i = 0, len = this.sortedPathsRules.length; i < len; i++) {\n\t\t\t\tpathRule = this.sortedPathsRules[i];\n\t\t\t\tif (AMDLoader.Utilities.startsWith(moduleId, pathRule.from)) {\n\t\t\t\t\tlet result = [];\n\t\t\t\t\tfor (let j = 0, lenJ = pathRule.to.length; j < lenJ; j++) {\n\t\t\t\t\t\tresult.push(pathRule.to[j] + moduleId.substr(pathRule.from.length));\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn [moduleId];\n\t\t}\n\t\t_addUrlArgsToUrl(url) {\n\t\t\tif (AMDLoader.Utilities.containsQueryString(url)) {\n\t\t\t\treturn url + '&' + this.options.urlArgs;\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn url + '?' + this.options.urlArgs;\n\t\t\t}\n\t\t}\n\t\t_addUrlArgsIfNecessaryToUrl(url) {\n\t\t\tif (this.options.urlArgs) {\n\t\t\t\treturn this._addUrlArgsToUrl(url);\n\t\t\t}\n\t\t\treturn url;\n\t\t}\n\t\t_addUrlArgsIfNecessaryToUrls(urls) {\n\t\t\tif (this.options.urlArgs) {\n\t\t\t\tfor (let i = 0, len = urls.length; i < len; i++) {\n\t\t\t\t\turls[i] = this._addUrlArgsToUrl(urls[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn urls;\n\t\t}\n\t\t/**\n\t\t * Transform a module id to a location. Appends .js to module ids\n\t\t */\n\t\tmoduleIdToPaths(moduleId) {\n\t\t\tif (this._env.isNode) {\n\t\t\t\tconst isNodeModule = (this.options.amdModulesPattern instanceof RegExp\n\t\t\t\t\t&& !this.options.amdModulesPattern.test(moduleId));\n\t\t\t\tif (isNodeModule) {\n\t\t\t\t\t// This is a node module...\n\t\t\t\t\tif (this.isBuild()) {\n\t\t\t\t\t\t// ...and we are at build time, drop it\n\t\t\t\t\t\treturn ['empty:'];\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\t// ...and at runtime we create a `shortcut`-path\n\t\t\t\t\t\treturn ['node|' + moduleId];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet result = moduleId;\n\t\t\tlet results;\n\t\t\tif (!AMDLoader.Utilities.endsWith(result, '.js') && !AMDLoader.Utilities.isAbsolutePath(result)) {\n\t\t\t\tresults = this._applyPaths(result);\n\t\t\t\tfor (let i = 0, len = results.length; i < len; i++) {\n\t\t\t\t\tif (this.isBuild() && results[i] === 'empty:') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (!AMDLoader.Utilities.isAbsolutePath(results[i])) {\n\t\t\t\t\t\tresults[i] = this.options.baseUrl + results[i];\n\t\t\t\t\t}\n\t\t\t\t\tif (!AMDLoader.Utilities.endsWith(results[i], '.js') && !AMDLoader.Utilities.containsQueryString(results[i])) {\n\t\t\t\t\t\tresults[i] = results[i] + '.js';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (!AMDLoader.Utilities.endsWith(result, '.js') && !AMDLoader.Utilities.containsQueryString(result)) {\n\t\t\t\t\tresult = result + '.js';\n\t\t\t\t}\n\t\t\t\tresults = [result];\n\t\t\t}\n\t\t\treturn this._addUrlArgsIfNecessaryToUrls(results);\n\t\t}\n\t\t/**\n\t\t * Transform a module id or url to a location.\n\t\t */\n\t\trequireToUrl(url) {\n\t\t\tlet result = url;\n\t\t\tif (!AMDLoader.Utilities.isAbsolutePath(result)) {\n\t\t\t\tresult = this._applyPaths(result)[0];\n\t\t\t\tif (!AMDLoader.Utilities.isAbsolutePath(result)) {\n\t\t\t\t\tresult = this.options.baseUrl + result;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this._addUrlArgsIfNecessaryToUrl(result);\n\t\t}\n\t\t/**\n\t\t * Flag to indicate if current execution is as part of a build.\n\t\t */\n\t\tisBuild() {\n\t\t\treturn this.options.isBuild;\n\t\t}\n\t\tshouldInvokeFactory(strModuleId) {\n\t\t\tif (!this.options.isBuild) {\n\t\t\t\t// outside of a build, all factories should be invoked\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t// during a build, only explicitly marked or anonymous modules get their factories invoked\n\t\t\tif (AMDLoader.Utilities.isAnonymousModule(strModuleId)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tif (this.options.buildForceInvokeFactory && this.options.buildForceInvokeFactory[strModuleId]) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Test if module `moduleId` is expected to be defined multiple times\n\t\t */\n\t\tisDuplicateMessageIgnoredFor(moduleId) {\n\t\t\treturn this.ignoreDuplicateModulesMap.hasOwnProperty(moduleId);\n\t\t}\n\t\t/**\n\t\t * Get the configuration settings for the provided module id\n\t\t */\n\t\tgetConfigForModule(moduleId) {\n\t\t\tif (this.options.config) {\n\t\t\t\treturn this.options.config[moduleId];\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Should errors be caught when executing module factories?\n\t\t */\n\t\tshouldCatchError() {\n\t\t\treturn this.options.catchError;\n\t\t}\n\t\t/**\n\t\t * Should statistics be recorded?\n\t\t */\n\t\tshouldRecordStats() {\n\t\t\treturn this.options.recordStats;\n\t\t}\n\t\t/**\n\t\t * Forward an error to the error handler.\n\t\t */\n\t\tonError(err) {\n\t\t\tthis.options.onError(err);\n\t\t}\n\t}\n\tAMDLoader.Configuration = Configuration;\n})(AMDLoader || (AMDLoader = {}));\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar AMDLoader;\n(function (AMDLoader) {\n\t/**\n\t * Load `scriptSrc` only once (avoid multiple <script> tags)\n\t */\n\tclass OnlyOnceScriptLoader {\n\t\tconstructor(env) {\n\t\t\tthis._env = env;\n\t\t\tthis._scriptLoader = null;\n\t\t\tthis._callbackMap = {};\n\t\t}\n\t\tload(moduleManager, scriptSrc, callback, errorback) {\n\t\t\tif (!this._scriptLoader) {\n\t\t\t\tif (this._env.isWebWorker) {\n\t\t\t\t\tthis._scriptLoader = new WorkerScriptLoader();\n\t\t\t\t}\n\t\t\t\telse if (this._env.isElectronRenderer) {\n\t\t\t\t\tconst { preferScriptTags } = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\t\tif (preferScriptTags) {\n\t\t\t\t\t\tthis._scriptLoader = new BrowserScriptLoader();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tthis._scriptLoader = new NodeScriptLoader(this._env);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (this._env.isNode) {\n\t\t\t\t\tthis._scriptLoader = new NodeScriptLoader(this._env);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._scriptLoader = new BrowserScriptLoader();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet scriptCallbacks = {\n\t\t\t\tcallback: callback,\n\t\t\t\terrorback: errorback\n\t\t\t};\n\t\t\tif (this._callbackMap.hasOwnProperty(scriptSrc)) {\n\t\t\t\tthis._callbackMap[scriptSrc].push(scriptCallbacks);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._callbackMap[scriptSrc] = [scriptCallbacks];\n\t\t\tthis._scriptLoader.load(moduleManager, scriptSrc, () => this.triggerCallback(scriptSrc), (err) => this.triggerErrorback(scriptSrc, err));\n\t\t}\n\t\ttriggerCallback(scriptSrc) {\n\t\t\tlet scriptCallbacks = this._callbackMap[scriptSrc];\n\t\t\tdelete this._callbackMap[scriptSrc];\n\t\t\tfor (let i = 0; i < scriptCallbacks.length; i++) {\n\t\t\t\tscriptCallbacks[i].callback();\n\t\t\t}\n\t\t}\n\t\ttriggerErrorback(scriptSrc, err) {\n\t\t\tlet scriptCallbacks = this._callbackMap[scriptSrc];\n\t\t\tdelete this._callbackMap[scriptSrc];\n\t\t\tfor (let i = 0; i < scriptCallbacks.length; i++) {\n\t\t\t\tscriptCallbacks[i].errorback(err);\n\t\t\t}\n\t\t}\n\t}\n\tclass BrowserScriptLoader {\n\t\t/**\n\t\t * Attach load / error listeners to a script element and remove them when either one has fired.\n\t\t * Implemented for browsers supporting HTML5 standard 'load' and 'error' events.\n\t\t */\n\t\tattachListeners(script, callback, errorback) {\n\t\t\tlet unbind = () => {\n\t\t\t\tscript.removeEventListener('load', loadEventListener);\n\t\t\t\tscript.removeEventListener('error', errorEventListener);\n\t\t\t};\n\t\t\tlet loadEventListener = (e) => {\n\t\t\t\tunbind();\n\t\t\t\tcallback();\n\t\t\t};\n\t\t\tlet errorEventListener = (e) => {\n\t\t\t\tunbind();\n\t\t\t\terrorback(e);\n\t\t\t};\n\t\t\tscript.addEventListener('load', loadEventListener);\n\t\t\tscript.addEventListener('error', errorEventListener);\n\t\t}\n\t\tload(moduleManager, scriptSrc, callback, errorback) {\n\t\t\tif (/^node\\|/.test(scriptSrc)) {\n\t\t\t\tlet opts = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\tlet nodeRequire = ensureRecordedNodeRequire(moduleManager.getRecorder(), (opts.nodeRequire || AMDLoader.global.nodeRequire));\n\t\t\t\tlet pieces = scriptSrc.split('|');\n\t\t\t\tlet moduleExports = null;\n\t\t\t\ttry {\n\t\t\t\t\tmoduleExports = nodeRequire(pieces[1]);\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t\terrorback(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tmoduleManager.enqueueDefineAnonymousModule([], () => moduleExports);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet script = document.createElement('script');\n\t\t\t\tscript.setAttribute('async', 'async');\n\t\t\t\tscript.setAttribute('type', 'text/javascript');\n\t\t\t\tthis.attachListeners(script, callback, errorback);\n\t\t\t\tconst { trustedTypesPolicy } = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\tif (trustedTypesPolicy) {\n\t\t\t\t\tscriptSrc = trustedTypesPolicy.createScriptURL(scriptSrc);\n\t\t\t\t}\n\t\t\t\tscript.setAttribute('src', scriptSrc);\n\t\t\t\t// Propagate CSP nonce to dynamically created script tag.\n\t\t\t\tconst { cspNonce } = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\tif (cspNonce) {\n\t\t\t\t\tscript.setAttribute('nonce', cspNonce);\n\t\t\t\t}\n\t\t\t\tdocument.getElementsByTagName('head')[0].appendChild(script);\n\t\t\t}\n\t\t}\n\t}\n\tfunction canUseEval(moduleManager) {\n\t\tconst { trustedTypesPolicy } = moduleManager.getConfig().getOptionsLiteral();\n\t\ttry {\n\t\t\tconst func = (trustedTypesPolicy\n\t\t\t\t? self.eval(trustedTypesPolicy.createScript('', 'true')) // CodeQL [SM01632] the loader is responsible with loading code, fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\n\t\t\t\t: new Function('true') // CodeQL [SM01632] the loader is responsible with loading code, fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\n\t\t\t);\n\t\t\tfunc.call(self);\n\t\t\treturn true;\n\t\t}\n\t\tcatch (err) {\n\t\t\treturn false;\n\t\t}\n\t}\n\tclass WorkerScriptLoader {\n\t\tconstructor() {\n\t\t\tthis._cachedCanUseEval = null;\n\t\t}\n\t\t_canUseEval(moduleManager) {\n\t\t\tif (this._cachedCanUseEval === null) {\n\t\t\t\tthis._cachedCanUseEval = canUseEval(moduleManager);\n\t\t\t}\n\t\t\treturn this._cachedCanUseEval;\n\t\t}\n\t\tload(moduleManager, scriptSrc, callback, errorback) {\n\t\t\tif (/^node\\|/.test(scriptSrc)) {\n\t\t\t\tconst opts = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\tconst nodeRequire = ensureRecordedNodeRequire(moduleManager.getRecorder(), (opts.nodeRequire || AMDLoader.global.nodeRequire));\n\t\t\t\tconst pieces = scriptSrc.split('|');\n\t\t\t\tlet moduleExports = null;\n\t\t\t\ttry {\n\t\t\t\t\tmoduleExports = nodeRequire(pieces[1]);\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t\terrorback(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tmoduleManager.enqueueDefineAnonymousModule([], function () { return moduleExports; });\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tconst { trustedTypesPolicy } = moduleManager.getConfig().getOptionsLiteral();\n\t\t\t\tconst isCrossOrigin = (/^((http:)|(https:)|(file:))/.test(scriptSrc) && scriptSrc.substring(0, self.origin.length) !== self.origin);\n\t\t\t\tif (!isCrossOrigin && this._canUseEval(moduleManager)) {\n\t\t\t\t\t// use `fetch` if possible because `importScripts`\n\t\t\t\t\t// is synchronous and can lead to deadlocks on Safari\n\t\t\t\t\tfetch(scriptSrc).then((response) => {\n\t\t\t\t\t\tif (response.status !== 200) {\n\t\t\t\t\t\t\tthrow new Error(response.statusText);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn response.text();\n\t\t\t\t\t}).then((text) => {\n\t\t\t\t\t\ttext = `${text}\\n//# sourceURL=${scriptSrc}`;\n\t\t\t\t\t\tconst func = (trustedTypesPolicy\n\t\t\t\t\t\t\t? self.eval(trustedTypesPolicy.createScript('', text))\n\t\t\t\t\t\t\t: new Function(text) // CodeQL [SM01632] the loader is responsible with loading code, fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\n\t\t\t\t\t\t);\n\t\t\t\t\t\tfunc.call(self);\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t}).then(undefined, errorback);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\ttry {\n\t\t\t\t\tif (trustedTypesPolicy) {\n\t\t\t\t\t\tscriptSrc = trustedTypesPolicy.createScriptURL(scriptSrc);\n\t\t\t\t\t}\n\t\t\t\t\timportScripts(scriptSrc);\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t\tcatch (e) {\n\t\t\t\t\terrorback(e);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tclass NodeScriptLoader {\n\t\tconstructor(env) {\n\t\t\tthis._env = env;\n\t\t\tthis._didInitialize = false;\n\t\t\tthis._didPatchNodeRequire = false;\n\t\t}\n\t\t_init(nodeRequire) {\n\t\t\tif (this._didInitialize) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._didInitialize = true;\n\t\t\t// capture node modules\n\t\t\tthis._fs = nodeRequire('fs');\n\t\t\tthis._vm = nodeRequire('vm');\n\t\t\tthis._path = nodeRequire('path');\n\t\t\tthis._crypto = nodeRequire('crypto');\n\t\t}\n\t\t// patch require-function of nodejs such that we can manually create a script\n\t\t// from cached data. this is done by overriding the `Module._compile` function\n\t\t_initNodeRequire(nodeRequire, moduleManager) {\n\t\t\t// It is important to check for `nodeCachedData` first and then set `_didPatchNodeRequire`.\n\t\t\t// That's because `nodeCachedData` is set _after_ calling this for the first time...\n\t\t\tconst { nodeCachedData } = moduleManager.getConfig().getOptionsLiteral();\n\t\t\tif (!nodeCachedData) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (this._didPatchNodeRequire) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._didPatchNodeRequire = true;\n\t\t\tconst that = this;\n\t\t\tconst Module = nodeRequire('module');\n\t\t\tfunction makeRequireFunction(mod) {\n\t\t\t\tconst Module = mod.constructor;\n\t\t\t\tlet require = function require(path) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn mod.require(path);\n\t\t\t\t\t}\n\t\t\t\t\tfinally {\n\t\t\t\t\t\t// nothing\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\trequire.resolve = function resolve(request, options) {\n\t\t\t\t\treturn Module._resolveFilename(request, mod, false, options);\n\t\t\t\t};\n\t\t\t\trequire.resolve.paths = function paths(request) {\n\t\t\t\t\treturn Module._resolveLookupPaths(request, mod);\n\t\t\t\t};\n\t\t\t\trequire.main = process.mainModule;\n\t\t\t\trequire.extensions = Module._extensions;\n\t\t\t\trequire.cache = Module._cache;\n\t\t\t\treturn require;\n\t\t\t}\n\t\t\tModule.prototype._compile = function (content, filename) {\n\t\t\t\t// remove shebang and create wrapper function\n\t\t\t\tconst scriptSource = Module.wrap(content.replace(/^#!.*/, ''));\n\t\t\t\t// create script\n\t\t\t\tconst recorder = moduleManager.getRecorder();\n\t\t\t\tconst cachedDataPath = that._getCachedDataPath(nodeCachedData, filename);\n\t\t\t\tconst options = { filename };\n\t\t\t\tlet hashData;\n\t\t\t\ttry {\n\t\t\t\t\tconst data = that._fs.readFileSync(cachedDataPath);\n\t\t\t\t\thashData = data.slice(0, 16);\n\t\t\t\t\toptions.cachedData = data.slice(16);\n\t\t\t\t\trecorder.record(60 /* LoaderEventType.CachedDataFound */, cachedDataPath);\n\t\t\t\t}\n\t\t\t\tcatch (_e) {\n\t\t\t\t\trecorder.record(61 /* LoaderEventType.CachedDataMissed */, cachedDataPath);\n\t\t\t\t}\n\t\t\t\tconst script = new that._vm.Script(scriptSource, options);\n\t\t\t\tconst compileWrapper = script.runInThisContext(options);\n\t\t\t\t// run script\n\t\t\t\tconst dirname = that._path.dirname(filename);\n\t\t\t\tconst require = makeRequireFunction(this);\n\t\t\t\tconst args = [this.exports, require, this, filename, dirname, process, _commonjsGlobal, Buffer];\n\t\t\t\tconst result = compileWrapper.apply(this.exports, args);\n\t\t\t\t// cached data aftermath\n\t\t\t\tthat._handleCachedData(script, scriptSource, cachedDataPath, !options.cachedData, moduleManager);\n\t\t\t\tthat._verifyCachedData(script, scriptSource, cachedDataPath, hashData, moduleManager);\n\t\t\t\treturn result;\n\t\t\t};\n\t\t}\n\t\tload(moduleManager, scriptSrc, callback, errorback) {\n\t\t\tconst opts = moduleManager.getConfig().getOptionsLiteral();\n\t\t\tconst nodeRequire = ensureRecordedNodeRequire(moduleManager.getRecorder(), (opts.nodeRequire || AMDLoader.global.nodeRequire));\n\t\t\tconst nodeInstrumenter = (opts.nodeInstrumenter || function (c) { return c; });\n\t\t\tthis._init(nodeRequire);\n\t\t\tthis._initNodeRequire(nodeRequire, moduleManager);\n\t\t\tlet recorder = moduleManager.getRecorder();\n\t\t\tif (/^node\\|/.test(scriptSrc)) {\n\t\t\t\tlet pieces = scriptSrc.split('|');\n\t\t\t\tlet moduleExports = null;\n\t\t\t\ttry {\n\t\t\t\t\tmoduleExports = nodeRequire(pieces[1]);\n\t\t\t\t}\n\t\t\t\tcatch (err) {\n\t\t\t\t\terrorback(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tmoduleManager.enqueueDefineAnonymousModule([], () => moduleExports);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tscriptSrc = AMDLoader.Utilities.fileUriToFilePath(this._env.isWindows, scriptSrc);\n\t\t\t\tconst normalizedScriptSrc = this._path.normalize(scriptSrc);\n\t\t\t\tconst vmScriptPathOrUri = this._getElectronRendererScriptPathOrUri(normalizedScriptSrc);\n\t\t\t\tconst wantsCachedData = Boolean(opts.nodeCachedData);\n\t\t\t\tconst cachedDataPath = wantsCachedData ? this._getCachedDataPath(opts.nodeCachedData, scriptSrc) : undefined;\n\t\t\t\tthis._readSourceAndCachedData(normalizedScriptSrc, cachedDataPath, recorder, (err, data, cachedData, hashData) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\terrorback(err);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlet scriptSource;\n\t\t\t\t\tif (data.charCodeAt(0) === NodeScriptLoader._BOM) {\n\t\t\t\t\t\tscriptSource = NodeScriptLoader._PREFIX + data.substring(1) + NodeScriptLoader._SUFFIX;\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tscriptSource = NodeScriptLoader._PREFIX + data + NodeScriptLoader._SUFFIX;\n\t\t\t\t\t}\n\t\t\t\t\tscriptSource = nodeInstrumenter(scriptSource, normalizedScriptSrc);\n\t\t\t\t\tconst scriptOpts = { filename: vmScriptPathOrUri, cachedData };\n\t\t\t\t\tconst script = this._createAndEvalScript(moduleManager, scriptSource, scriptOpts, callback, errorback);\n\t\t\t\t\tthis._handleCachedData(script, scriptSource, cachedDataPath, wantsCachedData && !cachedData, moduleManager);\n\t\t\t\t\tthis._verifyCachedData(script, scriptSource, cachedDataPath, hashData, moduleManager);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t_createAndEvalScript(moduleManager, contents, options, callback, errorback) {\n\t\t\tconst recorder = moduleManager.getRecorder();\n\t\t\trecorder.record(31 /* LoaderEventType.NodeBeginEvaluatingScript */, options.filename);\n\t\t\tconst script = new this._vm.Script(contents, options);\n\t\t\tconst ret = script.runInThisContext(options);\n\t\t\tconst globalDefineFunc = moduleManager.getGlobalAMDDefineFunc();\n\t\t\tlet receivedDefineCall = false;\n\t\t\tconst localDefineFunc = function () {\n\t\t\t\treceivedDefineCall = true;\n\t\t\t\treturn globalDefineFunc.apply(null, arguments);\n\t\t\t};\n\t\t\tlocalDefineFunc.amd = globalDefineFunc.amd;\n\t\t\tret.call(AMDLoader.global, moduleManager.getGlobalAMDRequireFunc(), localDefineFunc, options.filename, this._path.dirname(options.filename));\n\t\t\trecorder.record(32 /* LoaderEventType.NodeEndEvaluatingScript */, options.filename);\n\t\t\tif (receivedDefineCall) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t\telse {\n\t\t\t\terrorback(new Error(`Didn't receive define call in ${options.filename}!`));\n\t\t\t}\n\t\t\treturn script;\n\t\t}\n\t\t_getElectronRendererScriptPathOrUri(path) {\n\t\t\tif (!this._env.isElectronRenderer) {\n\t\t\t\treturn path;\n\t\t\t}\n\t\t\tlet driveLetterMatch = path.match(/^([a-z])\\:(.*)/i);\n\t\t\tif (driveLetterMatch) {\n\t\t\t\t// windows\n\t\t\t\treturn `file:///${(driveLetterMatch[1].toUpperCase() + ':' + driveLetterMatch[2]).replace(/\\\\/g, '/')}`;\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// nix\n\t\t\t\treturn `file://${path}`;\n\t\t\t}\n\t\t}\n\t\t_getCachedDataPath(config, filename) {\n\t\t\tconst hash = this._crypto.createHash('md5').update(filename, 'utf8').update(config.seed, 'utf8').update(process.arch, '').digest('hex');\n\t\t\tconst basename = this._path.basename(filename).replace(/\\.js$/, '');\n\t\t\treturn this._path.join(config.path, `${basename}-${hash}.code`);\n\t\t}\n\t\t_handleCachedData(script, scriptSource, cachedDataPath, createCachedData, moduleManager) {\n\t\t\tif (script.cachedDataRejected) {\n\t\t\t\t// cached data got rejected -> delete and re-create\n\t\t\t\tthis._fs.unlink(cachedDataPath, err => {\n\t\t\t\t\tmoduleManager.getRecorder().record(62 /* LoaderEventType.CachedDataRejected */, cachedDataPath);\n\t\t\t\t\tthis._createAndWriteCachedData(script, scriptSource, cachedDataPath, moduleManager);\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tmoduleManager.getConfig().onError(err);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (createCachedData) {\n\t\t\t\t// no cached data, but wanted\n\t\t\t\tthis._createAndWriteCachedData(script, scriptSource, cachedDataPath, moduleManager);\n\t\t\t}\n\t\t}\n\t\t// Cached data format: | SOURCE_HASH | V8_CACHED_DATA |\n\t\t// -SOURCE_HASH is the md5 hash of the JS source (always 16 bytes)\n\t\t// -V8_CACHED_DATA is what v8 produces\n\t\t_createAndWriteCachedData(script, scriptSource, cachedDataPath, moduleManager) {\n\t\t\tlet timeout = Math.ceil(moduleManager.getConfig().getOptionsLiteral().nodeCachedData.writeDelay * (1 + Math.random()));\n\t\t\tlet lastSize = -1;\n\t\t\tlet iteration = 0;\n\t\t\tlet hashData = undefined;\n\t\t\tconst createLoop = () => {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (!hashData) {\n\t\t\t\t\t\thashData = this._crypto.createHash('md5').update(scriptSource, 'utf8').digest();\n\t\t\t\t\t}\n\t\t\t\t\tconst cachedData = script.createCachedData();\n\t\t\t\t\tif (cachedData.length === 0 || cachedData.length === lastSize || iteration >= 5) {\n\t\t\t\t\t\t// done\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (cachedData.length < lastSize) {\n\t\t\t\t\t\t// less data than before: skip, try again next round\n\t\t\t\t\t\tcreateLoop();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tlastSize = cachedData.length;\n\t\t\t\t\tthis._fs.writeFile(cachedDataPath, Buffer.concat([hashData, cachedData]), err => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tmoduleManager.getConfig().onError(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmoduleManager.getRecorder().record(63 /* LoaderEventType.CachedDataCreated */, cachedDataPath);\n\t\t\t\t\t\tcreateLoop();\n\t\t\t\t\t});\n\t\t\t\t}, timeout * (Math.pow(4, iteration++)));\n\t\t\t};\n\t\t\t// with some delay (`timeout`) create cached data\n\t\t\t// and repeat that (with backoff delay) until the\n\t\t\t// data seems to be not changing anymore\n\t\t\tcreateLoop();\n\t\t}\n\t\t_readSourceAndCachedData(sourcePath, cachedDataPath, recorder, callback) {\n\t\t\tif (!cachedDataPath) {\n\t\t\t\t// no cached data case\n\t\t\t\tthis._fs.readFile(sourcePath, { encoding: 'utf8' }, callback);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// cached data case: read both files in parallel\n\t\t\t\tlet source = undefined;\n\t\t\t\tlet cachedData = undefined;\n\t\t\t\tlet hashData = undefined;\n\t\t\t\tlet steps = 2;\n\t\t\t\tconst step = (err) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tcallback(err);\n\t\t\t\t\t}\n\t\t\t\t\telse if (--steps === 0) {\n\t\t\t\t\t\tcallback(undefined, source, cachedData, hashData);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tthis._fs.readFile(sourcePath, { encoding: 'utf8' }, (err, data) => {\n\t\t\t\t\tsource = data;\n\t\t\t\t\tstep(err);\n\t\t\t\t});\n\t\t\t\tthis._fs.readFile(cachedDataPath, (err, data) => {\n\t\t\t\t\tif (!err && data && data.length > 0) {\n\t\t\t\t\t\thashData = data.slice(0, 16);\n\t\t\t\t\t\tcachedData = data.slice(16);\n\t\t\t\t\t\trecorder.record(60 /* LoaderEventType.CachedDataFound */, cachedDataPath);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\trecorder.record(61 /* LoaderEventType.CachedDataMissed */, cachedDataPath);\n\t\t\t\t\t}\n\t\t\t\t\tstep(); // ignored: cached data is optional\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t_verifyCachedData(script, scriptSource, cachedDataPath, hashData, moduleManager) {\n\t\t\tif (!hashData) {\n\t\t\t\t// nothing to do\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (script.cachedDataRejected) {\n\t\t\t\t// invalid anyways\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tsetTimeout(() => {\n\t\t\t\t// check source hash - the contract is that file paths change when file content\n\t\t\t\t// change (e.g use the commit or version id as cache path). this check is\n\t\t\t\t// for violations of this contract.\n\t\t\t\tconst hashDataNow = this._crypto.createHash('md5').update(scriptSource, 'utf8').digest();\n\t\t\t\tif (!hashData.equals(hashDataNow)) {\n\t\t\t\t\tmoduleManager.getConfig().onError(new Error(`FAILED TO VERIFY CACHED DATA, deleting stale '${cachedDataPath}' now, but a RESTART IS REQUIRED`));\n\t\t\t\t\tthis._fs.unlink(cachedDataPath, err => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tmoduleManager.getConfig().onError(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, Math.ceil(5000 * (1 + Math.random())));\n\t\t}\n\t}\n\tNodeScriptLoader._BOM = 0xFEFF;\n\tNodeScriptLoader._PREFIX = '(function (require, define, __filename, __dirname) { ';\n\tNodeScriptLoader._SUFFIX = '\\n});';\n\tfunction ensureRecordedNodeRequire(recorder, _nodeRequire) {\n\t\tif (_nodeRequire.__$__isRecorded) {\n\t\t\t// it is already recorded\n\t\t\treturn _nodeRequire;\n\t\t}\n\t\tconst nodeRequire = function nodeRequire(what) {\n\t\t\trecorder.record(33 /* LoaderEventType.NodeBeginNativeRequire */, what);\n\t\t\ttry {\n\t\t\t\treturn _nodeRequire(what);\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\trecorder.record(34 /* LoaderEventType.NodeEndNativeRequire */, what);\n\t\t\t}\n\t\t};\n\t\tnodeRequire.__$__isRecorded = true;\n\t\treturn nodeRequire;\n\t}\n\tAMDLoader.ensureRecordedNodeRequire = ensureRecordedNodeRequire;\n\tfunction createScriptLoader(env) {\n\t\treturn new OnlyOnceScriptLoader(env);\n\t}\n\tAMDLoader.createScriptLoader = createScriptLoader;\n})(AMDLoader || (AMDLoader = {}));\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar AMDLoader;\n(function (AMDLoader) {\n\t// ------------------------------------------------------------------------\n\t// ModuleIdResolver\n\tclass ModuleIdResolver {\n\t\tconstructor(fromModuleId) {\n\t\t\tlet lastSlash = fromModuleId.lastIndexOf('/');\n\t\t\tif (lastSlash !== -1) {\n\t\t\t\tthis.fromModulePath = fromModuleId.substr(0, lastSlash + 1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.fromModulePath = '';\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Normalize 'a/../name' to 'name', etc.\n\t\t */\n\t\tstatic _normalizeModuleId(moduleId) {\n\t\t\tlet r = moduleId, pattern;\n\t\t\t// replace /./ => /\n\t\t\tpattern = /\\/\\.\\//;\n\t\t\twhile (pattern.test(r)) {\n\t\t\t\tr = r.replace(pattern, '/');\n\t\t\t}\n\t\t\t// replace ^./ => nothing\n\t\t\tr = r.replace(/^\\.\\//g, '');\n\t\t\t// replace /aa/../ => / (BUT IGNORE /../../)\n\t\t\tpattern = /\\/(([^\\/])|([^\\/][^\\/\\.])|([^\\/\\.][^\\/])|([^\\/][^\\/][^\\/]+))\\/\\.\\.\\//;\n\t\t\twhile (pattern.test(r)) {\n\t\t\t\tr = r.replace(pattern, '/');\n\t\t\t}\n\t\t\t// replace ^aa/../ => nothing (BUT IGNORE ../../)\n\t\t\tr = r.replace(/^(([^\\/])|([^\\/][^\\/\\.])|([^\\/\\.][^\\/])|([^\\/][^\\/][^\\/]+))\\/\\.\\.\\//, '');\n\t\t\treturn r;\n\t\t}\n\t\t/**\n\t\t * Resolve relative module ids\n\t\t */\n\t\tresolveModule(moduleId) {\n\t\t\tlet result = moduleId;\n\t\t\tif (!AMDLoader.Utilities.isAbsolutePath(result)) {\n\t\t\t\tif (AMDLoader.Utilities.startsWith(result, './') || AMDLoader.Utilities.startsWith(result, '../')) {\n\t\t\t\t\tresult = ModuleIdResolver._normalizeModuleId(this.fromModulePath + result);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\tModuleIdResolver.ROOT = new ModuleIdResolver('');\n\tAMDLoader.ModuleIdResolver = ModuleIdResolver;\n\t// ------------------------------------------------------------------------\n\t// Module\n\tclass Module {\n\t\tconstructor(id, strId, dependencies, callback, errorback, moduleIdResolver) {\n\t\t\tthis.id = id;\n\t\t\tthis.strId = strId;\n\t\t\tthis.dependencies = dependencies;\n\t\t\tthis._callback = callback;\n\t\t\tthis._errorback = errorback;\n\t\t\tthis.moduleIdResolver = moduleIdResolver;\n\t\t\tthis.exports = {};\n\t\t\tthis.error = null;\n\t\t\tthis.exportsPassedIn = false;\n\t\t\tthis.unresolvedDependenciesCount = this.dependencies.length;\n\t\t\tthis._isComplete = false;\n\t\t}\n\t\tstatic _safeInvokeFunction(callback, args) {\n\t\t\ttry {\n\t\t\t\treturn {\n\t\t\t\t\treturnedValue: callback.apply(AMDLoader.global, args),\n\t\t\t\t\tproducedError: null\n\t\t\t\t};\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\treturn {\n\t\t\t\t\treturnedValue: null,\n\t\t\t\t\tproducedError: e\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tstatic _invokeFactory(config, strModuleId, callback, dependenciesValues) {\n\t\t\tif (!config.shouldInvokeFactory(strModuleId)) {\n\t\t\t\treturn {\n\t\t\t\t\treturnedValue: null,\n\t\t\t\t\tproducedError: null\n\t\t\t\t};\n\t\t\t}\n\t\t\tif (config.shouldCatchError()) {\n\t\t\t\treturn this._safeInvokeFunction(callback, dependenciesValues);\n\t\t\t}\n\t\t\treturn {\n\t\t\t\treturnedValue: callback.apply(AMDLoader.global, dependenciesValues),\n\t\t\t\tproducedError: null\n\t\t\t};\n\t\t}\n\t\tcomplete(recorder, config, dependenciesValues, inversedependenciesProvider) {\n\t\t\tthis._isComplete = true;\n\t\t\tlet producedError = null;\n\t\t\tif (this._callback) {\n\t\t\t\tif (typeof this._callback === 'function') {\n\t\t\t\t\trecorder.record(21 /* LoaderEventType.BeginInvokeFactory */, this.strId);\n\t\t\t\t\tlet r = Module._invokeFactory(config, this.strId, this._callback, dependenciesValues);\n\t\t\t\t\tproducedError = r.producedError;\n\t\t\t\t\trecorder.record(22 /* LoaderEventType.EndInvokeFactory */, this.strId);\n\t\t\t\t\tif (!producedError && typeof r.returnedValue !== 'undefined' && (!this.exportsPassedIn || AMDLoader.Utilities.isEmpty(this.exports))) {\n\t\t\t\t\t\tthis.exports = r.returnedValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.exports = this._callback;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (producedError) {\n\t\t\t\tlet err = AMDLoader.ensureError(producedError);\n\t\t\t\terr.phase = 'factory';\n\t\t\t\terr.moduleId = this.strId;\n\t\t\t\terr.neededBy = inversedependenciesProvider(this.id);\n\t\t\t\tthis.error = err;\n\t\t\t\tconfig.onError(err);\n\t\t\t}\n\t\t\tthis.dependencies = null;\n\t\t\tthis._callback = null;\n\t\t\tthis._errorback = null;\n\t\t\tthis.moduleIdResolver = null;\n\t\t}\n\t\t/**\n\t\t * One of the direct dependencies or a transitive dependency has failed to load.\n\t\t */\n\t\tonDependencyError(err) {\n\t\t\tthis._isComplete = true;\n\t\t\tthis.error = err;\n\t\t\tif (this._errorback) {\n\t\t\t\tthis._errorback(err);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Is the current module complete?\n\t\t */\n\t\tisComplete() {\n\t\t\treturn this._isComplete;\n\t\t}\n\t}\n\tAMDLoader.Module = Module;\n\tclass ModuleIdProvider {\n\t\tconstructor() {\n\t\t\tthis._nextId = 0;\n\t\t\tthis._strModuleIdToIntModuleId = new Map();\n\t\t\tthis._intModuleIdToStrModuleId = [];\n\t\t\t// Ensure values 0, 1, 2 are assigned accordingly with ModuleId\n\t\t\tthis.getModuleId('exports');\n\t\t\tthis.getModuleId('module');\n\t\t\tthis.getModuleId('require');\n\t\t}\n\t\tgetMaxModuleId() {\n\t\t\treturn this._nextId;\n\t\t}\n\t\tgetModuleId(strModuleId) {\n\t\t\tlet id = this._strModuleIdToIntModuleId.get(strModuleId);\n\t\t\tif (typeof id === 'undefined') {\n\t\t\t\tid = this._nextId++;\n\t\t\t\tthis._strModuleIdToIntModuleId.set(strModuleId, id);\n\t\t\t\tthis._intModuleIdToStrModuleId[id] = strModuleId;\n\t\t\t}\n\t\t\treturn id;\n\t\t}\n\t\tgetStrModuleId(moduleId) {\n\t\t\treturn this._intModuleIdToStrModuleId[moduleId];\n\t\t}\n\t}\n\tclass RegularDependency {\n\t\tconstructor(id) {\n\t\t\tthis.id = id;\n\t\t}\n\t}\n\tRegularDependency.EXPORTS = new RegularDependency(0 /* ModuleId.EXPORTS */);\n\tRegularDependency.MODULE = new RegularDependency(1 /* ModuleId.MODULE */);\n\tRegularDependency.REQUIRE = new RegularDependency(2 /* ModuleId.REQUIRE */);\n\tAMDLoader.RegularDependency = RegularDependency;\n\tclass PluginDependency {\n\t\tconstructor(id, pluginId, pluginParam) {\n\t\t\tthis.id = id;\n\t\t\tthis.pluginId = pluginId;\n\t\t\tthis.pluginParam = pluginParam;\n\t\t}\n\t}\n\tAMDLoader.PluginDependency = PluginDependency;\n\tclass ModuleManager {\n\t\tconstructor(env, scriptLoader, defineFunc, requireFunc, loaderAvailableTimestamp = 0) {\n\t\t\tthis._env = env;\n\t\t\tthis._scriptLoader = scriptLoader;\n\t\t\tthis._loaderAvailableTimestamp = loaderAvailableTimestamp;\n\t\t\tthis._defineFunc = defineFunc;\n\t\t\tthis._requireFunc = requireFunc;\n\t\t\tthis._moduleIdProvider = new ModuleIdProvider();\n\t\t\tthis._config = new AMDLoader.Configuration(this._env);\n\t\t\tthis._hasDependencyCycle = false;\n\t\t\tthis._modules2 = [];\n\t\t\tthis._knownModules2 = [];\n\t\t\tthis._inverseDependencies2 = [];\n\t\t\tthis._inversePluginDependencies2 = new Map();\n\t\t\tthis._currentAnonymousDefineCall = null;\n\t\t\tthis._recorder = null;\n\t\t\tthis._buildInfoPath = [];\n\t\t\tthis._buildInfoDefineStack = [];\n\t\t\tthis._buildInfoDependencies = [];\n\t\t\tthis._requireFunc.moduleManager = this;\n\t\t}\n\t\treset() {\n\t\t\treturn new ModuleManager(this._env, this._scriptLoader, this._defineFunc, this._requireFunc, this._loaderAvailableTimestamp);\n\t\t}\n\t\tgetGlobalAMDDefineFunc() {\n\t\t\treturn this._defineFunc;\n\t\t}\n\t\tgetGlobalAMDRequireFunc() {\n\t\t\treturn this._requireFunc;\n\t\t}\n\t\tstatic _findRelevantLocationInStack(needle, stack) {\n\t\t\tlet normalize = (str) => str.replace(/\\\\/g, '/');\n\t\t\tlet normalizedPath = normalize(needle);\n\t\t\tlet stackPieces = stack.split(/\\n/);\n\t\t\tfor (let i = 0; i < stackPieces.length; i++) {\n\t\t\t\tlet m = stackPieces[i].match(/(.*):(\\d+):(\\d+)\\)?$/);\n\t\t\t\tif (m) {\n\t\t\t\t\tlet stackPath = m[1];\n\t\t\t\t\tlet stackLine = m[2];\n\t\t\t\t\tlet stackColumn = m[3];\n\t\t\t\t\tlet trimPathOffset = Math.max(stackPath.lastIndexOf(' ') + 1, stackPath.lastIndexOf('(') + 1);\n\t\t\t\t\tstackPath = stackPath.substr(trimPathOffset);\n\t\t\t\t\tstackPath = normalize(stackPath);\n\t\t\t\t\tif (stackPath === normalizedPath) {\n\t\t\t\t\t\tlet r = {\n\t\t\t\t\t\t\tline: parseInt(stackLine, 10),\n\t\t\t\t\t\t\tcol: parseInt(stackColumn, 10)\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (r.line === 1) {\n\t\t\t\t\t\t\tr.col -= '(function (require, define, __filename, __dirname) { '.length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn r;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthrow new Error('Could not correlate define call site for needle ' + needle);\n\t\t}\n\t\tgetBuildInfo() {\n\t\t\tif (!this._config.isBuild()) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tlet result = [], resultLen = 0;\n\t\t\tfor (let i = 0, len = this._modules2.length; i < len; i++) {\n\t\t\t\tlet m = this._modules2[i];\n\t\t\t\tif (!m) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tlet location = this._buildInfoPath[m.id] || null;\n\t\t\t\tlet defineStack = this._buildInfoDefineStack[m.id] || null;\n\t\t\t\tlet dependencies = this._buildInfoDependencies[m.id];\n\t\t\t\tresult[resultLen++] = {\n\t\t\t\t\tid: m.strId,\n\t\t\t\t\tpath: location,\n\t\t\t\t\tdefineLocation: (location && defineStack ? ModuleManager._findRelevantLocationInStack(location, defineStack) : null),\n\t\t\t\t\tdependencies: dependencies,\n\t\t\t\t\tshim: null,\n\t\t\t\t\texports: m.exports\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\tgetRecorder() {\n\t\t\tif (!this._recorder) {\n\t\t\t\tif (this._config.shouldRecordStats()) {\n\t\t\t\t\tthis._recorder = new AMDLoader.LoaderEventRecorder(this._loaderAvailableTimestamp);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._recorder = AMDLoader.NullLoaderEventRecorder.INSTANCE;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn this._recorder;\n\t\t}\n\t\tgetLoaderEvents() {\n\t\t\treturn this.getRecorder().getEvents();\n\t\t}\n\t\t/**\n\t\t * Defines an anonymous module (without an id). Its name will be resolved as we receive a callback from the scriptLoader.\n\t\t * @param dependencies @see defineModule\n\t\t * @param callback @see defineModule\n\t\t */\n\t\tenqueueDefineAnonymousModule(dependencies, callback) {\n\t\t\tif (this._currentAnonymousDefineCall !== null) {\n\t\t\t\tthrow new Error('Can only have one anonymous define call per script file');\n\t\t\t}\n\t\t\tlet stack = null;\n\t\t\tif (this._config.isBuild()) {\n\t\t\t\tstack = new Error('StackLocation').stack || null;\n\t\t\t}\n\t\t\tthis._currentAnonymousDefineCall = {\n\t\t\t\tstack: stack,\n\t\t\t\tdependencies: dependencies,\n\t\t\t\tcallback: callback\n\t\t\t};\n\t\t}\n\t\t/**\n\t\t * Creates a module and stores it in _modules. The manager will immediately begin resolving its dependencies.\n\t\t * @param strModuleId An unique and absolute id of the module. This must not collide with another module's id\n\t\t * @param dependencies An array with the dependencies of the module. Special keys are: \"require\", \"exports\" and \"module\"\n\t\t * @param callback if callback is a function, it will be called with the resolved dependencies. if callback is an object, it will be considered as the exports of the module.\n\t\t */\n\t\tdefineModule(strModuleId, dependencies, callback, errorback, stack, moduleIdResolver = new ModuleIdResolver(strModuleId)) {\n\t\t\tlet moduleId = this._moduleIdProvider.getModuleId(strModuleId);\n\t\t\tif (this._modules2[moduleId]) {\n\t\t\t\tif (!this._config.isDuplicateMessageIgnoredFor(strModuleId)) {\n\t\t\t\t\tconsole.warn('Duplicate definition of module \\'' + strModuleId + '\\'');\n\t\t\t\t}\n\t\t\t\t// Super important! Completely ignore duplicate module definition\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet m = new Module(moduleId, strModuleId, this._normalizeDependencies(dependencies, moduleIdResolver), callback, errorback, moduleIdResolver);\n\t\t\tthis._modules2[moduleId] = m;\n\t\t\tif (this._config.isBuild()) {\n\t\t\t\tthis._buildInfoDefineStack[moduleId] = stack;\n\t\t\t\tthis._buildInfoDependencies[moduleId] = (m.dependencies || []).map(dep => this._moduleIdProvider.getStrModuleId(dep.id));\n\t\t\t}\n\t\t\t// Resolving of dependencies is immediate (not in a timeout). If there's a need to support a packer that concatenates in an\n\t\t\t// unordered manner, in order to finish processing the file, execute the following method in a timeout\n\t\t\tthis._resolve(m);\n\t\t}\n\t\t_normalizeDependency(dependency, moduleIdResolver) {\n\t\t\tif (dependency === 'exports') {\n\t\t\t\treturn RegularDependency.EXPORTS;\n\t\t\t}\n\t\t\tif (dependency === 'module') {\n\t\t\t\treturn RegularDependency.MODULE;\n\t\t\t}\n\t\t\tif (dependency === 'require') {\n\t\t\t\treturn RegularDependency.REQUIRE;\n\t\t\t}\n\t\t\t// Normalize dependency and then request it from the manager\n\t\t\tlet bangIndex = dependency.indexOf('!');\n\t\t\tif (bangIndex >= 0) {\n\t\t\t\tlet strPluginId = moduleIdResolver.resolveModule(dependency.substr(0, bangIndex));\n\t\t\t\tlet pluginParam = moduleIdResolver.resolveModule(dependency.substr(bangIndex + 1));\n\t\t\t\tlet dependencyId = this._moduleIdProvider.getModuleId(strPluginId + '!' + pluginParam);\n\t\t\t\tlet pluginId = this._moduleIdProvider.getModuleId(strPluginId);\n\t\t\t\treturn new PluginDependency(dependencyId, pluginId, pluginParam);\n\t\t\t}\n\t\t\treturn new RegularDependency(this._moduleIdProvider.getModuleId(moduleIdResolver.resolveModule(dependency)));\n\t\t}\n\t\t_normalizeDependencies(dependencies, moduleIdResolver) {\n\t\t\tlet result = [], resultLen = 0;\n\t\t\tfor (let i = 0, len = dependencies.length; i < len; i++) {\n\t\t\t\tresult[resultLen++] = this._normalizeDependency(dependencies[i], moduleIdResolver);\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\t_relativeRequire(moduleIdResolver, dependencies, callback, errorback) {\n\t\t\tif (typeof dependencies === 'string') {\n\t\t\t\treturn this.synchronousRequire(dependencies, moduleIdResolver);\n\t\t\t}\n\t\t\tthis.defineModule(AMDLoader.Utilities.generateAnonymousModule(), dependencies, callback, errorback, null, moduleIdResolver);\n\t\t}\n\t\t/**\n\t\t * Require synchronously a module by its absolute id. If the module is not loaded, an exception will be thrown.\n\t\t * @param id The unique and absolute id of the required module\n\t\t * @return The exports of module 'id'\n\t\t */\n\t\tsynchronousRequire(_strModuleId, moduleIdResolver = new ModuleIdResolver(_strModuleId)) {\n\t\t\tlet dependency = this._normalizeDependency(_strModuleId, moduleIdResolver);\n\t\t\tlet m = this._modules2[dependency.id];\n\t\t\tif (!m) {\n\t\t\t\tthrow new Error('Check dependency list! Synchronous require cannot resolve module \\'' + _strModuleId + '\\'. This is the first mention of this module!');\n\t\t\t}\n\t\t\tif (!m.isComplete()) {\n\t\t\t\tthrow new Error('Check dependency list! Synchronous require cannot resolve module \\'' + _strModuleId + '\\'. This module has not been resolved completely yet.');\n\t\t\t}\n\t\t\tif (m.error) {\n\t\t\t\tthrow m.error;\n\t\t\t}\n\t\t\treturn m.exports;\n\t\t}\n\t\tconfigure(params, shouldOverwrite) {\n\t\t\tlet oldShouldRecordStats = this._config.shouldRecordStats();\n\t\t\tif (shouldOverwrite) {\n\t\t\t\tthis._config = new AMDLoader.Configuration(this._env, params);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._config = this._config.cloneAndMerge(params);\n\t\t\t}\n\t\t\tif (this._config.shouldRecordStats() && !oldShouldRecordStats) {\n\t\t\t\tthis._recorder = null;\n\t\t\t}\n\t\t}\n\t\tgetConfig() {\n\t\t\treturn this._config;\n\t\t}\n\t\t/**\n\t\t * Callback from the scriptLoader when a module has been loaded.\n\t\t * This means its code is available and has been executed.\n\t\t */\n\t\t_onLoad(moduleId) {\n\t\t\tif (this._currentAnonymousDefineCall !== null) {\n\t\t\t\tlet defineCall = this._currentAnonymousDefineCall;\n\t\t\t\tthis._currentAnonymousDefineCall = null;\n\t\t\t\t// Hit an anonymous define call\n\t\t\t\tthis.defineModule(this._moduleIdProvider.getStrModuleId(moduleId), defineCall.dependencies, defineCall.callback, null, defineCall.stack);\n\t\t\t}\n\t\t}\n\t\t_createLoadError(moduleId, _err) {\n\t\t\tlet strModuleId = this._moduleIdProvider.getStrModuleId(moduleId);\n\t\t\tlet neededBy = (this._inverseDependencies2[moduleId] || []).map((intModuleId) => this._moduleIdProvider.getStrModuleId(intModuleId));\n\t\t\tconst err = AMDLoader.ensureError(_err);\n\t\t\terr.phase = 'loading';\n\t\t\terr.moduleId = strModuleId;\n\t\t\terr.neededBy = neededBy;\n\t\t\treturn err;\n\t\t}\n\t\t/**\n\t\t * Callback from the scriptLoader when a module hasn't been loaded.\n\t\t * This means that the script was not found (e.g. 404) or there was an error in the script.\n\t\t */\n\t\t_onLoadError(moduleId, err) {\n\t\t\tconst error = this._createLoadError(moduleId, err);\n\t\t\tif (!this._modules2[moduleId]) {\n\t\t\t\tthis._modules2[moduleId] = new Module(moduleId, this._moduleIdProvider.getStrModuleId(moduleId), [], () => { }, null, null);\n\t\t\t}\n\t\t\t// Find any 'local' error handlers, walk the entire chain of inverse dependencies if necessary.\n\t\t\tlet seenModuleId = [];\n\t\t\tfor (let i = 0, len = this._moduleIdProvider.getMaxModuleId(); i < len; i++) {\n\t\t\t\tseenModuleId[i] = false;\n\t\t\t}\n\t\t\tlet someoneNotified = false;\n\t\t\tlet queue = [];\n\t\t\tqueue.push(moduleId);\n\t\t\tseenModuleId[moduleId] = true;\n\t\t\twhile (queue.length > 0) {\n\t\t\t\tlet queueElement = queue.shift();\n\t\t\t\tlet m = this._modules2[queueElement];\n\t\t\t\tif (m) {\n\t\t\t\t\tsomeoneNotified = m.onDependencyError(error) || someoneNotified;\n\t\t\t\t}\n\t\t\t\tlet inverseDeps = this._inverseDependencies2[queueElement];\n\t\t\t\tif (inverseDeps) {\n\t\t\t\t\tfor (let i = 0, len = inverseDeps.length; i < len; i++) {\n\t\t\t\t\t\tlet inverseDep = inverseDeps[i];\n\t\t\t\t\t\tif (!seenModuleId[inverseDep]) {\n\t\t\t\t\t\t\tqueue.push(inverseDep);\n\t\t\t\t\t\t\tseenModuleId[inverseDep] = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!someoneNotified) {\n\t\t\t\tthis._config.onError(error);\n\t\t\t}\n\t\t}\n\t\t/**\n\t\t * Walks (recursively) the dependencies of 'from' in search of 'to'.\n\t\t * Returns true if there is such a path or false otherwise.\n\t\t * @param from Module id to start at\n\t\t * @param to Module id to look for\n\t\t */\n\t\t_hasDependencyPath(fromId, toId) {\n\t\t\tlet from = this._modules2[fromId];\n\t\t\tif (!from) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet inQueue = [];\n\t\t\tfor (let i = 0, len = this._moduleIdProvider.getMaxModuleId(); i < len; i++) {\n\t\t\t\tinQueue[i] = false;\n\t\t\t}\n\t\t\tlet queue = [];\n\t\t\t// Insert 'from' in queue\n\t\t\tqueue.push(from);\n\t\t\tinQueue[fromId] = true;\n\t\t\twhile (queue.length > 0) {\n\t\t\t\t// Pop first inserted element of queue\n\t\t\t\tlet element = queue.shift();\n\t\t\t\tlet dependencies = element.dependencies;\n\t\t\t\tif (dependencies) {\n\t\t\t\t\t// Walk the element's dependencies\n\t\t\t\t\tfor (let i = 0, len = dependencies.length; i < len; i++) {\n\t\t\t\t\t\tlet dependency = dependencies[i];\n\t\t\t\t\t\tif (dependency.id === toId) {\n\t\t\t\t\t\t\t// There is a path to 'to'\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlet dependencyModule = this._modules2[dependency.id];\n\t\t\t\t\t\tif (dependencyModule && !inQueue[dependency.id]) {\n\t\t\t\t\t\t\t// Insert 'dependency' in queue\n\t\t\t\t\t\t\tinQueue[dependency.id] = true;\n\t\t\t\t\t\t\tqueue.push(dependencyModule);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// There is no path to 'to'\n\t\t\treturn false;\n\t\t}\n\t\t/**\n\t\t * Walks (recursively) the dependencies of 'from' in search of 'to'.\n\t\t * Returns cycle as array.\n\t\t * @param from Module id to start at\n\t\t * @param to Module id to look for\n\t\t */\n\t\t_findCyclePath(fromId, toId, depth) {\n\t\t\tif (fromId === toId || depth === 50) {\n\t\t\t\treturn [fromId];\n\t\t\t}\n\t\t\tlet from = this._modules2[fromId];\n\t\t\tif (!from) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\t// Walk the element's dependencies\n\t\t\tlet dependencies = from.dependencies;\n\t\t\tif (dependencies) {\n\t\t\t\tfor (let i = 0, len = dependencies.length; i < len; i++) {\n\t\t\t\t\tlet path = this._findCyclePath(dependencies[i].id, toId, depth + 1);\n\t\t\t\t\tif (path !== null) {\n\t\t\t\t\t\tpath.push(fromId);\n\t\t\t\t\t\treturn path;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t\t/**\n\t\t * Create the local 'require' that is passed into modules\n\t\t */\n\t\t_createRequire(moduleIdResolver) {\n\t\t\tlet result = ((dependencies, callback, errorback) => {\n\t\t\t\treturn this._relativeRequire(moduleIdResolver, dependencies, callback, errorback);\n\t\t\t});\n\t\t\tresult.toUrl = (id) => {\n\t\t\t\treturn this._config.requireToUrl(moduleIdResolver.resolveModule(id));\n\t\t\t};\n\t\t\tresult.getStats = () => {\n\t\t\t\treturn this.getLoaderEvents();\n\t\t\t};\n\t\t\tresult.hasDependencyCycle = () => {\n\t\t\t\treturn this._hasDependencyCycle;\n\t\t\t};\n\t\t\tresult.config = (params, shouldOverwrite = false) => {\n\t\t\t\tthis.configure(params, shouldOverwrite);\n\t\t\t};\n\t\t\tresult.__$__nodeRequire = AMDLoader.global.nodeRequire;\n\t\t\treturn result;\n\t\t}\n\t\t_loadModule(moduleId) {\n\t\t\tif (this._modules2[moduleId] || this._knownModules2[moduleId]) {\n\t\t\t\t// known module\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._knownModules2[moduleId] = true;\n\t\t\tlet strModuleId = this._moduleIdProvider.getStrModuleId(moduleId);\n\t\t\tlet paths = this._config.moduleIdToPaths(strModuleId);\n\t\t\tlet scopedPackageRegex = /^@[^\\/]+\\/[^\\/]+$/; // matches @scope/package-name\n\t\t\tif (this._env.isNode && (strModuleId.indexOf('/') === -1 || scopedPackageRegex.test(strModuleId))) {\n\t\t\t\tpaths.push('node|' + strModuleId);\n\t\t\t}\n\t\t\tlet lastPathIndex = -1;\n\t\t\tlet loadNextPath = (err) => {\n\t\t\t\tlastPathIndex++;\n\t\t\t\tif (lastPathIndex >= paths.length) {\n\t\t\t\t\t// No more paths to try\n\t\t\t\t\tthis._onLoadError(moduleId, err);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tlet currentPath = paths[lastPathIndex];\n\t\t\t\t\tlet recorder = this.getRecorder();\n\t\t\t\t\tif (this._config.isBuild() && currentPath === 'empty:') {\n\t\t\t\t\t\tthis._buildInfoPath[moduleId] = currentPath;\n\t\t\t\t\t\tthis.defineModule(this._moduleIdProvider.getStrModuleId(moduleId), [], null, null, null);\n\t\t\t\t\t\tthis._onLoad(moduleId);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\trecorder.record(10 /* LoaderEventType.BeginLoadingScript */, currentPath);\n\t\t\t\t\tthis._scriptLoader.load(this, currentPath, () => {\n\t\t\t\t\t\tif (this._config.isBuild()) {\n\t\t\t\t\t\t\tthis._buildInfoPath[moduleId] = currentPath;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trecorder.record(11 /* LoaderEventType.EndLoadingScriptOK */, currentPath);\n\t\t\t\t\t\tthis._onLoad(moduleId);\n\t\t\t\t\t}, (err) => {\n\t\t\t\t\t\trecorder.record(12 /* LoaderEventType.EndLoadingScriptError */, currentPath);\n\t\t\t\t\t\tloadNextPath(err);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\tloadNextPath(null);\n\t\t}\n\t\t/**\n\t\t * Resolve a plugin dependency with the plugin loaded & complete\n\t\t * @param module The module that has this dependency\n\t\t * @param pluginDependency The semi-normalized dependency that appears in the module. e.g. 'vs/css!./mycssfile'. Only the plugin part (before !) is normalized\n\t\t * @param plugin The plugin (what the plugin exports)\n\t\t */\n\t\t_loadPluginDependency(plugin, pluginDependency) {\n\t\t\tif (this._modules2[pluginDependency.id] || this._knownModules2[pluginDependency.id]) {\n\t\t\t\t// known module\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._knownModules2[pluginDependency.id] = true;\n\t\t\t// Delegate the loading of the resource to the plugin\n\t\t\tlet load = ((value) => {\n\t\t\t\tthis.defineModule(this._moduleIdProvider.getStrModuleId(pluginDependency.id), [], value, null, null);\n\t\t\t});\n\t\t\tload.error = (err) => {\n\t\t\t\tthis._config.onError(this._createLoadError(pluginDependency.id, err));\n\t\t\t};\n\t\t\tplugin.load(pluginDependency.pluginParam, this._createRequire(ModuleIdResolver.ROOT), load, this._config.getOptionsLiteral());\n\t\t}\n\t\t/**\n\t\t * Examine the dependencies of module 'module' and resolve them as needed.\n\t\t */\n\t\t_resolve(module) {\n\t\t\tlet dependencies = module.dependencies;\n\t\t\tif (dependencies) {\n\t\t\t\tfor (let i = 0, len = dependencies.length; i < len; i++) {\n\t\t\t\t\tlet dependency = dependencies[i];\n\t\t\t\t\tif (dependency === RegularDependency.EXPORTS) {\n\t\t\t\t\t\tmodule.exportsPassedIn = true;\n\t\t\t\t\t\tmodule.unresolvedDependenciesCount--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (dependency === RegularDependency.MODULE) {\n\t\t\t\t\t\tmodule.unresolvedDependenciesCount--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (dependency === RegularDependency.REQUIRE) {\n\t\t\t\t\t\tmodule.unresolvedDependenciesCount--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet dependencyModule = this._modules2[dependency.id];\n\t\t\t\t\tif (dependencyModule && dependencyModule.isComplete()) {\n\t\t\t\t\t\tif (dependencyModule.error) {\n\t\t\t\t\t\t\tmodule.onDependencyError(dependencyModule.error);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmodule.unresolvedDependenciesCount--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (this._hasDependencyPath(dependency.id, module.id)) {\n\t\t\t\t\t\tthis._hasDependencyCycle = true;\n\t\t\t\t\t\tconsole.warn('There is a dependency cycle between \\'' + this._moduleIdProvider.getStrModuleId(dependency.id) + '\\' and \\'' + this._moduleIdProvider.getStrModuleId(module.id) + '\\'. The cyclic path follows:');\n\t\t\t\t\t\tlet cyclePath = this._findCyclePath(dependency.id, module.id, 0) || [];\n\t\t\t\t\t\tcyclePath.reverse();\n\t\t\t\t\t\tcyclePath.push(dependency.id);\n\t\t\t\t\t\tconsole.warn(cyclePath.map(id => this._moduleIdProvider.getStrModuleId(id)).join(' => \\n'));\n\t\t\t\t\t\t// Break the cycle\n\t\t\t\t\t\tmodule.unresolvedDependenciesCount--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\t// record inverse dependency\n\t\t\t\t\tthis._inverseDependencies2[dependency.id] = this._inverseDependencies2[dependency.id] || [];\n\t\t\t\t\tthis._inverseDependencies2[dependency.id].push(module.id);\n\t\t\t\t\tif (dependency instanceof PluginDependency) {\n\t\t\t\t\t\tlet plugin = this._modules2[dependency.pluginId];\n\t\t\t\t\t\tif (plugin && plugin.isComplete()) {\n\t\t\t\t\t\t\tthis._loadPluginDependency(plugin.exports, dependency);\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Record dependency for when the plugin gets loaded\n\t\t\t\t\t\tlet inversePluginDeps = this._inversePluginDependencies2.get(dependency.pluginId);\n\t\t\t\t\t\tif (!inversePluginDeps) {\n\t\t\t\t\t\t\tinversePluginDeps = [];\n\t\t\t\t\t\t\tthis._inversePluginDependencies2.set(dependency.pluginId, inversePluginDeps);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tinversePluginDeps.push(dependency);\n\t\t\t\t\t\tthis._loadModule(dependency.pluginId);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tthis._loadModule(dependency.id);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (module.unresolvedDependenciesCount === 0) {\n\t\t\t\tthis._onModuleComplete(module);\n\t\t\t}\n\t\t}\n\t\t_onModuleComplete(module) {\n\t\t\tlet recorder = this.getRecorder();\n\t\t\tif (module.isComplete()) {\n\t\t\t\t// already done\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet dependencies = module.dependencies;\n\t\t\tlet dependenciesValues = [];\n\t\t\tif (dependencies) {\n\t\t\t\tfor (let i = 0, len = dependencies.length; i < len; i++) {\n\t\t\t\t\tlet dependency = dependencies[i];\n\t\t\t\t\tif (dependency === RegularDependency.EXPORTS) {\n\t\t\t\t\t\tdependenciesValues[i] = module.exports;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (dependency === RegularDependency.MODULE) {\n\t\t\t\t\t\tdependenciesValues[i] = {\n\t\t\t\t\t\t\tid: module.strId,\n\t\t\t\t\t\t\tconfig: () => {\n\t\t\t\t\t\t\t\treturn this._config.getConfigForModule(module.strId);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (dependency === RegularDependency.REQUIRE) {\n\t\t\t\t\t\tdependenciesValues[i] = this._createRequire(module.moduleIdResolver);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tlet dependencyModule = this._modules2[dependency.id];\n\t\t\t\t\tif (dependencyModule) {\n\t\t\t\t\t\tdependenciesValues[i] = dependencyModule.exports;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tdependenciesValues[i] = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst inversedependenciesProvider = (moduleId) => {\n\t\t\t\treturn (this._inverseDependencies2[moduleId] || []).map((intModuleId) => this._moduleIdProvider.getStrModuleId(intModuleId));\n\t\t\t};\n\t\t\tmodule.complete(recorder, this._config, dependenciesValues, inversedependenciesProvider);\n\t\t\t// Fetch and clear inverse dependencies\n\t\t\tlet inverseDeps = this._inverseDependencies2[module.id];\n\t\t\tthis._inverseDependencies2[module.id] = null;\n\t\t\tif (inverseDeps) {\n\t\t\t\t// Resolve one inverse dependency at a time, always\n\t\t\t\t// on the lookout for a completed module.\n\t\t\t\tfor (let i = 0, len = inverseDeps.length; i < len; i++) {\n\t\t\t\t\tlet inverseDependencyId = inverseDeps[i];\n\t\t\t\t\tlet inverseDependency = this._modules2[inverseDependencyId];\n\t\t\t\t\tinverseDependency.unresolvedDependenciesCount--;\n\t\t\t\t\tif (inverseDependency.unresolvedDependenciesCount === 0) {\n\t\t\t\t\t\tthis._onModuleComplete(inverseDependency);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlet inversePluginDeps = this._inversePluginDependencies2.get(module.id);\n\t\t\tif (inversePluginDeps) {\n\t\t\t\t// This module is used as a plugin at least once\n\t\t\t\t// Fetch and clear these inverse plugin dependencies\n\t\t\t\tthis._inversePluginDependencies2.delete(module.id);\n\t\t\t\t// Resolve plugin dependencies one at a time\n\t\t\t\tfor (let i = 0, len = inversePluginDeps.length; i < len; i++) {\n\t\t\t\t\tthis._loadPluginDependency(module.exports, inversePluginDeps[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tAMDLoader.ModuleManager = ModuleManager;\n})(AMDLoader || (AMDLoader = {}));\nvar define;\nvar AMDLoader;\n(function (AMDLoader) {\n\tconst env = new AMDLoader.Environment();\n\tlet moduleManager = null;\n\tconst DefineFunc = function (id, dependencies, callback) {\n\t\tif (typeof id !== 'string') {\n\t\t\tcallback = dependencies;\n\t\t\tdependencies = id;\n\t\t\tid = null;\n\t\t}\n\t\tif (typeof dependencies !== 'object' || !Array.isArray(dependencies)) {\n\t\t\tcallback = dependencies;\n\t\t\tdependencies = null;\n\t\t}\n\t\tif (!dependencies) {\n\t\t\tdependencies = ['require', 'exports', 'module'];\n\t\t}\n\t\tif (id) {\n\t\t\tmoduleManager.defineModule(id, dependencies, callback, null, null);\n\t\t}\n\t\telse {\n\t\t\tmoduleManager.enqueueDefineAnonymousModule(dependencies, callback);\n\t\t}\n\t};\n\tDefineFunc.amd = {\n\t\tjQuery: true\n\t};\n\tconst _requireFunc_config = function (params, shouldOverwrite = false) {\n\t\tmoduleManager.configure(params, shouldOverwrite);\n\t};\n\tconst RequireFunc = function () {\n\t\tif (arguments.length === 1) {\n\t\t\tif ((arguments[0] instanceof Object) && !Array.isArray(arguments[0])) {\n\t\t\t\t_requireFunc_config(arguments[0]);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (typeof arguments[0] === 'string') {\n\t\t\t\treturn moduleManager.synchronousRequire(arguments[0]);\n\t\t\t}\n\t\t}\n\t\tif (arguments.length === 2 || arguments.length === 3) {\n\t\t\tif (Array.isArray(arguments[0])) {\n\t\t\t\tmoduleManager.defineModule(AMDLoader.Utilities.generateAnonymousModule(), arguments[0], arguments[1], arguments[2], null);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthrow new Error('Unrecognized require call');\n\t};\n\tRequireFunc.config = _requireFunc_config;\n\tRequireFunc.getConfig = function () {\n\t\treturn moduleManager.getConfig().getOptionsLiteral();\n\t};\n\tRequireFunc.reset = function () {\n\t\tmoduleManager = moduleManager.reset();\n\t};\n\tRequireFunc.getBuildInfo = function () {\n\t\treturn moduleManager.getBuildInfo();\n\t};\n\tRequireFunc.getStats = function () {\n\t\treturn moduleManager.getLoaderEvents();\n\t};\n\tRequireFunc.define = DefineFunc;\n\tfunction init() {\n\t\tif (typeof AMDLoader.global.require !== 'undefined' || typeof require !== 'undefined') {\n\t\t\tconst _nodeRequire = (AMDLoader.global.require || require);\n\t\t\tif (typeof _nodeRequire === 'function' && typeof _nodeRequire.resolve === 'function') {\n\t\t\t\t// re-expose node's require function\n\t\t\t\tconst nodeRequire = AMDLoader.ensureRecordedNodeRequire(moduleManager.getRecorder(), _nodeRequire);\n\t\t\t\tAMDLoader.global.nodeRequire = nodeRequire;\n\t\t\t\tRequireFunc.nodeRequire = nodeRequire;\n\t\t\t\tRequireFunc.__$__nodeRequire = nodeRequire;\n\t\t\t}\n\t\t}\n\t\tif (env.isNode && !env.isElectronRenderer && !env.isElectronNodeIntegrationWebWorker) {\n\t\t\tmodule.exports = RequireFunc;\n\t\t}\n\t\telse {\n\t\t\tif (!env.isElectronRenderer) {\n\t\t\t\tAMDLoader.global.define = DefineFunc;\n\t\t\t}\n\t\t\tAMDLoader.global.require = RequireFunc;\n\t\t}\n\t}\n\tAMDLoader.init = init;\n\tif (typeof AMDLoader.global.define !== 'function' || !AMDLoader.global.define.amd) {\n\t\tmoduleManager = new AMDLoader.ModuleManager(env, AMDLoader.createScriptLoader(env), DefineFunc, RequireFunc, AMDLoader.Utilities.getHighPerformanceTimestamp());\n\t\t// The global variable require can configure the loader\n\t\tif (typeof AMDLoader.global.require !== 'undefined' && typeof AMDLoader.global.require !== 'function') {\n\t\t\tRequireFunc.config(AMDLoader.global.require);\n\t\t}\n\t\t// This define is for the local closure defined in node in the case that the loader is concatenated\n\t\tdefine = function () {\n\t\t\treturn DefineFunc.apply(null, arguments);\n\t\t};\n\t\tdefine.amd = DefineFunc.amd;\n\t\tif (typeof doNotInitLoader === 'undefined') {\n\t\t\tinit();\n\t\t}\n\t}\n})(AMDLoader || (AMDLoader = {}));\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nlet isPseudo = (typeof document !== 'undefined' && document.location && document.location.hash.indexOf('pseudo=true') >= 0);\r\nconst DEFAULT_TAG = 'i-default';\r\n\r\ninterface INLSPluginConfig {\r\n\tavailableLanguages?: INLSPluginConfigAvailableLanguages;\r\n\tloadBundle?: BundleLoader;\r\n\ttranslationServiceUrl?: string;\r\n}\r\n\r\nexport interface INLSPluginConfigAvailableLanguages {\r\n\t'*'?: string;\r\n\t[module: string]: string | undefined;\r\n}\r\n\r\ninterface BundleLoader {\r\n\t(bundle: string, locale: string | null, cb: (err: Error, messages: string[] | IBundledStrings) => void): void;\r\n}\r\n\r\ninterface IBundledStrings {\r\n\t[moduleId: string]: string[];\r\n}\r\n\r\nexport interface ILocalizeInfo {\r\n\tkey: string;\r\n\tcomment: string[];\r\n}\r\n\r\ninterface ILocalizeFunc {\r\n\t(info: ILocalizeInfo, message: string, ...args: (string | number | boolean | undefined | null)[]): string;\r\n\t(key: string, message: string, ...args: (string | number | boolean | undefined | null)[]): string;\r\n}\r\n\r\ninterface IBoundLocalizeFunc {\r\n\t(idx: number, defaultValue: null): string;\r\n}\r\n\r\ninterface IConsumerAPI {\r\n\tlocalize: ILocalizeFunc | IBoundLocalizeFunc;\r\n\tgetConfiguredDefaultLocale(stringFromLocalizeCall: string): string | undefined;\r\n}\r\n\r\nfunction _format(message: string, args: (string | number | boolean | undefined | null)[]): string {\r\n\tlet result: string;\r\n\r\n\tif (args.length === 0) {\r\n\t\tresult = message;\r\n\t} else {\r\n\t\tresult = message.replace(/\\{(\\d+)\\}/g, (match, rest) => {\r\n\t\t\tconst index = rest[0];\r\n\t\t\tconst arg = args[index];\r\n\t\t\tlet result = match;\r\n\t\t\tif (typeof arg === 'string') {\r\n\t\t\t\tresult = arg;\r\n\t\t\t} else if (typeof arg === 'number' || typeof arg === 'boolean' || arg === void 0 || arg === null) {\r\n\t\t\t\tresult = String(arg);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t});\r\n\t}\r\n\r\n\tif (isPseudo) {\r\n\t\t// FF3B and FF3D is the Unicode zenkaku representation for [ and ]\r\n\t\tresult = '\\uFF3B' + result.replace(/[aouei]/g, '$&$&') + '\\uFF3D';\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction findLanguageForModule(config: INLSPluginConfigAvailableLanguages, name: string) {\r\n\tlet result = config[name];\r\n\tif (result) {\r\n\t\treturn result;\r\n\t}\r\n\tresult = config['*'];\r\n\tif (result) {\r\n\t\treturn result;\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nfunction endWithSlash(path: string): string {\r\n\tif (path.charAt(path.length - 1) === '/') {\r\n\t\treturn path;\r\n\t}\r\n\treturn path + '/';\r\n}\r\n\r\nasync function getMessagesFromTranslationsService(translationServiceUrl: string, language: string, name: string): Promise<string[] | IBundledStrings> {\r\n\tconst url = endWithSlash(translationServiceUrl) + endWithSlash(language) + 'vscode/' + endWithSlash(name);\r\n\tconst res = await fetch(url);\r\n\tif (res.ok) {\r\n\t\tconst messages = await res.json() as string[] | IBundledStrings;\r\n\t\treturn messages;\r\n\t}\r\n\tthrow new Error(`${res.status} - ${res.statusText}`);\r\n}\r\n\r\nfunction createScopedLocalize(scope: string[]): IBoundLocalizeFunc {\r\n\treturn function (idx: number, defaultValue: null) {\r\n\t\tconst restArgs = Array.prototype.slice.call(arguments, 2);\r\n\t\treturn _format(scope[idx], restArgs);\r\n\t};\r\n}\r\n\r\n/**\r\n * Localize a message.\r\n *\r\n * `message` can contain `{n}` notation where it is replaced by the nth value in `...args`\r\n * For example, `localize({ key: 'sayHello', comment: ['Welcomes user'] }, 'hello {0}', name)`\r\n */\r\nexport function localize(info: ILocalizeInfo, message: string, ...args: (string | number | boolean | undefined | null)[]): string;\r\n\r\n/**\r\n * Localize a message.\r\n *\r\n * `message` can contain `{n}` notation where it is replaced by the nth value in `...args`\r\n * For example, `localize('sayHello', 'hello {0}', name)`\r\n */\r\nexport function localize(key: string, message: string, ...args: (string | number | boolean | undefined | null)[]): string;\r\n\r\n/**\r\n * @skipMangle\r\n */\r\nexport function localize(data: ILocalizeInfo | string, message: string, ...args: (string | number | boolean | undefined | null)[]): string {\r\n\treturn _format(message, args);\r\n}\r\n\r\n/**\r\n *\r\n * @param stringFromLocalizeCall You must pass in a string that was returned from a `nls.localize()` call\r\n * in order to ensure the loader plugin has been initialized before this function is called.\r\n */\r\nexport function getConfiguredDefaultLocale(stringFromLocalizeCall: string): string | undefined;\r\n/**\r\n * @skipMangle\r\n */\r\nexport function getConfiguredDefaultLocale(_: string): string | undefined {\r\n\t// This returns undefined because this implementation isn't used and is overwritten by the loader\r\n\t// when loaded.\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * @skipMangle\r\n */\r\nexport function setPseudoTranslation(value: boolean) {\r\n\tisPseudo = value;\r\n}\r\n\r\n/**\r\n * Invoked in a built product at run-time\r\n * @skipMangle\r\n */\r\nexport function create(key: string, data: IBundledStrings & IConsumerAPI): IConsumerAPI {\r\n\treturn {\r\n\t\tlocalize: createScopedLocalize(data[key]),\r\n\t\tgetConfiguredDefaultLocale: data.getConfiguredDefaultLocale ?? ((_: string) => undefined)\r\n\t};\r\n}\r\n\r\n/**\r\n * Invoked by the loader at run-time\r\n * @skipMangle\r\n */\r\nexport function load(name: string, req: AMDLoader.IRelativeRequire, load: AMDLoader.IPluginLoadCallback, config: AMDLoader.IConfigurationOptions): void {\r\n\tconst pluginConfig: INLSPluginConfig = config['vs/nls'] ?? {};\r\n\tif (!name || name.length === 0) {\r\n\t\t// TODO: We need to give back the mangled names here\r\n\t\treturn load({\r\n\t\t\tlocalize: localize,\r\n\t\t\tgetConfiguredDefaultLocale: () => pluginConfig.availableLanguages?.['*']\r\n\t\t});\r\n\t}\r\n\tconst language = pluginConfig.availableLanguages ? findLanguageForModule(pluginConfig.availableLanguages, name) : null;\r\n\tconst useDefaultLanguage = language === null || language === DEFAULT_TAG;\r\n\tlet suffix = '.nls';\r\n\tif (!useDefaultLanguage) {\r\n\t\tsuffix = suffix + '.' + language;\r\n\t}\r\n\tconst messagesLoaded = (messages: string[] | IBundledStrings) => {\r\n\t\tif (Array.isArray(messages)) {\r\n\t\t\t(messages as any as IConsumerAPI).localize = createScopedLocalize(messages);\r\n\t\t} else {\r\n\t\t\t(messages as any as IConsumerAPI).localize = createScopedLocalize(messages[name]);\r\n\t\t}\r\n\t\t(messages as any as IConsumerAPI).getConfiguredDefaultLocale = () => pluginConfig.availableLanguages?.['*'];\r\n\t\tload(messages);\r\n\t};\r\n\tif (typeof pluginConfig.loadBundle === 'function') {\r\n\t\t(pluginConfig.loadBundle as BundleLoader)(name, language, (err: Error, messages) => {\r\n\t\t\t// We have an error. Load the English default strings to not fail\r\n\t\t\tif (err) {\r\n\t\t\t\treq([name + '.nls'], messagesLoaded);\r\n\t\t\t} else {\r\n\t\t\t\tmessagesLoaded(messages);\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (pluginConfig.translationServiceUrl && !useDefaultLanguage) {\r\n\t\t(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tconst messages = await getMessagesFromTranslationsService(pluginConfig.translationServiceUrl!, language, name);\r\n\t\t\t\treturn messagesLoaded(messages);\r\n\t\t\t} catch (err) {\r\n\t\t\t\t// Language is already as generic as it gets, so require default messages\r\n\t\t\t\tif (!language.includes('-')) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\treturn req([name + '.nls'], messagesLoaded);\r\n\t\t\t\t}\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// Since there is a dash, the language configured is a specific sub-language of the same generic language.\r\n\t\t\t\t\t// Since we were unable to load the specific language, try to load the generic language. Ex. we failed to find a\r\n\t\t\t\t\t// Swiss German (de-CH), so try to load the generic German (de) messages instead.\r\n\t\t\t\t\tconst genericLanguage = language.split('-')[0];\r\n\t\t\t\t\tconst messages = await getMessagesFromTranslationsService(pluginConfig.translationServiceUrl!, genericLanguage, name);\r\n\t\t\t\t\t// We got some messages, so we configure the configuration to use the generic language for this session.\r\n\t\t\t\t\tpluginConfig.availableLanguages ??= {};\r\n\t\t\t\t\tpluginConfig.availableLanguages['*'] = genericLanguage;\r\n\t\t\t\t\treturn messagesLoaded(messages);\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\treturn req([name + '.nls'], messagesLoaded);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})();\r\n\t} else {\r\n\t\treq([name + suffix], messagesLoaded, (err: Error) => {\r\n\t\t\tif (suffix === '.nls') {\r\n\t\t\t\tconsole.error('Failed trying to load default language strings', err);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconsole.error(`Failed to load message bundle for language ${language}. Falling back to the default language:`, err);\r\n\t\t\treq([name + '.nls'], messagesLoaded);\r\n\t\t});\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n(function () {\r\n\r\n\tinterface IMonacoEnvironment {\r\n\t\tbaseUrl?: string;\r\n\t\tcreateTrustedTypesPolicy<Options extends TrustedTypePolicyOptions>(\r\n\t\t\tpolicyName: string,\r\n\t\t\tpolicyOptions?: Options,\r\n\t\t): undefined | Pick<TrustedTypePolicy<Options>, 'name' | Extract<keyof Options, keyof TrustedTypePolicyOptions>>;\r\n\t}\r\n\tconst monacoEnvironment: IMonacoEnvironment | undefined = (globalThis as any).MonacoEnvironment;\r\n\tconst monacoBaseUrl = monacoEnvironment && monacoEnvironment.baseUrl ? monacoEnvironment.baseUrl : '../../../';\r\n\r\n\tfunction createTrustedTypesPolicy<Options extends TrustedTypePolicyOptions>(\r\n\t\tpolicyName: string,\r\n\t\tpolicyOptions?: Options,\r\n\t): undefined | Pick<TrustedTypePolicy<Options>, 'name' | Extract<keyof Options, keyof TrustedTypePolicyOptions>> {\r\n\r\n\t\tif (monacoEnvironment?.createTrustedTypesPolicy) {\r\n\t\t\ttry {\r\n\t\t\t\treturn monacoEnvironment.createTrustedTypesPolicy(policyName, policyOptions);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.warn(err);\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\treturn self.trustedTypes?.createPolicy(policyName, policyOptions);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.warn(err);\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\r\n\tconst trustedTypesPolicy = createTrustedTypesPolicy('amdLoader', {\r\n\t\tcreateScriptURL: value => value,\r\n\t\tcreateScript: (_, ...args: string[]) => {\r\n\t\t\t// workaround a chrome issue not allowing to create new functions\r\n\t\t\t// see https://github.com/w3c/webappsec-trusted-types/wiki/Trusted-Types-for-function-constructor\r\n\t\t\tconst fnArgs = args.slice(0, -1).join(',');\r\n\t\t\tconst fnBody = args.pop()!.toString();\r\n\t\t\t// Do not add a new line to fnBody, as this will confuse source maps.\r\n\t\t\tconst body = `(function anonymous(${fnArgs}) { ${fnBody}\\n})`;\r\n\t\t\treturn body;\r\n\t\t}\r\n\t});\r\n\r\n\tfunction canUseEval(): boolean {\r\n\t\ttry {\r\n\t\t\tconst func = (\r\n\t\t\t\ttrustedTypesPolicy\r\n\t\t\t\t\t? globalThis.eval(<any>trustedTypesPolicy.createScript('', 'true')) // CodeQL [SM01632] fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\r\n\t\t\t\t\t: new Function('true') // CodeQL [SM01632] fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\r\n\t\t\t);\r\n\t\t\tfunc.call(globalThis);\r\n\t\t\treturn true;\r\n\t\t} catch (err) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction loadAMDLoader() {\r\n\t\treturn new Promise<void>((resolve, reject) => {\r\n\t\t\tif (typeof (<any>globalThis).define === 'function' && (<any>globalThis).define.amd) {\r\n\t\t\t\treturn resolve();\r\n\t\t\t}\r\n\t\t\tconst loaderSrc: string | TrustedScriptURL = monacoBaseUrl + 'vs/loader.js';\r\n\r\n\t\t\tconst isCrossOrigin = (/^((http:)|(https:)|(file:))/.test(loaderSrc) && loaderSrc.substring(0, globalThis.origin.length) !== globalThis.origin);\r\n\t\t\tif (!isCrossOrigin && canUseEval()) {\r\n\t\t\t\t// use `fetch` if possible because `importScripts`\r\n\t\t\t\t// is synchronous and can lead to deadlocks on Safari\r\n\t\t\t\tfetch(loaderSrc).then((response) => {\r\n\t\t\t\t\tif (response.status !== 200) {\r\n\t\t\t\t\t\tthrow new Error(response.statusText);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn response.text();\r\n\t\t\t\t}).then((text) => {\r\n\t\t\t\t\ttext = `${text}\\n//# sourceURL=${loaderSrc}`;\r\n\t\t\t\t\tconst func = (\r\n\t\t\t\t\t\ttrustedTypesPolicy\r\n\t\t\t\t\t\t\t? globalThis.eval(trustedTypesPolicy.createScript('', text) as unknown as string)\r\n\t\t\t\t\t\t\t: new Function(text) // CodeQL [SM01632] fetch + eval is used on the web worker instead of importScripts if possible because importScripts is synchronous and we observed deadlocks on Safari\r\n\t\t\t\t\t);\r\n\t\t\t\t\tfunc.call(globalThis);\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t}).then(undefined, reject);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (trustedTypesPolicy) {\r\n\t\t\t\timportScripts(trustedTypesPolicy.createScriptURL(loaderSrc) as unknown as string);\r\n\t\t\t} else {\r\n\t\t\t\timportScripts(loaderSrc as string);\r\n\t\t\t}\r\n\t\t\tresolve();\r\n\t\t});\r\n\t}\r\n\r\n\tfunction configureAMDLoader() {\r\n\t\trequire.config({\r\n\t\t\tbaseUrl: monacoBaseUrl,\r\n\t\t\tcatchError: true,\r\n\t\t\ttrustedTypesPolicy,\r\n\t\t\tamdModulesPattern: /^vs\\//\r\n\t\t});\r\n\t}\r\n\r\n\tfunction loadCode(moduleId: string) {\r\n\t\tloadAMDLoader().then(() => {\r\n\t\t\tconfigureAMDLoader();\r\n\t\t\trequire([moduleId], function (ws) {\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tconst messageHandler = ws.create((msg: any, transfer?: Transferable[]) => {\r\n\t\t\t\t\t\t(<any>globalThis).postMessage(msg, transfer);\r\n\t\t\t\t\t}, null);\r\n\r\n\t\t\t\t\tglobalThis.onmessage = (e: MessageEvent) => messageHandler.onmessage(e.data, e.ports);\r\n\t\t\t\t\twhile (beforeReadyMessages.length > 0) {\r\n\t\t\t\t\t\tconst e = beforeReadyMessages.shift()!;\r\n\t\t\t\t\t\tmessageHandler.onmessage(e.data, e.ports);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 0);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t// If the loader is already defined, configure it immediately\r\n\t// This helps in the bundled case, where we must load nls files\r\n\t// and they need a correct baseUrl to be loaded.\r\n\tif (typeof (<any>globalThis).define === 'function' && (<any>globalThis).define.amd) {\r\n\t\tconfigureAMDLoader();\r\n\t}\r\n\r\n\tlet isFirstMessage = true;\r\n\tconst beforeReadyMessages: MessageEvent[] = [];\r\n\tglobalThis.onmessage = (message: MessageEvent) => {\r\n\t\tif (!isFirstMessage) {\r\n\t\t\tbeforeReadyMessages.push(message);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tisFirstMessage = false;\r\n\t\tloadCode(message.data);\r\n\t};\r\n})();\r\n","\r\n\r\n/**\r\n * Returns the last element of an array.\r\n * @param array The array.\r\n * @param n Which element from the end (default is zero).\r\n */\r\nexport function tail<T>(array: ArrayLike<T>, n: number = 0): T {\r\n\treturn array[array.length - (1 + n)];\r\n}\r\n\r\nexport function tail2<T>(arr: T[]): [T[], T] {\r\n\tif (arr.length === 0) {\r\n\t\tthrow new Error('Invalid tail call');\r\n\t}\r\n\r\n\treturn [arr.slice(0, arr.length - 1), arr[arr.length - 1]];\r\n}\r\n\r\nexport function equals<T>(one: ReadonlyArray<T> | undefined, other: ReadonlyArray<T> | undefined, itemEquals: (a: T, b: T) => boolean = (a, b) => a === b): boolean {\r\n\tif (one === other) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (!one || !other) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (one.length !== other.length) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfor (let i = 0, len = one.length; i < len; i++) {\r\n\t\tif (!itemEquals(one[i], other[i])) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Remove the element at `index` by replacing it with the last element. This is faster than `splice`\r\n * but changes the order of the array\r\n */\r\nexport function removeFastWithoutKeepingOrder<T>(array: T[], index: number) {\r\n\tconst last = array.length - 1;\r\n\tif (index < last) {\r\n\t\tarray[index] = array[last];\r\n\t}\r\n\tarray.pop();\r\n}\r\n\r\n/**\r\n * Performs a binary search algorithm over a sorted array.\r\n *\r\n * @param array The array being searched.\r\n * @param key The value we search for.\r\n * @param comparator A function that takes two array elements and returns zero\r\n *   if they are equal, a negative number if the first element precedes the\r\n *   second one in the sorting order, or a positive number if the second element\r\n *   precedes the first one.\r\n * @return See {@link binarySearch2}\r\n */\r\nexport function binarySearch<T>(array: ReadonlyArray<T>, key: T, comparator: (op1: T, op2: T) => number): number {\r\n\treturn binarySearch2(array.length, i => comparator(array[i], key));\r\n}\r\n\r\n/**\r\n * Performs a binary search algorithm over a sorted collection. Useful for cases\r\n * when we need to perform a binary search over something that isn't actually an\r\n * array, and converting data to an array would defeat the use of binary search\r\n * in the first place.\r\n *\r\n * @param length The collection length.\r\n * @param compareToKey A function that takes an index of an element in the\r\n *   collection and returns zero if the value at this index is equal to the\r\n *   search key, a negative number if the value precedes the search key in the\r\n *   sorting order, or a positive number if the search key precedes the value.\r\n * @return A non-negative index of an element, if found. If not found, the\r\n *   result is -(n+1) (or ~n, using bitwise notation), where n is the index\r\n *   where the key should be inserted to maintain the sorting order.\r\n */\r\nexport function binarySearch2(length: number, compareToKey: (index: number) => number): number {\r\n\tlet low = 0,\r\n\t\thigh = length - 1;\r\n\r\n\twhile (low <= high) {\r\n\t\tconst mid = ((low + high) / 2) | 0;\r\n\t\tconst comp = compareToKey(mid);\r\n\t\tif (comp < 0) {\r\n\t\t\tlow = mid + 1;\r\n\t\t} else if (comp > 0) {\r\n\t\t\thigh = mid - 1;\r\n\t\t} else {\r\n\t\t\treturn mid;\r\n\t\t}\r\n\t}\r\n\treturn -(low + 1);\r\n}\r\n\r\n/**\r\n * Takes a sorted array and a function p. The array is sorted in such a way that all elements where p(x) is false\r\n * are located before all elements where p(x) is true.\r\n * @returns the least x for which p(x) is true or array.length if no element fullfills the given function.\r\n */\r\nexport function findFirstInSorted<T>(array: ReadonlyArray<T>, p: (x: T) => boolean): number {\r\n\tlet low = 0, high = array.length;\r\n\tif (high === 0) {\r\n\t\treturn 0; // no children\r\n\t}\r\n\twhile (low < high) {\r\n\t\tconst mid = Math.floor((low + high) / 2);\r\n\t\tif (p(array[mid])) {\r\n\t\t\thigh = mid;\r\n\t\t} else {\r\n\t\t\tlow = mid + 1;\r\n\t\t}\r\n\t}\r\n\treturn low;\r\n}\r\n\r\ntype Compare<T> = (a: T, b: T) => number;\r\n\r\n\r\nexport function quickSelect<T>(nth: number, data: T[], compare: Compare<T>): T {\r\n\r\n\tnth = nth | 0;\r\n\r\n\tif (nth >= data.length) {\r\n\t\tthrow new TypeError('invalid index');\r\n\t}\r\n\r\n\tconst pivotValue = data[Math.floor(data.length * Math.random())];\r\n\tconst lower: T[] = [];\r\n\tconst higher: T[] = [];\r\n\tconst pivots: T[] = [];\r\n\r\n\tfor (const value of data) {\r\n\t\tconst val = compare(value, pivotValue);\r\n\t\tif (val < 0) {\r\n\t\t\tlower.push(value);\r\n\t\t} else if (val > 0) {\r\n\t\t\thigher.push(value);\r\n\t\t} else {\r\n\t\t\tpivots.push(value);\r\n\t\t}\r\n\t}\r\n\r\n\tif (nth < lower.length) {\r\n\t\treturn quickSelect(nth, lower, compare);\r\n\t} else if (nth < lower.length + pivots.length) {\r\n\t\treturn pivots[0];\r\n\t} else {\r\n\t\treturn quickSelect(nth - (lower.length + pivots.length), higher, compare);\r\n\t}\r\n}\r\n\r\nexport function groupBy<T>(data: ReadonlyArray<T>, compare: (a: T, b: T) => number): T[][] {\r\n\tconst result: T[][] = [];\r\n\tlet currentGroup: T[] | undefined = undefined;\r\n\tfor (const element of data.slice(0).sort(compare)) {\r\n\t\tif (!currentGroup || compare(currentGroup[0], element) !== 0) {\r\n\t\t\tcurrentGroup = [element];\r\n\t\t\tresult.push(currentGroup);\r\n\t\t} else {\r\n\t\t\tcurrentGroup.push(element);\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * @returns New array with all falsy values removed. The original array IS NOT modified.\r\n */\r\nexport function coalesce<T>(array: ReadonlyArray<T | undefined | null>): T[] {\r\n\treturn <T[]>array.filter(e => !!e);\r\n}\r\n\r\n/**\r\n * Remove all falsy values from `array`. The original array IS modified.\r\n */\r\nexport function coalesceInPlace<T>(array: Array<T | undefined | null>): void {\r\n\tlet to = 0;\r\n\tfor (let i = 0; i < array.length; i++) {\r\n\t\tif (!!array[i]) {\r\n\t\t\tarray[to] = array[i];\r\n\t\t\tto += 1;\r\n\t\t}\r\n\t}\r\n\tarray.length = to;\r\n}\r\n\r\n/**\r\n * @returns false if the provided object is an array and not empty.\r\n */\r\nexport function isFalsyOrEmpty(obj: any): boolean {\r\n\treturn !Array.isArray(obj) || obj.length === 0;\r\n}\r\n\r\n/**\r\n * @returns True if the provided object is an array and has at least one element.\r\n */\r\nexport function isNonEmptyArray<T>(obj: T[] | undefined | null): obj is T[];\r\nexport function isNonEmptyArray<T>(obj: readonly T[] | undefined | null): obj is readonly T[];\r\nexport function isNonEmptyArray<T>(obj: T[] | readonly T[] | undefined | null): obj is T[] | readonly T[] {\r\n\treturn Array.isArray(obj) && obj.length > 0;\r\n}\r\n\r\n/**\r\n * Removes duplicates from the given array. The optional keyFn allows to specify\r\n * how elements are checked for equality by returning an alternate value for each.\r\n */\r\nexport function distinct<T>(array: ReadonlyArray<T>, keyFn: (value: T) => any = value => value): T[] {\r\n\tconst seen = new Set<any>();\r\n\r\n\treturn array.filter(element => {\r\n\t\tconst key = keyFn!(element);\r\n\t\tif (seen.has(key)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tseen.add(key);\r\n\t\treturn true;\r\n\t});\r\n}\r\n\r\nexport function findLast<T>(arr: readonly T[], predicate: (item: T) => boolean): T | undefined {\r\n\tconst idx = findLastIndex(arr, predicate);\r\n\tif (idx === -1) {\r\n\t\treturn undefined;\r\n\t}\r\n\treturn arr[idx];\r\n}\r\n\r\nexport function findLastIndex<T>(array: ReadonlyArray<T>, fn: (item: T) => boolean): number {\r\n\tfor (let i = array.length - 1; i >= 0; i--) {\r\n\t\tconst element = array[i];\r\n\r\n\t\tif (fn(element)) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\r\n\treturn -1;\r\n}\r\n\r\nexport function firstOrDefault<T, NotFound = T>(array: ReadonlyArray<T>, notFoundValue: NotFound): T | NotFound;\r\nexport function firstOrDefault<T>(array: ReadonlyArray<T>): T | undefined;\r\nexport function firstOrDefault<T, NotFound = T>(array: ReadonlyArray<T>, notFoundValue?: NotFound): T | NotFound | undefined {\r\n\treturn array.length > 0 ? array[0] : notFoundValue;\r\n}\r\n\r\nexport function range(to: number): number[];\r\nexport function range(from: number, to: number): number[];\r\nexport function range(arg: number, to?: number): number[] {\r\n\tlet from = typeof to === 'number' ? arg : 0;\r\n\r\n\tif (typeof to === 'number') {\r\n\t\tfrom = arg;\r\n\t} else {\r\n\t\tfrom = 0;\r\n\t\tto = arg;\r\n\t}\r\n\r\n\tconst result: number[] = [];\r\n\r\n\tif (from <= to) {\r\n\t\tfor (let i = from; i < to; i++) {\r\n\t\t\tresult.push(i);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (let i = from; i > to; i--) {\r\n\t\t\tresult.push(i);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Insert `insertArr` inside `target` at `insertIndex`.\r\n * Please don't touch unless you understand https://jsperf.com/inserting-an-array-within-an-array\r\n */\r\nexport function arrayInsert<T>(target: T[], insertIndex: number, insertArr: T[]): T[] {\r\n\tconst before = target.slice(0, insertIndex);\r\n\tconst after = target.slice(insertIndex);\r\n\treturn before.concat(insertArr, after);\r\n}\r\n\r\n/**\r\n * Pushes an element to the start of the array, if found.\r\n */\r\nexport function pushToStart<T>(arr: T[], value: T): void {\r\n\tconst index = arr.indexOf(value);\r\n\r\n\tif (index > -1) {\r\n\t\tarr.splice(index, 1);\r\n\t\tarr.unshift(value);\r\n\t}\r\n}\r\n\r\n/**\r\n * Pushes an element to the end of the array, if found.\r\n */\r\nexport function pushToEnd<T>(arr: T[], value: T): void {\r\n\tconst index = arr.indexOf(value);\r\n\r\n\tif (index > -1) {\r\n\t\tarr.splice(index, 1);\r\n\t\tarr.push(value);\r\n\t}\r\n}\r\n\r\nexport function pushMany<T>(arr: T[], items: ReadonlyArray<T>): void {\r\n\tfor (const item of items) {\r\n\t\tarr.push(item);\r\n\t}\r\n}\r\n\r\nexport function asArray<T>(x: T | T[]): T[];\r\nexport function asArray<T>(x: T | readonly T[]): readonly T[];\r\nexport function asArray<T>(x: T | T[]): T[] {\r\n\treturn Array.isArray(x) ? x : [x];\r\n}\r\n\r\n/**\r\n * Returns the first mapped value of the array which is not undefined.\r\n */\r\nexport function mapFind<T, R>(array: Iterable<T>, mapFn: (value: T) => R | undefined): R | undefined {\r\n\tfor (const value of array) {\r\n\t\tconst mapped = mapFn(value);\r\n\t\tif (mapped !== undefined) {\r\n\t\t\treturn mapped;\r\n\t\t}\r\n\t}\r\n\r\n\treturn undefined;\r\n}\r\n\r\n/**\r\n * Insert the new items in the array.\r\n * @param array The original array.\r\n * @param start The zero-based location in the array from which to start inserting elements.\r\n * @param newItems The items to be inserted\r\n */\r\nexport function insertInto<T>(array: T[], start: number, newItems: T[]): void {\r\n\tconst startIdx = getActualStartIndex(array, start);\r\n\tconst originalLength = array.length;\r\n\tconst newItemsLength = newItems.length;\r\n\tarray.length = originalLength + newItemsLength;\r\n\t// Move the items after the start index, start from the end so that we don't overwrite any value.\r\n\tfor (let i = originalLength - 1; i >= startIdx; i--) {\r\n\t\tarray[i + newItemsLength] = array[i];\r\n\t}\r\n\r\n\tfor (let i = 0; i < newItemsLength; i++) {\r\n\t\tarray[i + startIdx] = newItems[i];\r\n\t}\r\n}\r\n\r\n/**\r\n * Removes elements from an array and inserts new elements in their place, returning the deleted elements. Alternative to the native Array.splice method, it\r\n * can only support limited number of items due to the maximum call stack size limit.\r\n * @param array The original array.\r\n * @param start The zero-based location in the array from which to start removing elements.\r\n * @param deleteCount The number of elements to remove.\r\n * @returns An array containing the elements that were deleted.\r\n */\r\nexport function splice<T>(array: T[], start: number, deleteCount: number, newItems: T[]): T[] {\r\n\tconst index = getActualStartIndex(array, start);\r\n\tconst result = array.splice(index, deleteCount);\r\n\tinsertInto(array, index, newItems);\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Determine the actual start index (same logic as the native splice() or slice())\r\n * If greater than the length of the array, start will be set to the length of the array. In this case, no element will be deleted but the method will behave as an adding function, adding as many element as item[n*] provided.\r\n * If negative, it will begin that many elements from the end of the array. (In this case, the origin -1, meaning -n is the index of the nth last element, and is therefore equivalent to the index of array.length - n.) If array.length + start is less than 0, it will begin from index 0.\r\n * @param array The target array.\r\n * @param start The operation index.\r\n */\r\nfunction getActualStartIndex<T>(array: T[], start: number): number {\r\n\treturn start < 0 ? Math.max(start + array.length, 0) : Math.min(start, array.length);\r\n}\r\n\r\n/**\r\n * When comparing two values,\r\n * a negative number indicates that the first value is less than the second,\r\n * a positive number indicates that the first value is greater than the second,\r\n * and zero indicates that neither is the case.\r\n*/\r\nexport type CompareResult = number;\r\n\r\nexport namespace CompareResult {\r\n\texport function isLessThan(result: CompareResult): boolean {\r\n\t\treturn result < 0;\r\n\t}\r\n\r\n\texport function isLessThanOrEqual(result: CompareResult): boolean {\r\n\t\treturn result <= 0;\r\n\t}\r\n\r\n\texport function isGreaterThan(result: CompareResult): boolean {\r\n\t\treturn result > 0;\r\n\t}\r\n\r\n\texport function isNeitherLessOrGreaterThan(result: CompareResult): boolean {\r\n\t\treturn result === 0;\r\n\t}\r\n\r\n\texport const greaterThan = 1;\r\n\texport const lessThan = -1;\r\n\texport const neitherLessOrGreaterThan = 0;\r\n}\r\n\r\n/**\r\n * A comparator `c` defines a total order `<=` on `T` as following:\r\n * `c(a, b) <= 0` iff `a` <= `b`.\r\n * We also have `c(a, b) == 0` iff `c(b, a) == 0`.\r\n*/\r\nexport type Comparator<T> = (a: T, b: T) => CompareResult;\r\n\r\nexport function compareBy<TItem, TCompareBy>(selector: (item: TItem) => TCompareBy, comparator: Comparator<TCompareBy>): Comparator<TItem> {\r\n\treturn (a, b) => comparator(selector(a), selector(b));\r\n}\r\n\r\nexport function tieBreakComparators<TItem>(...comparators: Comparator<TItem>[]): Comparator<TItem> {\r\n\treturn (item1, item2) => {\r\n\t\tfor (const comparator of comparators) {\r\n\t\t\tconst result = comparator(item1, item2);\r\n\t\t\tif (!CompareResult.isNeitherLessOrGreaterThan(result)) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn CompareResult.neitherLessOrGreaterThan;\r\n\t};\r\n}\r\n\r\n/**\r\n * The natural order on numbers.\r\n*/\r\nexport const numberComparator: Comparator<number> = (a, b) => a - b;\r\n\r\nexport const booleanComparator: Comparator<boolean> = (a, b) => numberComparator(a ? 1 : 0, b ? 1 : 0);\r\n\r\nexport function reverseOrder<TItem>(comparator: Comparator<TItem>): Comparator<TItem> {\r\n\treturn (a, b) => -comparator(a, b);\r\n}\r\n\r\n/**\r\n * Returns the first item that is equal to or greater than every other item.\r\n*/\r\nexport function findMaxBy<T>(items: readonly T[], comparator: Comparator<T>): T | undefined {\r\n\tif (items.length === 0) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet max = items[0];\r\n\tfor (let i = 1; i < items.length; i++) {\r\n\t\tconst item = items[i];\r\n\t\tif (comparator(item, max) > 0) {\r\n\t\t\tmax = item;\r\n\t\t}\r\n\t}\r\n\treturn max;\r\n}\r\n\r\n/**\r\n * Returns the last item that is equal to or greater than every other item.\r\n*/\r\nexport function findLastMaxBy<T>(items: readonly T[], comparator: Comparator<T>): T | undefined {\r\n\tif (items.length === 0) {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet max = items[0];\r\n\tfor (let i = 1; i < items.length; i++) {\r\n\t\tconst item = items[i];\r\n\t\tif (comparator(item, max) >= 0) {\r\n\t\t\tmax = item;\r\n\t\t}\r\n\t}\r\n\treturn max;\r\n}\r\n\r\n/**\r\n * Returns the first item that is equal to or less than every other item.\r\n*/\r\nexport function findMinBy<T>(items: readonly T[], comparator: Comparator<T>): T | undefined {\r\n\treturn findMaxBy(items, (a, b) => -comparator(a, b));\r\n}\r\n\r\nexport function findMaxIdxBy<T>(items: readonly T[], comparator: Comparator<T>): number {\r\n\tif (items.length === 0) {\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tlet maxIdx = 0;\r\n\tfor (let i = 1; i < items.length; i++) {\r\n\t\tconst item = items[i];\r\n\t\tif (comparator(item, items[maxIdx]) > 0) {\r\n\t\t\tmaxIdx = i;\r\n\t\t}\r\n\t}\r\n\treturn maxIdx;\r\n}\r\n\r\nexport class ArrayQueue<T> {\r\n\tprivate firstIdx = 0;\r\n\tprivate lastIdx = this.items.length - 1;\r\n\r\n\t/**\r\n\t * Constructs a queue that is backed by the given array. Runtime is O(1).\r\n\t*/\r\n\tconstructor(private readonly items: readonly T[]) { }\r\n\r\n\tget length(): number {\r\n\t\treturn this.lastIdx - this.firstIdx + 1;\r\n\t}\r\n\r\n\t/**\r\n\t * Consumes elements from the beginning of the queue as long as the predicate returns true.\r\n\t * If no elements were consumed, `null` is returned. Has a runtime of O(result.length).\r\n\t*/\r\n\ttakeWhile(predicate: (value: T) => boolean): T[] | null {\r\n\t\t// P(k) := k <= this.lastIdx && predicate(this.items[k])\r\n\t\t// Find s := min { k | k >= this.firstIdx && !P(k) } and return this.data[this.firstIdx...s)\r\n\r\n\t\tlet startIdx = this.firstIdx;\r\n\t\twhile (startIdx < this.items.length && predicate(this.items[startIdx])) {\r\n\t\t\tstartIdx++;\r\n\t\t}\r\n\t\tconst result = startIdx === this.firstIdx ? null : this.items.slice(this.firstIdx, startIdx);\r\n\t\tthis.firstIdx = startIdx;\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Consumes elements from the end of the queue as long as the predicate returns true.\r\n\t * If no elements were consumed, `null` is returned.\r\n\t * The result has the same order as the underlying array!\r\n\t*/\r\n\ttakeFromEndWhile(predicate: (value: T) => boolean): T[] | null {\r\n\t\t// P(k) := this.firstIdx >= k && predicate(this.items[k])\r\n\t\t// Find s := max { k | k <= this.lastIdx && !P(k) } and return this.data(s...this.lastIdx]\r\n\r\n\t\tlet endIdx = this.lastIdx;\r\n\t\twhile (endIdx >= 0 && predicate(this.items[endIdx])) {\r\n\t\t\tendIdx--;\r\n\t\t}\r\n\t\tconst result = endIdx === this.lastIdx ? null : this.items.slice(endIdx + 1, this.lastIdx + 1);\r\n\t\tthis.lastIdx = endIdx;\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpeek(): T | undefined {\r\n\t\tif (this.length === 0) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn this.items[this.firstIdx];\r\n\t}\r\n\r\n\tdequeue(): T | undefined {\r\n\t\tconst result = this.items[this.firstIdx];\r\n\t\tthis.firstIdx++;\r\n\t\treturn result;\r\n\t}\r\n\r\n\ttakeCount(count: number): T[] {\r\n\t\tconst result = this.items.slice(this.firstIdx, this.firstIdx + count);\r\n\t\tthis.firstIdx += count;\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n/**\r\n * This class is faster than an iterator and array for lazy computed data.\r\n*/\r\nexport class CallbackIterable<T> {\r\n\tpublic static readonly empty = new CallbackIterable<never>(_callback => { });\r\n\r\n\tconstructor(\r\n\t\t/**\r\n\t\t * Calls the callback for every item.\r\n\t\t * Stops when the callback returns false.\r\n\t\t*/\r\n\t\tpublic readonly iterate: (callback: (item: T) => boolean) => void\r\n\t) {\r\n\t}\r\n\r\n\ttoArray(): T[] {\r\n\t\tconst result: T[] = [];\r\n\t\tthis.iterate(item => { result.push(item); return true; });\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfilter(predicate: (item: T) => boolean): CallbackIterable<T> {\r\n\t\treturn new CallbackIterable(cb => this.iterate(item => predicate(item) ? cb(item) : true));\r\n\t}\r\n\r\n\tmap<TResult>(mapFn: (item: T) => TResult): CallbackIterable<TResult> {\r\n\t\treturn new CallbackIterable<TResult>(cb => this.iterate(item => cb(mapFn(item))));\r\n\t}\r\n\r\n\tfindLast(predicate: (item: T) => boolean): T | undefined {\r\n\t\tlet result: T | undefined;\r\n\t\tthis.iterate(item => {\r\n\t\t\tif (predicate(item)) {\r\n\t\t\t\tresult = item;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\r\n\tfindLastMaxBy(comparator: Comparator<T>): T | undefined {\r\n\t\tlet result: T | undefined;\r\n\t\tlet first = true;\r\n\t\tthis.iterate(item => {\r\n\t\t\tif (first || CompareResult.isGreaterThan(comparator(item, result!))) {\r\n\t\t\t\tfirst = false;\r\n\t\t\t\tresult = item;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n}\r\n","\r\n\r\n/**\r\n * Uses a LRU cache to make a given parametrized function cached.\r\n * Caches just the last value.\r\n * The key must be JSON serializable.\r\n*/\r\nexport class LRUCachedFunction<TArg, TComputed> {\r\n\tprivate lastCache: TComputed | undefined = undefined;\r\n\tprivate lastArgKey: string | undefined = undefined;\r\n\r\n\tconstructor(private readonly fn: (arg: TArg) => TComputed) {\r\n\t}\r\n\r\n\tpublic get(arg: TArg): TComputed {\r\n\t\tconst key = JSON.stringify(arg);\r\n\t\tif (this.lastArgKey !== key) {\r\n\t\t\tthis.lastArgKey = key;\r\n\t\t\tthis.lastCache = this.fn(arg);\r\n\t\t}\r\n\t\treturn this.lastCache!;\r\n\t}\r\n}\r\n\r\n/**\r\n * Uses an unbounded cache (referential equality) to memoize the results of the given function.\r\n*/\r\nexport class CachedFunction<TArg, TValue> {\r\n\tprivate readonly _map = new Map<TArg, TValue>();\r\n\tpublic get cachedValues(): ReadonlyMap<TArg, TValue> {\r\n\t\treturn this._map;\r\n\t}\r\n\r\n\tconstructor(private readonly fn: (arg: TArg) => TValue) { }\r\n\r\n\tpublic get(arg: TArg): TValue {\r\n\t\tif (this._map.has(arg)) {\r\n\t\t\treturn this._map.get(arg)!;\r\n\t\t}\r\n\t\tconst value = this.fn(arg);\r\n\t\tthis._map.set(arg, value);\r\n\t\treturn value;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/**\r\n * An interface for a JavaScript object that\r\n * acts a dictionary. The keys are strings.\r\n */\r\nexport type IStringDictionary<V> = Record<string, V>;\r\nexport class SetMap<K, V> {\r\n\r\n\tprivate map = new Map<K, Set<V>>();\r\n\r\n\tadd(key: K, value: V): void {\r\n\t\tlet values = this.map.get(key);\r\n\r\n\t\tif (!values) {\r\n\t\t\tvalues = new Set<V>();\r\n\t\t\tthis.map.set(key, values);\r\n\t\t}\r\n\r\n\t\tvalues.add(value);\r\n\t}\r\n\r\n\tdelete(key: K, value: V): void {\r\n\t\tconst values = this.map.get(key);\r\n\r\n\t\tif (!values) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvalues.delete(value);\r\n\r\n\t\tif (values.size === 0) {\r\n\t\t\tthis.map.delete(key);\r\n\t\t}\r\n\t}\r\n\r\n\tforEach(key: K, fn: (value: V) => void): void {\r\n\t\tconst values = this.map.get(key);\r\n\r\n\t\tif (!values) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvalues.forEach(fn);\r\n\t}\r\n\r\n\tget(key: K): ReadonlySet<V> {\r\n\t\tconst values = this.map.get(key);\r\n\t\tif (!values) {\r\n\t\t\treturn new Set<V>();\r\n\t\t}\r\n\t\treturn values;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\n\r\nfunction roundFloat(number: number, decimalPoints: number): number {\r\n\tconst decimal = Math.pow(10, decimalPoints);\r\n\treturn Math.round(number * decimal) / decimal;\r\n}\r\n\r\nexport class RGBA {\r\n\t_rgbaBrand: void = undefined;\r\n\r\n\t/**\r\n\t * Red: integer in [0-255]\r\n\t */\r\n\treadonly r: number;\r\n\r\n\t/**\r\n\t * Green: integer in [0-255]\r\n\t */\r\n\treadonly g: number;\r\n\r\n\t/**\r\n\t * Blue: integer in [0-255]\r\n\t */\r\n\treadonly b: number;\r\n\r\n\t/**\r\n\t * Alpha: float in [0-1]\r\n\t */\r\n\treadonly a: number;\r\n\r\n\tconstructor(r: number, g: number, b: number, a: number = 1) {\r\n\t\tthis.r = Math.min(255, Math.max(0, r)) | 0;\r\n\t\tthis.g = Math.min(255, Math.max(0, g)) | 0;\r\n\t\tthis.b = Math.min(255, Math.max(0, b)) | 0;\r\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n\t}\r\n\r\n\tstatic equals(a: RGBA, b: RGBA): boolean {\r\n\t\treturn a.r === b.r && a.g === b.g && a.b === b.b && a.a === b.a;\r\n\t}\r\n}\r\n\r\nexport class HSLA {\r\n\r\n\t_hslaBrand: void = undefined;\r\n\r\n\t/**\r\n\t * Hue: integer in [0, 360]\r\n\t */\r\n\treadonly h: number;\r\n\r\n\t/**\r\n\t * Saturation: float in [0, 1]\r\n\t */\r\n\treadonly s: number;\r\n\r\n\t/**\r\n\t * Luminosity: float in [0, 1]\r\n\t */\r\n\treadonly l: number;\r\n\r\n\t/**\r\n\t * Alpha: float in [0, 1]\r\n\t */\r\n\treadonly a: number;\r\n\r\n\tconstructor(h: number, s: number, l: number, a: number) {\r\n\t\tthis.h = Math.max(Math.min(360, h), 0) | 0;\r\n\t\tthis.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\r\n\t\tthis.l = roundFloat(Math.max(Math.min(1, l), 0), 3);\r\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n\t}\r\n\r\n\tstatic equals(a: HSLA, b: HSLA): boolean {\r\n\t\treturn a.h === b.h && a.s === b.s && a.l === b.l && a.a === b.a;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts an RGB color value to HSL. Conversion formula\r\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n\t * Assumes r, g, and b are contained in the set [0, 255] and\r\n\t * returns h in the set [0, 360], s, and l in the set [0, 1].\r\n\t */\r\n\tstatic fromRGBA(rgba: RGBA): HSLA {\r\n\t\tconst r = rgba.r / 255;\r\n\t\tconst g = rgba.g / 255;\r\n\t\tconst b = rgba.b / 255;\r\n\t\tconst a = rgba.a;\r\n\r\n\t\tconst max = Math.max(r, g, b);\r\n\t\tconst min = Math.min(r, g, b);\r\n\t\tlet h = 0;\r\n\t\tlet s = 0;\r\n\t\tconst l = (min + max) / 2;\r\n\t\tconst chroma = max - min;\r\n\r\n\t\tif (chroma > 0) {\r\n\t\t\ts = Math.min((l <= 0.5 ? chroma / (2 * l) : chroma / (2 - (2 * l))), 1);\r\n\r\n\t\t\tswitch (max) {\r\n\t\t\t\tcase r: h = (g - b) / chroma + (g < b ? 6 : 0); break;\r\n\t\t\t\tcase g: h = (b - r) / chroma + 2; break;\r\n\t\t\t\tcase b: h = (r - g) / chroma + 4; break;\r\n\t\t\t}\r\n\r\n\t\t\th *= 60;\r\n\t\t\th = Math.round(h);\r\n\t\t}\r\n\t\treturn new HSLA(h, s, l, a);\r\n\t}\r\n\r\n\tprivate static _hue2rgb(p: number, q: number, t: number): number {\r\n\t\tif (t < 0) {\r\n\t\t\tt += 1;\r\n\t\t}\r\n\t\tif (t > 1) {\r\n\t\t\tt -= 1;\r\n\t\t}\r\n\t\tif (t < 1 / 6) {\r\n\t\t\treturn p + (q - p) * 6 * t;\r\n\t\t}\r\n\t\tif (t < 1 / 2) {\r\n\t\t\treturn q;\r\n\t\t}\r\n\t\tif (t < 2 / 3) {\r\n\t\t\treturn p + (q - p) * (2 / 3 - t) * 6;\r\n\t\t}\r\n\t\treturn p;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts an HSL color value to RGB. Conversion formula\r\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\r\n\t * Assumes h in the set [0, 360] s, and l are contained in the set [0, 1] and\r\n\t * returns r, g, and b in the set [0, 255].\r\n\t */\r\n\tstatic toRGBA(hsla: HSLA): RGBA {\r\n\t\tconst h = hsla.h / 360;\r\n\t\tconst { s, l, a } = hsla;\r\n\t\tlet r: number, g: number, b: number;\r\n\r\n\t\tif (s === 0) {\r\n\t\t\tr = g = b = l; // achromatic\r\n\t\t} else {\r\n\t\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\r\n\t\t\tconst p = 2 * l - q;\r\n\t\t\tr = HSLA._hue2rgb(p, q, h + 1 / 3);\r\n\t\t\tg = HSLA._hue2rgb(p, q, h);\r\n\t\t\tb = HSLA._hue2rgb(p, q, h - 1 / 3);\r\n\t\t}\r\n\r\n\t\treturn new RGBA(Math.round(r * 255), Math.round(g * 255), Math.round(b * 255), a);\r\n\t}\r\n}\r\n\r\nexport class HSVA {\r\n\r\n\t_hsvaBrand: void = undefined;\r\n\r\n\t/**\r\n\t * Hue: integer in [0, 360]\r\n\t */\r\n\treadonly h: number;\r\n\r\n\t/**\r\n\t * Saturation: float in [0, 1]\r\n\t */\r\n\treadonly s: number;\r\n\r\n\t/**\r\n\t * Value: float in [0, 1]\r\n\t */\r\n\treadonly v: number;\r\n\r\n\t/**\r\n\t * Alpha: float in [0, 1]\r\n\t */\r\n\treadonly a: number;\r\n\r\n\tconstructor(h: number, s: number, v: number, a: number) {\r\n\t\tthis.h = Math.max(Math.min(360, h), 0) | 0;\r\n\t\tthis.s = roundFloat(Math.max(Math.min(1, s), 0), 3);\r\n\t\tthis.v = roundFloat(Math.max(Math.min(1, v), 0), 3);\r\n\t\tthis.a = roundFloat(Math.max(Math.min(1, a), 0), 3);\r\n\t}\r\n\r\n\tstatic equals(a: HSVA, b: HSVA): boolean {\r\n\t\treturn a.h === b.h && a.s === b.s && a.v === b.v && a.a === b.a;\r\n\t}\r\n\r\n\t// from http://www.rapidtables.com/convert/color/rgb-to-hsv.htm\r\n\tstatic fromRGBA(rgba: RGBA): HSVA {\r\n\t\tconst r = rgba.r / 255;\r\n\t\tconst g = rgba.g / 255;\r\n\t\tconst b = rgba.b / 255;\r\n\t\tconst cmax = Math.max(r, g, b);\r\n\t\tconst cmin = Math.min(r, g, b);\r\n\t\tconst delta = cmax - cmin;\r\n\t\tconst s = cmax === 0 ? 0 : (delta / cmax);\r\n\t\tlet m: number;\r\n\r\n\t\tif (delta === 0) {\r\n\t\t\tm = 0;\r\n\t\t} else if (cmax === r) {\r\n\t\t\tm = ((((g - b) / delta) % 6) + 6) % 6;\r\n\t\t} else if (cmax === g) {\r\n\t\t\tm = ((b - r) / delta) + 2;\r\n\t\t} else {\r\n\t\t\tm = ((r - g) / delta) + 4;\r\n\t\t}\r\n\r\n\t\treturn new HSVA(Math.round(m * 60), s, cmax, rgba.a);\r\n\t}\r\n\r\n\t// from http://www.rapidtables.com/convert/color/hsv-to-rgb.htm\r\n\tstatic toRGBA(hsva: HSVA): RGBA {\r\n\t\tconst { h, s, v, a } = hsva;\r\n\t\tconst c = v * s;\r\n\t\tconst x = c * (1 - Math.abs((h / 60) % 2 - 1));\r\n\t\tconst m = v - c;\r\n\t\tlet [r, g, b] = [0, 0, 0];\r\n\r\n\t\tif (h < 60) {\r\n\t\t\tr = c;\r\n\t\t\tg = x;\r\n\t\t} else if (h < 120) {\r\n\t\t\tr = x;\r\n\t\t\tg = c;\r\n\t\t} else if (h < 180) {\r\n\t\t\tg = c;\r\n\t\t\tb = x;\r\n\t\t} else if (h < 240) {\r\n\t\t\tg = x;\r\n\t\t\tb = c;\r\n\t\t} else if (h < 300) {\r\n\t\t\tr = x;\r\n\t\t\tb = c;\r\n\t\t} else if (h <= 360) {\r\n\t\t\tr = c;\r\n\t\t\tb = x;\r\n\t\t}\r\n\r\n\t\tr = Math.round((r + m) * 255);\r\n\t\tg = Math.round((g + m) * 255);\r\n\t\tb = Math.round((b + m) * 255);\r\n\r\n\t\treturn new RGBA(r, g, b, a);\r\n\t}\r\n}\r\n\r\nexport class Color {\r\n\r\n\tstatic fromHex(hex: string): Color {\r\n\t\treturn Color.Format.CSS.parseHex(hex) || Color.red;\r\n\t}\r\n\r\n\tstatic equals(a: Color | null, b: Color | null): boolean {\r\n\t\tif (!a && !b) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (!a || !b) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn a.equals(b);\r\n\t}\r\n\r\n\treadonly rgba: RGBA;\r\n\tprivate _hsla?: HSLA;\r\n\tget hsla(): HSLA {\r\n\t\tif (this._hsla) {\r\n\t\t\treturn this._hsla;\r\n\t\t} else {\r\n\t\t\treturn HSLA.fromRGBA(this.rgba);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _hsva?: HSVA;\r\n\tget hsva(): HSVA {\r\n\t\tif (this._hsva) {\r\n\t\t\treturn this._hsva;\r\n\t\t}\r\n\t\treturn HSVA.fromRGBA(this.rgba);\r\n\t}\r\n\r\n\tconstructor(arg: RGBA | HSLA | HSVA) {\r\n\t\tif (!arg) {\r\n\t\t\tthrow new Error('Color needs a value');\r\n\t\t} else if (arg instanceof RGBA) {\r\n\t\t\tthis.rgba = arg;\r\n\t\t} else if (arg instanceof HSLA) {\r\n\t\t\tthis._hsla = arg;\r\n\t\t\tthis.rgba = HSLA.toRGBA(arg);\r\n\t\t} else if (arg instanceof HSVA) {\r\n\t\t\tthis._hsva = arg;\r\n\t\t\tthis.rgba = HSVA.toRGBA(arg);\r\n\t\t} else {\r\n\t\t\tthrow new Error('Invalid color ctor argument');\r\n\t\t}\r\n\t}\r\n\r\n\tequals(other: Color | null): boolean {\r\n\t\treturn !!other && RGBA.equals(this.rgba, other.rgba) && HSLA.equals(this.hsla, other.hsla) && HSVA.equals(this.hsva, other.hsva);\r\n\t}\r\n\r\n\t/**\r\n\t * http://www.w3.org/TR/WCAG20/#relativeluminancedef\r\n\t * Returns the number in the set [0, 1]. O => Darkest Black. 1 => Lightest white.\r\n\t */\r\n\tgetRelativeLuminance(): number {\r\n\t\tconst R = Color._relativeLuminanceForComponent(this.rgba.r);\r\n\t\tconst G = Color._relativeLuminanceForComponent(this.rgba.g);\r\n\t\tconst B = Color._relativeLuminanceForComponent(this.rgba.b);\r\n\t\tconst luminance = 0.2126 * R + 0.7152 * G + 0.0722 * B;\r\n\r\n\t\treturn roundFloat(luminance, 4);\r\n\t}\r\n\r\n\tprivate static _relativeLuminanceForComponent(color: number): number {\r\n\t\tconst c = color / 255;\r\n\t\treturn (c <= 0.03928) ? c / 12.92 : Math.pow(((c + 0.055) / 1.055), 2.4);\r\n\t}\r\n\r\n\t/**\r\n\t *\thttp://24ways.org/2010/calculating-color-contrast\r\n\t *  Return 'true' if lighter color otherwise 'false'\r\n\t */\r\n\tisLighter(): boolean {\r\n\t\tconst yiq = (this.rgba.r * 299 + this.rgba.g * 587 + this.rgba.b * 114) / 1000;\r\n\t\treturn yiq >= 128;\r\n\t}\r\n\r\n\tisLighterThan(another: Color): boolean {\r\n\t\tconst lum1 = this.getRelativeLuminance();\r\n\t\tconst lum2 = another.getRelativeLuminance();\r\n\t\treturn lum1 > lum2;\r\n\t}\r\n\r\n\tisDarkerThan(another: Color): boolean {\r\n\t\tconst lum1 = this.getRelativeLuminance();\r\n\t\tconst lum2 = another.getRelativeLuminance();\r\n\t\treturn lum1 < lum2;\r\n\t}\r\n\r\n\tlighten(factor: number): Color {\r\n\t\treturn new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l + this.hsla.l * factor, this.hsla.a));\r\n\t}\r\n\r\n\tdarken(factor: number): Color {\r\n\t\treturn new Color(new HSLA(this.hsla.h, this.hsla.s, this.hsla.l - this.hsla.l * factor, this.hsla.a));\r\n\t}\r\n\r\n\ttransparent(factor: number): Color {\r\n\t\tconst { r, g, b, a } = this.rgba;\r\n\t\treturn new Color(new RGBA(r, g, b, a * factor));\r\n\t}\r\n\r\n\tisTransparent(): boolean {\r\n\t\treturn this.rgba.a === 0;\r\n\t}\r\n\r\n\tisOpaque(): boolean {\r\n\t\treturn this.rgba.a === 1;\r\n\t}\r\n\r\n\topposite(): Color {\r\n\t\treturn new Color(new RGBA(255 - this.rgba.r, 255 - this.rgba.g, 255 - this.rgba.b, this.rgba.a));\r\n\t}\r\n\r\n\tmakeOpaque(opaqueBackground: Color): Color {\r\n\t\tif (this.isOpaque() || opaqueBackground.rgba.a !== 1) {\r\n\t\t\t// only allow to blend onto a non-opaque color onto a opaque color\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tconst { r, g, b, a } = this.rgba;\r\n\r\n\t\t// https://stackoverflow.com/questions/12228548/finding-equivalent-color-with-opacity\r\n\t\treturn new Color(new RGBA(\r\n\t\t\topaqueBackground.rgba.r - a * (opaqueBackground.rgba.r - r),\r\n\t\t\topaqueBackground.rgba.g - a * (opaqueBackground.rgba.g - g),\r\n\t\t\topaqueBackground.rgba.b - a * (opaqueBackground.rgba.b - b),\r\n\t\t\t1\r\n\t\t));\r\n\t}\r\n\r\n\tprivate _toString?: string;\r\n\ttoString(): string {\r\n\t\tif (!this._toString) {\r\n\t\t\tthis._toString = Color.Format.CSS.format(this);\r\n\t\t}\r\n\t\treturn this._toString;\r\n\t}\r\n\r\n\tstatic getLighterColor(of: Color, relative: Color, factor?: number): Color {\r\n\t\tif (of.isLighterThan(relative)) {\r\n\t\t\treturn of;\r\n\t\t}\r\n\t\tfactor = factor ? factor : 0.5;\r\n\t\tconst lum1 = of.getRelativeLuminance();\r\n\t\tconst lum2 = relative.getRelativeLuminance();\r\n\t\tfactor = factor * (lum2 - lum1) / lum2;\r\n\t\treturn of.lighten(factor);\r\n\t}\r\n\r\n\tstatic getDarkerColor(of: Color, relative: Color, factor?: number): Color {\r\n\t\tif (of.isDarkerThan(relative)) {\r\n\t\t\treturn of;\r\n\t\t}\r\n\t\tfactor = factor ? factor : 0.5;\r\n\t\tconst lum1 = of.getRelativeLuminance();\r\n\t\tconst lum2 = relative.getRelativeLuminance();\r\n\t\tfactor = factor * (lum1 - lum2) / lum1;\r\n\t\treturn of.darken(factor);\r\n\t}\r\n\r\n\tstatic readonly white = new Color(new RGBA(255, 255, 255, 1));\r\n\tstatic readonly black = new Color(new RGBA(0, 0, 0, 1));\r\n\tstatic readonly red = new Color(new RGBA(255, 0, 0, 1));\r\n\tstatic readonly blue = new Color(new RGBA(0, 0, 255, 1));\r\n\tstatic readonly green = new Color(new RGBA(0, 255, 0, 1));\r\n\tstatic readonly cyan = new Color(new RGBA(0, 255, 255, 1));\r\n\tstatic readonly lightgrey = new Color(new RGBA(211, 211, 211, 1));\r\n\tstatic readonly transparent = new Color(new RGBA(0, 0, 0, 0));\r\n}\r\n\r\nexport namespace Color {\r\n\texport namespace Format {\r\n\t\texport namespace CSS {\r\n\r\n\t\t\texport function formatRGB(color: Color): string {\r\n\t\t\t\tif (color.rgba.a === 1) {\r\n\t\t\t\t\treturn `rgb(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b})`;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn Color.Format.CSS.formatRGBA(color);\r\n\t\t\t}\r\n\r\n\t\t\texport function formatRGBA(color: Color): string {\r\n\t\t\t\treturn `rgba(${color.rgba.r}, ${color.rgba.g}, ${color.rgba.b}, ${+(color.rgba.a).toFixed(2)})`;\r\n\t\t\t}\r\n\r\n\t\t\texport function formatHSL(color: Color): string {\r\n\t\t\t\tif (color.hsla.a === 1) {\r\n\t\t\t\t\treturn `hsl(${color.hsla.h}, ${(color.hsla.s * 100).toFixed(2)}%, ${(color.hsla.l * 100).toFixed(2)}%)`;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn Color.Format.CSS.formatHSLA(color);\r\n\t\t\t}\r\n\r\n\t\t\texport function formatHSLA(color: Color): string {\r\n\t\t\t\treturn `hsla(${color.hsla.h}, ${(color.hsla.s * 100).toFixed(2)}%, ${(color.hsla.l * 100).toFixed(2)}%, ${color.hsla.a.toFixed(2)})`;\r\n\t\t\t}\r\n\r\n\t\t\tfunction _toTwoDigitHex(n: number): string {\r\n\t\t\t\tconst r = n.toString(16);\r\n\t\t\t\treturn r.length !== 2 ? '0' + r : r;\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Formats the color as #RRGGBB\r\n\t\t\t */\r\n\t\t\texport function formatHex(color: Color): string {\r\n\t\t\t\treturn `#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}`;\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Formats the color as #RRGGBBAA\r\n\t\t\t * If 'compact' is set, colors without transparancy will be printed as #RRGGBB\r\n\t\t\t */\r\n\t\t\texport function formatHexA(color: Color, compact = false): string {\r\n\t\t\t\tif (compact && color.rgba.a === 1) {\r\n\t\t\t\t\treturn Color.Format.CSS.formatHex(color);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn `#${_toTwoDigitHex(color.rgba.r)}${_toTwoDigitHex(color.rgba.g)}${_toTwoDigitHex(color.rgba.b)}${_toTwoDigitHex(Math.round(color.rgba.a * 255))}`;\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * The default format will use HEX if opaque and RGBA otherwise.\r\n\t\t\t */\r\n\t\t\texport function format(color: Color): string {\r\n\t\t\t\tif (color.isOpaque()) {\r\n\t\t\t\t\treturn Color.Format.CSS.formatHex(color);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn Color.Format.CSS.formatRGBA(color);\r\n\t\t\t}\r\n\r\n\t\t\t/**\r\n\t\t\t * Converts an Hex color value to a Color.\r\n\t\t\t * returns r, g, and b are contained in the set [0, 255]\r\n\t\t\t * @param hex string (#RGB, #RGBA, #RRGGBB or #RRGGBBAA).\r\n\t\t\t */\r\n\t\t\texport function parseHex(hex: string): Color | null {\r\n\t\t\t\tconst length = hex.length;\r\n\r\n\t\t\t\tif (length === 0) {\r\n\t\t\t\t\t// Invalid color\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (hex.charCodeAt(0) !== CharCode.Hash) {\r\n\t\t\t\t\t// Does not begin with a #\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length === 7) {\r\n\t\t\t\t\t// #RRGGBB format\r\n\t\t\t\t\tconst r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\r\n\t\t\t\t\tconst g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\r\n\t\t\t\t\tconst b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\r\n\t\t\t\t\treturn new Color(new RGBA(r, g, b, 1));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length === 9) {\r\n\t\t\t\t\t// #RRGGBBAA format\r\n\t\t\t\t\tconst r = 16 * _parseHexDigit(hex.charCodeAt(1)) + _parseHexDigit(hex.charCodeAt(2));\r\n\t\t\t\t\tconst g = 16 * _parseHexDigit(hex.charCodeAt(3)) + _parseHexDigit(hex.charCodeAt(4));\r\n\t\t\t\t\tconst b = 16 * _parseHexDigit(hex.charCodeAt(5)) + _parseHexDigit(hex.charCodeAt(6));\r\n\t\t\t\t\tconst a = 16 * _parseHexDigit(hex.charCodeAt(7)) + _parseHexDigit(hex.charCodeAt(8));\r\n\t\t\t\t\treturn new Color(new RGBA(r, g, b, a / 255));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length === 4) {\r\n\t\t\t\t\t// #RGB format\r\n\t\t\t\t\tconst r = _parseHexDigit(hex.charCodeAt(1));\r\n\t\t\t\t\tconst g = _parseHexDigit(hex.charCodeAt(2));\r\n\t\t\t\t\tconst b = _parseHexDigit(hex.charCodeAt(3));\r\n\t\t\t\t\treturn new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length === 5) {\r\n\t\t\t\t\t// #RGBA format\r\n\t\t\t\t\tconst r = _parseHexDigit(hex.charCodeAt(1));\r\n\t\t\t\t\tconst g = _parseHexDigit(hex.charCodeAt(2));\r\n\t\t\t\t\tconst b = _parseHexDigit(hex.charCodeAt(3));\r\n\t\t\t\t\tconst a = _parseHexDigit(hex.charCodeAt(4));\r\n\t\t\t\t\treturn new Color(new RGBA(16 * r + r, 16 * g + g, 16 * b + b, (16 * a + a) / 255));\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Invalid color\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tfunction _parseHexDigit(charCode: CharCode): number {\r\n\t\t\t\tswitch (charCode) {\r\n\t\t\t\t\tcase CharCode.Digit0: return 0;\r\n\t\t\t\t\tcase CharCode.Digit1: return 1;\r\n\t\t\t\t\tcase CharCode.Digit2: return 2;\r\n\t\t\t\t\tcase CharCode.Digit3: return 3;\r\n\t\t\t\t\tcase CharCode.Digit4: return 4;\r\n\t\t\t\t\tcase CharCode.Digit5: return 5;\r\n\t\t\t\t\tcase CharCode.Digit6: return 6;\r\n\t\t\t\t\tcase CharCode.Digit7: return 7;\r\n\t\t\t\t\tcase CharCode.Digit8: return 8;\r\n\t\t\t\t\tcase CharCode.Digit9: return 9;\r\n\t\t\t\t\tcase CharCode.a: return 10;\r\n\t\t\t\t\tcase CharCode.A: return 10;\r\n\t\t\t\t\tcase CharCode.b: return 11;\r\n\t\t\t\t\tcase CharCode.B: return 11;\r\n\t\t\t\t\tcase CharCode.c: return 12;\r\n\t\t\t\t\tcase CharCode.C: return 12;\r\n\t\t\t\t\tcase CharCode.d: return 13;\r\n\t\t\t\t\tcase CharCode.D: return 13;\r\n\t\t\t\t\tcase CharCode.e: return 14;\r\n\t\t\t\t\tcase CharCode.E: return 14;\r\n\t\t\t\t\tcase CharCode.f: return 15;\r\n\t\t\t\t\tcase CharCode.F: return 15;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/**\r\n * Represents information about a specific difference between two sequences.\r\n */\r\nexport class DiffChange {\r\n\r\n\t/**\r\n\t * The position of the first element in the original sequence which\r\n\t * this change affects.\r\n\t */\r\n\tpublic originalStart: number;\r\n\r\n\t/**\r\n\t * The number of elements from the original sequence which were\r\n\t * affected.\r\n\t */\r\n\tpublic originalLength: number;\r\n\r\n\t/**\r\n\t * The position of the first element in the modified sequence which\r\n\t * this change affects.\r\n\t */\r\n\tpublic modifiedStart: number;\r\n\r\n\t/**\r\n\t * The number of elements from the modified sequence which were\r\n\t * affected (added).\r\n\t */\r\n\tpublic modifiedLength: number;\r\n\r\n\t/**\r\n\t * Constructs a new DiffChange with the given sequence information\r\n\t * and content.\r\n\t */\r\n\tconstructor(originalStart: number, originalLength: number, modifiedStart: number, modifiedLength: number) {\r\n\t\t//Debug.Assert(originalLength > 0 || modifiedLength > 0, \"originalLength and modifiedLength cannot both be <= 0\");\r\n\t\tthis.originalStart = originalStart;\r\n\t\tthis.originalLength = originalLength;\r\n\t\tthis.modifiedStart = modifiedStart;\r\n\t\tthis.modifiedLength = modifiedLength;\r\n\t}\r\n\r\n\t/**\r\n\t * The end point (exclusive) of the change in the original sequence.\r\n\t */\r\n\tpublic getOriginalEnd() {\r\n\t\treturn this.originalStart + this.originalLength;\r\n\t}\r\n\r\n\t/**\r\n\t * The end point (exclusive) of the change in the modified sequence.\r\n\t */\r\n\tpublic getModifiedEnd() {\r\n\t\treturn this.modifiedStart + this.modifiedLength;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nexport interface ErrorListenerCallback {\r\n\t(error: any): void;\r\n}\r\n\r\n// Avoid circular dependency on EventEmitter by implementing a subset of the interface.\r\nexport class ErrorHandler {\r\n\tprivate unexpectedErrorHandler: (e: any) => void;\r\n\tprivate listeners: ErrorListenerCallback[];\r\n\r\n\tconstructor() {\r\n\r\n\t\tthis.listeners = [];\r\n\r\n\t\tthis.unexpectedErrorHandler = function (e: any) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (e.stack) {\r\n\t\t\t\t\tif (ErrorNoTelemetry.isErrorNoTelemetry(e)) {\r\n\t\t\t\t\t\tthrow new ErrorNoTelemetry(e.message + '\\n\\n' + e.stack);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthrow new Error(e.message + '\\n\\n' + e.stack);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthrow e;\r\n\t\t\t}, 0);\r\n\t\t};\r\n\t}\r\n\r\n\tprivate emit(e: any): void {\r\n\t\tthis.listeners.forEach((listener) => {\r\n\t\t\tlistener(e);\r\n\t\t});\r\n\t}\r\n\r\n\tonUnexpectedError(e: any): void {\r\n\t\tthis.unexpectedErrorHandler(e);\r\n\t\tthis.emit(e);\r\n\t}\r\n\r\n\t// For external errors, we don't want the listeners to be called\r\n\tonUnexpectedExternalError(e: any): void {\r\n\t\tthis.unexpectedErrorHandler(e);\r\n\t}\r\n}\r\n\r\nexport const errorHandler = new ErrorHandler();\r\n\r\nexport function onUnexpectedError(e: any): undefined {\r\n\t// ignore errors from cancelled promises\r\n\tif (!isCancellationError(e)) {\r\n\t\terrorHandler.onUnexpectedError(e);\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nexport function onUnexpectedExternalError(e: any): undefined {\r\n\t// ignore errors from cancelled promises\r\n\tif (!isCancellationError(e)) {\r\n\t\terrorHandler.onUnexpectedExternalError(e);\r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nexport interface SerializedError {\r\n}\r\n\r\nexport function transformErrorForSerialization(error: Error): SerializedError;\r\nexport function transformErrorForSerialization(error: any): any;\r\nexport function transformErrorForSerialization(error: any): any {\r\n\tif (error instanceof Error) {\r\n\t\tconst { name, message } = error;\r\n\t\tconst stack: string = (<any>error).stacktrace || (<any>error).stack;\r\n\t\treturn {\r\n\t\t\t$isError: true,\r\n\t\t\tname,\r\n\t\t\tmessage,\r\n\t\t\tstack,\r\n\t\t\tnoTelemetry: ErrorNoTelemetry.isErrorNoTelemetry(error)\r\n\t\t};\r\n\t}\r\n\r\n\t// return as is\r\n\treturn error;\r\n}\r\n\r\nconst canceledName = 'Canceled';\r\n\r\n/**\r\n * Checks if the given error is a promise in canceled state\r\n */\r\nexport function isCancellationError(error: any): boolean {\r\n\tif (error instanceof CancellationError) {\r\n\t\treturn true;\r\n\t}\r\n\treturn error instanceof Error && error.name === canceledName && error.message === canceledName;\r\n}\r\n\r\n// !!!IMPORTANT!!!\r\n// Do NOT change this class because it is also used as an API-type.\r\nexport class CancellationError extends Error {\r\n\tconstructor() {\r\n\t\tsuper(canceledName);\r\n\t\tthis.name = this.message;\r\n\t}\r\n}\r\n\r\n/**\r\n * @deprecated use {@link CancellationError `new CancellationError()`} instead\r\n */\r\nexport function canceled(): Error {\r\n\tconst error = new Error(canceledName);\r\n\terror.name = error.message;\r\n\treturn error;\r\n}\r\n\r\nexport function illegalArgument(name?: string): Error {\r\n\tif (name) {\r\n\t\treturn new Error(`Illegal argument: ${name}`);\r\n\t} else {\r\n\t\treturn new Error('Illegal argument');\r\n\t}\r\n}\r\n\r\nexport function illegalState(name?: string): Error {\r\n\tif (name) {\r\n\t\treturn new Error(`Illegal state: ${name}`);\r\n\t} else {\r\n\t\treturn new Error('Illegal state');\r\n\t}\r\n}\r\n\r\nexport class NotSupportedError extends Error {\r\n\tconstructor(message?: string) {\r\n\t\tsuper('NotSupported');\r\n\t\tif (message) {\r\n\t\t\tthis.message = message;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * Error that when thrown won't be logged in telemetry as an unhandled error.\r\n */\r\nexport class ErrorNoTelemetry extends Error {\r\n\toverride readonly name: string;\r\n\r\n\tconstructor(msg?: string) {\r\n\t\tsuper(msg);\r\n\t\tthis.name = 'CodeExpectedError';\r\n\t}\r\n\r\n\tpublic static fromError(err: Error): ErrorNoTelemetry {\r\n\t\tif (err instanceof ErrorNoTelemetry) {\r\n\t\t\treturn err;\r\n\t\t}\r\n\r\n\t\tconst result = new ErrorNoTelemetry();\r\n\t\tresult.message = err.message;\r\n\t\tresult.stack = err.stack;\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static isErrorNoTelemetry(err: Error): err is ErrorNoTelemetry {\r\n\t\treturn err.name === 'CodeExpectedError';\r\n\t}\r\n}\r\n\r\n/**\r\n * This error indicates a bug.\r\n * Do not throw this for invalid user input.\r\n * Only catch this error to recover gracefully from bugs.\r\n */\r\nexport class BugIndicatingError extends Error {\r\n\tconstructor(message?: string) {\r\n\t\tsuper(message || 'An unexpected bug occurred.');\r\n\t\tObject.setPrototypeOf(this, BugIndicatingError.prototype);\r\n\r\n\t\t// Because we know for sure only buggy code throws this,\r\n\t\t// we definitely want to break here and fix the bug.\r\n\t\t// eslint-disable-next-line no-debugger\r\n\t\t// debugger;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { BugIndicatingError, onUnexpectedError } from 'vs/base/common/errors';\r\n\r\n/**\r\n * Throws an error with the provided message if the provided value does not evaluate to a true Javascript value.\r\n *\r\n * @deprecated Use `assert(...)` instead.\r\n * This method is usually used like this:\r\n * ```ts\r\n * import * as assert from 'vs/base/common/assert';\r\n * assert.ok(...);\r\n * ```\r\n *\r\n * However, `assert` in that example is a user chosen name.\r\n * There is no tooling for generating such an import statement.\r\n * Thus, the `assert(...)` function should be used instead.\r\n */\r\nexport function ok(value?: unknown, message?: string) {\r\n\tif (!value) {\r\n\t\tthrow new Error(message ? `Assertion failed (${message})` : 'Assertion Failed');\r\n\t}\r\n}\r\n\r\nexport function assertNever(value: never, message = 'Unreachable'): never {\r\n\tthrow new Error(message);\r\n}\r\n\r\n/**\r\n * condition must be side-effect free!\r\n */\r\nexport function assertFn(condition: () => boolean): void {\r\n\tif (!condition()) {\r\n\t\t// eslint-disable-next-line no-debugger\r\n\t\tdebugger;\r\n\t\t// Reevaluate `condition` again to make debugging easier\r\n\t\tcondition();\r\n\t\tonUnexpectedError(new BugIndicatingError('Assertion Failed'));\r\n\t}\r\n}\r\n\r\nexport function checkAdjacentItems<T>(items: readonly T[], predicate: (item1: T, item2: T) => boolean): boolean {\r\n\tlet i = 0;\r\n\twhile (i < items.length - 1) {\r\n\t\tconst a = items[i];\r\n\t\tconst b = items[i + 1];\r\n\t\tif (!predicate(a, b)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\ti++;\r\n\t}\r\n\treturn true;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nexport function once<T extends Function>(this: unknown, fn: T): T {\r\n\tconst _this = this;\r\n\tlet didCall = false;\r\n\tlet result: unknown;\r\n\r\n\treturn function () {\r\n\t\tif (didCall) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tdidCall = true;\r\n\t\tresult = fn.apply(_this, arguments);\r\n\r\n\t\treturn result;\r\n\t} as unknown as T;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nexport namespace Iterable {\r\n\r\n\texport function is<T = any>(thing: any): thing is Iterable<T> {\r\n\t\treturn thing && typeof thing === 'object' && typeof thing[Symbol.iterator] === 'function';\r\n\t}\r\n\r\n\tconst _empty: Iterable<any> = Object.freeze([]);\r\n\texport function empty<T = any>(): Iterable<T> {\r\n\t\treturn _empty;\r\n\t}\r\n\r\n\texport function* single<T>(element: T): Iterable<T> {\r\n\t\tyield element;\r\n\t}\r\n\r\n\texport function wrap<T>(iterableOrElement: Iterable<T> | T): Iterable<T> {\r\n\t\tif (is(iterableOrElement)) {\r\n\t\t\treturn iterableOrElement;\r\n\t\t} else {\r\n\t\t\treturn single(iterableOrElement);\r\n\t\t}\r\n\t}\r\n\r\n\texport function from<T>(iterable: Iterable<T> | undefined | null): Iterable<T> {\r\n\t\treturn iterable || _empty;\r\n\t}\r\n\r\n\texport function isEmpty<T>(iterable: Iterable<T> | undefined | null): boolean {\r\n\t\treturn !iterable || iterable[Symbol.iterator]().next().done === true;\r\n\t}\r\n\r\n\texport function first<T>(iterable: Iterable<T>): T | undefined {\r\n\t\treturn iterable[Symbol.iterator]().next().value;\r\n\t}\r\n\r\n\texport function some<T>(iterable: Iterable<T>, predicate: (t: T) => unknown): boolean {\r\n\t\tfor (const element of iterable) {\r\n\t\t\tif (predicate(element)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\texport function find<T, R extends T>(iterable: Iterable<T>, predicate: (t: T) => t is R): R | undefined;\r\n\texport function find<T>(iterable: Iterable<T>, predicate: (t: T) => boolean): T | undefined;\r\n\texport function find<T>(iterable: Iterable<T>, predicate: (t: T) => boolean): T | undefined {\r\n\t\tfor (const element of iterable) {\r\n\t\t\tif (predicate(element)) {\r\n\t\t\t\treturn element;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\texport function filter<T, R extends T>(iterable: Iterable<T>, predicate: (t: T) => t is R): Iterable<R>;\r\n\texport function filter<T>(iterable: Iterable<T>, predicate: (t: T) => boolean): Iterable<T>;\r\n\texport function* filter<T>(iterable: Iterable<T>, predicate: (t: T) => boolean): Iterable<T> {\r\n\t\tfor (const element of iterable) {\r\n\t\t\tif (predicate(element)) {\r\n\t\t\t\tyield element;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport function* map<T, R>(iterable: Iterable<T>, fn: (t: T, index: number) => R): Iterable<R> {\r\n\t\tlet index = 0;\r\n\t\tfor (const element of iterable) {\r\n\t\t\tyield fn(element, index++);\r\n\t\t}\r\n\t}\r\n\r\n\texport function* concat<T>(...iterables: Iterable<T>[]): Iterable<T> {\r\n\t\tfor (const iterable of iterables) {\r\n\t\t\tfor (const element of iterable) {\r\n\t\t\t\tyield element;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\texport function reduce<T, R>(iterable: Iterable<T>, reducer: (previousValue: R, currentValue: T) => R, initialValue: R): R {\r\n\t\tlet value = initialValue;\r\n\t\tfor (const element of iterable) {\r\n\t\t\tvalue = reducer(value, element);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an iterable slice of the array, with the same semantics as `array.slice()`.\r\n\t */\r\n\texport function* slice<T>(arr: ReadonlyArray<T>, from: number, to = arr.length): Iterable<T> {\r\n\t\tif (from < 0) {\r\n\t\t\tfrom += arr.length;\r\n\t\t}\r\n\r\n\t\tif (to < 0) {\r\n\t\t\tto += arr.length;\r\n\t\t} else if (to > arr.length) {\r\n\t\t\tto = arr.length;\r\n\t\t}\r\n\r\n\t\tfor (; from < to; from++) {\r\n\t\t\tyield arr[from];\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Consumes `atMost` elements from iterable and returns the consumed elements,\r\n\t * and an iterable for the rest of the elements.\r\n\t */\r\n\texport function consume<T>(iterable: Iterable<T>, atMost: number = Number.POSITIVE_INFINITY): [T[], Iterable<T>] {\r\n\t\tconst consumed: T[] = [];\r\n\r\n\t\tif (atMost === 0) {\r\n\t\t\treturn [consumed, iterable];\r\n\t\t}\r\n\r\n\t\tconst iterator = iterable[Symbol.iterator]();\r\n\r\n\t\tfor (let i = 0; i < atMost; i++) {\r\n\t\t\tconst next = iterator.next();\r\n\r\n\t\t\tif (next.done) {\r\n\t\t\t\treturn [consumed, Iterable.empty()];\r\n\t\t\t}\r\n\r\n\t\t\tconsumed.push(next.value);\r\n\t\t}\r\n\r\n\t\treturn [consumed, { [Symbol.iterator]() { return iterator; } }];\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/**\r\n * Virtual Key Codes, the value does not hold any inherent meaning.\r\n * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\r\n * But these are \"more general\", as they should work across browsers & OS`s.\r\n */\r\nexport const enum KeyCode {\r\n\tDependsOnKbLayout = -1,\r\n\r\n\t/**\r\n\t * Placed first to cover the 0 value of the enum.\r\n\t */\r\n\tUnknown = 0,\r\n\r\n\tBackspace,\r\n\tTab,\r\n\tEnter,\r\n\tShift,\r\n\tCtrl,\r\n\tAlt,\r\n\tPauseBreak,\r\n\tCapsLock,\r\n\tEscape,\r\n\tSpace,\r\n\tPageUp,\r\n\tPageDown,\r\n\tEnd,\r\n\tHome,\r\n\tLeftArrow,\r\n\tUpArrow,\r\n\tRightArrow,\r\n\tDownArrow,\r\n\tInsert,\r\n\tDelete,\r\n\r\n\tDigit0,\r\n\tDigit1,\r\n\tDigit2,\r\n\tDigit3,\r\n\tDigit4,\r\n\tDigit5,\r\n\tDigit6,\r\n\tDigit7,\r\n\tDigit8,\r\n\tDigit9,\r\n\r\n\tKeyA,\r\n\tKeyB,\r\n\tKeyC,\r\n\tKeyD,\r\n\tKeyE,\r\n\tKeyF,\r\n\tKeyG,\r\n\tKeyH,\r\n\tKeyI,\r\n\tKeyJ,\r\n\tKeyK,\r\n\tKeyL,\r\n\tKeyM,\r\n\tKeyN,\r\n\tKeyO,\r\n\tKeyP,\r\n\tKeyQ,\r\n\tKeyR,\r\n\tKeyS,\r\n\tKeyT,\r\n\tKeyU,\r\n\tKeyV,\r\n\tKeyW,\r\n\tKeyX,\r\n\tKeyY,\r\n\tKeyZ,\r\n\r\n\tMeta,\r\n\tContextMenu,\r\n\r\n\tF1,\r\n\tF2,\r\n\tF3,\r\n\tF4,\r\n\tF5,\r\n\tF6,\r\n\tF7,\r\n\tF8,\r\n\tF9,\r\n\tF10,\r\n\tF11,\r\n\tF12,\r\n\tF13,\r\n\tF14,\r\n\tF15,\r\n\tF16,\r\n\tF17,\r\n\tF18,\r\n\tF19,\r\n\tF20,\r\n\tF21,\r\n\tF22,\r\n\tF23,\r\n\tF24,\r\n\r\n\tNumLock,\r\n\tScrollLock,\r\n\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the ';:' key\r\n\t */\r\n\tSemicolon,\r\n\t/**\r\n\t * For any country/region, the '+' key\r\n\t * For the US standard keyboard, the '=+' key\r\n\t */\r\n\tEqual,\r\n\t/**\r\n\t * For any country/region, the ',' key\r\n\t * For the US standard keyboard, the ',<' key\r\n\t */\r\n\tComma,\r\n\t/**\r\n\t * For any country/region, the '-' key\r\n\t * For the US standard keyboard, the '-_' key\r\n\t */\r\n\tMinus,\r\n\t/**\r\n\t * For any country/region, the '.' key\r\n\t * For the US standard keyboard, the '.>' key\r\n\t */\r\n\tPeriod,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the '/?' key\r\n\t */\r\n\tSlash,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the '`~' key\r\n\t */\r\n\tBackquote,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the '[{' key\r\n\t */\r\n\tBracketLeft,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the '\\|' key\r\n\t */\r\n\tBackslash,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the ']}' key\r\n\t */\r\n\tBracketRight,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t * For the US standard keyboard, the ''\"' key\r\n\t */\r\n\tQuote,\r\n\t/**\r\n\t * Used for miscellaneous characters; it can vary by keyboard.\r\n\t */\r\n\tOEM_8,\r\n\t/**\r\n\t * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\r\n\t */\r\n\tIntlBackslash,\r\n\r\n\tNumpad0, // VK_NUMPAD0, 0x60, Numeric keypad 0 key\r\n\tNumpad1, // VK_NUMPAD1, 0x61, Numeric keypad 1 key\r\n\tNumpad2, // VK_NUMPAD2, 0x62, Numeric keypad 2 key\r\n\tNumpad3, // VK_NUMPAD3, 0x63, Numeric keypad 3 key\r\n\tNumpad4, // VK_NUMPAD4, 0x64, Numeric keypad 4 key\r\n\tNumpad5, // VK_NUMPAD5, 0x65, Numeric keypad 5 key\r\n\tNumpad6, // VK_NUMPAD6, 0x66, Numeric keypad 6 key\r\n\tNumpad7, // VK_NUMPAD7, 0x67, Numeric keypad 7 key\r\n\tNumpad8, // VK_NUMPAD8, 0x68, Numeric keypad 8 key\r\n\tNumpad9, // VK_NUMPAD9, 0x69, Numeric keypad 9 key\r\n\r\n\tNumpadMultiply,\t// VK_MULTIPLY, 0x6A, Multiply key\r\n\tNumpadAdd,\t\t// VK_ADD, 0x6B, Add key\r\n\tNUMPAD_SEPARATOR,\t// VK_SEPARATOR, 0x6C, Separator key\r\n\tNumpadSubtract,\t// VK_SUBTRACT, 0x6D, Subtract key\r\n\tNumpadDecimal,\t// VK_DECIMAL, 0x6E, Decimal key\r\n\tNumpadDivide,\t// VK_DIVIDE, 0x6F,\r\n\r\n\t/**\r\n\t * Cover all key codes when IME is processing input.\r\n\t */\r\n\tKEY_IN_COMPOSITION,\r\n\r\n\tABNT_C1, // Brazilian (ABNT) Keyboard\r\n\tABNT_C2, // Brazilian (ABNT) Keyboard\r\n\r\n\tAudioVolumeMute,\r\n\tAudioVolumeUp,\r\n\tAudioVolumeDown,\r\n\r\n\tBrowserSearch,\r\n\tBrowserHome,\r\n\tBrowserBack,\r\n\tBrowserForward,\r\n\r\n\tMediaTrackNext,\r\n\tMediaTrackPrevious,\r\n\tMediaStop,\r\n\tMediaPlayPause,\r\n\tLaunchMediaPlayer,\r\n\tLaunchMail,\r\n\tLaunchApp2,\r\n\r\n\t/**\r\n\t * VK_CLEAR, 0x0C, CLEAR key\r\n\t */\r\n\tClear,\r\n\r\n\t/**\r\n\t * Placed last to cover the length of the enum.\r\n\t * Please do not depend on this value!\r\n\t */\r\n\tMAX_VALUE\r\n}\r\n\r\n/**\r\n * keyboardEvent.code\r\n */\r\nexport const enum ScanCode {\r\n\tDependsOnKbLayout = -1,\r\n\tNone,\r\n\tHyper,\r\n\tSuper,\r\n\tFn,\r\n\tFnLock,\r\n\tSuspend,\r\n\tResume,\r\n\tTurbo,\r\n\tSleep,\r\n\tWakeUp,\r\n\tKeyA,\r\n\tKeyB,\r\n\tKeyC,\r\n\tKeyD,\r\n\tKeyE,\r\n\tKeyF,\r\n\tKeyG,\r\n\tKeyH,\r\n\tKeyI,\r\n\tKeyJ,\r\n\tKeyK,\r\n\tKeyL,\r\n\tKeyM,\r\n\tKeyN,\r\n\tKeyO,\r\n\tKeyP,\r\n\tKeyQ,\r\n\tKeyR,\r\n\tKeyS,\r\n\tKeyT,\r\n\tKeyU,\r\n\tKeyV,\r\n\tKeyW,\r\n\tKeyX,\r\n\tKeyY,\r\n\tKeyZ,\r\n\tDigit1,\r\n\tDigit2,\r\n\tDigit3,\r\n\tDigit4,\r\n\tDigit5,\r\n\tDigit6,\r\n\tDigit7,\r\n\tDigit8,\r\n\tDigit9,\r\n\tDigit0,\r\n\tEnter,\r\n\tEscape,\r\n\tBackspace,\r\n\tTab,\r\n\tSpace,\r\n\tMinus,\r\n\tEqual,\r\n\tBracketLeft,\r\n\tBracketRight,\r\n\tBackslash,\r\n\tIntlHash,\r\n\tSemicolon,\r\n\tQuote,\r\n\tBackquote,\r\n\tComma,\r\n\tPeriod,\r\n\tSlash,\r\n\tCapsLock,\r\n\tF1,\r\n\tF2,\r\n\tF3,\r\n\tF4,\r\n\tF5,\r\n\tF6,\r\n\tF7,\r\n\tF8,\r\n\tF9,\r\n\tF10,\r\n\tF11,\r\n\tF12,\r\n\tPrintScreen,\r\n\tScrollLock,\r\n\tPause,\r\n\tInsert,\r\n\tHome,\r\n\tPageUp,\r\n\tDelete,\r\n\tEnd,\r\n\tPageDown,\r\n\tArrowRight,\r\n\tArrowLeft,\r\n\tArrowDown,\r\n\tArrowUp,\r\n\tNumLock,\r\n\tNumpadDivide,\r\n\tNumpadMultiply,\r\n\tNumpadSubtract,\r\n\tNumpadAdd,\r\n\tNumpadEnter,\r\n\tNumpad1,\r\n\tNumpad2,\r\n\tNumpad3,\r\n\tNumpad4,\r\n\tNumpad5,\r\n\tNumpad6,\r\n\tNumpad7,\r\n\tNumpad8,\r\n\tNumpad9,\r\n\tNumpad0,\r\n\tNumpadDecimal,\r\n\tIntlBackslash,\r\n\tContextMenu,\r\n\tPower,\r\n\tNumpadEqual,\r\n\tF13,\r\n\tF14,\r\n\tF15,\r\n\tF16,\r\n\tF17,\r\n\tF18,\r\n\tF19,\r\n\tF20,\r\n\tF21,\r\n\tF22,\r\n\tF23,\r\n\tF24,\r\n\tOpen,\r\n\tHelp,\r\n\tSelect,\r\n\tAgain,\r\n\tUndo,\r\n\tCut,\r\n\tCopy,\r\n\tPaste,\r\n\tFind,\r\n\tAudioVolumeMute,\r\n\tAudioVolumeUp,\r\n\tAudioVolumeDown,\r\n\tNumpadComma,\r\n\tIntlRo,\r\n\tKanaMode,\r\n\tIntlYen,\r\n\tConvert,\r\n\tNonConvert,\r\n\tLang1,\r\n\tLang2,\r\n\tLang3,\r\n\tLang4,\r\n\tLang5,\r\n\tAbort,\r\n\tProps,\r\n\tNumpadParenLeft,\r\n\tNumpadParenRight,\r\n\tNumpadBackspace,\r\n\tNumpadMemoryStore,\r\n\tNumpadMemoryRecall,\r\n\tNumpadMemoryClear,\r\n\tNumpadMemoryAdd,\r\n\tNumpadMemorySubtract,\r\n\tNumpadClear,\r\n\tNumpadClearEntry,\r\n\tControlLeft,\r\n\tShiftLeft,\r\n\tAltLeft,\r\n\tMetaLeft,\r\n\tControlRight,\r\n\tShiftRight,\r\n\tAltRight,\r\n\tMetaRight,\r\n\tBrightnessUp,\r\n\tBrightnessDown,\r\n\tMediaPlay,\r\n\tMediaRecord,\r\n\tMediaFastForward,\r\n\tMediaRewind,\r\n\tMediaTrackNext,\r\n\tMediaTrackPrevious,\r\n\tMediaStop,\r\n\tEject,\r\n\tMediaPlayPause,\r\n\tMediaSelect,\r\n\tLaunchMail,\r\n\tLaunchApp2,\r\n\tLaunchApp1,\r\n\tSelectTask,\r\n\tLaunchScreenSaver,\r\n\tBrowserSearch,\r\n\tBrowserHome,\r\n\tBrowserBack,\r\n\tBrowserForward,\r\n\tBrowserStop,\r\n\tBrowserRefresh,\r\n\tBrowserFavorites,\r\n\tZoomToggle,\r\n\tMailReply,\r\n\tMailForward,\r\n\tMailSend,\r\n\r\n\tMAX_VALUE\r\n}\r\n\r\nclass KeyCodeStrMap {\r\n\r\n\tpublic _keyCodeToStr: string[];\r\n\tpublic _strToKeyCode: { [str: string]: KeyCode };\r\n\r\n\tconstructor() {\r\n\t\tthis._keyCodeToStr = [];\r\n\t\tthis._strToKeyCode = Object.create(null);\r\n\t}\r\n\r\n\tdefine(keyCode: KeyCode, str: string): void {\r\n\t\tthis._keyCodeToStr[keyCode] = str;\r\n\t\tthis._strToKeyCode[str.toLowerCase()] = keyCode;\r\n\t}\r\n\r\n\tkeyCodeToStr(keyCode: KeyCode): string {\r\n\t\treturn this._keyCodeToStr[keyCode];\r\n\t}\r\n\r\n\tstrToKeyCode(str: string): KeyCode {\r\n\t\treturn this._strToKeyCode[str.toLowerCase()] || KeyCode.Unknown;\r\n\t}\r\n}\r\n\r\nconst uiMap = new KeyCodeStrMap();\r\nconst userSettingsUSMap = new KeyCodeStrMap();\r\nconst userSettingsGeneralMap = new KeyCodeStrMap();\r\nexport const EVENT_KEY_CODE_MAP: { [keyCode: number]: KeyCode } = new Array(230);\r\nexport const NATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE: { [nativeKeyCode: string]: KeyCode } = {};\r\nconst scanCodeIntToStr: string[] = [];\r\nconst scanCodeStrToInt: { [code: string]: number } = Object.create(null);\r\nconst scanCodeLowerCaseStrToInt: { [code: string]: number } = Object.create(null);\r\n\r\n/**\r\n * -1 if a ScanCode => KeyCode mapping depends on kb layout.\r\n */\r\nexport const IMMUTABLE_CODE_TO_KEY_CODE: KeyCode[] = [];\r\n\r\n/**\r\n * -1 if a KeyCode => ScanCode mapping depends on kb layout.\r\n */\r\nexport const IMMUTABLE_KEY_CODE_TO_CODE: ScanCode[] = [];\r\n\r\nfor (let i = 0; i <= ScanCode.MAX_VALUE; i++) {\r\n\tIMMUTABLE_CODE_TO_KEY_CODE[i] = KeyCode.DependsOnKbLayout;\r\n}\r\n\r\nfor (let i = 0; i <= KeyCode.MAX_VALUE; i++) {\r\n\tIMMUTABLE_KEY_CODE_TO_CODE[i] = ScanCode.DependsOnKbLayout;\r\n}\r\n\r\n(function () {\r\n\r\n\t// See https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\r\n\t// See https://github.com/microsoft/node-native-keymap/blob/88c0b0e5/deps/chromium/keyboard_codes_win.h\r\n\r\n\tconst empty = '';\r\n\ttype IMappingEntry = [0 | 1, ScanCode, string, KeyCode, string, number, string, string, string];\r\n\tconst mappings: IMappingEntry[] = [\r\n\t\t// immutable, scanCode, scanCodeStr, keyCode, keyCodeStr, eventKeyCode, vkey, usUserSettingsLabel, generalUserSettingsLabel\r\n\t\t[1, ScanCode.None, 'None', KeyCode.Unknown, 'unknown', 0, 'VK_UNKNOWN', empty, empty],\r\n\t\t[1, ScanCode.Hyper, 'Hyper', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Super, 'Super', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Fn, 'Fn', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.FnLock, 'FnLock', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Suspend, 'Suspend', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Resume, 'Resume', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Turbo, 'Turbo', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Sleep, 'Sleep', KeyCode.Unknown, empty, 0, 'VK_SLEEP', empty, empty],\r\n\t\t[1, ScanCode.WakeUp, 'WakeUp', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[0, ScanCode.KeyA, 'KeyA', KeyCode.KeyA, 'A', 65, 'VK_A', empty, empty],\r\n\t\t[0, ScanCode.KeyB, 'KeyB', KeyCode.KeyB, 'B', 66, 'VK_B', empty, empty],\r\n\t\t[0, ScanCode.KeyC, 'KeyC', KeyCode.KeyC, 'C', 67, 'VK_C', empty, empty],\r\n\t\t[0, ScanCode.KeyD, 'KeyD', KeyCode.KeyD, 'D', 68, 'VK_D', empty, empty],\r\n\t\t[0, ScanCode.KeyE, 'KeyE', KeyCode.KeyE, 'E', 69, 'VK_E', empty, empty],\r\n\t\t[0, ScanCode.KeyF, 'KeyF', KeyCode.KeyF, 'F', 70, 'VK_F', empty, empty],\r\n\t\t[0, ScanCode.KeyG, 'KeyG', KeyCode.KeyG, 'G', 71, 'VK_G', empty, empty],\r\n\t\t[0, ScanCode.KeyH, 'KeyH', KeyCode.KeyH, 'H', 72, 'VK_H', empty, empty],\r\n\t\t[0, ScanCode.KeyI, 'KeyI', KeyCode.KeyI, 'I', 73, 'VK_I', empty, empty],\r\n\t\t[0, ScanCode.KeyJ, 'KeyJ', KeyCode.KeyJ, 'J', 74, 'VK_J', empty, empty],\r\n\t\t[0, ScanCode.KeyK, 'KeyK', KeyCode.KeyK, 'K', 75, 'VK_K', empty, empty],\r\n\t\t[0, ScanCode.KeyL, 'KeyL', KeyCode.KeyL, 'L', 76, 'VK_L', empty, empty],\r\n\t\t[0, ScanCode.KeyM, 'KeyM', KeyCode.KeyM, 'M', 77, 'VK_M', empty, empty],\r\n\t\t[0, ScanCode.KeyN, 'KeyN', KeyCode.KeyN, 'N', 78, 'VK_N', empty, empty],\r\n\t\t[0, ScanCode.KeyO, 'KeyO', KeyCode.KeyO, 'O', 79, 'VK_O', empty, empty],\r\n\t\t[0, ScanCode.KeyP, 'KeyP', KeyCode.KeyP, 'P', 80, 'VK_P', empty, empty],\r\n\t\t[0, ScanCode.KeyQ, 'KeyQ', KeyCode.KeyQ, 'Q', 81, 'VK_Q', empty, empty],\r\n\t\t[0, ScanCode.KeyR, 'KeyR', KeyCode.KeyR, 'R', 82, 'VK_R', empty, empty],\r\n\t\t[0, ScanCode.KeyS, 'KeyS', KeyCode.KeyS, 'S', 83, 'VK_S', empty, empty],\r\n\t\t[0, ScanCode.KeyT, 'KeyT', KeyCode.KeyT, 'T', 84, 'VK_T', empty, empty],\r\n\t\t[0, ScanCode.KeyU, 'KeyU', KeyCode.KeyU, 'U', 85, 'VK_U', empty, empty],\r\n\t\t[0, ScanCode.KeyV, 'KeyV', KeyCode.KeyV, 'V', 86, 'VK_V', empty, empty],\r\n\t\t[0, ScanCode.KeyW, 'KeyW', KeyCode.KeyW, 'W', 87, 'VK_W', empty, empty],\r\n\t\t[0, ScanCode.KeyX, 'KeyX', KeyCode.KeyX, 'X', 88, 'VK_X', empty, empty],\r\n\t\t[0, ScanCode.KeyY, 'KeyY', KeyCode.KeyY, 'Y', 89, 'VK_Y', empty, empty],\r\n\t\t[0, ScanCode.KeyZ, 'KeyZ', KeyCode.KeyZ, 'Z', 90, 'VK_Z', empty, empty],\r\n\t\t[0, ScanCode.Digit1, 'Digit1', KeyCode.Digit1, '1', 49, 'VK_1', empty, empty],\r\n\t\t[0, ScanCode.Digit2, 'Digit2', KeyCode.Digit2, '2', 50, 'VK_2', empty, empty],\r\n\t\t[0, ScanCode.Digit3, 'Digit3', KeyCode.Digit3, '3', 51, 'VK_3', empty, empty],\r\n\t\t[0, ScanCode.Digit4, 'Digit4', KeyCode.Digit4, '4', 52, 'VK_4', empty, empty],\r\n\t\t[0, ScanCode.Digit5, 'Digit5', KeyCode.Digit5, '5', 53, 'VK_5', empty, empty],\r\n\t\t[0, ScanCode.Digit6, 'Digit6', KeyCode.Digit6, '6', 54, 'VK_6', empty, empty],\r\n\t\t[0, ScanCode.Digit7, 'Digit7', KeyCode.Digit7, '7', 55, 'VK_7', empty, empty],\r\n\t\t[0, ScanCode.Digit8, 'Digit8', KeyCode.Digit8, '8', 56, 'VK_8', empty, empty],\r\n\t\t[0, ScanCode.Digit9, 'Digit9', KeyCode.Digit9, '9', 57, 'VK_9', empty, empty],\r\n\t\t[0, ScanCode.Digit0, 'Digit0', KeyCode.Digit0, '0', 48, 'VK_0', empty, empty],\r\n\t\t[1, ScanCode.Enter, 'Enter', KeyCode.Enter, 'Enter', 13, 'VK_RETURN', empty, empty],\r\n\t\t[1, ScanCode.Escape, 'Escape', KeyCode.Escape, 'Escape', 27, 'VK_ESCAPE', empty, empty],\r\n\t\t[1, ScanCode.Backspace, 'Backspace', KeyCode.Backspace, 'Backspace', 8, 'VK_BACK', empty, empty],\r\n\t\t[1, ScanCode.Tab, 'Tab', KeyCode.Tab, 'Tab', 9, 'VK_TAB', empty, empty],\r\n\t\t[1, ScanCode.Space, 'Space', KeyCode.Space, 'Space', 32, 'VK_SPACE', empty, empty],\r\n\t\t[0, ScanCode.Minus, 'Minus', KeyCode.Minus, '-', 189, 'VK_OEM_MINUS', '-', 'OEM_MINUS'],\r\n\t\t[0, ScanCode.Equal, 'Equal', KeyCode.Equal, '=', 187, 'VK_OEM_PLUS', '=', 'OEM_PLUS'],\r\n\t\t[0, ScanCode.BracketLeft, 'BracketLeft', KeyCode.BracketLeft, '[', 219, 'VK_OEM_4', '[', 'OEM_4'],\r\n\t\t[0, ScanCode.BracketRight, 'BracketRight', KeyCode.BracketRight, ']', 221, 'VK_OEM_6', ']', 'OEM_6'],\r\n\t\t[0, ScanCode.Backslash, 'Backslash', KeyCode.Backslash, '\\\\', 220, 'VK_OEM_5', '\\\\', 'OEM_5'],\r\n\t\t[0, ScanCode.IntlHash, 'IntlHash', KeyCode.Unknown, empty, 0, empty, empty, empty], // has been dropped from the w3c spec\r\n\t\t[0, ScanCode.Semicolon, 'Semicolon', KeyCode.Semicolon, ';', 186, 'VK_OEM_1', ';', 'OEM_1'],\r\n\t\t[0, ScanCode.Quote, 'Quote', KeyCode.Quote, '\\'', 222, 'VK_OEM_7', '\\'', 'OEM_7'],\r\n\t\t[0, ScanCode.Backquote, 'Backquote', KeyCode.Backquote, '`', 192, 'VK_OEM_3', '`', 'OEM_3'],\r\n\t\t[0, ScanCode.Comma, 'Comma', KeyCode.Comma, ',', 188, 'VK_OEM_COMMA', ',', 'OEM_COMMA'],\r\n\t\t[0, ScanCode.Period, 'Period', KeyCode.Period, '.', 190, 'VK_OEM_PERIOD', '.', 'OEM_PERIOD'],\r\n\t\t[0, ScanCode.Slash, 'Slash', KeyCode.Slash, '/', 191, 'VK_OEM_2', '/', 'OEM_2'],\r\n\t\t[1, ScanCode.CapsLock, 'CapsLock', KeyCode.CapsLock, 'CapsLock', 20, 'VK_CAPITAL', empty, empty],\r\n\t\t[1, ScanCode.F1, 'F1', KeyCode.F1, 'F1', 112, 'VK_F1', empty, empty],\r\n\t\t[1, ScanCode.F2, 'F2', KeyCode.F2, 'F2', 113, 'VK_F2', empty, empty],\r\n\t\t[1, ScanCode.F3, 'F3', KeyCode.F3, 'F3', 114, 'VK_F3', empty, empty],\r\n\t\t[1, ScanCode.F4, 'F4', KeyCode.F4, 'F4', 115, 'VK_F4', empty, empty],\r\n\t\t[1, ScanCode.F5, 'F5', KeyCode.F5, 'F5', 116, 'VK_F5', empty, empty],\r\n\t\t[1, ScanCode.F6, 'F6', KeyCode.F6, 'F6', 117, 'VK_F6', empty, empty],\r\n\t\t[1, ScanCode.F7, 'F7', KeyCode.F7, 'F7', 118, 'VK_F7', empty, empty],\r\n\t\t[1, ScanCode.F8, 'F8', KeyCode.F8, 'F8', 119, 'VK_F8', empty, empty],\r\n\t\t[1, ScanCode.F9, 'F9', KeyCode.F9, 'F9', 120, 'VK_F9', empty, empty],\r\n\t\t[1, ScanCode.F10, 'F10', KeyCode.F10, 'F10', 121, 'VK_F10', empty, empty],\r\n\t\t[1, ScanCode.F11, 'F11', KeyCode.F11, 'F11', 122, 'VK_F11', empty, empty],\r\n\t\t[1, ScanCode.F12, 'F12', KeyCode.F12, 'F12', 123, 'VK_F12', empty, empty],\r\n\t\t[1, ScanCode.PrintScreen, 'PrintScreen', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.ScrollLock, 'ScrollLock', KeyCode.ScrollLock, 'ScrollLock', 145, 'VK_SCROLL', empty, empty],\r\n\t\t[1, ScanCode.Pause, 'Pause', KeyCode.PauseBreak, 'PauseBreak', 19, 'VK_PAUSE', empty, empty],\r\n\t\t[1, ScanCode.Insert, 'Insert', KeyCode.Insert, 'Insert', 45, 'VK_INSERT', empty, empty],\r\n\t\t[1, ScanCode.Home, 'Home', KeyCode.Home, 'Home', 36, 'VK_HOME', empty, empty],\r\n\t\t[1, ScanCode.PageUp, 'PageUp', KeyCode.PageUp, 'PageUp', 33, 'VK_PRIOR', empty, empty],\r\n\t\t[1, ScanCode.Delete, 'Delete', KeyCode.Delete, 'Delete', 46, 'VK_DELETE', empty, empty],\r\n\t\t[1, ScanCode.End, 'End', KeyCode.End, 'End', 35, 'VK_END', empty, empty],\r\n\t\t[1, ScanCode.PageDown, 'PageDown', KeyCode.PageDown, 'PageDown', 34, 'VK_NEXT', empty, empty],\r\n\t\t[1, ScanCode.ArrowRight, 'ArrowRight', KeyCode.RightArrow, 'RightArrow', 39, 'VK_RIGHT', 'Right', empty],\r\n\t\t[1, ScanCode.ArrowLeft, 'ArrowLeft', KeyCode.LeftArrow, 'LeftArrow', 37, 'VK_LEFT', 'Left', empty],\r\n\t\t[1, ScanCode.ArrowDown, 'ArrowDown', KeyCode.DownArrow, 'DownArrow', 40, 'VK_DOWN', 'Down', empty],\r\n\t\t[1, ScanCode.ArrowUp, 'ArrowUp', KeyCode.UpArrow, 'UpArrow', 38, 'VK_UP', 'Up', empty],\r\n\t\t[1, ScanCode.NumLock, 'NumLock', KeyCode.NumLock, 'NumLock', 144, 'VK_NUMLOCK', empty, empty],\r\n\t\t[1, ScanCode.NumpadDivide, 'NumpadDivide', KeyCode.NumpadDivide, 'NumPad_Divide', 111, 'VK_DIVIDE', empty, empty],\r\n\t\t[1, ScanCode.NumpadMultiply, 'NumpadMultiply', KeyCode.NumpadMultiply, 'NumPad_Multiply', 106, 'VK_MULTIPLY', empty, empty],\r\n\t\t[1, ScanCode.NumpadSubtract, 'NumpadSubtract', KeyCode.NumpadSubtract, 'NumPad_Subtract', 109, 'VK_SUBTRACT', empty, empty],\r\n\t\t[1, ScanCode.NumpadAdd, 'NumpadAdd', KeyCode.NumpadAdd, 'NumPad_Add', 107, 'VK_ADD', empty, empty],\r\n\t\t[1, ScanCode.NumpadEnter, 'NumpadEnter', KeyCode.Enter, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Numpad1, 'Numpad1', KeyCode.Numpad1, 'NumPad1', 97, 'VK_NUMPAD1', empty, empty],\r\n\t\t[1, ScanCode.Numpad2, 'Numpad2', KeyCode.Numpad2, 'NumPad2', 98, 'VK_NUMPAD2', empty, empty],\r\n\t\t[1, ScanCode.Numpad3, 'Numpad3', KeyCode.Numpad3, 'NumPad3', 99, 'VK_NUMPAD3', empty, empty],\r\n\t\t[1, ScanCode.Numpad4, 'Numpad4', KeyCode.Numpad4, 'NumPad4', 100, 'VK_NUMPAD4', empty, empty],\r\n\t\t[1, ScanCode.Numpad5, 'Numpad5', KeyCode.Numpad5, 'NumPad5', 101, 'VK_NUMPAD5', empty, empty],\r\n\t\t[1, ScanCode.Numpad6, 'Numpad6', KeyCode.Numpad6, 'NumPad6', 102, 'VK_NUMPAD6', empty, empty],\r\n\t\t[1, ScanCode.Numpad7, 'Numpad7', KeyCode.Numpad7, 'NumPad7', 103, 'VK_NUMPAD7', empty, empty],\r\n\t\t[1, ScanCode.Numpad8, 'Numpad8', KeyCode.Numpad8, 'NumPad8', 104, 'VK_NUMPAD8', empty, empty],\r\n\t\t[1, ScanCode.Numpad9, 'Numpad9', KeyCode.Numpad9, 'NumPad9', 105, 'VK_NUMPAD9', empty, empty],\r\n\t\t[1, ScanCode.Numpad0, 'Numpad0', KeyCode.Numpad0, 'NumPad0', 96, 'VK_NUMPAD0', empty, empty],\r\n\t\t[1, ScanCode.NumpadDecimal, 'NumpadDecimal', KeyCode.NumpadDecimal, 'NumPad_Decimal', 110, 'VK_DECIMAL', empty, empty],\r\n\t\t[0, ScanCode.IntlBackslash, 'IntlBackslash', KeyCode.IntlBackslash, 'OEM_102', 226, 'VK_OEM_102', empty, empty],\r\n\t\t[1, ScanCode.ContextMenu, 'ContextMenu', KeyCode.ContextMenu, 'ContextMenu', 93, empty, empty, empty],\r\n\t\t[1, ScanCode.Power, 'Power', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadEqual, 'NumpadEqual', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.F13, 'F13', KeyCode.F13, 'F13', 124, 'VK_F13', empty, empty],\r\n\t\t[1, ScanCode.F14, 'F14', KeyCode.F14, 'F14', 125, 'VK_F14', empty, empty],\r\n\t\t[1, ScanCode.F15, 'F15', KeyCode.F15, 'F15', 126, 'VK_F15', empty, empty],\r\n\t\t[1, ScanCode.F16, 'F16', KeyCode.F16, 'F16', 127, 'VK_F16', empty, empty],\r\n\t\t[1, ScanCode.F17, 'F17', KeyCode.F17, 'F17', 128, 'VK_F17', empty, empty],\r\n\t\t[1, ScanCode.F18, 'F18', KeyCode.F18, 'F18', 129, 'VK_F18', empty, empty],\r\n\t\t[1, ScanCode.F19, 'F19', KeyCode.F19, 'F19', 130, 'VK_F19', empty, empty],\r\n\t\t[1, ScanCode.F20, 'F20', KeyCode.F20, 'F20', 131, 'VK_F20', empty, empty],\r\n\t\t[1, ScanCode.F21, 'F21', KeyCode.F21, 'F21', 132, 'VK_F21', empty, empty],\r\n\t\t[1, ScanCode.F22, 'F22', KeyCode.F22, 'F22', 133, 'VK_F22', empty, empty],\r\n\t\t[1, ScanCode.F23, 'F23', KeyCode.F23, 'F23', 134, 'VK_F23', empty, empty],\r\n\t\t[1, ScanCode.F24, 'F24', KeyCode.F24, 'F24', 135, 'VK_F24', empty, empty],\r\n\t\t[1, ScanCode.Open, 'Open', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Help, 'Help', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Select, 'Select', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Again, 'Again', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Undo, 'Undo', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Cut, 'Cut', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Copy, 'Copy', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Paste, 'Paste', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Find, 'Find', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.AudioVolumeMute, 'AudioVolumeMute', KeyCode.AudioVolumeMute, 'AudioVolumeMute', 173, 'VK_VOLUME_MUTE', empty, empty],\r\n\t\t[1, ScanCode.AudioVolumeUp, 'AudioVolumeUp', KeyCode.AudioVolumeUp, 'AudioVolumeUp', 175, 'VK_VOLUME_UP', empty, empty],\r\n\t\t[1, ScanCode.AudioVolumeDown, 'AudioVolumeDown', KeyCode.AudioVolumeDown, 'AudioVolumeDown', 174, 'VK_VOLUME_DOWN', empty, empty],\r\n\t\t[1, ScanCode.NumpadComma, 'NumpadComma', KeyCode.NUMPAD_SEPARATOR, 'NumPad_Separator', 108, 'VK_SEPARATOR', empty, empty],\r\n\t\t[0, ScanCode.IntlRo, 'IntlRo', KeyCode.ABNT_C1, 'ABNT_C1', 193, 'VK_ABNT_C1', empty, empty],\r\n\t\t[1, ScanCode.KanaMode, 'KanaMode', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[0, ScanCode.IntlYen, 'IntlYen', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Convert, 'Convert', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NonConvert, 'NonConvert', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Lang1, 'Lang1', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Lang2, 'Lang2', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Lang3, 'Lang3', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Lang4, 'Lang4', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Lang5, 'Lang5', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Abort, 'Abort', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.Props, 'Props', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadParenLeft, 'NumpadParenLeft', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadParenRight, 'NumpadParenRight', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadBackspace, 'NumpadBackspace', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadMemoryStore, 'NumpadMemoryStore', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadMemoryRecall, 'NumpadMemoryRecall', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadMemoryClear, 'NumpadMemoryClear', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadMemoryAdd, 'NumpadMemoryAdd', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadMemorySubtract, 'NumpadMemorySubtract', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.NumpadClear, 'NumpadClear', KeyCode.Clear, 'Clear', 12, 'VK_CLEAR', empty, empty],\r\n\t\t[1, ScanCode.NumpadClearEntry, 'NumpadClearEntry', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Ctrl, 'Ctrl', 17, 'VK_CONTROL', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Shift, 'Shift', 16, 'VK_SHIFT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Alt, 'Alt', 18, 'VK_MENU', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Meta, 'Meta', 91, 'VK_COMMAND', empty, empty],\r\n\t\t[1, ScanCode.ControlLeft, 'ControlLeft', KeyCode.Ctrl, empty, 0, 'VK_LCONTROL', empty, empty],\r\n\t\t[1, ScanCode.ShiftLeft, 'ShiftLeft', KeyCode.Shift, empty, 0, 'VK_LSHIFT', empty, empty],\r\n\t\t[1, ScanCode.AltLeft, 'AltLeft', KeyCode.Alt, empty, 0, 'VK_LMENU', empty, empty],\r\n\t\t[1, ScanCode.MetaLeft, 'MetaLeft', KeyCode.Meta, empty, 0, 'VK_LWIN', empty, empty],\r\n\t\t[1, ScanCode.ControlRight, 'ControlRight', KeyCode.Ctrl, empty, 0, 'VK_RCONTROL', empty, empty],\r\n\t\t[1, ScanCode.ShiftRight, 'ShiftRight', KeyCode.Shift, empty, 0, 'VK_RSHIFT', empty, empty],\r\n\t\t[1, ScanCode.AltRight, 'AltRight', KeyCode.Alt, empty, 0, 'VK_RMENU', empty, empty],\r\n\t\t[1, ScanCode.MetaRight, 'MetaRight', KeyCode.Meta, empty, 0, 'VK_RWIN', empty, empty],\r\n\t\t[1, ScanCode.BrightnessUp, 'BrightnessUp', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.BrightnessDown, 'BrightnessDown', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaPlay, 'MediaPlay', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaRecord, 'MediaRecord', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaFastForward, 'MediaFastForward', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaRewind, 'MediaRewind', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaTrackNext, 'MediaTrackNext', KeyCode.MediaTrackNext, 'MediaTrackNext', 176, 'VK_MEDIA_NEXT_TRACK', empty, empty],\r\n\t\t[1, ScanCode.MediaTrackPrevious, 'MediaTrackPrevious', KeyCode.MediaTrackPrevious, 'MediaTrackPrevious', 177, 'VK_MEDIA_PREV_TRACK', empty, empty],\r\n\t\t[1, ScanCode.MediaStop, 'MediaStop', KeyCode.MediaStop, 'MediaStop', 178, 'VK_MEDIA_STOP', empty, empty],\r\n\t\t[1, ScanCode.Eject, 'Eject', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MediaPlayPause, 'MediaPlayPause', KeyCode.MediaPlayPause, 'MediaPlayPause', 179, 'VK_MEDIA_PLAY_PAUSE', empty, empty],\r\n\t\t[1, ScanCode.MediaSelect, 'MediaSelect', KeyCode.LaunchMediaPlayer, 'LaunchMediaPlayer', 181, 'VK_MEDIA_LAUNCH_MEDIA_SELECT', empty, empty],\r\n\t\t[1, ScanCode.LaunchMail, 'LaunchMail', KeyCode.LaunchMail, 'LaunchMail', 180, 'VK_MEDIA_LAUNCH_MAIL', empty, empty],\r\n\t\t[1, ScanCode.LaunchApp2, 'LaunchApp2', KeyCode.LaunchApp2, 'LaunchApp2', 183, 'VK_MEDIA_LAUNCH_APP2', empty, empty],\r\n\t\t[1, ScanCode.LaunchApp1, 'LaunchApp1', KeyCode.Unknown, empty, 0, 'VK_MEDIA_LAUNCH_APP1', empty, empty],\r\n\t\t[1, ScanCode.SelectTask, 'SelectTask', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.LaunchScreenSaver, 'LaunchScreenSaver', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.BrowserSearch, 'BrowserSearch', KeyCode.BrowserSearch, 'BrowserSearch', 170, 'VK_BROWSER_SEARCH', empty, empty],\r\n\t\t[1, ScanCode.BrowserHome, 'BrowserHome', KeyCode.BrowserHome, 'BrowserHome', 172, 'VK_BROWSER_HOME', empty, empty],\r\n\t\t[1, ScanCode.BrowserBack, 'BrowserBack', KeyCode.BrowserBack, 'BrowserBack', 166, 'VK_BROWSER_BACK', empty, empty],\r\n\t\t[1, ScanCode.BrowserForward, 'BrowserForward', KeyCode.BrowserForward, 'BrowserForward', 167, 'VK_BROWSER_FORWARD', empty, empty],\r\n\t\t[1, ScanCode.BrowserStop, 'BrowserStop', KeyCode.Unknown, empty, 0, 'VK_BROWSER_STOP', empty, empty],\r\n\t\t[1, ScanCode.BrowserRefresh, 'BrowserRefresh', KeyCode.Unknown, empty, 0, 'VK_BROWSER_REFRESH', empty, empty],\r\n\t\t[1, ScanCode.BrowserFavorites, 'BrowserFavorites', KeyCode.Unknown, empty, 0, 'VK_BROWSER_FAVORITES', empty, empty],\r\n\t\t[1, ScanCode.ZoomToggle, 'ZoomToggle', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MailReply, 'MailReply', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MailForward, 'MailForward', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\t\t[1, ScanCode.MailSend, 'MailSend', KeyCode.Unknown, empty, 0, empty, empty, empty],\r\n\r\n\t\t// See https://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\r\n\t\t// If an Input Method Editor is processing key input and the event is keydown, return 229.\r\n\t\t[1, ScanCode.None, empty, KeyCode.KEY_IN_COMPOSITION, 'KeyInComposition', 229, empty, empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.ABNT_C2, 'ABNT_C2', 194, 'VK_ABNT_C2', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.OEM_8, 'OEM_8', 223, 'VK_OEM_8', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_KANA', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_HANGUL', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_JUNJA', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_FINAL', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_HANJA', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_KANJI', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_CONVERT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_NONCONVERT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_ACCEPT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_MODECHANGE', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_SELECT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_PRINT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_EXECUTE', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_SNAPSHOT', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_HELP', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_APPS', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_PROCESSKEY', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_PACKET', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_DBE_SBCSCHAR', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_DBE_DBCSCHAR', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_ATTN', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_CRSEL', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_EXSEL', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_EREOF', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_PLAY', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_ZOOM', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_NONAME', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_PA1', empty, empty],\r\n\t\t[1, ScanCode.None, empty, KeyCode.Unknown, empty, 0, 'VK_OEM_CLEAR', empty, empty],\r\n\t];\r\n\r\n\tconst seenKeyCode: boolean[] = [];\r\n\tconst seenScanCode: boolean[] = [];\r\n\tfor (const mapping of mappings) {\r\n\t\tconst [immutable, scanCode, scanCodeStr, keyCode, keyCodeStr, eventKeyCode, vkey, usUserSettingsLabel, generalUserSettingsLabel] = mapping;\r\n\t\tif (!seenScanCode[scanCode]) {\r\n\t\t\tseenScanCode[scanCode] = true;\r\n\t\t\tscanCodeIntToStr[scanCode] = scanCodeStr;\r\n\t\t\tscanCodeStrToInt[scanCodeStr] = scanCode;\r\n\t\t\tscanCodeLowerCaseStrToInt[scanCodeStr.toLowerCase()] = scanCode;\r\n\t\t\tif (immutable) {\r\n\t\t\t\tIMMUTABLE_CODE_TO_KEY_CODE[scanCode] = keyCode;\r\n\t\t\t\tif (\r\n\t\t\t\t\t(keyCode !== KeyCode.Unknown)\r\n\t\t\t\t\t&& (keyCode !== KeyCode.Enter)\r\n\t\t\t\t\t&& (keyCode !== KeyCode.Ctrl)\r\n\t\t\t\t\t&& (keyCode !== KeyCode.Shift)\r\n\t\t\t\t\t&& (keyCode !== KeyCode.Alt)\r\n\t\t\t\t\t&& (keyCode !== KeyCode.Meta)\r\n\t\t\t\t) {\r\n\t\t\t\t\tIMMUTABLE_KEY_CODE_TO_CODE[keyCode] = scanCode;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!seenKeyCode[keyCode]) {\r\n\t\t\tseenKeyCode[keyCode] = true;\r\n\t\t\tif (!keyCodeStr) {\r\n\t\t\t\tthrow new Error(`String representation missing for key code ${keyCode} around scan code ${scanCodeStr}`);\r\n\t\t\t}\r\n\t\t\tuiMap.define(keyCode, keyCodeStr);\r\n\t\t\tuserSettingsUSMap.define(keyCode, usUserSettingsLabel || keyCodeStr);\r\n\t\t\tuserSettingsGeneralMap.define(keyCode, generalUserSettingsLabel || usUserSettingsLabel || keyCodeStr);\r\n\t\t}\r\n\t\tif (eventKeyCode) {\r\n\t\t\tEVENT_KEY_CODE_MAP[eventKeyCode] = keyCode;\r\n\t\t}\r\n\t\tif (vkey) {\r\n\t\t\tNATIVE_WINDOWS_KEY_CODE_TO_KEY_CODE[vkey] = keyCode;\r\n\t\t}\r\n\t}\r\n\t// Manually added due to the exclusion above (due to duplication with NumpadEnter)\r\n\tIMMUTABLE_KEY_CODE_TO_CODE[KeyCode.Enter] = ScanCode.Enter;\r\n\r\n})();\r\n\r\nexport namespace KeyCodeUtils {\r\n\texport function toString(keyCode: KeyCode): string {\r\n\t\treturn uiMap.keyCodeToStr(keyCode);\r\n\t}\r\n\texport function fromString(key: string): KeyCode {\r\n\t\treturn uiMap.strToKeyCode(key);\r\n\t}\r\n\r\n\texport function toUserSettingsUS(keyCode: KeyCode): string {\r\n\t\treturn userSettingsUSMap.keyCodeToStr(keyCode);\r\n\t}\r\n\texport function toUserSettingsGeneral(keyCode: KeyCode): string {\r\n\t\treturn userSettingsGeneralMap.keyCodeToStr(keyCode);\r\n\t}\r\n\texport function fromUserSettings(key: string): KeyCode {\r\n\t\treturn userSettingsUSMap.strToKeyCode(key) || userSettingsGeneralMap.strToKeyCode(key);\r\n\t}\r\n\r\n\texport function toElectronAccelerator(keyCode: KeyCode): string | null {\r\n\t\tif (keyCode >= KeyCode.Numpad0 && keyCode <= KeyCode.NumpadDivide) {\r\n\t\t\t// [Electron Accelerators] Electron is able to parse numpad keys, but unfortunately it\r\n\t\t\t// renders them just as regular keys in menus. For example, num0 is rendered as \"0\",\r\n\t\t\t// numdiv is rendered as \"/\", numsub is rendered as \"-\".\r\n\t\t\t//\r\n\t\t\t// This can lead to incredible confusion, as it makes numpad based keybindings indistinguishable\r\n\t\t\t// from keybindings based on regular keys.\r\n\t\t\t//\r\n\t\t\t// We therefore need to fall back to custom rendering for numpad keys.\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tswitch (keyCode) {\r\n\t\t\tcase KeyCode.UpArrow:\r\n\t\t\t\treturn 'Up';\r\n\t\t\tcase KeyCode.DownArrow:\r\n\t\t\t\treturn 'Down';\r\n\t\t\tcase KeyCode.LeftArrow:\r\n\t\t\t\treturn 'Left';\r\n\t\t\tcase KeyCode.RightArrow:\r\n\t\t\t\treturn 'Right';\r\n\t\t}\r\n\r\n\t\treturn uiMap.keyCodeToStr(keyCode);\r\n\t}\r\n}\r\n\r\nexport const enum KeyMod {\r\n\tCtrlCmd = (1 << 11) >>> 0,\r\n\tShift = (1 << 10) >>> 0,\r\n\tAlt = (1 << 9) >>> 0,\r\n\tWinCtrl = (1 << 8) >>> 0,\r\n}\r\n\r\nexport function KeyChord(firstPart: number, secondPart: number): number {\r\n\tconst chordPart = ((secondPart & 0x0000FFFF) << 16) >>> 0;\r\n\treturn (firstPart | chordPart) >>> 0;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n *   \r\n * []\r\n * export class Lazy<T>\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nexport class Lazy<T> {\r\n\r\n\tprivate _didRun: boolean = false;\r\n\tprivate _value?: T; //  \r\n\tprivate _error: Error | undefined;\r\n\r\n\tconstructor(\r\n\t\tprivate readonly executor: () => T,\r\n\t) { }\r\n\r\n\t/**\r\n\t *   \r\n\t *\r\n\t * -   (resolved) ,   .\r\n\t * -       .\r\n\t * -  (resolve)       .\r\n\t */\r\n\tget value(): T {\r\n\t\tif (!this._didRun) {\r\n\t\t\ttry {\r\n\t\t\t\tthis._value = this.executor();\r\n\t\t\t} catch (err) {\r\n\t\t\t\tthis._error = err;\r\n\t\t\t} finally {\r\n\t\t\t\tthis._didRun = true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (this._error) {\r\n\t\t\tthrow this._error;\r\n\t\t}\r\n\t\treturn this._value!;\r\n\t}\r\n\r\n\t/**\r\n\t *   \r\n\t *\r\n\t * -    \r\n\t */\r\n\tget rawValue(): T | undefined { return this._value; }\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { once } from 'vs/base/common/functional';\r\nimport { Iterable } from 'vs/base/common/iterator';\r\n\r\n// #region Disposable Tracking\r\n\r\n/**\r\n * Enables logging of potentially leaked disposables.\r\n *\r\n * A disposable is considered leaked if it is not disposed or not registered as the child of\r\n * another disposable. This tracking is very simple an only works for classes that either\r\n * extend Disposable or use a DisposableStore. This means there are a lot of false positives.\r\n */\r\nconst TRACK_DISPOSABLES = false;\r\nlet disposableTracker: IDisposableTracker | null = null;\r\n\r\nexport interface IDisposableTracker {\r\n\t/**\r\n\t * Is called on construction of a disposable.\r\n\t*/\r\n\ttrackDisposable(disposable: IDisposable): void;\r\n\r\n\t/**\r\n\t * Is called when a disposable is registered as child of another disposable (e.g. {@link DisposableStore}).\r\n\t * If parent is `null`, the disposable is removed from its former parent.\r\n\t*/\r\n\tsetParent(child: IDisposable, parent: IDisposable | null): void;\r\n\r\n\t/**\r\n\t * Is called after a disposable is disposed.\r\n\t*/\r\n\tmarkAsDisposed(disposable: IDisposable): void;\r\n\r\n\t/**\r\n\t * Indicates that the given object is a singleton which does not need to be disposed.\r\n\t*/\r\n\tmarkAsSingleton(disposable: IDisposable): void;\r\n}\r\n\r\nexport function setDisposableTracker(tracker: IDisposableTracker | null): void {\r\n\tdisposableTracker = tracker;\r\n}\r\n\r\nif (TRACK_DISPOSABLES) {\r\n\tconst __is_disposable_tracked__ = '__is_disposable_tracked__';\r\n\tsetDisposableTracker(new class implements IDisposableTracker {\r\n\t\ttrackDisposable(x: IDisposable): void {\r\n\t\t\tconst stack = new Error('Potentially leaked disposable').stack!;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (!(x as any)[__is_disposable_tracked__]) {\r\n\t\t\t\t\tconsole.log(stack);\r\n\t\t\t\t}\r\n\t\t\t}, 3000);\r\n\t\t}\r\n\r\n\t\tsetParent(child: IDisposable, parent: IDisposable | null): void {\r\n\t\t\tif (child && child !== Disposable.None) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t(child as any)[__is_disposable_tracked__] = true;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// noop\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmarkAsDisposed(disposable: IDisposable): void {\r\n\t\t\tif (disposable && disposable !== Disposable.None) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t(disposable as any)[__is_disposable_tracked__] = true;\r\n\t\t\t\t} catch {\r\n\t\t\t\t\t// noop\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tmarkAsSingleton(disposable: IDisposable): void { }\r\n\t});\r\n}\r\n\r\nfunction trackDisposable<T extends IDisposable>(x: T): T {\r\n\tdisposableTracker?.trackDisposable(x);\r\n\treturn x;\r\n}\r\n\r\nfunction markAsDisposed(disposable: IDisposable): void {\r\n\tdisposableTracker?.markAsDisposed(disposable);\r\n}\r\n\r\nfunction setParentOfDisposable(child: IDisposable, parent: IDisposable | null): void {\r\n\tdisposableTracker?.setParent(child, parent);\r\n}\r\n\r\nfunction setParentOfDisposables(children: IDisposable[], parent: IDisposable | null): void {\r\n\tif (!disposableTracker) {\r\n\t\treturn;\r\n\t}\r\n\tfor (const child of children) {\r\n\t\tdisposableTracker.setParent(child, parent);\r\n\t}\r\n}\r\n\r\n/**\r\n * Indicates that the given object is a singleton which does not need to be disposed.\r\n*/\r\nexport function markAsSingleton<T extends IDisposable>(singleton: T): T {\r\n\tdisposableTracker?.markAsSingleton(singleton);\r\n\treturn singleton;\r\n}\r\n\r\n// #endregion\r\n\r\n/**\r\n * An object that performs a cleanup operation when `.dispose()` is called.\r\n *\r\n * Some examples of how disposables are used:\r\n *\r\n * - An event listener that removes itself when `.dispose()` is called.\r\n * - A resource such as a file system watcher that cleans up the resource when `.dispose()` is called.\r\n * - The return value from registering a provider. When `.dispose()` is called, the provider is unregistered.\r\n */\r\nexport interface IDisposable {\r\n\tdispose(): void;\r\n}\r\n\r\n/**\r\n * Check if `thing` is {@link IDisposable disposable}.\r\n */\r\nexport function isDisposable<E extends object>(thing: E): thing is E & IDisposable {\r\n\treturn typeof (<IDisposable>thing).dispose === 'function' && (<IDisposable>thing).dispose.length === 0;\r\n}\r\n\r\n/**\r\n * Disposes of the value(s) passed in.\r\n */\r\nexport function dispose<T extends IDisposable>(disposable: T): T;\r\nexport function dispose<T extends IDisposable>(disposable: T | undefined): T | undefined;\r\nexport function dispose<T extends IDisposable, A extends Iterable<T> = Iterable<T>>(disposables: A): A;\r\nexport function dispose<T extends IDisposable>(disposables: Array<T>): Array<T>;\r\nexport function dispose<T extends IDisposable>(disposables: ReadonlyArray<T>): ReadonlyArray<T>;\r\nexport function dispose<T extends IDisposable>(arg: T | Iterable<T> | undefined): any {\r\n\tif (Iterable.is(arg)) {\r\n\t\tconst errors: any[] = [];\r\n\r\n\t\tfor (const d of arg) {\r\n\t\t\tif (d) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\td.dispose();\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\terrors.push(e);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (errors.length === 1) {\r\n\t\t\tthrow errors[0];\r\n\t\t} else if (errors.length > 1) {\r\n\t\t\tthrow new AggregateError(errors, 'Encountered errors while disposing of store');\r\n\t\t}\r\n\r\n\t\treturn Array.isArray(arg) ? [] : arg;\r\n\t} else if (arg) {\r\n\t\targ.dispose();\r\n\t\treturn arg;\r\n\t}\r\n}\r\n\r\n/**\r\n * Combine multiple disposable values into a single {@link IDisposable}.\r\n */\r\nexport function combinedDisposable(...disposables: IDisposable[]): IDisposable {\r\n\tconst parent = toDisposable(() => dispose(disposables));\r\n\tsetParentOfDisposables(disposables, parent);\r\n\treturn parent;\r\n}\r\n\r\n/**\r\n * Turn a function that implements dispose into an {@link IDisposable}.\r\n *\r\n * @param fn Clean up function, guaranteed to be called only **once**.\r\n */\r\nexport function toDisposable(fn: () => void): IDisposable {\r\n\tconst self = trackDisposable({\r\n\t\tdispose: once(() => {\r\n\t\t\tmarkAsDisposed(self);\r\n\t\t\tfn();\r\n\t\t})\r\n\t});\r\n\treturn self;\r\n}\r\n\r\n/**\r\n * Manages a collection of disposable values.\r\n *\r\n * This is the preferred way to manage multiple disposables. A `DisposableStore` is safer to work with than an\r\n * `IDisposable[]` as it considers edge cases, such as registering the same value multiple times or adding an item to a\r\n * store that has already been disposed of.\r\n */\r\nexport class DisposableStore implements IDisposable {\r\n\r\n\tstatic DISABLE_DISPOSED_WARNING = false;\r\n\r\n\tprivate readonly _toDispose = new Set<IDisposable>();\r\n\tprivate _isDisposed = false;\r\n\r\n\tconstructor() {\r\n\t\ttrackDisposable(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Dispose of all registered disposables and mark this object as disposed.\r\n\t *\r\n\t * Any future disposables added to this object will be disposed of on `add`.\r\n\t */\r\n\tpublic dispose(): void {\r\n\t\tif (this._isDisposed) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tmarkAsDisposed(this);\r\n\t\tthis._isDisposed = true;\r\n\t\tthis.clear();\r\n\t}\r\n\r\n\t/**\r\n\t * @return `true` if this object has been disposed of.\r\n\t */\r\n\tpublic get isDisposed(): boolean {\r\n\t\treturn this._isDisposed;\r\n\t}\r\n\r\n\t/**\r\n\t * Dispose of all registered disposables but do not mark this object as disposed.\r\n\t */\r\n\tpublic clear(): void {\r\n\t\tif (this._toDispose.size === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tdispose(this._toDispose);\r\n\t\t} finally {\r\n\t\t\tthis._toDispose.clear();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Add a new {@link IDisposable disposable} to the collection.\r\n\t */\r\n\tpublic add<T extends IDisposable>(o: T): T {\r\n\t\tif (!o) {\r\n\t\t\treturn o;\r\n\t\t}\r\n\t\tif ((o as unknown as DisposableStore) === this) {\r\n\t\t\tthrow new Error('Cannot register a disposable on itself!');\r\n\t\t}\r\n\r\n\t\tsetParentOfDisposable(o, this);\r\n\t\tif (this._isDisposed) {\r\n\t\t\tif (!DisposableStore.DISABLE_DISPOSED_WARNING) {\r\n\t\t\t\tconsole.warn(new Error('Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!').stack);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._toDispose.add(o);\r\n\t\t}\r\n\r\n\t\treturn o;\r\n\t}\r\n}\r\n\r\n/**\r\n * Abstract base class for a {@link IDisposable disposable} object.\r\n *\r\n * Subclasses can {@linkcode _register} disposables that will be automatically cleaned up when this object is disposed of.\r\n */\r\nexport abstract class Disposable implements IDisposable {\r\n\r\n\t/**\r\n\t * A disposable that does nothing when it is disposed of.\r\n\t *\r\n\t * TODO: This should not be a static property.\r\n\t */\r\n\tstatic readonly None = Object.freeze<IDisposable>({ dispose() { } });\r\n\r\n\tprotected readonly _store = new DisposableStore();\r\n\r\n\tconstructor() {\r\n\t\ttrackDisposable(this);\r\n\t\tsetParentOfDisposable(this._store, this);\r\n\t}\r\n\r\n\tpublic dispose(): void {\r\n\t\tmarkAsDisposed(this);\r\n\r\n\t\tthis._store.dispose();\r\n\t}\r\n\r\n\t/**\r\n\t * Adds `o` to the collection of disposables managed by this object.\r\n\t */\r\n\tprotected _register<T extends IDisposable>(o: T): T {\r\n\t\tif ((o as unknown as Disposable) === this) {\r\n\t\t\tthrow new Error('Cannot register a disposable on itself!');\r\n\t\t}\r\n\t\treturn this._store.add(o);\r\n\t}\r\n}\r\n\r\n/**\r\n * Manages the lifecycle of a disposable value that may be changed.\r\n *\r\n * This ensures that when the disposable value is changed, the previously held disposable is disposed of. You can\r\n * also register a `MutableDisposable` on a `Disposable` to ensure it is automatically cleaned up.\r\n */\r\nexport class MutableDisposable<T extends IDisposable> implements IDisposable {\r\n\tprivate _value?: T;\r\n\tprivate _isDisposed = false;\r\n\r\n\tconstructor() {\r\n\t\ttrackDisposable(this);\r\n\t}\r\n\r\n\tget value(): T | undefined {\r\n\t\treturn this._isDisposed ? undefined : this._value;\r\n\t}\r\n\r\n\tset value(value: T | undefined) {\r\n\t\tif (this._isDisposed || value === this._value) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._value?.dispose();\r\n\t\tif (value) {\r\n\t\t\tsetParentOfDisposable(value, this);\r\n\t\t}\r\n\t\tthis._value = value;\r\n\t}\r\n\r\n\t/**\r\n\t * Resets the stored value and disposed of the previously stored value.\r\n\t */\r\n\tclear(): void {\r\n\t\tthis.value = undefined;\r\n\t}\r\n\r\n\tdispose(): void {\r\n\t\tthis._isDisposed = true;\r\n\t\tmarkAsDisposed(this);\r\n\t\tthis._value?.dispose();\r\n\t\tthis._value = undefined;\r\n\t}\r\n}\r\n\r\nexport class RefCountedDisposable {\r\n\r\n\tprivate _counter: number = 1;\r\n\r\n\tconstructor(\r\n\t\tprivate readonly _disposable: IDisposable,\r\n\t) { }\r\n\r\n\tacquire() {\r\n\t\tthis._counter++;\r\n\t\treturn this;\r\n\t}\r\n\r\n\trelease() {\r\n\t\tif (--this._counter === 0) {\r\n\t\t\tthis._disposable.dispose();\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n}\r\n\r\nexport interface IReference<T> extends IDisposable {\r\n\treadonly object: T;\r\n}\r\n\r\nexport class ImmortalReference<T> implements IReference<T> {\r\n\tconstructor(public object: T) { }\r\n\tdispose(): void { /* noop */ }\r\n}\r\n\r\n/**\r\n * A map the manages the lifecycle of the values that it stores.\r\n */\r\nexport class DisposableMap<K, V extends IDisposable = IDisposable> implements IDisposable {\r\n\r\n\tprivate readonly _store = new Map<K, V>();\r\n\tprivate _isDisposed = false;\r\n\r\n\tconstructor() {\r\n\t\ttrackDisposable(this);\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes of all stored values and mark this object as disposed.\r\n\t *\r\n\t * Trying to use this object after it has been disposed of is an error.\r\n\t */\r\n\tdispose(): void {\r\n\t\tmarkAsDisposed(this);\r\n\t\tthis._isDisposed = true;\r\n\t\tthis.clearAndDisposeAll();\r\n\t}\r\n\r\n\t/**\r\n\t * Disposes of all stored values and clear the map, but DO NOT mark this object as disposed.\r\n\t */\r\n\tclearAndDisposeAll(): void {\r\n\t\tif (!this._store.size) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tdispose(this._store.values());\r\n\t\t} finally {\r\n\t\t\tthis._store.clear();\r\n\t\t}\r\n\t}\r\n\r\n\tget(key: K): V | undefined {\r\n\t\treturn this._store.get(key);\r\n\t}\r\n\r\n\tset(key: K, value: V, skipDisposeOnOverwrite = false): void {\r\n\t\tif (this._isDisposed) {\r\n\t\t\tconsole.warn(new Error('Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!').stack);\r\n\t\t}\r\n\r\n\t\tif (!skipDisposeOnOverwrite) {\r\n\t\t\tthis._store.get(key)?.dispose();\r\n\t\t}\r\n\r\n\t\tthis._store.set(key, value);\r\n\t}\r\n\r\n\t/**\r\n\t * Delete the value stored for `key` from this map and also dispose of it.\r\n\t */\r\n\tdeleteAndDispose(key: K): void {\r\n\t\tthis._store.get(key)?.dispose();\r\n\t\tthis._store.delete(key);\r\n\t}\r\n\r\n\t[Symbol.iterator](): IterableIterator<[K, V]> {\r\n\t\treturn this._store[Symbol.iterator]();\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nclass Node<E> {\r\n\r\n\tstatic readonly Undefined = new Node<any>(undefined);\r\n\r\n\telement: E;\r\n\tnext: Node<E>;\r\n\tprev: Node<E>;\r\n\r\n\tconstructor(element: E) {\r\n\t\tthis.element = element;\r\n\t\tthis.next = Node.Undefined;\r\n\t\tthis.prev = Node.Undefined;\r\n\t}\r\n}\r\n\r\nexport class LinkedList<E> {\r\n\r\n\tprivate _first: Node<E> = Node.Undefined;\r\n\tprivate _last: Node<E> = Node.Undefined;\r\n\tprivate _size: number = 0;\r\n\r\n\tget size(): number {\r\n\t\treturn this._size;\r\n\t}\r\n\r\n\tisEmpty(): boolean {\r\n\t\treturn this._first === Node.Undefined;\r\n\t}\r\n\r\n\tclear(): void {\r\n\t\tlet node = this._first;\r\n\t\twhile (node !== Node.Undefined) {\r\n\t\t\tconst next = node.next;\r\n\t\t\tnode.prev = Node.Undefined;\r\n\t\t\tnode.next = Node.Undefined;\r\n\t\t\tnode = next;\r\n\t\t}\r\n\r\n\t\tthis._first = Node.Undefined;\r\n\t\tthis._last = Node.Undefined;\r\n\t\tthis._size = 0;\r\n\t}\r\n\r\n\tunshift(element: E): () => void {\r\n\t\treturn this._insert(element, false);\r\n\t}\r\n\r\n\tpush(element: E): () => void {\r\n\t\treturn this._insert(element, true);\r\n\t}\r\n\r\n\tprivate _insert(element: E, atTheEnd: boolean): () => void {\r\n\t\tconst newNode = new Node(element);\r\n\t\tif (this._first === Node.Undefined) {\r\n\t\t\tthis._first = newNode;\r\n\t\t\tthis._last = newNode;\r\n\r\n\t\t} else if (atTheEnd) {\r\n\t\t\t// push\r\n\t\t\tconst oldLast = this._last!;\r\n\t\t\tthis._last = newNode;\r\n\t\t\tnewNode.prev = oldLast;\r\n\t\t\toldLast.next = newNode;\r\n\r\n\t\t} else {\r\n\t\t\t// unshift\r\n\t\t\tconst oldFirst = this._first;\r\n\t\t\tthis._first = newNode;\r\n\t\t\tnewNode.next = oldFirst;\r\n\t\t\toldFirst.prev = newNode;\r\n\t\t}\r\n\t\tthis._size += 1;\r\n\r\n\t\tlet didRemove = false;\r\n\t\treturn () => {\r\n\t\t\tif (!didRemove) {\r\n\t\t\t\tdidRemove = true;\r\n\t\t\t\tthis._remove(newNode);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tshift(): E | undefined {\r\n\t\tif (this._first === Node.Undefined) {\r\n\t\t\treturn undefined;\r\n\t\t} else {\r\n\t\t\tconst res = this._first.element;\r\n\t\t\tthis._remove(this._first);\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\r\n\tpop(): E | undefined {\r\n\t\tif (this._last === Node.Undefined) {\r\n\t\t\treturn undefined;\r\n\t\t} else {\r\n\t\t\tconst res = this._last.element;\r\n\t\t\tthis._remove(this._last);\r\n\t\t\treturn res;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _remove(node: Node<E>): void {\r\n\t\tif (node.prev !== Node.Undefined && node.next !== Node.Undefined) {\r\n\t\t\t// middle\r\n\t\t\tconst anchor = node.prev;\r\n\t\t\tanchor.next = node.next;\r\n\t\t\tnode.next.prev = anchor;\r\n\r\n\t\t} else if (node.prev === Node.Undefined && node.next === Node.Undefined) {\r\n\t\t\t// only node\r\n\t\t\tthis._first = Node.Undefined;\r\n\t\t\tthis._last = Node.Undefined;\r\n\r\n\t\t} else if (node.next === Node.Undefined) {\r\n\t\t\t// last\r\n\t\t\tthis._last = this._last!.prev!;\r\n\t\t\tthis._last.next = Node.Undefined;\r\n\r\n\t\t} else if (node.prev === Node.Undefined) {\r\n\t\t\t// first\r\n\t\t\tthis._first = this._first!.next!;\r\n\t\t\tthis._first.prev = Node.Undefined;\r\n\t\t}\r\n\r\n\t\t// done\r\n\t\tthis._size -= 1;\r\n\t}\r\n\r\n\t*[Symbol.iterator](): Iterator<E> {\r\n\t\tlet node = this._first;\r\n\t\twhile (node !== Node.Undefined) {\r\n\t\t\tyield node.element;\r\n\t\t\tnode = node.next;\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export class `StopWatch`\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n// fake definition so that the valid layers check won't trip on this\r\ndeclare const globalThis: { performance?: { now(): number } };\r\n\r\nconst hasPerformanceNow = (globalThis.performance && typeof globalThis.performance.now === 'function');\r\n\r\nexport class StopWatch {\r\n\r\n\tprivate _startTime: number;\r\n\tprivate _stopTime: number;\r\n\r\n\tprivate readonly _now: () => number;\r\n\r\n\tpublic static create(highResolution?: boolean): StopWatch {\r\n\t\treturn new StopWatch(highResolution);\r\n\t}\r\n\r\n\t/**  ,    */\r\n\tconstructor(highResolution?: boolean) {\r\n\t\tthis._now = hasPerformanceNow && highResolution === false ? Date.now : globalThis.performance!.now.bind(globalThis.performance);\r\n\t\tthis._startTime = this._now();\r\n\t\tthis._stopTime = -1;\r\n\t}\r\n\r\n\t/**     */\r\n\tpublic stop(): void {\r\n\t\tthis._stopTime = this._now();\r\n\t}\r\n\r\n\t/**    */\r\n\tpublic elapsed(): number {\r\n\t\tif (this._stopTime !== -1) {\r\n\t\t\treturn this._stopTime - this._startTime;\r\n\t\t}\r\n\t\treturn this._now() - this._startTime;\r\n\t}\r\n}\r\n","\r\nimport { onUnexpectedError } from 'vs/base/common/errors';\r\nimport { once as onceFn } from 'vs/base/common/functional';\r\nimport { combinedDisposable, Disposable, DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\r\nimport { LinkedList } from 'vs/base/common/linkedList';\r\nimport { IObservable, IObserver } from 'vs/base/common/observable';\r\nimport { StopWatch } from 'vs/base/common/stopwatch';\r\nimport { MicrotaskDelay } from 'vs/base/common/symbols';\r\n\r\n\r\n// -----------------------------------------------------------------------------------------------------------------------\r\n// Uncomment the next line to print warnings whenever an emitter with listeners is disposed. That is a sign of code smell.\r\n// -----------------------------------------------------------------------------------------------------------------------\r\nconst _enableDisposeWithListenerWarning = false;\r\n// _enableDisposeWithListenerWarning = Boolean(\"TRUE\"); // causes a linter warning so that it cannot be pushed\r\n\r\n\r\n// -----------------------------------------------------------------------------------------------------------------------\r\n// Uncomment the next line to print warnings whenever a snapshotted event is used repeatedly without cleanup.\r\n// See https://github.com/microsoft/vscode/issues/142851\r\n// -----------------------------------------------------------------------------------------------------------------------\r\nconst _enableSnapshotPotentialLeakWarning = false;\r\n// _enableSnapshotPotentialLeakWarning = Boolean(\"TRUE\"); // causes a linter warning so that it cannot be pushed\r\n\r\n/**\r\n * An event with zero or one parameters that can be subscribed to. The event is a function itself.\r\n */\r\nexport interface Event<T> {\r\n\t(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[] | DisposableStore): IDisposable;\r\n}\r\n\r\nexport namespace Event {\r\n\texport const None: Event<any> = () => Disposable.None;\r\n\r\n\tfunction _addLeakageTraceLogic(options: EmitterOptions) {\r\n\t\tif (_enableSnapshotPotentialLeakWarning) {\r\n\t\t\tconst { onDidAddListener: origListenerDidAdd } = options;\r\n\t\t\tconst stack = Stacktrace.create();\r\n\t\t\tlet count = 0;\r\n\t\t\toptions.onDidAddListener = () => {\r\n\t\t\t\tif (++count === 2) {\r\n\t\t\t\t\tconsole.warn('snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here');\r\n\t\t\t\t\tstack.print();\r\n\t\t\t\t}\r\n\t\t\t\torigListenerDidAdd?.();\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Given an event, returns another event which debounces calls and defers the listeners to a later task via a shared\r\n\t * `setTimeout`. The event is converted into a signal (`Event<void>`) to avoid additional object creation as a\r\n\t * result of merging events and to try prevent race conditions that could arise when using related deferred and\r\n\t * non-deferred events.\r\n\t *\r\n\t * This is useful for deferring non-critical work (eg. general UI updates) to ensure it does not block critical work\r\n\t * (eg. latency of keypress to text rendered).\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t */\r\n\texport function defer(event: Event<unknown>, disposable?: DisposableStore): Event<void> {\r\n\t\treturn debounce<unknown, void>(event, () => void 0, 0, undefined, true, undefined, disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Given an event, returns another event which only fires once.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t */\r\n\texport function once<T>(event: Event<T>): Event<T> {\r\n\t\treturn (listener, thisArgs = null, disposables?) => {\r\n\t\t\t// we need this, in case the event fires during the listener call\r\n\t\t\tlet didFire = false;\r\n\t\t\tlet result: IDisposable | undefined = undefined;\r\n\t\t\tresult = event(e => {\r\n\t\t\t\tif (didFire) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (result) {\r\n\t\t\t\t\tresult.dispose();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdidFire = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn listener.call(thisArgs, e);\r\n\t\t\t}, null, disposables);\r\n\r\n\t\t\tif (didFire) {\r\n\t\t\t\tresult.dispose();\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Maps an event of one type into an event of another type using a mapping function, similar to how\r\n\t * `Array.prototype.map` works.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param map The mapping function.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t */\r\n\texport function map<I, O>(event: Event<I>, map: (i: I) => O, disposable?: DisposableStore): Event<O> {\r\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(i => listener.call(thisArgs, map(i)), null, disposables), disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps an event in another event that performs some function on the event object before firing.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param each The function to perform on the event object.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t */\r\n\texport function forEach<I>(event: Event<I>, each: (i: I) => void, disposable?: DisposableStore): Event<I> {\r\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(i => { each(i); listener.call(thisArgs, i); }, null, disposables), disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps an event in another event that fires only when some condition is met.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param filter The filter function that defines the condition. The event will fire for the object if this function\r\n\t * returns true.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t */\r\n\texport function filter<T, U>(event: Event<T | U>, filter: (e: T | U) => e is T, disposable?: DisposableStore): Event<T>;\r\n\texport function filter<T>(event: Event<T>, filter: (e: T) => boolean, disposable?: DisposableStore): Event<T>;\r\n\texport function filter<T, R>(event: Event<T | R>, filter: (e: T | R) => e is R, disposable?: DisposableStore): Event<R>;\r\n\texport function filter<T>(event: Event<T>, filter: (e: T) => boolean, disposable?: DisposableStore): Event<T> {\r\n\t\treturn snapshot((listener, thisArgs = null, disposables?) => event(e => filter(e) && listener.call(thisArgs, e), null, disposables), disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Given an event, returns the same event but typed as `Event<void>`.\r\n\t */\r\n\texport function signal<T>(event: Event<T>): Event<void> {\r\n\t\treturn event as Event<any> as Event<void>;\r\n\t}\r\n\r\n\t/**\r\n\t * Given a collection of events, returns a single event which emits whenever any of the provided events emit.\r\n\t */\r\n\texport function any<T>(...events: Event<T>[]): Event<T>;\r\n\texport function any(...events: Event<any>[]): Event<void>;\r\n\texport function any<T>(...events: Event<T>[]): Event<T> {\r\n\t\treturn (listener, thisArgs = null, disposables?) => combinedDisposable(...events.map(event => event(e => listener.call(thisArgs, e), null, disposables)));\r\n\t}\r\n\r\n\t/**\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t */\r\n\texport function reduce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, initial?: O, disposable?: DisposableStore): Event<O> {\r\n\t\tlet output: O | undefined = initial;\r\n\r\n\t\treturn map<I, O>(event, e => {\r\n\t\t\toutput = merge(output, e);\r\n\t\t\treturn output;\r\n\t\t}, disposable);\r\n\t}\r\n\r\n\tfunction snapshot<T>(event: Event<T>, disposable: DisposableStore | undefined): Event<T> {\r\n\t\tlet listener: IDisposable | undefined;\r\n\r\n\t\tconst options: EmitterOptions | undefined = {\r\n\t\t\tonWillAddFirstListener() {\r\n\t\t\t\tlistener = event(emitter.fire, emitter);\r\n\t\t\t},\r\n\t\t\tonDidRemoveLastListener() {\r\n\t\t\t\tlistener?.dispose();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (!disposable) {\r\n\t\t\t_addLeakageTraceLogic(options);\r\n\t\t}\r\n\r\n\t\tconst emitter = new Emitter<T>(options);\r\n\r\n\t\tdisposable?.add(emitter);\r\n\r\n\t\treturn emitter.event;\r\n\t}\r\n\r\n\t/**\r\n\t * Given an event, creates a new emitter that event that will debounce events based on {@link delay} and give an\r\n\t * array event object of all events that fired.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The original event to debounce.\r\n\t * @param merge A function that reduces all events into a single event.\r\n\t * @param delay The number of milliseconds to debounce.\r\n\t * @param leading Whether to fire a leading event without debouncing.\r\n\t * @param flushOnListenerRemove Whether to fire all debounced events when a listener is removed. If this is not\r\n\t * specified, some events could go missing. Use this if it's important that all events are processed, even if the\r\n\t * listener gets disposed before the debounced event fires.\r\n\t * @param leakWarningThreshold See {@link EmitterOptions.leakWarningThreshold}.\r\n\t * @param disposable A disposable store to register the debounce emitter to.\r\n\t */\r\n\texport function debounce<T>(event: Event<T>, merge: (last: T | undefined, event: T) => T, delay?: number | typeof MicrotaskDelay, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number, disposable?: DisposableStore): Event<T>;\r\n\texport function debounce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, delay?: number | typeof MicrotaskDelay, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number, disposable?: DisposableStore): Event<O>;\r\n\texport function debounce<I, O>(event: Event<I>, merge: (last: O | undefined, event: I) => O, delay: number | typeof MicrotaskDelay = 100, leading = false, flushOnListenerRemove = false, leakWarningThreshold?: number, disposable?: DisposableStore): Event<O> {\r\n\t\tlet subscription: IDisposable;\r\n\t\tlet output: O | undefined = undefined;\r\n\t\tlet handle: any = undefined;\r\n\t\tlet numDebouncedCalls = 0;\r\n\t\tlet doFire: (() => void) | undefined;\r\n\r\n\t\tconst options: EmitterOptions | undefined = {\r\n\t\t\tleakWarningThreshold,\r\n\t\t\tonWillAddFirstListener() {\r\n\t\t\t\tsubscription = event(cur => {\r\n\t\t\t\t\tnumDebouncedCalls++;\r\n\t\t\t\t\toutput = merge(output, cur);\r\n\r\n\t\t\t\t\tif (leading && !handle) {\r\n\t\t\t\t\t\temitter.fire(output);\r\n\t\t\t\t\t\toutput = undefined;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tdoFire = () => {\r\n\t\t\t\t\t\tconst _output = output;\r\n\t\t\t\t\t\toutput = undefined;\r\n\t\t\t\t\t\thandle = undefined;\r\n\t\t\t\t\t\tif (!leading || numDebouncedCalls > 1) {\r\n\t\t\t\t\t\t\temitter.fire(_output!);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tnumDebouncedCalls = 0;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (typeof delay === 'number') {\r\n\t\t\t\t\t\tclearTimeout(handle);\r\n\t\t\t\t\t\thandle = setTimeout(doFire, delay);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (handle === undefined) {\r\n\t\t\t\t\t\t\thandle = 0;\r\n\t\t\t\t\t\t\tqueueMicrotask(doFire);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tonWillRemoveListener() {\r\n\t\t\t\tif (flushOnListenerRemove && numDebouncedCalls > 0) {\r\n\t\t\t\t\tdoFire?.();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonDidRemoveLastListener() {\r\n\t\t\t\tdoFire = undefined;\r\n\t\t\t\tsubscription.dispose();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (!disposable) {\r\n\t\t\t_addLeakageTraceLogic(options);\r\n\t\t}\r\n\r\n\t\tconst emitter = new Emitter<O>(options);\r\n\r\n\t\tdisposable?.add(emitter);\r\n\r\n\t\treturn emitter.event;\r\n\t}\r\n\r\n\t/**\r\n\t * Debounces an event, firing after some delay (default=0) with an array of all event original objects.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t */\r\n\texport function accumulate<T>(event: Event<T>, delay: number = 0, disposable?: DisposableStore): Event<T[]> {\r\n\t\treturn Event.debounce<T, T[]>(event, (last, e) => {\r\n\t\t\tif (!last) {\r\n\t\t\t\treturn [e];\r\n\t\t\t}\r\n\t\t\tlast.push(e);\r\n\t\t\treturn last;\r\n\t\t}, delay, undefined, true, undefined, disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Filters an event such that some condition is _not_ met more than once in a row, effectively ensuring duplicate\r\n\t * event objects from different sources do not fire the same event object.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param equals The equality condition.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t *\r\n\t * @example\r\n\t * ```\r\n\t * // Fire only one time when a single window is opened or focused\r\n\t * Event.latch(Event.any(onDidOpenWindow, onDidFocusWindow))\r\n\t * ```\r\n\t */\r\n\texport function latch<T>(event: Event<T>, equals: (a: T, b: T) => boolean = (a, b) => a === b, disposable?: DisposableStore): Event<T> {\r\n\t\tlet firstCall = true;\r\n\t\tlet cache: T;\r\n\r\n\t\treturn filter(event, value => {\r\n\t\t\tconst shouldEmit = firstCall || !equals(value, cache);\r\n\t\t\tfirstCall = false;\r\n\t\t\tcache = value;\r\n\t\t\treturn shouldEmit;\r\n\t\t}, disposable);\r\n\t}\r\n\r\n\t/**\r\n\t * Splits an event whose parameter is a union type into 2 separate events for each type in the union.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @example\r\n\t * ```\r\n\t * const event = new EventEmitter<number | undefined>().event;\r\n\t * const [numberEvent, undefinedEvent] = Event.split(event, isUndefined);\r\n\t * ```\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param isT A function that determines what event is of the first type.\r\n\t * @param disposable A disposable store to add the new EventEmitter to.\r\n\t */\r\n\texport function split<T, U>(event: Event<T | U>, isT: (e: T | U) => e is T, disposable?: DisposableStore): [Event<T>, Event<U>] {\r\n\t\treturn [\r\n\t\t\tEvent.filter(event, isT, disposable),\r\n\t\t\tEvent.filter(event, e => !isT(e), disposable) as Event<U>,\r\n\t\t];\r\n\t}\r\n\r\n\t/**\r\n\t * Buffers an event until it has a listener attached.\r\n\t *\r\n\t * *NOTE* that this function returns an `Event` and it MUST be called with a `DisposableStore` whenever the returned\r\n\t * event is accessible to \"third parties\", e.g the event is a public property. Otherwise a leaked listener on the\r\n\t * returned event causes this utility to leak a listener on the original event.\r\n\t *\r\n\t * @param event The event source for the new event.\r\n\t * @param flushAfterTimeout Determines whether to flush the buffer after a timeout immediately or after a\r\n\t * `setTimeout` when the first event listener is added.\r\n\t * @param _buffer Internal: A source event array used for tests.\r\n\t *\r\n\t * @example\r\n\t * ```\r\n\t * // Start accumulating events, when the first listener is attached, flush\r\n\t * // the event after a timeout such that multiple listeners attached before\r\n\t * // the timeout would receive the event\r\n\t * this.onInstallExtension = Event.buffer(service.onInstallExtension, true);\r\n\t * ```\r\n\t */\r\n\texport function buffer<T>(event: Event<T>, flushAfterTimeout = false, _buffer: T[] = []): Event<T> {\r\n\t\tlet buffer: T[] | null = _buffer.slice();\r\n\r\n\t\tlet listener: IDisposable | null = event(e => {\r\n\t\t\tif (buffer) {\r\n\t\t\t\tbuffer.push(e);\r\n\t\t\t} else {\r\n\t\t\t\temitter.fire(e);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconst flush = () => {\r\n\t\t\tbuffer?.forEach(e => emitter.fire(e));\r\n\t\t\tbuffer = null;\r\n\t\t};\r\n\r\n\t\tconst emitter = new Emitter<T>({\r\n\t\t\tonWillAddFirstListener() {\r\n\t\t\t\tif (!listener) {\r\n\t\t\t\t\tlistener = event(e => emitter.fire(e));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonDidAddFirstListener() {\r\n\t\t\t\tif (buffer) {\r\n\t\t\t\t\tif (flushAfterTimeout) {\r\n\t\t\t\t\t\tsetTimeout(flush);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tflush();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\tonDidRemoveLastListener() {\r\n\t\t\t\tif (listener) {\r\n\t\t\t\t\tlistener.dispose();\r\n\t\t\t\t}\r\n\t\t\t\tlistener = null;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn emitter.event;\r\n\t}\r\n\r\n\texport interface IChainableEvent<T> extends IDisposable {\r\n\r\n\t\tevent: Event<T>;\r\n\t\tmap<O>(fn: (i: T) => O): IChainableEvent<O>;\r\n\t\tforEach(fn: (i: T) => void): IChainableEvent<T>;\r\n\t\tfilter(fn: (e: T) => boolean): IChainableEvent<T>;\r\n\t\tfilter<R>(fn: (e: T | R) => e is R): IChainableEvent<R>;\r\n\t\treduce<R>(merge: (last: R | undefined, event: T) => R, initial?: R): IChainableEvent<R>;\r\n\t\tlatch(): IChainableEvent<T>;\r\n\t\tdebounce(merge: (last: T | undefined, event: T) => T, delay?: number, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number): IChainableEvent<T>;\r\n\t\tdebounce<R>(merge: (last: R | undefined, event: T) => R, delay?: number, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number): IChainableEvent<R>;\r\n\t\ton(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[] | DisposableStore): IDisposable;\r\n\t\tonce(listener: (e: T) => any, thisArgs?: any, disposables?: IDisposable[]): IDisposable;\r\n\t}\r\n\r\n\tclass ChainableEvent<T> implements IChainableEvent<T> {\r\n\r\n\t\tprivate readonly disposables = new DisposableStore();\r\n\r\n\t\tconstructor(readonly event: Event<T>) { }\r\n\r\n\t\t/** @see {@link Event.map} */\r\n\t\tmap<O>(fn: (i: T) => O): IChainableEvent<O> {\r\n\t\t\treturn new ChainableEvent(map(this.event, fn, this.disposables));\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.forEach} */\r\n\t\tforEach(fn: (i: T) => void): IChainableEvent<T> {\r\n\t\t\treturn new ChainableEvent(forEach(this.event, fn, this.disposables));\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.filter} */\r\n\t\tfilter(fn: (e: T) => boolean): IChainableEvent<T>;\r\n\t\tfilter<R>(fn: (e: T | R) => e is R): IChainableEvent<R>;\r\n\t\tfilter(fn: (e: T) => boolean): IChainableEvent<T> {\r\n\t\t\treturn new ChainableEvent(filter(this.event, fn, this.disposables));\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.reduce} */\r\n\t\treduce<R>(merge: (last: R | undefined, event: T) => R, initial?: R): IChainableEvent<R> {\r\n\t\t\treturn new ChainableEvent(reduce(this.event, merge, initial, this.disposables));\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.reduce} */\r\n\t\tlatch(): IChainableEvent<T> {\r\n\t\t\treturn new ChainableEvent(latch(this.event, undefined, this.disposables));\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.debounce} */\r\n\t\tdebounce(merge: (last: T | undefined, event: T) => T, delay?: number, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number): IChainableEvent<T>;\r\n\t\tdebounce<R>(merge: (last: R | undefined, event: T) => R, delay?: number, leading?: boolean, flushOnListenerRemove?: boolean, leakWarningThreshold?: number): IChainableEvent<R>;\r\n\t\tdebounce<R>(merge: (last: R | undefined, event: T) => R, delay: number = 100, leading = false, flushOnListenerRemove = false, leakWarningThreshold?: number): IChainableEvent<R> {\r\n\t\t\treturn new ChainableEvent(debounce(this.event, merge, delay, leading, flushOnListenerRemove, leakWarningThreshold, this.disposables));\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Attach a listener to the event.\r\n\t\t */\r\n\t\ton(listener: (e: T) => any, thisArgs: any, disposables: IDisposable[] | DisposableStore) {\r\n\t\t\treturn this.event(listener, thisArgs, disposables);\r\n\t\t}\r\n\r\n\t\t/** @see {@link Event.once} */\r\n\t\tonce(listener: (e: T) => any, thisArgs: any, disposables: IDisposable[]) {\r\n\t\t\treturn once(this.event)(listener, thisArgs, disposables);\r\n\t\t}\r\n\r\n\t\tdispose() {\r\n\t\t\tthis.disposables.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Wraps the event in an {@link IChainableEvent}, allowing a more functional programming style.\r\n\t *\r\n\t * @example\r\n\t * ```\r\n\t * // Normal\r\n\t * const onEnterPressNormal = Event.filter(\r\n\t *   Event.map(onKeyPress.event, e => new StandardKeyboardEvent(e)),\r\n\t *   e.keyCode === KeyCode.Enter\r\n\t * ).event;\r\n\t *\r\n\t * // Using chain\r\n\t * const onEnterPressChain = Event.chain(onKeyPress.event)\r\n\t *   .map(e => new StandardKeyboardEvent(e))\r\n\t *   .filter(e => e.keyCode === KeyCode.Enter)\r\n\t *   .event;\r\n\t * ```\r\n\t */\r\n\texport function chain<T>(event: Event<T>): IChainableEvent<T> {\r\n\t\treturn new ChainableEvent(event);\r\n\t}\r\n\r\n\texport interface NodeEventEmitter {\r\n\t\ton(event: string | symbol, listener: Function): unknown;\r\n\t\tremoveListener(event: string | symbol, listener: Function): unknown;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an {@link Event} from a node event emitter.\r\n\t */\r\n\texport function fromNodeEventEmitter<T>(emitter: NodeEventEmitter, eventName: string, map: (...args: any[]) => T = id => id): Event<T> {\r\n\t\tconst fn = (...args: any[]) => result.fire(map(...args));\r\n\t\tconst onFirstListenerAdd = () => emitter.on(eventName, fn);\r\n\t\tconst onLastListenerRemove = () => emitter.removeListener(eventName, fn);\r\n\t\tconst result = new Emitter<T>({ onWillAddFirstListener: onFirstListenerAdd, onDidRemoveLastListener: onLastListenerRemove });\r\n\r\n\t\treturn result.event;\r\n\t}\r\n\r\n\texport interface DOMEventEmitter {\r\n\t\taddEventListener(event: string | symbol, listener: Function): void;\r\n\t\tremoveEventListener(event: string | symbol, listener: Function): void;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an {@link Event} from a DOM event emitter.\r\n\t */\r\n\texport function fromDOMEventEmitter<T>(emitter: DOMEventEmitter, eventName: string, map: (...args: any[]) => T = id => id): Event<T> {\r\n\t\tconst fn = (...args: any[]) => result.fire(map(...args));\r\n\t\tconst onFirstListenerAdd = () => emitter.addEventListener(eventName, fn);\r\n\t\tconst onLastListenerRemove = () => emitter.removeEventListener(eventName, fn);\r\n\t\tconst result = new Emitter<T>({ onWillAddFirstListener: onFirstListenerAdd, onDidRemoveLastListener: onLastListenerRemove });\r\n\r\n\t\treturn result.event;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a promise out of an event, using the {@link Event.once} helper.\r\n\t */\r\n\texport function toPromise<T>(event: Event<T>): Promise<T> {\r\n\t\treturn new Promise(resolve => once(event)(resolve));\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an event out of a promise that fires once when the promise is\r\n\t * resolved with the result of the promise or `undefined`.\r\n\t */\r\n\texport function fromPromise<T>(promise: Promise<T>): Event<T | undefined> {\r\n\t\tconst result = new Emitter<T | undefined>();\r\n\r\n\t\tpromise.then(res => {\r\n\t\t\tresult.fire(res);\r\n\t\t}, () => {\r\n\t\t\tresult.fire(undefined);\r\n\t\t}).finally(() => {\r\n\t\t\tresult.dispose();\r\n\t\t});\r\n\r\n\t\treturn result.event;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a listener to an event and calls the listener immediately with undefined as the event object.\r\n\t *\r\n\t * @example\r\n\t * ```\r\n\t * // Initialize the UI and update it when dataChangeEvent fires\r\n\t * runAndSubscribe(dataChangeEvent, () => this._updateUI());\r\n\t * ```\r\n\t */\r\n\texport function runAndSubscribe<T>(event: Event<T>, handler: (e: T | undefined) => any): IDisposable {\r\n\t\thandler(undefined);\r\n\t\treturn event(e => handler(e));\r\n\t}\r\n\r\n\t/**\r\n\t * Adds a listener to an event and calls the listener immediately with undefined as the event object. A new\r\n\t * {@link DisposableStore} is passed to the listener which is disposed when the returned disposable is disposed.\r\n\t */\r\n\texport function runAndSubscribeWithStore<T>(event: Event<T>, handler: (e: T | undefined, disposableStore: DisposableStore) => any): IDisposable {\r\n\t\tlet store: DisposableStore | null = null;\r\n\r\n\t\tfunction run(e: T | undefined) {\r\n\t\t\tstore?.dispose();\r\n\t\t\tstore = new DisposableStore();\r\n\t\t\thandler(e, store);\r\n\t\t}\r\n\r\n\t\trun(undefined);\r\n\t\tconst disposable = event(e => run(e));\r\n\t\treturn toDisposable(() => {\r\n\t\t\tdisposable.dispose();\r\n\t\t\tstore?.dispose();\r\n\t\t});\r\n\t}\r\n\r\n\tclass EmitterObserver<T> implements IObserver {\r\n\r\n\t\treadonly emitter: Emitter<T>;\r\n\r\n\t\tprivate _counter = 0;\r\n\t\tprivate _hasChanged = false;\r\n\r\n\t\tconstructor(readonly _observable: IObservable<T, any>, store: DisposableStore | undefined) {\r\n\t\t\tconst options: EmitterOptions = {\r\n\t\t\t\tonWillAddFirstListener: () => {\r\n\t\t\t\t\t_observable.addObserver(this);\r\n\t\t\t\t},\r\n\t\t\t\tonDidRemoveLastListener: () => {\r\n\t\t\t\t\t_observable.removeObserver(this);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tif (!store) {\r\n\t\t\t\t_addLeakageTraceLogic(options);\r\n\t\t\t}\r\n\t\t\tthis.emitter = new Emitter<T>(options);\r\n\t\t\tif (store) {\r\n\t\t\t\tstore.add(this.emitter);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tbeginUpdate<T>(_observable: IObservable<T, void>): void {\r\n\t\t\t// assert(_observable === this.obs);\r\n\t\t\tthis._counter++;\r\n\t\t}\r\n\r\n\t\thandlePossibleChange<T>(_observable: IObservable<T, unknown>): void {\r\n\t\t\t// assert(_observable === this.obs);\r\n\t\t}\r\n\r\n\t\thandleChange<T, TChange>(_observable: IObservable<T, TChange>, _change: TChange): void {\r\n\t\t\t// assert(_observable === this.obs);\r\n\t\t\tthis._hasChanged = true;\r\n\t\t}\r\n\r\n\t\tendUpdate<T>(_observable: IObservable<T, void>): void {\r\n\t\t\t// assert(_observable === this.obs);\r\n\t\t\tthis._counter--;\r\n\t\t\tif (this._counter === 0) {\r\n\t\t\t\tthis._observable.reportChanges();\r\n\t\t\t\tif (this._hasChanged) {\r\n\t\t\t\t\tthis._hasChanged = false;\r\n\t\t\t\t\tthis.emitter.fire(this._observable.get());\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an event emitter that is fired when the observable changes.\r\n\t * Each listeners subscribes to the emitter.\r\n\t */\r\n\texport function fromObservable<T>(obs: IObservable<T, any>, store?: DisposableStore): Event<T> {\r\n\t\tconst observer = new EmitterObserver(obs, store);\r\n\t\treturn observer.emitter.event;\r\n\t}\r\n\r\n\t/**\r\n\t * Each listener is attached to the observable directly.\r\n\t */\r\n\texport function fromObservableLight(observable: IObservable<any>): Event<void> {\r\n\t\treturn (listener) => {\r\n\t\t\tlet count = 0;\r\n\t\t\tlet didChange = false;\r\n\t\t\tconst observer: IObserver = {\r\n\t\t\t\tbeginUpdate() {\r\n\t\t\t\t\tcount++;\r\n\t\t\t\t},\r\n\t\t\t\tendUpdate() {\r\n\t\t\t\t\tcount--;\r\n\t\t\t\t\tif (count === 0) {\r\n\t\t\t\t\t\tobservable.reportChanges();\r\n\t\t\t\t\t\tif (didChange) {\r\n\t\t\t\t\t\t\tdidChange = false;\r\n\t\t\t\t\t\t\tlistener();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\thandlePossibleChange() {\r\n\t\t\t\t\t// noop\r\n\t\t\t\t},\r\n\t\t\t\thandleChange() {\r\n\t\t\t\t\tdidChange = true;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobservable.addObserver(observer);\r\n\t\t\tobservable.reportChanges();\r\n\t\t\treturn {\r\n\t\t\t\tdispose() {\r\n\t\t\t\t\tobservable.removeObserver(observer);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport interface EmitterOptions {\r\n\t/**\r\n\t * Optional function that's called *before* the very first listener is added\r\n\t */\r\n\tonWillAddFirstListener?: Function;\r\n\t/**\r\n\t * Optional function that's called *after* the very first listener is added\r\n\t */\r\n\tonDidAddFirstListener?: Function;\r\n\t/**\r\n\t * Optional function that's called after a listener is added\r\n\t */\r\n\tonDidAddListener?: Function;\r\n\t/**\r\n\t * Optional function that's called *after* remove the very last listener\r\n\t */\r\n\tonDidRemoveLastListener?: Function;\r\n\t/**\r\n\t * Optional function that's called *before* a listener is removed\r\n\t */\r\n\tonWillRemoveListener?: Function;\r\n\t/**\r\n\t * Optional function that's called when a listener throws an error. Defaults to\r\n\t * {@link onUnexpectedError}\r\n\t */\r\n\tonListenerError?: (e: any) => void;\r\n\t/**\r\n\t * Number of listeners that are allowed before assuming a leak. Default to\r\n\t * a globally configured value\r\n\t *\r\n\t * @see setGlobalLeakWarningThreshold\r\n\t */\r\n\tleakWarningThreshold?: number;\r\n\t/**\r\n\t * Pass in a delivery queue, which is useful for ensuring\r\n\t * in order event delivery across multiple emitters.\r\n\t */\r\n\tdeliveryQueue?: EventDeliveryQueue;\r\n\r\n\t/** ONLY enable this during development */\r\n\t_profName?: string;\r\n}\r\n\r\n\r\nexport class EventProfiling {\r\n\r\n\tstatic readonly all = new Set<EventProfiling>();\r\n\r\n\tprivate static _idPool = 0;\r\n\r\n\treadonly name: string;\r\n\tpublic listenerCount: number = 0;\r\n\tpublic invocationCount = 0;\r\n\tpublic elapsedOverall = 0;\r\n\tpublic durations: number[] = [];\r\n\r\n\tprivate _stopWatch?: StopWatch;\r\n\r\n\tconstructor(name: string) {\r\n\t\tthis.name = `${name}_${EventProfiling._idPool++}`;\r\n\t\tEventProfiling.all.add(this);\r\n\t}\r\n\r\n\tstart(listenerCount: number): void {\r\n\t\tthis._stopWatch = new StopWatch();\r\n\t\tthis.listenerCount = listenerCount;\r\n\t}\r\n\r\n\tstop(): void {\r\n\t\tif (this._stopWatch) {\r\n\t\t\tconst elapsed = this._stopWatch.elapsed();\r\n\t\t\tthis.durations.push(elapsed);\r\n\t\t\tthis.elapsedOverall += elapsed;\r\n\t\t\tthis.invocationCount += 1;\r\n\t\t\tthis._stopWatch = undefined;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nlet _globalLeakWarningThreshold = -1;\r\n\r\nclass LeakageMonitor {\r\n\r\n\tprivate _stacks: Map<string, number> | undefined;\r\n\tprivate _warnCountdown: number = 0;\r\n\r\n\tconstructor(\r\n\t\treadonly threshold: number,\r\n\t\treadonly name: string = Math.random().toString(18).slice(2, 5),\r\n\t) { }\r\n\r\n\tdispose(): void {\r\n\t\tthis._stacks?.clear();\r\n\t}\r\n\r\n\tcheck(stack: Stacktrace, listenerCount: number): undefined | (() => void) {\r\n\r\n\t\tconst threshold = this.threshold;\r\n\t\tif (threshold <= 0 || listenerCount < threshold) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tif (!this._stacks) {\r\n\t\t\tthis._stacks = new Map();\r\n\t\t}\r\n\t\tconst count = (this._stacks.get(stack.value) || 0);\r\n\t\tthis._stacks.set(stack.value, count + 1);\r\n\t\tthis._warnCountdown -= 1;\r\n\r\n\t\tif (this._warnCountdown <= 0) {\r\n\t\t\t// only warn on first exceed and then every time the limit\r\n\t\t\t// is exceeded by 50% again\r\n\t\t\tthis._warnCountdown = threshold * 0.5;\r\n\r\n\t\t\t// find most frequent listener and print warning\r\n\t\t\tlet topStack: string | undefined;\r\n\t\t\tlet topCount: number = 0;\r\n\t\t\tfor (const [stack, count] of this._stacks) {\r\n\t\t\t\tif (!topStack || topCount < count) {\r\n\t\t\t\t\ttopStack = stack;\r\n\t\t\t\t\ttopCount = count;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconsole.warn(`[${this.name}] potential listener LEAK detected, having ${listenerCount} listeners already. MOST frequent listener (${topCount}):`);\r\n\t\t\tconsole.warn(topStack!);\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tconst count = (this._stacks!.get(stack.value) || 0);\r\n\t\t\tthis._stacks!.set(stack.value, count - 1);\r\n\t\t};\r\n\t}\r\n}\r\n\r\nclass Stacktrace {\r\n\r\n\tstatic create() {\r\n\t\treturn new Stacktrace(new Error().stack ?? '');\r\n\t}\r\n\r\n\tprivate constructor(readonly value: string) { }\r\n\r\n\tprint() {\r\n\t\tconsole.warn(this.value.split('\\n').slice(2).join('\\n'));\r\n\t}\r\n}\r\nclass UniqueContainer<T> {\r\n\tstack?: Stacktrace;\r\n\tconstructor(public readonly value: T) { }\r\n}\r\nconst compactionThreshold = 2;\r\n\r\ntype ListenerContainer<T> = UniqueContainer<(data: T) => void>;\r\ntype ListenerOrListeners<T> = (ListenerContainer<T> | undefined)[] | ListenerContainer<T>;\r\n\r\nconst forEachListener = <T>(listeners: ListenerOrListeners<T>, fn: (c: ListenerContainer<T>) => void) => {\r\n\tif (listeners instanceof UniqueContainer) {\r\n\t\tfn(listeners);\r\n\t} else {\r\n\t\tfor (let i = 0; i < listeners.length; i++) {\r\n\t\t\tconst l = listeners[i];\r\n\t\t\tif (l) {\r\n\t\t\t\tfn(l);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\n/**\r\n * The Emitter can be used to expose an Event to the public\r\n * to fire it from the insides.\r\n * Sample:\r\n\tclass Document {\r\n\r\n\t\tprivate readonly _onDidChange = new Emitter<(value:string)=>any>();\r\n\t\tpublic onDidChange = this._onDidChange.event;\r\n\r\n\t\t// getter-style\r\n\t\t// get onDidChange(): Event<(value:string)=>any> {\r\n\t\t// \treturn this._onDidChange.event;\r\n\t\t// }\r\n\r\n\t\tprivate _doIt() {\r\n\t\t\t//...\r\n\t\t\tthis._onDidChange.fire(value);\r\n\t\t}\r\n\t}\r\n */\r\nexport class Emitter<T> {\r\n\r\n\tprivate readonly _options?: EmitterOptions;\r\n\tprivate readonly _leakageMon?: LeakageMonitor;\r\n\tprivate readonly _perfMon?: EventProfiling;\r\n\tprivate _disposed?: true;\r\n\tprivate _event?: Event<T>;\r\n\r\n\t/**\r\n\t * A listener, or list of listeners. A single listener is the most common\r\n\t * for event emitters (#185789), so we optimize that special case to avoid\r\n\t * wrapping it in an array (just like Node.js itself.)\r\n\t *\r\n\t * A list of listeners never 'downgrades' back to a plain function if\r\n\t * listeners are removed, for two reasons:\r\n\t *\r\n\t *  1. That's complicated (especially with the deliveryQueue)\r\n\t *  2. A listener with >1 listener is likely to have >1 listener again at\r\n\t *     some point, and swapping between arrays and functions may[citation needed]\r\n\t *     introduce unnecessary work and garbage.\r\n\t *\r\n\t * The array listeners can be 'sparse', to avoid reallocating the array\r\n\t * whenever any listener is added or removed. If more than `1 / compactionThreshold`\r\n\t * of the array is empty, only then is it resized.\r\n\t */\r\n\tprotected _listeners?: ListenerOrListeners<T>;\r\n\r\n\t/**\r\n\t * Always to be defined if _listeners is an array. It's no longer a true\r\n\t * queue, but holds the dispatching 'state'. If `fire()` is called on an\r\n\t * emitter, any work left in the _deliveryQueue is finished first.\r\n\t */\r\n\tprivate _deliveryQueue?: EventDeliveryQueuePrivate;\r\n\tprotected _size = 0;\r\n\r\n\tconstructor(options?: EmitterOptions) {\r\n\t\tthis._options = options;\r\n\t\tthis._leakageMon = _globalLeakWarningThreshold > 0 || this._options?.leakWarningThreshold ? new LeakageMonitor(this._options?.leakWarningThreshold ?? _globalLeakWarningThreshold) : undefined;\r\n\t\tthis._perfMon = this._options?._profName ? new EventProfiling(this._options._profName) : undefined;\r\n\t\tthis._deliveryQueue = this._options?.deliveryQueue as EventDeliveryQueuePrivate | undefined;\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tif (!this._disposed) {\r\n\t\t\tthis._disposed = true;\r\n\r\n\t\t\t// It is bad to have listeners at the time of disposing an emitter, it is worst to have listeners keep the emitter\r\n\t\t\t// alive via the reference that's embedded in their disposables. Therefore we loop over all remaining listeners and\r\n\t\t\t// unset their subscriptions/disposables. Looping and blaming remaining listeners is done on next tick because the\r\n\t\t\t// the following programming pattern is very popular:\r\n\t\t\t//\r\n\t\t\t// const someModel = this._disposables.add(new ModelObject()); // (1) create and register model\r\n\t\t\t// this._disposables.add(someModel.onDidChange(() => { ... }); // (2) subscribe and register model-event listener\r\n\t\t\t// ...later...\r\n\t\t\t// this._disposables.dispose(); disposes (1) then (2): don't warn after (1) but after the \"overall dispose\" is done\r\n\r\n\t\t\tif (this._deliveryQueue?.current === this) {\r\n\t\t\t\tthis._deliveryQueue.reset();\r\n\t\t\t}\r\n\t\t\tif (this._listeners) {\r\n\t\t\t\tif (_enableDisposeWithListenerWarning) {\r\n\t\t\t\t\tconst listeners = this._listeners;\r\n\t\t\t\t\tqueueMicrotask(() => {\r\n\t\t\t\t\t\tforEachListener(listeners, l => l.stack?.print());\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._listeners = undefined;\r\n\t\t\t\tthis._size = 0;\r\n\t\t\t}\r\n\t\t\tthis._options?.onDidRemoveLastListener?.();\r\n\t\t\tthis._leakageMon?.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * For the public to allow to subscribe\r\n\t * to events from this Emitter\r\n\t */\r\n\tget event(): Event<T> {\r\n\t\tthis._event ??= (callback: (e: T) => any, thisArgs?: any, disposables?: IDisposable[] | DisposableStore) => {\r\n\t\t\tif (this._leakageMon && this._size > this._leakageMon.threshold * 3) {\r\n\t\t\t\tconsole.warn(`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far`);\r\n\t\t\t\treturn Disposable.None;\r\n\t\t\t}\r\n\r\n\t\t\tif (this._disposed) {\r\n\t\t\t\t// todo: should we warn if a listener is added to a disposed emitter? This happens often\r\n\t\t\t\treturn Disposable.None;\r\n\t\t\t}\r\n\r\n\t\t\tif (thisArgs) {\r\n\t\t\t\tcallback = callback.bind(thisArgs);\r\n\t\t\t}\r\n\r\n\t\t\tconst contained = new UniqueContainer(callback);\r\n\r\n\t\t\tlet removeMonitor: Function | undefined;\r\n\t\t\tlet stack: Stacktrace | undefined;\r\n\t\t\tif (this._leakageMon && this._size >= Math.ceil(this._leakageMon.threshold * 0.2)) {\r\n\t\t\t\t// check and record this emitter for potential leakage\r\n\t\t\t\tcontained.stack = Stacktrace.create();\r\n\t\t\t\tremoveMonitor = this._leakageMon.check(contained.stack, this._size + 1);\r\n\t\t\t}\r\n\r\n\t\t\tif (_enableDisposeWithListenerWarning) {\r\n\t\t\t\tcontained.stack = stack ?? Stacktrace.create();\r\n\t\t\t}\r\n\r\n\t\t\tif (!this._listeners) {\r\n\t\t\t\tthis._options?.onWillAddFirstListener?.(this);\r\n\t\t\t\tthis._listeners = contained;\r\n\t\t\t\tthis._options?.onDidAddFirstListener?.(this);\r\n\t\t\t} else if (this._listeners instanceof UniqueContainer) {\r\n\t\t\t\tthis._deliveryQueue ??= new EventDeliveryQueuePrivate();\r\n\t\t\t\tthis._listeners = [this._listeners, contained];\r\n\t\t\t} else {\r\n\t\t\t\tthis._listeners.push(contained);\r\n\t\t\t}\r\n\r\n\t\t\tthis._size++;\r\n\r\n\t\t\tconst result = toDisposable(() => { removeMonitor?.(); this._removeListener(contained); });\r\n\t\t\tif (disposables instanceof DisposableStore) {\r\n\t\t\t\tdisposables.add(result);\r\n\t\t\t} else if (Array.isArray(disposables)) {\r\n\t\t\t\tdisposables.push(result);\r\n\t\t\t}\r\n\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\treturn this._event;\r\n\t}\r\n\r\n\tprivate _removeListener(listener: ListenerContainer<T>) {\r\n\t\tthis._options?.onWillRemoveListener?.(this);\r\n\r\n\t\tif (!this._listeners) {\r\n\t\t\treturn; // expected if a listener gets disposed\r\n\t\t}\r\n\r\n\t\tif (this._size === 1) {\r\n\t\t\tthis._listeners = undefined;\r\n\t\t\tthis._options?.onDidRemoveLastListener?.(this);\r\n\t\t\tthis._size = 0;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// size > 1 which requires that listeners be a list:\r\n\t\tconst listeners = this._listeners as (ListenerContainer<T> | undefined)[];\r\n\r\n\t\tconst index = listeners.indexOf(listener);\r\n\t\tif (index === -1) {\r\n\t\t\tconsole.log('disposed?', this._disposed);\r\n\t\t\tconsole.log('size?', this._size);\r\n\t\t\tconsole.log('arr?', JSON.stringify(this._listeners));\r\n\t\t\tthrow new Error('Attempted to dispose unknown listener');\r\n\t\t}\r\n\r\n\t\tthis._size--;\r\n\t\tlisteners[index] = undefined;\r\n\r\n\t\tconst adjustDeliveryQueue = this._deliveryQueue!.current === this;\r\n\t\tif (this._size * compactionThreshold <= listeners.length) {\r\n\t\t\tlet n = 0;\r\n\t\t\tfor (let i = 0; i < listeners.length; i++) {\r\n\t\t\t\tif (listeners[i]) {\r\n\t\t\t\t\tlisteners[n++] = listeners[i];\r\n\t\t\t\t} else if (adjustDeliveryQueue) {\r\n\t\t\t\t\tthis._deliveryQueue!.end--;\r\n\t\t\t\t\tif (n < this._deliveryQueue!.i) {\r\n\t\t\t\t\t\tthis._deliveryQueue!.i--;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlisteners.length = n;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _deliver(listener: undefined | UniqueContainer<(value: T) => void>, value: T) {\r\n\t\tif (!listener) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst errorHandler = this._options?.onListenerError || onUnexpectedError;\r\n\t\tif (!errorHandler) {\r\n\t\t\tlistener.value(value);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tlistener.value(value);\r\n\t\t} catch (e) {\r\n\t\t\terrorHandler(e);\r\n\t\t}\r\n\t}\r\n\r\n\t/** Delivers items in the queue. Assumes the queue is ready to go. */\r\n\tprivate _deliverQueue(dq: EventDeliveryQueuePrivate) {\r\n\t\tconst listeners = dq.current!._listeners! as (ListenerContainer<T> | undefined)[];\r\n\t\twhile (dq.i < dq.end) {\r\n\t\t\t// important: dq.i is incremented before calling deliver() because it might reenter deliverQueue()\r\n\t\t\tthis._deliver(listeners[dq.i++], dq.value as T);\r\n\t\t}\r\n\t\tdq.reset();\r\n\t}\r\n\r\n\t/**\r\n\t * To be kept private to fire an event to\r\n\t * subscribers\r\n\t */\r\n\tfire(event: T): void {\r\n\t\tif (this._deliveryQueue?.current) {\r\n\t\t\tthis._deliverQueue(this._deliveryQueue);\r\n\t\t\tthis._perfMon?.stop(); // last fire() will have starting perfmon, stop it before starting the next dispatch\r\n\t\t}\r\n\r\n\t\tthis._perfMon?.start(this._size);\r\n\r\n\t\tif (!this._listeners) {\r\n\t\t\t// no-op\r\n\t\t} else if (this._listeners instanceof UniqueContainer) {\r\n\t\t\tthis._deliver(this._listeners, event);\r\n\t\t} else {\r\n\t\t\tconst dq = this._deliveryQueue!;\r\n\t\t\tdq.enqueue(this, event, this._listeners.length);\r\n\t\t\tthis._deliverQueue(dq);\r\n\t\t}\r\n\r\n\t\tthis._perfMon?.stop();\r\n\t}\r\n\r\n\thasListeners(): boolean {\r\n\t\treturn this._size > 0;\r\n\t}\r\n}\r\n\r\nexport interface EventDeliveryQueue {\r\n}\r\n\r\nexport const createEventDeliveryQueue = (): EventDeliveryQueue => new EventDeliveryQueuePrivate();\r\n\r\nclass EventDeliveryQueuePrivate implements EventDeliveryQueue {\r\n\r\n\t/**\r\n\t * Index in current's listener list.\r\n\t */\r\n\tpublic i = -1;\r\n\r\n\t/**\r\n\t * The last index in the listener's list to deliver.\r\n\t */\r\n\tpublic end = 0;\r\n\r\n\t/**\r\n\t * Emitter currently being dispatched on. Emitter._listeners is always an array.\r\n\t */\r\n\tpublic current?: Emitter<any>;\r\n\t/**\r\n\t * Currently emitting value. Defined whenever `current` is.\r\n\t */\r\n\tpublic value?: unknown;\r\n\r\n\tpublic enqueue<T>(emitter: Emitter<T>, value: T, end: number) {\r\n\t\tthis.i = 0;\r\n\t\tthis.end = end;\r\n\t\tthis.current = emitter;\r\n\t\tthis.value = value;\r\n\t}\r\n\r\n\tpublic reset() {\r\n\t\tthis.i = this.end; // force any current emission loop to stop, mainly for during dispose\r\n\t\tthis.current = undefined;\r\n\t\tthis.value = undefined;\r\n\t}\r\n}\r\n\r\n\r\nexport class PauseableEmitter<T> extends Emitter<T> {\r\n\r\n\tprivate _isPaused = 0;\r\n\tprotected _eventQueue = new LinkedList<T>();\r\n\tprivate _mergeFn?: (input: T[]) => T;\r\n\r\n\tconstructor(options?: EmitterOptions & { merge?: (input: T[]) => T }) {\r\n\t\tsuper(options);\r\n\t\tthis._mergeFn = options?.merge;\r\n\t}\r\n\r\n\tpause(): void {\r\n\t\tthis._isPaused++;\r\n\t}\r\n\r\n\tresume(): void {\r\n\t\tif (this._isPaused !== 0 && --this._isPaused === 0) {\r\n\t\t\tif (this._mergeFn) {\r\n\t\t\t\t// use the merge function to create a single composite\r\n\t\t\t\t// event. make a copy in case firing pauses this emitter\r\n\t\t\t\tif (this._eventQueue.size > 0) {\r\n\t\t\t\t\tconst events = Array.from(this._eventQueue);\r\n\t\t\t\t\tthis._eventQueue.clear();\r\n\t\t\t\t\tsuper.fire(this._mergeFn(events));\r\n\t\t\t\t}\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// no merging, fire each event individually and test\r\n\t\t\t\t// that this emitter isn't paused halfway through\r\n\t\t\t\twhile (!this._isPaused && this._eventQueue.size !== 0) {\r\n\t\t\t\t\tsuper.fire(this._eventQueue.shift()!);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\toverride fire(event: T): void {\r\n\t\tif (this._size) {\r\n\t\t\tif (this._isPaused !== 0) {\r\n\t\t\t\tthis._eventQueue.push(event);\r\n\t\t\t} else {\r\n\t\t\t\tsuper.fire(event);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class DebounceEmitter<T> extends PauseableEmitter<T> {\r\n\r\n\tprivate readonly _delay: number;\r\n\tprivate _handle: any | undefined;\r\n\r\n\tconstructor(options: EmitterOptions & { merge: (input: T[]) => T; delay?: number }) {\r\n\t\tsuper(options);\r\n\t\tthis._delay = options.delay ?? 100;\r\n\t}\r\n\r\n\toverride fire(event: T): void {\r\n\t\tif (!this._handle) {\r\n\t\t\tthis.pause();\r\n\t\t\tthis._handle = setTimeout(() => {\r\n\t\t\t\tthis._handle = undefined;\r\n\t\t\t\tthis.resume();\r\n\t\t\t}, this._delay);\r\n\t\t}\r\n\t\tsuper.fire(event);\r\n\t}\r\n}\r\n\r\n/**\r\n * An emitter which queue all events and then process them at the\r\n * end of the event loop.\r\n */\r\nexport class MicrotaskEmitter<T> extends Emitter<T> {\r\n\tprivate _queuedEvents: T[] = [];\r\n\tprivate _mergeFn?: (input: T[]) => T;\r\n\r\n\tconstructor(options?: EmitterOptions & { merge?: (input: T[]) => T }) {\r\n\t\tsuper(options);\r\n\t\tthis._mergeFn = options?.merge;\r\n\t}\r\n\toverride fire(event: T): void {\r\n\r\n\t\tif (!this.hasListeners()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._queuedEvents.push(event);\r\n\t\tif (this._queuedEvents.length === 1) {\r\n\t\t\tqueueMicrotask(() => {\r\n\t\t\t\tif (this._mergeFn) {\r\n\t\t\t\t\tsuper.fire(this._mergeFn(this._queuedEvents));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._queuedEvents.forEach(e => super.fire(e));\r\n\t\t\t\t}\r\n\t\t\t\tthis._queuedEvents = [];\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * An event emitter that multiplexes many events into a single event.\r\n *\r\n * @example Listen to the `onData` event of all `Thing`s, dynamically adding and removing `Thing`s\r\n * to the multiplexer as needed.\r\n *\r\n * ```typescript\r\n * const anythingDataMultiplexer = new EventMultiplexer<{ data: string }>();\r\n *\r\n * const thingListeners = DisposableMap<Thing, IDisposable>();\r\n *\r\n * thingService.onDidAddThing(thing => {\r\n *   thingListeners.set(thing, anythingDataMultiplexer.add(thing.onData);\r\n * });\r\n * thingService.onDidRemoveThing(thing => {\r\n *   thingListeners.deleteAndDispose(thing);\r\n * });\r\n *\r\n * anythingDataMultiplexer.event(e => {\r\n *   console.log('Something fired data ' + e.data)\r\n * });\r\n * ```\r\n */\r\nexport class EventMultiplexer<T> implements IDisposable {\r\n\r\n\tprivate readonly emitter: Emitter<T>;\r\n\tprivate hasListeners = false;\r\n\tprivate events: { event: Event<T>; listener: IDisposable | null }[] = [];\r\n\r\n\tconstructor() {\r\n\t\tthis.emitter = new Emitter<T>({\r\n\t\t\tonWillAddFirstListener: () => this.onFirstListenerAdd(),\r\n\t\t\tonDidRemoveLastListener: () => this.onLastListenerRemove()\r\n\t\t});\r\n\t}\r\n\r\n\tget event(): Event<T> {\r\n\t\treturn this.emitter.event;\r\n\t}\r\n\r\n\tadd(event: Event<T>): IDisposable {\r\n\t\tconst e = { event: event, listener: null };\r\n\t\tthis.events.push(e);\r\n\r\n\t\tif (this.hasListeners) {\r\n\t\t\tthis.hook(e);\r\n\t\t}\r\n\r\n\t\tconst dispose = () => {\r\n\t\t\tif (this.hasListeners) {\r\n\t\t\t\tthis.unhook(e);\r\n\t\t\t}\r\n\r\n\t\t\tconst idx = this.events.indexOf(e);\r\n\t\t\tthis.events.splice(idx, 1);\r\n\t\t};\r\n\r\n\t\treturn toDisposable(onceFn(dispose));\r\n\t}\r\n\r\n\tprivate onFirstListenerAdd(): void {\r\n\t\tthis.hasListeners = true;\r\n\t\tthis.events.forEach(e => this.hook(e));\r\n\t}\r\n\r\n\tprivate onLastListenerRemove(): void {\r\n\t\tthis.hasListeners = false;\r\n\t\tthis.events.forEach(e => this.unhook(e));\r\n\t}\r\n\r\n\tprivate hook(e: { event: Event<T>; listener: IDisposable | null }): void {\r\n\t\te.listener = e.event(r => this.emitter.fire(r));\r\n\t}\r\n\r\n\tprivate unhook(e: { event: Event<T>; listener: IDisposable | null }): void {\r\n\t\tif (e.listener) {\r\n\t\t\te.listener.dispose();\r\n\t\t}\r\n\t\te.listener = null;\r\n\t}\r\n\r\n\tdispose(): void {\r\n\t\tthis.emitter.dispose();\r\n\t}\r\n}\r\n\r\n/**\r\n * The EventBufferer is useful in situations in which you want\r\n * to delay firing your events during some code.\r\n * You can wrap that code and be sure that the event will not\r\n * be fired during that wrap.\r\n *\r\n * ```\r\n * const emitter: Emitter;\r\n * const delayer = new EventDelayer();\r\n * const delayedEvent = delayer.wrapEvent(emitter.event);\r\n *\r\n * delayedEvent(console.log);\r\n *\r\n * delayer.bufferEvents(() => {\r\n *   emitter.fire(); // event will not be fired yet\r\n * });\r\n *\r\n * // event will only be fired at this point\r\n * ```\r\n */\r\nexport class EventBufferer {\r\n\r\n\tprivate buffers: Function[][] = [];\r\n\r\n\twrapEvent<T>(event: Event<T>): Event<T> {\r\n\t\treturn (listener, thisArgs?, disposables?) => {\r\n\t\t\treturn event(i => {\r\n\t\t\t\tconst buffer = this.buffers[this.buffers.length - 1];\r\n\r\n\t\t\t\tif (buffer) {\r\n\t\t\t\t\tbuffer.push(() => listener.call(thisArgs, i));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlistener.call(thisArgs, i);\r\n\t\t\t\t}\r\n\t\t\t}, undefined, disposables);\r\n\t\t};\r\n\t}\r\n\r\n\tbufferEvents<R = void>(fn: () => R): R {\r\n\t\tconst buffer: Array<() => R> = [];\r\n\t\tthis.buffers.push(buffer);\r\n\t\tconst r = fn();\r\n\t\tthis.buffers.pop();\r\n\t\tbuffer.forEach(flush => flush());\r\n\t\treturn r;\r\n\t}\r\n}\r\n\r\n/**\r\n * A Relay is an event forwarder which functions as a replugabble event pipe.\r\n * Once created, you can connect an input event to it and it will simply forward\r\n * events from that input event through its own `event` property. The `input`\r\n * can be changed at any point in time.\r\n */\r\nexport class Relay<T> implements IDisposable {\r\n\r\n\tprivate listening = false;\r\n\tprivate inputEvent: Event<T> = Event.None;\r\n\tprivate inputEventListener: IDisposable = Disposable.None;\r\n\r\n\tprivate readonly emitter = new Emitter<T>({\r\n\t\tonDidAddFirstListener: () => {\r\n\t\t\tthis.listening = true;\r\n\t\t\tthis.inputEventListener = this.inputEvent(this.emitter.fire, this.emitter);\r\n\t\t},\r\n\t\tonDidRemoveLastListener: () => {\r\n\t\t\tthis.listening = false;\r\n\t\t\tthis.inputEventListener.dispose();\r\n\t\t}\r\n\t});\r\n\r\n\treadonly event: Event<T> = this.emitter.event;\r\n\r\n\tset input(event: Event<T>) {\r\n\t\tthis.inputEvent = event;\r\n\r\n\t\tif (this.listening) {\r\n\t\t\tthis.inputEventListener.dispose();\r\n\t\t\tthis.inputEventListener = event(this.emitter.fire, this.emitter);\r\n\t\t}\r\n\t}\r\n\r\n\tdispose() {\r\n\t\tthis.inputEventListener.dispose();\r\n\t\tthis.emitter.dispose();\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { Emitter, Event } from 'vs/base/common/event';\r\nimport { IDisposable } from 'vs/base/common/lifecycle';\r\n\r\nexport interface CancellationToken {\r\n\r\n\t/**\r\n\t * A flag signalling is cancellation has been requested.\r\n\t */\r\n\treadonly isCancellationRequested: boolean;\r\n\r\n\t/**\r\n\t * An event which fires when cancellation is requested. This event\r\n\t * only ever fires `once` as cancellation can only happen once. Listeners\r\n\t * that are registered after cancellation will be called (next event loop run),\r\n\t * but also only once.\r\n\t *\r\n\t * @event\r\n\t */\r\n\treadonly onCancellationRequested: (listener: (e: any) => any, thisArgs?: any, disposables?: IDisposable[]) => IDisposable;\r\n}\r\n\r\nconst shortcutEvent: Event<any> = Object.freeze(function (callback, context?): IDisposable {\r\n\tconst handle = setTimeout(callback.bind(context), 0);\r\n\treturn { dispose() { clearTimeout(handle); } };\r\n});\r\n\r\nexport namespace CancellationToken {\r\n\r\n\texport function isCancellationToken(thing: unknown): thing is CancellationToken {\r\n\t\tif (thing === CancellationToken.None || thing === CancellationToken.Cancelled) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (thing instanceof MutableToken) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (!thing || typeof thing !== 'object') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn typeof (thing as CancellationToken).isCancellationRequested === 'boolean'\r\n\t\t\t&& typeof (thing as CancellationToken).onCancellationRequested === 'function';\r\n\t}\r\n\r\n\r\n\texport const None = Object.freeze<CancellationToken>({\r\n\t\tisCancellationRequested: false,\r\n\t\tonCancellationRequested: Event.None\r\n\t});\r\n\r\n\texport const Cancelled = Object.freeze<CancellationToken>({\r\n\t\tisCancellationRequested: true,\r\n\t\tonCancellationRequested: shortcutEvent\r\n\t});\r\n}\r\n\r\nclass MutableToken implements CancellationToken {\r\n\r\n\tprivate _isCancelled: boolean = false;\r\n\tprivate _emitter: Emitter<any> | null = null;\r\n\r\n\tpublic cancel() {\r\n\t\tif (!this._isCancelled) {\r\n\t\t\tthis._isCancelled = true;\r\n\t\t\tif (this._emitter) {\r\n\t\t\t\tthis._emitter.fire(undefined);\r\n\t\t\t\tthis.dispose();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tget isCancellationRequested(): boolean {\r\n\t\treturn this._isCancelled;\r\n\t}\r\n\r\n\tget onCancellationRequested(): Event<any> {\r\n\t\tif (this._isCancelled) {\r\n\t\t\treturn shortcutEvent;\r\n\t\t}\r\n\t\tif (!this._emitter) {\r\n\t\t\tthis._emitter = new Emitter<any>();\r\n\t\t}\r\n\t\treturn this._emitter.event;\r\n\t}\r\n\r\n\tpublic dispose(): void {\r\n\t\tif (this._emitter) {\r\n\t\t\tthis._emitter.dispose();\r\n\t\t\tthis._emitter = null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class CancellationTokenSource {\r\n\r\n\tprivate _token?: CancellationToken = undefined;\r\n\tprivate _parentListener?: IDisposable = undefined;\r\n\r\n\tconstructor(parent?: CancellationToken) {\r\n\t\tthis._parentListener = parent && parent.onCancellationRequested(this.cancel, this);\r\n\t}\r\n\r\n\tget token(): CancellationToken {\r\n\t\tif (!this._token) {\r\n\t\t\t// be lazy and create the token only when\r\n\t\t\t// actually needed\r\n\t\t\tthis._token = new MutableToken();\r\n\t\t}\r\n\t\treturn this._token;\r\n\t}\r\n\r\n\tcancel(): void {\r\n\t\tif (!this._token) {\r\n\t\t\t// save an object by returning the default\r\n\t\t\t// cancelled token when cancellation happens\r\n\t\t\t// before someone asks for the token\r\n\t\t\tthis._token = CancellationToken.Cancelled;\r\n\r\n\t\t} else if (this._token instanceof MutableToken) {\r\n\t\t\t// actually cancel\r\n\t\t\tthis._token.cancel();\r\n\t\t}\r\n\t}\r\n\r\n\tdispose(cancel: boolean = false): void {\r\n\t\tif (cancel) {\r\n\t\t\tthis.cancel();\r\n\t\t}\r\n\t\tthis._parentListener?.dispose();\r\n\t\tif (!this._token) {\r\n\t\t\t// ensure to initialize with an empty token if we had none\r\n\t\t\tthis._token = CancellationToken.None;\r\n\r\n\t\t} else if (this._token instanceof MutableToken) {\r\n\t\t\t// actually dispose\r\n\t\t\tthis._token.dispose();\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * [] export\r\n * export function isFalsyOrWhitespace\r\n * export function format\r\n * export function format2\r\n * export function escape\r\n * export function escapeRegExpCharacters\r\n * export function count\r\n * ...\r\n *\r\n *\r\n *\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { LRUCachedFunction } from 'vs/base/common/cache';\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { Lazy } from 'vs/base/common/lazy';\r\nimport { Constants } from 'vs/base/common/uint';\r\n\r\nexport function isFalsyOrWhitespace(str: string | undefined): boolean {\r\n\tif (!str || typeof str !== 'string') {\r\n\t\treturn true;\r\n\t}\r\n\treturn str.trim().length === 0;\r\n}\r\n\r\nconst _formatRegexp = /{(\\d+)}/g;\r\n\r\n/**\r\n * Helper to produce a string with a variable number of arguments. Insert variable segments\r\n * into the string using the {n} notation where N is the index of the argument following the string.\r\n * @param value string to which formatting is applied\r\n * @param args replacements for {n}-entries\r\n */\r\nexport function format(value: string, ...args: any[]): string {\r\n\tif (args.length === 0) {\r\n\t\treturn value;\r\n\t}\r\n\treturn value.replace(_formatRegexp, function (match, group) {\r\n\t\tconst idx = parseInt(group, 10);\r\n\t\treturn isNaN(idx) || idx < 0 || idx >= args.length ?\r\n\t\t\tmatch :\r\n\t\t\targs[idx];\r\n\t});\r\n}\r\n\r\n/**\r\n * Converts HTML characters inside the string to use entities instead. Makes the string safe from\r\n * being used e.g. in HTMLElement.innerHTML.\r\n */\r\nexport function escape(html: string): string {\r\n\treturn html.replace(/[<>&]/g, function (match) {\r\n\t\tswitch (match) {\r\n\t\t\tcase '<': return '&lt;';\r\n\t\t\tcase '>': return '&gt;';\r\n\t\t\tcase '&': return '&amp;';\r\n\t\t\tdefault: return match;\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/**\r\n * Escapes regular expression characters in a given string\r\n */\r\nexport function escapeRegExpCharacters(value: string): string {\r\n\treturn value.replace(/[\\\\\\{\\}\\*\\+\\?\\|\\^\\$\\.\\[\\]\\(\\)]/g, '\\\\$&');\r\n}\r\n\r\n/**\r\n * Removes all occurrences of needle from the beginning and end of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim (default is a blank)\r\n */\r\nexport function trim(haystack: string, needle: string = ' '): string {\r\n\tconst trimmed = ltrim(haystack, needle);\r\n\treturn rtrim(trimmed, needle);\r\n}\r\n\r\n/**\r\n * Removes all occurrences of needle from the beginning of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim\r\n */\r\nexport function ltrim(haystack: string, needle: string): string {\r\n\tif (!haystack || !needle) {\r\n\t\treturn haystack;\r\n\t}\r\n\r\n\tconst needleLen = needle.length;\r\n\tif (needleLen === 0 || haystack.length === 0) {\r\n\t\treturn haystack;\r\n\t}\r\n\r\n\tlet offset = 0;\r\n\r\n\twhile (haystack.indexOf(needle, offset) === offset) {\r\n\t\toffset = offset + needleLen;\r\n\t}\r\n\treturn haystack.substring(offset);\r\n}\r\n\r\n/**\r\n * Removes all occurrences of needle from the end of haystack.\r\n * @param haystack string to trim\r\n * @param needle the thing to trim\r\n */\r\nexport function rtrim(haystack: string, needle: string): string {\r\n\tif (!haystack || !needle) {\r\n\t\treturn haystack;\r\n\t}\r\n\r\n\tconst needleLen = needle.length,\r\n\t\thaystackLen = haystack.length;\r\n\r\n\tif (needleLen === 0 || haystackLen === 0) {\r\n\t\treturn haystack;\r\n\t}\r\n\r\n\tlet offset = haystackLen,\r\n\t\tidx = -1;\r\n\r\n\twhile (true) {\r\n\t\tidx = haystack.lastIndexOf(needle, offset - 1);\r\n\t\tif (idx === -1 || idx + needleLen !== offset) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tif (idx === 0) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\toffset = idx;\r\n\t}\r\n\r\n\treturn haystack.substring(0, offset);\r\n}\r\n\r\nexport function convertSimple2RegExpPattern(pattern: string): string {\r\n\treturn pattern.replace(/[\\-\\\\\\{\\}\\+\\?\\|\\^\\$\\.\\,\\[\\]\\(\\)\\#\\s]/g, '\\\\$&').replace(/[\\*]/g, '.*');\r\n}\r\n\r\nexport function stripWildcards(pattern: string): string {\r\n\treturn pattern.replace(/\\*/g, '');\r\n}\r\n\r\nexport interface RegExpOptions {\r\n\tmatchCase?: boolean;\r\n\twholeWord?: boolean;\r\n\tmultiline?: boolean;\r\n\tglobal?: boolean;\r\n\tunicode?: boolean;\r\n}\r\n\r\nexport function createRegExp(searchString: string, isRegex: boolean, options: RegExpOptions = {}): RegExp {\r\n\tif (!searchString) {\r\n\t\tthrow new Error('Cannot create regex from empty string');\r\n\t}\r\n\tif (!isRegex) {\r\n\t\tsearchString = escapeRegExpCharacters(searchString);\r\n\t}\r\n\tif (options.wholeWord) {\r\n\t\tif (!/\\B/.test(searchString.charAt(0))) {\r\n\t\t\tsearchString = '\\\\b' + searchString;\r\n\t\t}\r\n\t\tif (!/\\B/.test(searchString.charAt(searchString.length - 1))) {\r\n\t\t\tsearchString = searchString + '\\\\b';\r\n\t\t}\r\n\t}\r\n\tlet modifiers = '';\r\n\tif (options.global) {\r\n\t\tmodifiers += 'g';\r\n\t}\r\n\tif (!options.matchCase) {\r\n\t\tmodifiers += 'i';\r\n\t}\r\n\tif (options.multiline) {\r\n\t\tmodifiers += 'm';\r\n\t}\r\n\tif (options.unicode) {\r\n\t\tmodifiers += 'u';\r\n\t}\r\n\r\n\treturn new RegExp(searchString, modifiers);\r\n}\r\n\r\nexport function regExpLeadsToEndlessLoop(regexp: RegExp): boolean {\r\n\t// Exit early if it's one of these special cases which are meant to match\r\n\t// against an empty string\r\n\tif (regexp.source === '^' || regexp.source === '^$' || regexp.source === '$' || regexp.source === '^\\\\s*$') {\r\n\t\treturn false;\r\n\t}\r\n\r\n\t// We check against an empty string. If the regular expression doesn't advance\r\n\t// (e.g. ends in an endless loop) it will match an empty string.\r\n\tconst match = regexp.exec('');\r\n\treturn !!(match && regexp.lastIndex === 0);\r\n}\r\n\r\nexport function splitLines(str: string): string[] {\r\n\treturn str.split(/\\r\\n|\\r|\\n/);\r\n}\r\n\r\n/**\r\n * Returns first index of the string that is not whitespace.\r\n * - If string is `empty` or contains `only whitespaces`, returns -1\r\n */\r\nexport function firstNonWhitespaceIndex(str: string): number {\r\n\tfor (let i = 0, len = str.length; i < len; i++) {\r\n\t\tconst chCode = str.charCodeAt(i);\r\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\n/**\r\n * Returns the leading whitespace of the string.\r\n * If the string contains only whitespaces, returns entire string\r\n */\r\nexport function getLeadingWhitespace(str: string, start: number = 0, end: number = str.length): string {\r\n\tfor (let i = start; i < end; i++) {\r\n\t\tconst chCode = str.charCodeAt(i);\r\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\r\n\t\t\treturn str.substring(start, i);\r\n\t\t}\r\n\t}\r\n\treturn str.substring(start, end);\r\n}\r\n\r\n/**\r\n * Returns last index of the string that is not whitespace.\r\n * If string is empty or contains only whitespaces, returns -1\r\n */\r\nexport function lastNonWhitespaceIndex(str: string, startIndex: number = str.length - 1): number {\r\n\tfor (let i = startIndex; i >= 0; i--) {\r\n\t\tconst chCode = str.charCodeAt(i);\r\n\t\tif (chCode !== CharCode.Space && chCode !== CharCode.Tab) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\treturn -1;\r\n}\r\n\r\nexport function compare(a: string, b: string): number {\r\n\tif (a < b) {\r\n\t\treturn -1;\r\n\t} else if (a > b) {\r\n\t\treturn 1;\r\n\t} else {\r\n\t\treturn 0;\r\n\t}\r\n}\r\n\r\nexport function compareSubstring(a: string, b: string, aStart: number = 0, aEnd: number = a.length, bStart: number = 0, bEnd: number = b.length): number {\r\n\tfor (; aStart < aEnd && bStart < bEnd; aStart++, bStart++) {\r\n\t\tconst codeA = a.charCodeAt(aStart);\r\n\t\tconst codeB = b.charCodeAt(bStart);\r\n\t\tif (codeA < codeB) {\r\n\t\t\treturn -1;\r\n\t\t} else if (codeA > codeB) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t}\r\n\tconst aLen = aEnd - aStart;\r\n\tconst bLen = bEnd - bStart;\r\n\tif (aLen < bLen) {\r\n\t\treturn -1;\r\n\t} else if (aLen > bLen) {\r\n\t\treturn 1;\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\nexport function compareIgnoreCase(a: string, b: string): number {\r\n\treturn compareSubstringIgnoreCase(a, b, 0, a.length, 0, b.length);\r\n}\r\n\r\nexport function compareSubstringIgnoreCase(a: string, b: string, aStart: number = 0, aEnd: number = a.length, bStart: number = 0, bEnd: number = b.length): number {\r\n\r\n\tfor (; aStart < aEnd && bStart < bEnd; aStart++, bStart++) {\r\n\r\n\t\tlet codeA = a.charCodeAt(aStart);\r\n\t\tlet codeB = b.charCodeAt(bStart);\r\n\r\n\t\tif (codeA === codeB) {\r\n\t\t\t// equal\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (codeA >= 128 || codeB >= 128) {\r\n\t\t\t// not ASCII letters -> fallback to lower-casing strings\r\n\t\t\treturn compareSubstring(a.toLowerCase(), b.toLowerCase(), aStart, aEnd, bStart, bEnd);\r\n\t\t}\r\n\r\n\t\t// mapper lower-case ascii letter onto upper-case varinats\r\n\t\t// [97-122] (lower ascii) --> [65-90] (upper ascii)\r\n\t\tif (isLowerAsciiLetter(codeA)) {\r\n\t\t\tcodeA -= 32;\r\n\t\t}\r\n\t\tif (isLowerAsciiLetter(codeB)) {\r\n\t\t\tcodeB -= 32;\r\n\t\t}\r\n\r\n\t\t// compare both code points\r\n\t\tconst diff = codeA - codeB;\r\n\t\tif (diff === 0) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\treturn diff;\r\n\t}\r\n\r\n\tconst aLen = aEnd - aStart;\r\n\tconst bLen = bEnd - bStart;\r\n\r\n\tif (aLen < bLen) {\r\n\t\treturn -1;\r\n\t} else if (aLen > bLen) {\r\n\t\treturn 1;\r\n\t}\r\n\r\n\treturn 0;\r\n}\r\n\r\nexport function isAsciiDigit(code: number): boolean {\r\n\treturn code >= CharCode.Digit0 && code <= CharCode.Digit9;\r\n}\r\n\r\nexport function isLowerAsciiLetter(code: number): boolean {\r\n\treturn code >= CharCode.a && code <= CharCode.z;\r\n}\r\n\r\nexport function isUpperAsciiLetter(code: number): boolean {\r\n\treturn code >= CharCode.A && code <= CharCode.Z;\r\n}\r\n\r\nexport function equalsIgnoreCase(a: string, b: string): boolean {\r\n\treturn a.length === b.length && compareSubstringIgnoreCase(a, b) === 0;\r\n}\r\n\r\nexport function startsWithIgnoreCase(str: string, candidate: string): boolean {\r\n\tconst candidateLength = candidate.length;\r\n\tif (candidate.length > str.length) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\treturn compareSubstringIgnoreCase(str, candidate, 0, candidateLength) === 0;\r\n}\r\n\r\n/**\r\n * @returns the length of the common prefix of the two strings.\r\n */\r\nexport function commonPrefixLength(a: string, b: string): number {\r\n\r\n\tconst len = Math.min(a.length, b.length);\r\n\tlet i: number;\r\n\r\n\tfor (i = 0; i < len; i++) {\r\n\t\tif (a.charCodeAt(i) !== b.charCodeAt(i)) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\r\n\treturn len;\r\n}\r\n\r\n/**\r\n * @returns the length of the common suffix of the two strings.\r\n */\r\nexport function commonSuffixLength(a: string, b: string): number {\r\n\r\n\tconst len = Math.min(a.length, b.length);\r\n\tlet i: number;\r\n\r\n\tconst aLastIndex = a.length - 1;\r\n\tconst bLastIndex = b.length - 1;\r\n\r\n\tfor (i = 0; i < len; i++) {\r\n\t\tif (a.charCodeAt(aLastIndex - i) !== b.charCodeAt(bLastIndex - i)) {\r\n\t\t\treturn i;\r\n\t\t}\r\n\t}\r\n\r\n\treturn len;\r\n}\r\n\r\n/**\r\n * See http://en.wikipedia.org/wiki/Surrogate_pair\r\n */\r\nexport function isHighSurrogate(charCode: number): boolean {\r\n\treturn (0xD800 <= charCode && charCode <= 0xDBFF);\r\n}\r\n\r\n/**\r\n * See http://en.wikipedia.org/wiki/Surrogate_pair\r\n */\r\nexport function isLowSurrogate(charCode: number): boolean {\r\n\treturn (0xDC00 <= charCode && charCode <= 0xDFFF);\r\n}\r\n\r\n/**\r\n * See http://en.wikipedia.org/wiki/Surrogate_pair\r\n */\r\nexport function computeCodePoint(highSurrogate: number, lowSurrogate: number): number {\r\n\treturn ((highSurrogate - 0xD800) << 10) + (lowSurrogate - 0xDC00) + 0x10000;\r\n}\r\n\r\n/**\r\n * get the code point that begins at offset `offset`\r\n */\r\nexport function getNextCodePoint(str: string, len: number, offset: number): number {\r\n\tconst charCode = str.charCodeAt(offset);\r\n\tif (isHighSurrogate(charCode) && offset + 1 < len) {\r\n\t\tconst nextCharCode = str.charCodeAt(offset + 1);\r\n\t\tif (isLowSurrogate(nextCharCode)) {\r\n\t\t\treturn computeCodePoint(charCode, nextCharCode);\r\n\t\t}\r\n\t}\r\n\treturn charCode;\r\n}\r\n\r\n/**\r\n * get the code point that ends right before offset `offset`\r\n */\r\nfunction getPrevCodePoint(str: string, offset: number): number {\r\n\tconst charCode = str.charCodeAt(offset - 1);\r\n\tif (isLowSurrogate(charCode) && offset > 1) {\r\n\t\tconst prevCharCode = str.charCodeAt(offset - 2);\r\n\t\tif (isHighSurrogate(prevCharCode)) {\r\n\t\t\treturn computeCodePoint(prevCharCode, charCode);\r\n\t\t}\r\n\t}\r\n\treturn charCode;\r\n}\r\n\r\nexport class CodePointIterator {\r\n\r\n\tprivate readonly _str: string;\r\n\tprivate readonly _len: number;\r\n\tprivate _offset: number;\r\n\r\n\tpublic get offset(): number {\r\n\t\treturn this._offset;\r\n\t}\r\n\r\n\tconstructor(str: string, offset: number = 0) {\r\n\t\tthis._str = str;\r\n\t\tthis._len = str.length;\r\n\t\tthis._offset = offset;\r\n\t}\r\n\r\n\tpublic setOffset(offset: number): void {\r\n\t\tthis._offset = offset;\r\n\t}\r\n\r\n\tpublic prevCodePoint(): number {\r\n\t\tconst codePoint = getPrevCodePoint(this._str, this._offset);\r\n\t\tthis._offset -= (codePoint >= Constants.UNICODE_SUPPLEMENTARY_PLANE_BEGIN ? 2 : 1);\r\n\t\treturn codePoint;\r\n\t}\r\n\r\n\tpublic nextCodePoint(): number {\r\n\t\tconst codePoint = getNextCodePoint(this._str, this._len, this._offset);\r\n\t\tthis._offset += (codePoint >= Constants.UNICODE_SUPPLEMENTARY_PLANE_BEGIN ? 2 : 1);\r\n\t\treturn codePoint;\r\n\t}\r\n\r\n\tpublic eol(): boolean {\r\n\t\treturn (this._offset >= this._len);\r\n\t}\r\n}\r\n\r\nexport class GraphemeIterator {\r\n\r\n\tprivate readonly _iterator: CodePointIterator;\r\n\r\n\tpublic get offset(): number {\r\n\t\treturn this._iterator.offset;\r\n\t}\r\n\r\n\tconstructor(str: string, offset: number = 0) {\r\n\t\tthis._iterator = new CodePointIterator(str, offset);\r\n\t}\r\n\r\n\tpublic nextGraphemeLength(): number {\r\n\t\tconst graphemeBreakTree = GraphemeBreakTree.getInstance();\r\n\t\tconst iterator = this._iterator;\r\n\t\tconst initialOffset = iterator.offset;\r\n\r\n\t\tlet graphemeBreakType = graphemeBreakTree.getGraphemeBreakType(iterator.nextCodePoint());\r\n\t\twhile (!iterator.eol()) {\r\n\t\t\tconst offset = iterator.offset;\r\n\t\t\tconst nextGraphemeBreakType = graphemeBreakTree.getGraphemeBreakType(iterator.nextCodePoint());\r\n\t\t\tif (breakBetweenGraphemeBreakType(graphemeBreakType, nextGraphemeBreakType)) {\r\n\t\t\t\t// move iterator back\r\n\t\t\t\titerator.setOffset(offset);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tgraphemeBreakType = nextGraphemeBreakType;\r\n\t\t}\r\n\t\treturn (iterator.offset - initialOffset);\r\n\t}\r\n\r\n\tpublic prevGraphemeLength(): number {\r\n\t\tconst graphemeBreakTree = GraphemeBreakTree.getInstance();\r\n\t\tconst iterator = this._iterator;\r\n\t\tconst initialOffset = iterator.offset;\r\n\r\n\t\tlet graphemeBreakType = graphemeBreakTree.getGraphemeBreakType(iterator.prevCodePoint());\r\n\t\twhile (iterator.offset > 0) {\r\n\t\t\tconst offset = iterator.offset;\r\n\t\t\tconst prevGraphemeBreakType = graphemeBreakTree.getGraphemeBreakType(iterator.prevCodePoint());\r\n\t\t\tif (breakBetweenGraphemeBreakType(prevGraphemeBreakType, graphemeBreakType)) {\r\n\t\t\t\t// move iterator back\r\n\t\t\t\titerator.setOffset(offset);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tgraphemeBreakType = prevGraphemeBreakType;\r\n\t\t}\r\n\t\treturn (initialOffset - iterator.offset);\r\n\t}\r\n\r\n\tpublic eol(): boolean {\r\n\t\treturn this._iterator.eol();\r\n\t}\r\n}\r\n\r\nexport function nextCharLength(str: string, initialOffset: number): number {\r\n\tconst iterator = new GraphemeIterator(str, initialOffset);\r\n\treturn iterator.nextGraphemeLength();\r\n}\r\n\r\nexport function prevCharLength(str: string, initialOffset: number): number {\r\n\tconst iterator = new GraphemeIterator(str, initialOffset);\r\n\treturn iterator.prevGraphemeLength();\r\n}\r\n\r\nexport function getCharContainingOffset(str: string, offset: number): [number, number] {\r\n\tif (offset > 0 && isLowSurrogate(str.charCodeAt(offset))) {\r\n\t\toffset--;\r\n\t}\r\n\tconst endOffset = offset + nextCharLength(str, offset);\r\n\tconst startOffset = endOffset - prevCharLength(str, endOffset);\r\n\treturn [startOffset, endOffset];\r\n}\r\n\r\nlet CONTAINS_RTL: RegExp | undefined = undefined;\r\n\r\nfunction makeContainsRtl() {\r\n\t// Generated using https://github.com/alexdima/unicode-utils/blob/main/rtl-test.js\r\n\treturn /(?:[\\u05BE\\u05C0\\u05C3\\u05C6\\u05D0-\\u05F4\\u0608\\u060B\\u060D\\u061B-\\u064A\\u066D-\\u066F\\u0671-\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1-\\u07EA\\u07F4\\u07F5\\u07FA\\u07FE-\\u0815\\u081A\\u0824\\u0828\\u0830-\\u0858\\u085E-\\u088E\\u08A0-\\u08C9\\u200F\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFD3D\\uFD50-\\uFDC7\\uFDF0-\\uFDFC\\uFE70-\\uFEFC]|\\uD802[\\uDC00-\\uDD1B\\uDD20-\\uDE00\\uDE10-\\uDE35\\uDE40-\\uDEE4\\uDEEB-\\uDF35\\uDF40-\\uDFFF]|\\uD803[\\uDC00-\\uDD23\\uDE80-\\uDEA9\\uDEAD-\\uDF45\\uDF51-\\uDF81\\uDF86-\\uDFF6]|\\uD83A[\\uDC00-\\uDCCF\\uDD00-\\uDD43\\uDD4B-\\uDFFF]|\\uD83B[\\uDC00-\\uDEBB])/;\r\n}\r\n\r\n/**\r\n * ToDo: RTL    \\\r\n * Returns true if `str` contains any Unicode character that is classified as \"R(=RTL)\" or \"AL( )\".\r\n */\r\nexport function containsRTL(str: string): boolean {\r\n\tif (!CONTAINS_RTL) {\r\n\t\tCONTAINS_RTL = makeContainsRtl();\r\n\t}\r\n\r\n\treturn CONTAINS_RTL.test(str);\r\n}\r\n\r\nconst IS_BASIC_ASCII = /^[\\t\\n\\r\\x20-\\x7E]*$/;\r\n/**\r\n * `str` , ,  ([32 - 126])  `\\n`, `\\r`, `\\t`  `true` \r\n */\r\nexport function isBasicASCII(str: string): boolean {\r\n\treturn IS_BASIC_ASCII.test(str);\r\n}\r\n\r\nexport const UNUSUAL_LINE_TERMINATORS = /[\\u2028\\u2029]/; // LINE SEPARATOR (LS) or PARAGRAPH SEPARATOR (PS)\r\n/**\r\n * Returns true if `str` contains unusual line terminators, like LS or PS\r\n */\r\nexport function containsUnusualLineTerminators(str: string): boolean {\r\n\treturn UNUSUAL_LINE_TERMINATORS.test(str);\r\n}\r\n\r\nexport function isFullWidthCharacter(charCode: number): boolean {\r\n\t// Do a cheap trick to better support wrapping of wide characters, treat them as 2 columns\r\n\t// http://jrgraphix.net/research/unicode_blocks.php\r\n\t//          2E80 - 2EFF   CJK Radicals Supplement\r\n\t//          2F00 - 2FDF   Kangxi Radicals\r\n\t//          2FF0 - 2FFF   Ideographic Description Characters\r\n\t//          3000 - 303F   CJK Symbols and Punctuation\r\n\t//          3040 - 309F   Hiragana\r\n\t//          30A0 - 30FF   Katakana\r\n\t//          3100 - 312F   Bopomofo\r\n\t//          3130 - 318F   Hangul Compatibility Jamo\r\n\t//          3190 - 319F   Kanbun\r\n\t//          31A0 - 31BF   Bopomofo Extended\r\n\t//          31F0 - 31FF   Katakana Phonetic Extensions\r\n\t//          3200 - 32FF   Enclosed CJK Letters and Months\r\n\t//          3300 - 33FF   CJK Compatibility\r\n\t//          3400 - 4DBF   CJK Unified Ideographs Extension A\r\n\t//          4DC0 - 4DFF   Yijing Hexagram Symbols\r\n\t//          4E00 - 9FFF   CJK Unified Ideographs\r\n\t//          A000 - A48F   Yi Syllables\r\n\t//          A490 - A4CF   Yi Radicals\r\n\t//          AC00 - D7AF   Hangul Syllables\r\n\t// [IGNORE] D800 - DB7F   High Surrogates\r\n\t// [IGNORE] DB80 - DBFF   High Private Use Surrogates\r\n\t// [IGNORE] DC00 - DFFF   Low Surrogates\r\n\t// [IGNORE] E000 - F8FF   Private Use Area\r\n\t//          F900 - FAFF   CJK Compatibility Ideographs\r\n\t// [IGNORE] FB00 - FB4F   Alphabetic Presentation Forms\r\n\t// [IGNORE] FB50 - FDFF   Arabic Presentation Forms-A\r\n\t// [IGNORE] FE00 - FE0F   Variation Selectors\r\n\t// [IGNORE] FE20 - FE2F   Combining Half Marks\r\n\t// [IGNORE] FE30 - FE4F   CJK Compatibility Forms\r\n\t// [IGNORE] FE50 - FE6F   Small Form Variants\r\n\t// [IGNORE] FE70 - FEFF   Arabic Presentation Forms-B\r\n\t//          FF00 - FFEF   Halfwidth and Fullwidth Forms\r\n\t//               [https://en.wikipedia.org/wiki/Halfwidth_and_fullwidth_forms]\r\n\t//               of which FF01 - FF5E fullwidth ASCII of 21 to 7E\r\n\t// [IGNORE]    and FF65 - FFDC halfwidth of Katakana and Hangul\r\n\t// [IGNORE] FFF0 - FFFF   Specials\r\n\treturn (\r\n\t\t(charCode >= 0x2E80 && charCode <= 0xD7AF)\r\n\t\t|| (charCode >= 0xF900 && charCode <= 0xFAFF)\r\n\t\t|| (charCode >= 0xFF01 && charCode <= 0xFF5E)\r\n\t);\r\n}\r\n\r\n/**\r\n * A fast function (therefore imprecise) to check if code points are emojis.\r\n * Generated using https://github.com/alexdima/unicode-utils/blob/main/emoji-test.js\r\n */\r\nexport function isEmojiImprecise(x: number): boolean {\r\n\treturn (\r\n\t\t(x >= 0x1F1E6 && x <= 0x1F1FF) || (x === 8986) || (x === 8987) || (x === 9200)\r\n\t\t|| (x === 9203) || (x >= 9728 && x <= 10175) || (x === 11088) || (x === 11093)\r\n\t\t|| (x >= 127744 && x <= 128591) || (x >= 128640 && x <= 128764)\r\n\t\t|| (x >= 128992 && x <= 129008) || (x >= 129280 && x <= 129535)\r\n\t\t|| (x >= 129648 && x <= 129782)\r\n\t);\r\n}\r\n\r\n// -- UTF-8 BOM\r\n\r\nexport const UTF8_BOM_CHARACTER = String.fromCharCode(CharCode.UTF8_BOM);\r\n\r\nexport function startsWithUTF8BOM(str: string): boolean {\r\n\treturn !!(str && str.length > 0 && str.charCodeAt(0) === CharCode.UTF8_BOM);\r\n}\r\n\r\nexport function containsUppercaseCharacter(target: string, ignoreEscapedChars = false): boolean {\r\n\tif (!target) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (ignoreEscapedChars) {\r\n\t\ttarget = target.replace(/\\\\./g, '');\r\n\t}\r\n\r\n\treturn target.toLowerCase() !== target;\r\n}\r\n\r\n/**\r\n * Produces 'a'-'z', followed by 'A'-'Z'... followed by 'a'-'z', etc.\r\n */\r\nexport function singleLetterHash(n: number): string {\r\n\tconst LETTERS_CNT = (CharCode.Z - CharCode.A + 1);\r\n\r\n\tn = n % (2 * LETTERS_CNT);\r\n\r\n\tif (n < LETTERS_CNT) {\r\n\t\treturn String.fromCharCode(CharCode.a + n);\r\n\t}\r\n\r\n\treturn String.fromCharCode(CharCode.A + n - LETTERS_CNT);\r\n}\r\n\r\nfunction breakBetweenGraphemeBreakType(breakTypeA: GraphemeBreakType, breakTypeB: GraphemeBreakType): boolean {\r\n\t// http://www.unicode.org/reports/tr29/#Grapheme_Cluster_Boundary_Rules\r\n\r\n\t// !!! Let's make the common case a bit faster\r\n\tif (breakTypeA === GraphemeBreakType.Other) {\r\n\t\t// see https://www.unicode.org/Public/13.0.0/ucd/auxiliary/GraphemeBreakTest-13.0.0d10.html#table\r\n\t\treturn (breakTypeB !== GraphemeBreakType.Extend && breakTypeB !== GraphemeBreakType.SpacingMark);\r\n\t}\r\n\r\n\t// Do not break between a CR and LF. Otherwise, break before and after controls.\r\n\t// GB3                                        CR  LF\r\n\t// GB4                       (Control | CR | LF) \r\n\t// GB5                                            (Control | CR | LF)\r\n\tif (breakTypeA === GraphemeBreakType.CR) {\r\n\t\tif (breakTypeB === GraphemeBreakType.LF) {\r\n\t\t\treturn false; // GB3\r\n\t\t}\r\n\t}\r\n\tif (breakTypeA === GraphemeBreakType.Control || breakTypeA === GraphemeBreakType.CR || breakTypeA === GraphemeBreakType.LF) {\r\n\t\treturn true; // GB4\r\n\t}\r\n\tif (breakTypeB === GraphemeBreakType.Control || breakTypeB === GraphemeBreakType.CR || breakTypeB === GraphemeBreakType.LF) {\r\n\t\treturn true; // GB5\r\n\t}\r\n\r\n\t// Do not break Hangul syllable sequences.\r\n\t// GB6                                         L  (L | V | LV | LVT)\r\n\t// GB7                                  (LV | V)  (V | T)\r\n\t// GB8                                 (LVT | T)  T\r\n\tif (breakTypeA === GraphemeBreakType.L) {\r\n\t\tif (breakTypeB === GraphemeBreakType.L || breakTypeB === GraphemeBreakType.V || breakTypeB === GraphemeBreakType.LV || breakTypeB === GraphemeBreakType.LVT) {\r\n\t\t\treturn false; // GB6\r\n\t\t}\r\n\t}\r\n\tif (breakTypeA === GraphemeBreakType.LV || breakTypeA === GraphemeBreakType.V) {\r\n\t\tif (breakTypeB === GraphemeBreakType.V || breakTypeB === GraphemeBreakType.T) {\r\n\t\t\treturn false; // GB7\r\n\t\t}\r\n\t}\r\n\tif (breakTypeA === GraphemeBreakType.LVT || breakTypeA === GraphemeBreakType.T) {\r\n\t\tif (breakTypeB === GraphemeBreakType.T) {\r\n\t\t\treturn false; // GB8\r\n\t\t}\r\n\t}\r\n\r\n\t// Do not break before extending characters or ZWJ.\r\n\t// GB9                                            (Extend | ZWJ)\r\n\tif (breakTypeB === GraphemeBreakType.Extend || breakTypeB === GraphemeBreakType.ZWJ) {\r\n\t\treturn false; // GB9\r\n\t}\r\n\r\n\t// The GB9a and GB9b rules only apply to extended grapheme clusters:\r\n\t// Do not break before SpacingMarks, or after Prepend characters.\r\n\t// GB9a                                           SpacingMark\r\n\t// GB9b                                  Prepend \r\n\tif (breakTypeB === GraphemeBreakType.SpacingMark) {\r\n\t\treturn false; // GB9a\r\n\t}\r\n\tif (breakTypeA === GraphemeBreakType.Prepend) {\r\n\t\treturn false; // GB9b\r\n\t}\r\n\r\n\t// Do not break within emoji modifier sequences or emoji zwj sequences.\r\n\t// GB11    \\p{Extended_Pictographic} Extend* ZWJ  \\p{Extended_Pictographic}\r\n\tif (breakTypeA === GraphemeBreakType.ZWJ && breakTypeB === GraphemeBreakType.Extended_Pictographic) {\r\n\t\t// Note: we are not implementing the rule entirely here to avoid introducing states\r\n\t\treturn false; // GB11\r\n\t}\r\n\r\n\t// GB12                          sot (RI RI)* RI  RI\r\n\t// GB13                        [^RI] (RI RI)* RI  RI\r\n\tif (breakTypeA === GraphemeBreakType.Regional_Indicator && breakTypeB === GraphemeBreakType.Regional_Indicator) {\r\n\t\t// Note: we are not implementing the rule entirely here to avoid introducing states\r\n\t\treturn false; // GB12 & GB13\r\n\t}\r\n\r\n\t// GB999                                     Any  Any\r\n\treturn true;\r\n}\r\n\r\nexport const enum GraphemeBreakType {\r\n\tOther = 0,\r\n\tPrepend = 1,\r\n\tCR = 2,\r\n\tLF = 3,\r\n\tControl = 4,\r\n\tExtend = 5,\r\n\tRegional_Indicator = 6,\r\n\tSpacingMark = 7,\r\n\tL = 8,\r\n\tV = 9,\r\n\tT = 10,\r\n\tLV = 11,\r\n\tLVT = 12,\r\n\tZWJ = 13,\r\n\tExtended_Pictographic = 14\r\n}\r\n\r\nclass GraphemeBreakTree {\r\n\r\n\tprivate static _INSTANCE: GraphemeBreakTree | null = null;\r\n\tpublic static getInstance(): GraphemeBreakTree {\r\n\t\tif (!GraphemeBreakTree._INSTANCE) {\r\n\t\t\tGraphemeBreakTree._INSTANCE = new GraphemeBreakTree();\r\n\t\t}\r\n\t\treturn GraphemeBreakTree._INSTANCE;\r\n\t}\r\n\r\n\tprivate readonly _data: number[];\r\n\r\n\tconstructor() {\r\n\t\tthis._data = getGraphemeBreakRawData();\r\n\t}\r\n\r\n\tpublic getGraphemeBreakType(codePoint: number): GraphemeBreakType {\r\n\t\t// !!! Let's make 7bit ASCII a bit faster: 0..31\r\n\t\tif (codePoint < 32) {\r\n\t\t\tif (codePoint === CharCode.LineFeed) {\r\n\t\t\t\treturn GraphemeBreakType.LF;\r\n\t\t\t}\r\n\t\t\tif (codePoint === CharCode.CarriageReturn) {\r\n\t\t\t\treturn GraphemeBreakType.CR;\r\n\t\t\t}\r\n\t\t\treturn GraphemeBreakType.Control;\r\n\t\t}\r\n\t\t// !!! Let's make 7bit ASCII a bit faster: 32..126\r\n\t\tif (codePoint < 127) {\r\n\t\t\treturn GraphemeBreakType.Other;\r\n\t\t}\r\n\r\n\t\tconst data = this._data;\r\n\t\tconst nodeCount = data.length / 3;\r\n\t\tlet nodeIndex = 1;\r\n\t\twhile (nodeIndex <= nodeCount) {\r\n\t\t\tif (codePoint < data[3 * nodeIndex]) {\r\n\t\t\t\t// go left\r\n\t\t\t\tnodeIndex = 2 * nodeIndex;\r\n\t\t\t} else if (codePoint > data[3 * nodeIndex + 1]) {\r\n\t\t\t\t// go right\r\n\t\t\t\tnodeIndex = 2 * nodeIndex + 1;\r\n\t\t\t} else {\r\n\t\t\t\t// hit\r\n\t\t\t\treturn data[3 * nodeIndex + 2];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn GraphemeBreakType.Other;\r\n\t}\r\n}\r\n\r\nfunction getGraphemeBreakRawData(): number[] {\r\n\t// generated using https://github.com/alexdima/unicode-utils/blob/main/grapheme-break.js\r\n\treturn JSON.parse('[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]');\r\n}\r\n\r\n//#endregion\r\n\r\n/**\r\n * Computes the offset after performing a left delete on the given string,\r\n * while considering unicode grapheme/emoji rules.\r\n*/\r\nexport function getLeftDeleteOffset(offset: number, str: string): number {\r\n\tif (offset === 0) {\r\n\t\treturn 0;\r\n\t}\r\n\r\n\t// Try to delete emoji part.\r\n\tconst emojiOffset = getOffsetBeforeLastEmojiComponent(offset, str);\r\n\tif (emojiOffset !== undefined) {\r\n\t\treturn emojiOffset;\r\n\t}\r\n\r\n\t// Otherwise, just skip a single code point.\r\n\tconst iterator = new CodePointIterator(str, offset);\r\n\titerator.prevCodePoint();\r\n\treturn iterator.offset;\r\n}\r\n\r\nfunction getOffsetBeforeLastEmojiComponent(initialOffset: number, str: string): number | undefined {\r\n\t// See https://www.unicode.org/reports/tr51/tr51-14.html#EBNF_and_Regex for the\r\n\t// structure of emojis.\r\n\tconst iterator = new CodePointIterator(str, initialOffset);\r\n\tlet codePoint = iterator.prevCodePoint();\r\n\r\n\t// Skip modifiers\r\n\twhile ((isEmojiModifier(codePoint) || codePoint === CodePoint.emojiVariantSelector || codePoint === CodePoint.enclosingKeyCap)) {\r\n\t\tif (iterator.offset === 0) {\r\n\t\t\t// Cannot skip modifier, no preceding emoji base.\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tcodePoint = iterator.prevCodePoint();\r\n\t}\r\n\r\n\t// Expect base emoji\r\n\tif (!isEmojiImprecise(codePoint)) {\r\n\t\t// Unexpected code point, not a valid emoji.\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tlet resultOffset = iterator.offset;\r\n\r\n\tif (resultOffset > 0) {\r\n\t\t// Skip optional ZWJ code points that combine multiple emojis.\r\n\t\t// In theory, we should check if that ZWJ actually combines multiple emojis\r\n\t\t// to prevent deleting ZWJs in situations we didn't account for.\r\n\t\tconst optionalZwjCodePoint = iterator.prevCodePoint();\r\n\t\tif (optionalZwjCodePoint === CodePoint.zwj) {\r\n\t\t\tresultOffset = iterator.offset;\r\n\t\t}\r\n\t}\r\n\r\n\treturn resultOffset;\r\n}\r\n\r\nfunction isEmojiModifier(codePoint: number): boolean {\r\n\treturn 0x1F3FB <= codePoint && codePoint <= 0x1F3FF;\r\n}\r\n\r\nconst enum CodePoint {\r\n\tzwj = 0x200D,\r\n\r\n\t/**\r\n\t * Variation Selector-16 (VS16)\r\n\t*/\r\n\temojiVariantSelector = 0xFE0F,\r\n\r\n\t/**\r\n\t * Combining Enclosing Keycap\r\n\t */\r\n\tenclosingKeyCap = 0x20E3,\r\n}\r\n\r\nexport const noBreakWhitespace = '\\xa0';\r\n\r\nexport class AmbiguousCharacters {\r\n\tprivate static readonly ambiguousCharacterData = new Lazy<\r\n\t\tRecord<\r\n\t\t\tstring | '_common' | '_default',\r\n\t\t\t/* code point -> ascii code point */ number[]\r\n\t\t>\r\n\t>(() => {\r\n\t\t// Generated using https://github.com/hediet/vscode-unicode-data\r\n\t\t// Stored as key1, value1, key2, value2, ...\r\n\t\treturn JSON.parse(\r\n\t\t\t'{\\\"_common\\\":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],\\\"_default\\\":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"cs\\\":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"de\\\":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"es\\\":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"fr\\\":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"it\\\":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"ja\\\":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],\\\"ko\\\":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"pl\\\":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"pt-BR\\\":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"qps-ploc\\\":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"ru\\\":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"tr\\\":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],\\\"zh-hans\\\":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],\\\"zh-hant\\\":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'\r\n\t\t);\r\n\t});\r\n\r\n\tprivate static readonly cache = new LRUCachedFunction<\r\n\t\tstring[],\r\n\t\tAmbiguousCharacters\r\n\t>((locales) => {\r\n\t\tfunction arrayToMap(arr: number[]): Map<number, number> {\r\n\t\t\tconst result = new Map<number, number>();\r\n\t\t\tfor (let i = 0; i < arr.length; i += 2) {\r\n\t\t\t\tresult.set(arr[i], arr[i + 1]);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tfunction mergeMaps(\r\n\t\t\tmap1: Map<number, number>,\r\n\t\t\tmap2: Map<number, number>\r\n\t\t): Map<number, number> {\r\n\t\t\tconst result = new Map<number, number>(map1);\r\n\t\t\tfor (const [key, value] of map2) {\r\n\t\t\t\tresult.set(key, value);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tfunction intersectMaps(\r\n\t\t\tmap1: Map<number, number> | undefined,\r\n\t\t\tmap2: Map<number, number>\r\n\t\t) {\r\n\t\t\tif (!map1) {\r\n\t\t\t\treturn map2;\r\n\t\t\t}\r\n\t\t\tconst result = new Map<number, number>();\r\n\t\t\tfor (const [key, value] of map1) {\r\n\t\t\t\tif (map2.has(key)) {\r\n\t\t\t\t\tresult.set(key, value);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tconst data = this.ambiguousCharacterData.value;\r\n\r\n\t\tlet filteredLocales = locales.filter(\r\n\t\t\t(l) => !l.startsWith('_') && l in data\r\n\t\t);\r\n\t\tif (filteredLocales.length === 0) {\r\n\t\t\tfilteredLocales = ['_default'];\r\n\t\t}\r\n\r\n\t\tlet languageSpecificMap: Map<number, number> | undefined = undefined;\r\n\t\tfor (const locale of filteredLocales) {\r\n\t\t\tconst map = arrayToMap(data[locale]);\r\n\t\t\tlanguageSpecificMap = intersectMaps(languageSpecificMap, map);\r\n\t\t}\r\n\r\n\t\tconst commonMap = arrayToMap(data['_common']);\r\n\t\tconst map = mergeMaps(commonMap, languageSpecificMap!);\r\n\r\n\t\treturn new AmbiguousCharacters(map);\r\n\t});\r\n\r\n\tpublic static getInstance(locales: Set<string>): AmbiguousCharacters {\r\n\t\treturn AmbiguousCharacters.cache.get(Array.from(locales));\r\n\t}\r\n\r\n\tprivate static _locales = new Lazy<string[]>(() =>\r\n\t\tObject.keys(AmbiguousCharacters.ambiguousCharacterData.value).filter(\r\n\t\t\t(k) => !k.startsWith('_')\r\n\t\t)\r\n\t);\r\n\tpublic static getLocales(): string[] {\r\n\t\treturn AmbiguousCharacters._locales.value;\r\n\t}\r\n\r\n\tprivate constructor(\r\n\t\tprivate readonly confusableDictionary: Map<number, number>\r\n\t) { }\r\n\r\n\tpublic isAmbiguous(codePoint: number): boolean {\r\n\t\treturn this.confusableDictionary.has(codePoint);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the non basic ASCII code point that the given code point can be confused,\r\n\t * or undefined if such code point does note exist.\r\n\t */\r\n\tpublic getPrimaryConfusable(codePoint: number): number | undefined {\r\n\t\treturn this.confusableDictionary.get(codePoint);\r\n\t}\r\n\r\n\tpublic getConfusableCodePoints(): ReadonlySet<number> {\r\n\t\treturn new Set(this.confusableDictionary.keys());\r\n\t}\r\n}\r\n\r\nexport class InvisibleCharacters {\r\n\tprivate static getRawData(): number[] {\r\n\t\t// Generated using https://github.com/hediet/vscode-unicode-data\r\n\t\treturn JSON.parse('[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]');\r\n\t}\r\n\r\n\tprivate static _data: Set<number> | undefined = undefined;\r\n\r\n\tprivate static getData() {\r\n\t\tif (!this._data) {\r\n\t\t\tthis._data = new Set(InvisibleCharacters.getRawData());\r\n\t\t}\r\n\t\treturn this._data;\r\n\t}\r\n\r\n\tpublic static isInvisibleCharacter(codePoint: number): boolean {\r\n\t\treturn InvisibleCharacters.getData().has(codePoint);\r\n\t}\r\n\r\n\tpublic static get codePoints(): ReadonlySet<number> {\r\n\t\treturn InvisibleCharacters.getData();\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport * as strings from 'vs/base/common/strings';\r\n\r\n/**\r\n * Return a hash value for an object.\r\n */\r\nexport function hash(obj: any): number {\r\n\treturn doHash(obj, 0);\r\n}\r\n\r\nexport function doHash(obj: any, hashVal: number): number {\r\n\tswitch (typeof obj) {\r\n\t\tcase 'object':\r\n\t\t\tif (obj === null) {\r\n\t\t\t\treturn numberHash(349, hashVal);\r\n\t\t\t} else if (Array.isArray(obj)) {\r\n\t\t\t\treturn arrayHash(obj, hashVal);\r\n\t\t\t}\r\n\t\t\treturn objectHash(obj, hashVal);\r\n\t\tcase 'string':\r\n\t\t\treturn stringHash(obj, hashVal);\r\n\t\tcase 'boolean':\r\n\t\t\treturn booleanHash(obj, hashVal);\r\n\t\tcase 'number':\r\n\t\t\treturn numberHash(obj, hashVal);\r\n\t\tcase 'undefined':\r\n\t\t\treturn numberHash(937, hashVal);\r\n\t\tdefault:\r\n\t\t\treturn numberHash(617, hashVal);\r\n\t}\r\n}\r\n\r\nexport function numberHash(val: number, initialHashVal: number): number {\r\n\treturn (((initialHashVal << 5) - initialHashVal) + val) | 0;  // hashVal * 31 + ch, keep as int32\r\n}\r\n\r\nfunction booleanHash(b: boolean, initialHashVal: number): number {\r\n\treturn numberHash(b ? 433 : 863, initialHashVal);\r\n}\r\n\r\nexport function stringHash(s: string, hashVal: number) {\r\n\thashVal = numberHash(149417, hashVal);\r\n\tfor (let i = 0, length = s.length; i < length; i++) {\r\n\t\thashVal = numberHash(s.charCodeAt(i), hashVal);\r\n\t}\r\n\treturn hashVal;\r\n}\r\n\r\nfunction arrayHash(arr: any[], initialHashVal: number): number {\r\n\tinitialHashVal = numberHash(104579, initialHashVal);\r\n\treturn arr.reduce((hashVal, item) => doHash(item, hashVal), initialHashVal);\r\n}\r\n\r\nfunction objectHash(obj: any, initialHashVal: number): number {\r\n\tinitialHashVal = numberHash(181387, initialHashVal);\r\n\treturn Object.keys(obj).sort().reduce((hashVal, key) => {\r\n\t\thashVal = stringHash(key, hashVal);\r\n\t\treturn doHash(obj[key], hashVal);\r\n\t}, initialHashVal);\r\n}\r\n\r\nconst enum SHA1Constant {\r\n\tBLOCK_SIZE = 64, // 512 / 8\r\n\tUNICODE_REPLACEMENT = 0xFFFD,\r\n}\r\n\r\nfunction leftRotate(value: number, bits: number, totalBits: number = 32): number {\r\n\t// delta + bits = totalBits\r\n\tconst delta = totalBits - bits;\r\n\r\n\t// All ones, expect `delta` zeros aligned to the right\r\n\tconst mask = ~((1 << delta) - 1);\r\n\r\n\t// Join (value left-shifted `bits` bits) with (masked value right-shifted `delta` bits)\r\n\treturn ((value << bits) | ((mask & value) >>> delta)) >>> 0;\r\n}\r\n\r\nfunction fill(dest: Uint8Array, index: number = 0, count: number = dest.byteLength, value: number = 0): void {\r\n\tfor (let i = 0; i < count; i++) {\r\n\t\tdest[index + i] = value;\r\n\t}\r\n}\r\n\r\nfunction leftPad(value: string, length: number, char: string = '0'): string {\r\n\twhile (value.length < length) {\r\n\t\tvalue = char + value;\r\n\t}\r\n\treturn value;\r\n}\r\n\r\nexport function toHexString(buffer: ArrayBuffer): string;\r\nexport function toHexString(value: number, bitsize?: number): string;\r\nexport function toHexString(bufferOrValue: ArrayBuffer | number, bitsize: number = 32): string {\r\n\tif (bufferOrValue instanceof ArrayBuffer) {\r\n\t\treturn Array.from(new Uint8Array(bufferOrValue)).map(b => b.toString(16).padStart(2, '0')).join('');\r\n\t}\r\n\r\n\treturn leftPad((bufferOrValue >>> 0).toString(16), bitsize / 4);\r\n}\r\n\r\n/**\r\n * A SHA1 implementation that works with strings and does not allocate.\r\n */\r\nexport class StringSHA1 {\r\n\tprivate static _bigBlock32 = new DataView(new ArrayBuffer(320)); // 80 * 4 = 320\r\n\r\n\tprivate _h0 = 0x67452301;\r\n\tprivate _h1 = 0xEFCDAB89;\r\n\tprivate _h2 = 0x98BADCFE;\r\n\tprivate _h3 = 0x10325476;\r\n\tprivate _h4 = 0xC3D2E1F0;\r\n\r\n\tprivate readonly _buff: Uint8Array;\r\n\tprivate readonly _buffDV: DataView;\r\n\tprivate _buffLen: number;\r\n\tprivate _totalLen: number;\r\n\tprivate _leftoverHighSurrogate: number;\r\n\tprivate _finished: boolean;\r\n\r\n\tconstructor() {\r\n\t\tthis._buff = new Uint8Array(SHA1Constant.BLOCK_SIZE + 3 /* to fit any utf-8 */);\r\n\t\tthis._buffDV = new DataView(this._buff.buffer);\r\n\t\tthis._buffLen = 0;\r\n\t\tthis._totalLen = 0;\r\n\t\tthis._leftoverHighSurrogate = 0;\r\n\t\tthis._finished = false;\r\n\t}\r\n\r\n\tpublic update(str: string): void {\r\n\t\tconst strLen = str.length;\r\n\t\tif (strLen === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst buff = this._buff;\r\n\t\tlet buffLen = this._buffLen;\r\n\t\tlet leftoverHighSurrogate = this._leftoverHighSurrogate;\r\n\t\tlet charCode: number;\r\n\t\tlet offset: number;\r\n\r\n\t\tif (leftoverHighSurrogate !== 0) {\r\n\t\t\tcharCode = leftoverHighSurrogate;\r\n\t\t\toffset = -1;\r\n\t\t\tleftoverHighSurrogate = 0;\r\n\t\t} else {\r\n\t\t\tcharCode = str.charCodeAt(0);\r\n\t\t\toffset = 0;\r\n\t\t}\r\n\r\n\t\twhile (true) {\r\n\t\t\tlet codePoint = charCode;\r\n\t\t\tif (strings.isHighSurrogate(charCode)) {\r\n\t\t\t\tif (offset + 1 < strLen) {\r\n\t\t\t\t\tconst nextCharCode = str.charCodeAt(offset + 1);\r\n\t\t\t\t\tif (strings.isLowSurrogate(nextCharCode)) {\r\n\t\t\t\t\t\toffset++;\r\n\t\t\t\t\t\tcodePoint = strings.computeCodePoint(charCode, nextCharCode);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// illegal => unicode replacement character\r\n\t\t\t\t\t\tcodePoint = SHA1Constant.UNICODE_REPLACEMENT;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// last character is a surrogate pair\r\n\t\t\t\t\tleftoverHighSurrogate = charCode;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (strings.isLowSurrogate(charCode)) {\r\n\t\t\t\t// illegal => unicode replacement character\r\n\t\t\t\tcodePoint = SHA1Constant.UNICODE_REPLACEMENT;\r\n\t\t\t}\r\n\r\n\t\t\tbuffLen = this._push(buff, buffLen, codePoint);\r\n\t\t\toffset++;\r\n\t\t\tif (offset < strLen) {\r\n\t\t\t\tcharCode = str.charCodeAt(offset);\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._buffLen = buffLen;\r\n\t\tthis._leftoverHighSurrogate = leftoverHighSurrogate;\r\n\t}\r\n\r\n\tprivate _push(buff: Uint8Array, buffLen: number, codePoint: number): number {\r\n\t\tif (codePoint < 0x0080) {\r\n\t\t\tbuff[buffLen++] = codePoint;\r\n\t\t} else if (codePoint < 0x0800) {\r\n\t\t\tbuff[buffLen++] = 0b11000000 | ((codePoint & 0b00000000000000000000011111000000) >>> 6);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000000000000000111111) >>> 0);\r\n\t\t} else if (codePoint < 0x10000) {\r\n\t\t\tbuff[buffLen++] = 0b11100000 | ((codePoint & 0b00000000000000001111000000000000) >>> 12);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000000000111111000000) >>> 6);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000000000000000111111) >>> 0);\r\n\t\t} else {\r\n\t\t\tbuff[buffLen++] = 0b11110000 | ((codePoint & 0b00000000000111000000000000000000) >>> 18);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000111111000000000000) >>> 12);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000000000111111000000) >>> 6);\r\n\t\t\tbuff[buffLen++] = 0b10000000 | ((codePoint & 0b00000000000000000000000000111111) >>> 0);\r\n\t\t}\r\n\r\n\t\tif (buffLen >= SHA1Constant.BLOCK_SIZE) {\r\n\t\t\tthis._step();\r\n\t\t\tbuffLen -= SHA1Constant.BLOCK_SIZE;\r\n\t\t\tthis._totalLen += SHA1Constant.BLOCK_SIZE;\r\n\t\t\t// take last 3 in case of UTF8 overflow\r\n\t\t\tbuff[0] = buff[SHA1Constant.BLOCK_SIZE + 0];\r\n\t\t\tbuff[1] = buff[SHA1Constant.BLOCK_SIZE + 1];\r\n\t\t\tbuff[2] = buff[SHA1Constant.BLOCK_SIZE + 2];\r\n\t\t}\r\n\r\n\t\treturn buffLen;\r\n\t}\r\n\r\n\tpublic digest(): string {\r\n\t\tif (!this._finished) {\r\n\t\t\tthis._finished = true;\r\n\t\t\tif (this._leftoverHighSurrogate) {\r\n\t\t\t\t// illegal => unicode replacement character\r\n\t\t\t\tthis._leftoverHighSurrogate = 0;\r\n\t\t\t\tthis._buffLen = this._push(this._buff, this._buffLen, SHA1Constant.UNICODE_REPLACEMENT);\r\n\t\t\t}\r\n\t\t\tthis._totalLen += this._buffLen;\r\n\t\t\tthis._wrapUp();\r\n\t\t}\r\n\r\n\t\treturn toHexString(this._h0) + toHexString(this._h1) + toHexString(this._h2) + toHexString(this._h3) + toHexString(this._h4);\r\n\t}\r\n\r\n\tprivate _wrapUp(): void {\r\n\t\tthis._buff[this._buffLen++] = 0x80;\r\n\t\tfill(this._buff, this._buffLen);\r\n\r\n\t\tif (this._buffLen > 56) {\r\n\t\t\tthis._step();\r\n\t\t\tfill(this._buff);\r\n\t\t}\r\n\r\n\t\t// this will fit because the mantissa can cover up to 52 bits\r\n\t\tconst ml = 8 * this._totalLen;\r\n\r\n\t\tthis._buffDV.setUint32(56, Math.floor(ml / 4294967296), false);\r\n\t\tthis._buffDV.setUint32(60, ml % 4294967296, false);\r\n\r\n\t\tthis._step();\r\n\t}\r\n\r\n\tprivate _step(): void {\r\n\t\tconst bigBlock32 = StringSHA1._bigBlock32;\r\n\t\tconst data = this._buffDV;\r\n\r\n\t\tfor (let j = 0; j < 64 /* 16*4 */; j += 4) {\r\n\t\t\tbigBlock32.setUint32(j, data.getUint32(j, false), false);\r\n\t\t}\r\n\r\n\t\tfor (let j = 64; j < 320 /* 80*4 */; j += 4) {\r\n\t\t\tbigBlock32.setUint32(j, leftRotate((bigBlock32.getUint32(j - 12, false) ^ bigBlock32.getUint32(j - 32, false) ^ bigBlock32.getUint32(j - 56, false) ^ bigBlock32.getUint32(j - 64, false)), 1), false);\r\n\t\t}\r\n\r\n\t\tlet a = this._h0;\r\n\t\tlet b = this._h1;\r\n\t\tlet c = this._h2;\r\n\t\tlet d = this._h3;\r\n\t\tlet e = this._h4;\r\n\r\n\t\tlet f: number, k: number;\r\n\t\tlet temp: number;\r\n\r\n\t\tfor (let j = 0; j < 80; j++) {\r\n\t\t\tif (j < 20) {\r\n\t\t\t\tf = (b & c) | ((~b) & d);\r\n\t\t\t\tk = 0x5A827999;\r\n\t\t\t} else if (j < 40) {\r\n\t\t\t\tf = b ^ c ^ d;\r\n\t\t\t\tk = 0x6ED9EBA1;\r\n\t\t\t} else if (j < 60) {\r\n\t\t\t\tf = (b & c) | (b & d) | (c & d);\r\n\t\t\t\tk = 0x8F1BBCDC;\r\n\t\t\t} else {\r\n\t\t\t\tf = b ^ c ^ d;\r\n\t\t\t\tk = 0xCA62C1D6;\r\n\t\t\t}\r\n\r\n\t\t\ttemp = (leftRotate(a, 5) + f + e + k + bigBlock32.getUint32(j * 4, false)) & 0xffffffff;\r\n\t\t\te = d;\r\n\t\t\td = c;\r\n\t\t\tc = leftRotate(b, 30);\r\n\t\t\tb = a;\r\n\t\t\ta = temp;\r\n\t\t}\r\n\r\n\t\tthis._h0 = (this._h0 + a) & 0xffffffff;\r\n\t\tthis._h1 = (this._h1 + b) & 0xffffffff;\r\n\t\tthis._h2 = (this._h2 + c) & 0xffffffff;\r\n\t\tthis._h3 = (this._h3 + d) & 0xffffffff;\r\n\t\tthis._h4 = (this._h4 + e) & 0xffffffff;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { DiffChange } from 'vs/base/common/diff/diffChange';\r\nimport { stringHash } from 'vs/base/common/hash';\r\nimport { Constants } from 'vs/base/common/uint';\r\n\r\nexport class StringDiffSequence implements ISequence {\r\n\r\n\tconstructor(private source: string) { }\r\n\r\n\tgetElements(): Int32Array | number[] | string[] {\r\n\t\tconst source = this.source;\r\n\t\tconst characters = new Int32Array(source.length);\r\n\t\tfor (let i = 0, len = source.length; i < len; i++) {\r\n\t\t\tcharacters[i] = source.charCodeAt(i);\r\n\t\t}\r\n\t\treturn characters;\r\n\t}\r\n}\r\n\r\nexport function stringDiff(original: string, modified: string, pretty: boolean): IDiffChange[] {\r\n\treturn new LcsDiff(new StringDiffSequence(original), new StringDiffSequence(modified)).ComputeDiff(pretty).changes;\r\n}\r\n\r\nexport interface ISequence {\r\n\tgetElements(): Int32Array | number[] | string[];\r\n\tgetStrictElement?(index: number): string;\r\n}\r\n\r\nexport interface IDiffChange {\r\n\t/**\r\n\t * The position of the first element in the original sequence which\r\n\t * this change affects.\r\n\t */\r\n\toriginalStart: number;\r\n\r\n\t/**\r\n\t * The number of elements from the original sequence which were\r\n\t * affected.\r\n\t */\r\n\toriginalLength: number;\r\n\r\n\t/**\r\n\t * The position of the first element in the modified sequence which\r\n\t * this change affects.\r\n\t */\r\n\tmodifiedStart: number;\r\n\r\n\t/**\r\n\t * The number of elements from the modified sequence which were\r\n\t * affected (added).\r\n\t */\r\n\tmodifiedLength: number;\r\n}\r\n\r\nexport interface IContinueProcessingPredicate {\r\n\t(furthestOriginalIndex: number, matchLengthOfLongest: number): boolean;\r\n}\r\n\r\nexport interface IDiffResult {\r\n\tquitEarly: boolean;\r\n\tchanges: IDiffChange[];\r\n}\r\n\r\n//\r\n// The code below has been ported from a C# implementation in VS\r\n//\r\n\r\nclass Debug {\r\n\r\n\tpublic static Assert(condition: boolean, message: string): void {\r\n\t\tif (!condition) {\r\n\t\t\tthrow new Error(message);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass MyArray {\r\n\t/**\r\n\t * Copies a range of elements from an Array starting at the specified source index and pastes\r\n\t * them to another Array starting at the specified destination index. The length and the indexes\r\n\t * are specified as 64-bit integers.\r\n\t * sourceArray:\r\n\t *\t\tThe Array that contains the data to copy.\r\n\t * sourceIndex:\r\n\t *\t\tA 64-bit integer that represents the index in the sourceArray at which copying begins.\r\n\t * destinationArray:\r\n\t *\t\tThe Array that receives the data.\r\n\t * destinationIndex:\r\n\t *\t\tA 64-bit integer that represents the index in the destinationArray at which storing begins.\r\n\t * length:\r\n\t *\t\tA 64-bit integer that represents the number of elements to copy.\r\n\t */\r\n\tpublic static Copy(sourceArray: any[], sourceIndex: number, destinationArray: any[], destinationIndex: number, length: number) {\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tdestinationArray[destinationIndex + i] = sourceArray[sourceIndex + i];\r\n\t\t}\r\n\t}\r\n\tpublic static Copy2(sourceArray: Int32Array, sourceIndex: number, destinationArray: Int32Array, destinationIndex: number, length: number) {\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tdestinationArray[destinationIndex + i] = sourceArray[sourceIndex + i];\r\n\t\t}\r\n\t}\r\n}\r\n\r\n//*****************************************************************************\r\n// LcsDiff.cs\r\n//\r\n// An implementation of the difference algorithm described in\r\n// \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\r\n//\r\n// Copyright (C) 2008 Microsoft Corporation @minifier_do_not_preserve\r\n//*****************************************************************************\r\n\r\n// Our total memory usage for storing history is (worst-case):\r\n// 2 * [(MaxDifferencesHistory + 1) * (MaxDifferencesHistory + 1) - 1] * sizeof(int)\r\n// 2 * [1448*1448 - 1] * 4 = 16773624 = 16MB\r\nconst enum LocalConstants {\r\n\tMaxDifferencesHistory = 1447\r\n}\r\n\r\n/**\r\n * A utility class which helps to create the set of DiffChanges from\r\n * a difference operation. This class accepts original DiffElements and\r\n * modified DiffElements that are involved in a particular change. The\r\n * MarkNextChange() method can be called to mark the separation between\r\n * distinct changes. At the end, the Changes property can be called to retrieve\r\n * the constructed changes.\r\n */\r\nclass DiffChangeHelper {\r\n\r\n\tprivate m_changes: DiffChange[];\r\n\tprivate m_originalStart: number;\r\n\tprivate m_modifiedStart: number;\r\n\tprivate m_originalCount: number;\r\n\tprivate m_modifiedCount: number;\r\n\r\n\t/**\r\n\t * Constructs a new DiffChangeHelper for the given DiffSequences.\r\n\t */\r\n\tconstructor() {\r\n\t\tthis.m_changes = [];\r\n\t\tthis.m_originalStart = Constants.MAX_SAFE_SMALL_INTEGER;\r\n\t\tthis.m_modifiedStart = Constants.MAX_SAFE_SMALL_INTEGER;\r\n\t\tthis.m_originalCount = 0;\r\n\t\tthis.m_modifiedCount = 0;\r\n\t}\r\n\r\n\t/**\r\n\t * Marks the beginning of the next change in the set of differences.\r\n\t */\r\n\tpublic MarkNextChange(): void {\r\n\t\t// Only add to the list if there is something to add\r\n\t\tif (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n\t\t\t// Add the new change to our list\r\n\t\t\tthis.m_changes.push(new DiffChange(this.m_originalStart, this.m_originalCount,\r\n\t\t\t\tthis.m_modifiedStart, this.m_modifiedCount));\r\n\t\t}\r\n\r\n\t\t// Reset for the next change\r\n\t\tthis.m_originalCount = 0;\r\n\t\tthis.m_modifiedCount = 0;\r\n\t\tthis.m_originalStart = Constants.MAX_SAFE_SMALL_INTEGER;\r\n\t\tthis.m_modifiedStart = Constants.MAX_SAFE_SMALL_INTEGER;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds the original element at the given position to the elements\r\n\t * affected by the current change. The modified index gives context\r\n\t * to the change position with respect to the original sequence.\r\n\t * @param originalIndex The index of the original element to add.\r\n\t * @param modifiedIndex The index of the modified element that provides corresponding position in the modified sequence.\r\n\t */\r\n\tpublic AddOriginalElement(originalIndex: number, modifiedIndex: number) {\r\n\t\t// The 'true' start index is the smallest of the ones we've seen\r\n\t\tthis.m_originalStart = Math.min(this.m_originalStart, originalIndex);\r\n\t\tthis.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\r\n\r\n\t\tthis.m_originalCount++;\r\n\t}\r\n\r\n\t/**\r\n\t * Adds the modified element at the given position to the elements\r\n\t * affected by the current change. The original index gives context\r\n\t * to the change position with respect to the modified sequence.\r\n\t * @param originalIndex The index of the original element that provides corresponding position in the original sequence.\r\n\t * @param modifiedIndex The index of the modified element to add.\r\n\t */\r\n\tpublic AddModifiedElement(originalIndex: number, modifiedIndex: number): void {\r\n\t\t// The 'true' start index is the smallest of the ones we've seen\r\n\t\tthis.m_originalStart = Math.min(this.m_originalStart, originalIndex);\r\n\t\tthis.m_modifiedStart = Math.min(this.m_modifiedStart, modifiedIndex);\r\n\r\n\t\tthis.m_modifiedCount++;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves all of the changes marked by the class.\r\n\t */\r\n\tpublic getChanges(): DiffChange[] {\r\n\t\tif (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n\t\t\t// Finish up on whatever is left\r\n\t\t\tthis.MarkNextChange();\r\n\t\t}\r\n\r\n\t\treturn this.m_changes;\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves all of the changes marked by the class in the reverse order\r\n\t */\r\n\tpublic getReverseChanges(): DiffChange[] {\r\n\t\tif (this.m_originalCount > 0 || this.m_modifiedCount > 0) {\r\n\t\t\t// Finish up on whatever is left\r\n\t\t\tthis.MarkNextChange();\r\n\t\t}\r\n\r\n\t\tthis.m_changes.reverse();\r\n\t\treturn this.m_changes;\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * An implementation of the difference algorithm described in\r\n * \"An O(ND) Difference Algorithm and its variations\" by Eugene W. Myers\r\n */\r\nexport class LcsDiff {\r\n\r\n\tprivate readonly ContinueProcessingPredicate: IContinueProcessingPredicate | null;\r\n\r\n\tprivate readonly _originalSequence: ISequence;\r\n\tprivate readonly _modifiedSequence: ISequence;\r\n\tprivate readonly _hasStrings: boolean;\r\n\tprivate readonly _originalStringElements: string[];\r\n\tprivate readonly _originalElementsOrHash: Int32Array;\r\n\tprivate readonly _modifiedStringElements: string[];\r\n\tprivate readonly _modifiedElementsOrHash: Int32Array;\r\n\r\n\tprivate m_forwardHistory: Int32Array[];\r\n\tprivate m_reverseHistory: Int32Array[];\r\n\r\n\t/**\r\n\t * Constructs the DiffFinder\r\n\t */\r\n\tconstructor(originalSequence: ISequence, modifiedSequence: ISequence, continueProcessingPredicate: IContinueProcessingPredicate | null = null) {\r\n\t\tthis.ContinueProcessingPredicate = continueProcessingPredicate;\r\n\r\n\t\tthis._originalSequence = originalSequence;\r\n\t\tthis._modifiedSequence = modifiedSequence;\r\n\r\n\t\tconst [originalStringElements, originalElementsOrHash, originalHasStrings] = LcsDiff._getElements(originalSequence);\r\n\t\tconst [modifiedStringElements, modifiedElementsOrHash, modifiedHasStrings] = LcsDiff._getElements(modifiedSequence);\r\n\r\n\t\tthis._hasStrings = (originalHasStrings && modifiedHasStrings);\r\n\t\tthis._originalStringElements = originalStringElements;\r\n\t\tthis._originalElementsOrHash = originalElementsOrHash;\r\n\t\tthis._modifiedStringElements = modifiedStringElements;\r\n\t\tthis._modifiedElementsOrHash = modifiedElementsOrHash;\r\n\r\n\t\tthis.m_forwardHistory = [];\r\n\t\tthis.m_reverseHistory = [];\r\n\t}\r\n\r\n\tprivate static _isStringArray(arr: Int32Array | number[] | string[]): arr is string[] {\r\n\t\treturn (arr.length > 0 && typeof arr[0] === 'string');\r\n\t}\r\n\r\n\tprivate static _getElements(sequence: ISequence): [string[], Int32Array, boolean] {\r\n\t\tconst elements = sequence.getElements();\r\n\r\n\t\tif (LcsDiff._isStringArray(elements)) {\r\n\t\t\tconst hashes = new Int32Array(elements.length);\r\n\t\t\tfor (let i = 0, len = elements.length; i < len; i++) {\r\n\t\t\t\thashes[i] = stringHash(elements[i], 0);\r\n\t\t\t}\r\n\t\t\treturn [elements, hashes, true];\r\n\t\t}\r\n\r\n\t\tif (elements instanceof Int32Array) {\r\n\t\t\treturn [[], elements, false];\r\n\t\t}\r\n\r\n\t\treturn [[], new Int32Array(elements), false];\r\n\t}\r\n\r\n\tprivate ElementsAreEqual(originalIndex: number, newIndex: number): boolean {\r\n\t\tif (this._originalElementsOrHash[originalIndex] !== this._modifiedElementsOrHash[newIndex]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn (this._hasStrings ? this._originalStringElements[originalIndex] === this._modifiedStringElements[newIndex] : true);\r\n\t}\r\n\r\n\tprivate ElementsAreStrictEqual(originalIndex: number, newIndex: number): boolean {\r\n\t\tif (!this.ElementsAreEqual(originalIndex, newIndex)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst originalElement = LcsDiff._getStrictElement(this._originalSequence, originalIndex);\r\n\t\tconst modifiedElement = LcsDiff._getStrictElement(this._modifiedSequence, newIndex);\r\n\t\treturn (originalElement === modifiedElement);\r\n\t}\r\n\r\n\tprivate static _getStrictElement(sequence: ISequence, index: number): string | null {\r\n\t\tif (typeof sequence.getStrictElement === 'function') {\r\n\t\t\treturn sequence.getStrictElement(index);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate OriginalElementsAreEqual(index1: number, index2: number): boolean {\r\n\t\tif (this._originalElementsOrHash[index1] !== this._originalElementsOrHash[index2]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn (this._hasStrings ? this._originalStringElements[index1] === this._originalStringElements[index2] : true);\r\n\t}\r\n\r\n\tprivate ModifiedElementsAreEqual(index1: number, index2: number): boolean {\r\n\t\tif (this._modifiedElementsOrHash[index1] !== this._modifiedElementsOrHash[index2]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn (this._hasStrings ? this._modifiedStringElements[index1] === this._modifiedStringElements[index2] : true);\r\n\t}\r\n\r\n\tpublic ComputeDiff(pretty: boolean): IDiffResult {\r\n\t\treturn this._ComputeDiff(0, this._originalElementsOrHash.length - 1, 0, this._modifiedElementsOrHash.length - 1, pretty);\r\n\t}\r\n\r\n\t/**\r\n\t * Computes the differences between the original and modified input\r\n\t * sequences on the bounded range.\r\n\t * @returns An array of the differences between the two input sequences.\r\n\t */\r\n\tprivate _ComputeDiff(originalStart: number, originalEnd: number, modifiedStart: number, modifiedEnd: number, pretty: boolean): IDiffResult {\r\n\t\tconst quitEarlyArr = [false];\r\n\t\tlet changes = this.ComputeDiffRecursive(originalStart, originalEnd, modifiedStart, modifiedEnd, quitEarlyArr);\r\n\r\n\t\tif (pretty) {\r\n\t\t\t// We have to clean up the computed diff to be more intuitive\r\n\t\t\t// but it turns out this cannot be done correctly until the entire set\r\n\t\t\t// of diffs have been computed\r\n\t\t\tchanges = this.PrettifyChanges(changes);\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tquitEarly: quitEarlyArr[0],\r\n\t\t\tchanges: changes\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Private helper method which computes the differences on the bounded range\r\n\t * recursively.\r\n\t * @returns An array of the differences between the two input sequences.\r\n\t */\r\n\tprivate ComputeDiffRecursive(originalStart: number, originalEnd: number, modifiedStart: number, modifiedEnd: number, quitEarlyArr: boolean[]): DiffChange[] {\r\n\t\tquitEarlyArr[0] = false;\r\n\r\n\t\t// Find the start of the differences\r\n\t\twhile (originalStart <= originalEnd && modifiedStart <= modifiedEnd && this.ElementsAreEqual(originalStart, modifiedStart)) {\r\n\t\t\toriginalStart++;\r\n\t\t\tmodifiedStart++;\r\n\t\t}\r\n\r\n\t\t// Find the end of the differences\r\n\t\twhile (originalEnd >= originalStart && modifiedEnd >= modifiedStart && this.ElementsAreEqual(originalEnd, modifiedEnd)) {\r\n\t\t\toriginalEnd--;\r\n\t\t\tmodifiedEnd--;\r\n\t\t}\r\n\r\n\t\t// In the special case where we either have all insertions or all deletions or the sequences are identical\r\n\t\tif (originalStart > originalEnd || modifiedStart > modifiedEnd) {\r\n\t\t\tlet changes: DiffChange[];\r\n\r\n\t\t\tif (modifiedStart <= modifiedEnd) {\r\n\t\t\t\tDebug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd');\r\n\r\n\t\t\t\t// All insertions\r\n\t\t\t\tchanges = [\r\n\t\t\t\t\tnew DiffChange(originalStart, 0, modifiedStart, modifiedEnd - modifiedStart + 1)\r\n\t\t\t\t];\r\n\t\t\t} else if (originalStart <= originalEnd) {\r\n\t\t\t\tDebug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd');\r\n\r\n\t\t\t\t// All deletions\r\n\t\t\t\tchanges = [\r\n\t\t\t\t\tnew DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, 0)\r\n\t\t\t\t];\r\n\t\t\t} else {\r\n\t\t\t\tDebug.Assert(originalStart === originalEnd + 1, 'originalStart should only be one more than originalEnd');\r\n\t\t\t\tDebug.Assert(modifiedStart === modifiedEnd + 1, 'modifiedStart should only be one more than modifiedEnd');\r\n\r\n\t\t\t\t// Identical sequences - No differences\r\n\t\t\t\tchanges = [];\r\n\t\t\t}\r\n\r\n\t\t\treturn changes;\r\n\t\t}\r\n\r\n\t\t// This problem can be solved using the Divide-And-Conquer technique.\r\n\t\tconst midOriginalArr = [0];\r\n\t\tconst midModifiedArr = [0];\r\n\t\tconst result = this.ComputeRecursionPoint(originalStart, originalEnd, modifiedStart, modifiedEnd, midOriginalArr, midModifiedArr, quitEarlyArr);\r\n\r\n\t\tconst midOriginal = midOriginalArr[0];\r\n\t\tconst midModified = midModifiedArr[0];\r\n\r\n\t\tif (result !== null) {\r\n\t\t\t// Result is not-null when there was enough memory to compute the changes while\r\n\t\t\t// searching for the recursion point\r\n\t\t\treturn result;\r\n\t\t} else if (!quitEarlyArr[0]) {\r\n\t\t\t// We can break the problem down recursively by finding the changes in the\r\n\t\t\t// First Half:   (originalStart, modifiedStart) to (midOriginal, midModified)\r\n\t\t\t// Second Half:  (midOriginal + 1, minModified + 1) to (originalEnd, modifiedEnd)\r\n\t\t\t// NOTE: ComputeDiff() is inclusive, therefore the second range starts on the next point\r\n\r\n\t\t\tconst leftChanges = this.ComputeDiffRecursive(originalStart, midOriginal, modifiedStart, midModified, quitEarlyArr);\r\n\t\t\tlet rightChanges: DiffChange[] = [];\r\n\r\n\t\t\tif (!quitEarlyArr[0]) {\r\n\t\t\t\trightChanges = this.ComputeDiffRecursive(midOriginal + 1, originalEnd, midModified + 1, modifiedEnd, quitEarlyArr);\r\n\t\t\t} else {\r\n\t\t\t\t// We didn't have time to finish the first half, so we don't have time to compute this half.\r\n\t\t\t\t// Consider the entire rest of the sequence different.\r\n\t\t\t\trightChanges = [\r\n\t\t\t\t\tnew DiffChange(midOriginal + 1, originalEnd - (midOriginal + 1) + 1, midModified + 1, modifiedEnd - (midModified + 1) + 1)\r\n\t\t\t\t];\r\n\t\t\t}\r\n\r\n\t\t\treturn this.ConcatenateChanges(leftChanges, rightChanges);\r\n\t\t}\r\n\r\n\t\t// If we hit here, we quit early, and so can't return anything meaningful\r\n\t\treturn [\r\n\t\t\tnew DiffChange(originalStart, originalEnd - originalStart + 1, modifiedStart, modifiedEnd - modifiedStart + 1)\r\n\t\t];\r\n\t}\r\n\r\n\tprivate WALKTRACE(diagonalForwardBase: number, diagonalForwardStart: number, diagonalForwardEnd: number, diagonalForwardOffset: number,\r\n\t\tdiagonalReverseBase: number, diagonalReverseStart: number, diagonalReverseEnd: number, diagonalReverseOffset: number,\r\n\t\tforwardPoints: Int32Array, reversePoints: Int32Array,\r\n\t\toriginalIndex: number, originalEnd: number, midOriginalArr: number[],\r\n\t\tmodifiedIndex: number, modifiedEnd: number, midModifiedArr: number[],\r\n\t\tdeltaIsEven: boolean, quitEarlyArr: boolean[]\r\n\t): DiffChange[] {\r\n\t\tlet forwardChanges: DiffChange[] | null = null;\r\n\t\tlet reverseChanges: DiffChange[] | null = null;\r\n\r\n\t\t// First, walk backward through the forward diagonals history\r\n\t\tlet changeHelper = new DiffChangeHelper();\r\n\t\tlet diagonalMin = diagonalForwardStart;\r\n\t\tlet diagonalMax = diagonalForwardEnd;\r\n\t\tlet diagonalRelative = (midOriginalArr[0] - midModifiedArr[0]) - diagonalForwardOffset;\r\n\t\tlet lastOriginalIndex = Constants.MIN_SAFE_SMALL_INTEGER;\r\n\t\tlet historyIndex = this.m_forwardHistory.length - 1;\r\n\r\n\t\tdo {\r\n\t\t\t// Get the diagonal index from the relative diagonal number\r\n\t\t\tconst diagonal = diagonalRelative + diagonalForwardBase;\r\n\r\n\t\t\t// Figure out where we came from\r\n\t\t\tif (diagonal === diagonalMin || (diagonal < diagonalMax && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1])) {\r\n\t\t\t\t// Vertical line (the element is an insert)\r\n\t\t\t\toriginalIndex = forwardPoints[diagonal + 1];\r\n\t\t\t\tmodifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\r\n\t\t\t\tif (originalIndex < lastOriginalIndex) {\r\n\t\t\t\t\tchangeHelper.MarkNextChange();\r\n\t\t\t\t}\r\n\t\t\t\tlastOriginalIndex = originalIndex;\r\n\t\t\t\tchangeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex);\r\n\t\t\t\tdiagonalRelative = (diagonal + 1) - diagonalForwardBase; //Setup for the next iteration\r\n\t\t\t} else {\r\n\t\t\t\t// Horizontal line (the element is a deletion)\r\n\t\t\t\toriginalIndex = forwardPoints[diagonal - 1] + 1;\r\n\t\t\t\tmodifiedIndex = originalIndex - diagonalRelative - diagonalForwardOffset;\r\n\t\t\t\tif (originalIndex < lastOriginalIndex) {\r\n\t\t\t\t\tchangeHelper.MarkNextChange();\r\n\t\t\t\t}\r\n\t\t\t\tlastOriginalIndex = originalIndex - 1;\r\n\t\t\t\tchangeHelper.AddOriginalElement(originalIndex, modifiedIndex + 1);\r\n\t\t\t\tdiagonalRelative = (diagonal - 1) - diagonalForwardBase; //Setup for the next iteration\r\n\t\t\t}\r\n\r\n\t\t\tif (historyIndex >= 0) {\r\n\t\t\t\tforwardPoints = this.m_forwardHistory[historyIndex];\r\n\t\t\t\tdiagonalForwardBase = forwardPoints[0]; //We stored this in the first spot\r\n\t\t\t\tdiagonalMin = 1;\r\n\t\t\t\tdiagonalMax = forwardPoints.length - 1;\r\n\t\t\t}\r\n\t\t} while (--historyIndex >= -1);\r\n\r\n\t\t// Ironically, we get the forward changes as the reverse of the\r\n\t\t// order we added them since we technically added them backwards\r\n\t\tforwardChanges = changeHelper.getReverseChanges();\r\n\r\n\t\tif (quitEarlyArr[0]) {\r\n\t\t\t// TODO: Calculate a partial from the reverse diagonals.\r\n\t\t\t//       For now, just assume everything after the midOriginal/midModified point is a diff\r\n\r\n\t\t\tlet originalStartPoint = midOriginalArr[0] + 1;\r\n\t\t\tlet modifiedStartPoint = midModifiedArr[0] + 1;\r\n\r\n\t\t\tif (forwardChanges !== null && forwardChanges.length > 0) {\r\n\t\t\t\tconst lastForwardChange = forwardChanges[forwardChanges.length - 1];\r\n\t\t\t\toriginalStartPoint = Math.max(originalStartPoint, lastForwardChange.getOriginalEnd());\r\n\t\t\t\tmodifiedStartPoint = Math.max(modifiedStartPoint, lastForwardChange.getModifiedEnd());\r\n\t\t\t}\r\n\r\n\t\t\treverseChanges = [\r\n\t\t\t\tnew DiffChange(originalStartPoint, originalEnd - originalStartPoint + 1,\r\n\t\t\t\t\tmodifiedStartPoint, modifiedEnd - modifiedStartPoint + 1)\r\n\t\t\t];\r\n\t\t} else {\r\n\t\t\t// Now walk backward through the reverse diagonals history\r\n\t\t\tchangeHelper = new DiffChangeHelper();\r\n\t\t\tdiagonalMin = diagonalReverseStart;\r\n\t\t\tdiagonalMax = diagonalReverseEnd;\r\n\t\t\tdiagonalRelative = (midOriginalArr[0] - midModifiedArr[0]) - diagonalReverseOffset;\r\n\t\t\tlastOriginalIndex = Constants.MAX_SAFE_SMALL_INTEGER;\r\n\t\t\thistoryIndex = (deltaIsEven) ? this.m_reverseHistory.length - 1 : this.m_reverseHistory.length - 2;\r\n\r\n\t\t\tdo {\r\n\t\t\t\t// Get the diagonal index from the relative diagonal number\r\n\t\t\t\tconst diagonal = diagonalRelative + diagonalReverseBase;\r\n\r\n\t\t\t\t// Figure out where we came from\r\n\t\t\t\tif (diagonal === diagonalMin || (diagonal < diagonalMax && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1])) {\r\n\t\t\t\t\t// Horizontal line (the element is a deletion))\r\n\t\t\t\t\toriginalIndex = reversePoints[diagonal + 1] - 1;\r\n\t\t\t\t\tmodifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\r\n\t\t\t\t\tif (originalIndex > lastOriginalIndex) {\r\n\t\t\t\t\t\tchangeHelper.MarkNextChange();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastOriginalIndex = originalIndex + 1;\r\n\t\t\t\t\tchangeHelper.AddOriginalElement(originalIndex + 1, modifiedIndex + 1);\r\n\t\t\t\t\tdiagonalRelative = (diagonal + 1) - diagonalReverseBase; //Setup for the next iteration\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Vertical line (the element is an insertion)\r\n\t\t\t\t\toriginalIndex = reversePoints[diagonal - 1];\r\n\t\t\t\t\tmodifiedIndex = originalIndex - diagonalRelative - diagonalReverseOffset;\r\n\t\t\t\t\tif (originalIndex > lastOriginalIndex) {\r\n\t\t\t\t\t\tchangeHelper.MarkNextChange();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastOriginalIndex = originalIndex;\r\n\t\t\t\t\tchangeHelper.AddModifiedElement(originalIndex + 1, modifiedIndex + 1);\r\n\t\t\t\t\tdiagonalRelative = (diagonal - 1) - diagonalReverseBase; //Setup for the next iteration\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (historyIndex >= 0) {\r\n\t\t\t\t\treversePoints = this.m_reverseHistory[historyIndex];\r\n\t\t\t\t\tdiagonalReverseBase = reversePoints[0]; //We stored this in the first spot\r\n\t\t\t\t\tdiagonalMin = 1;\r\n\t\t\t\t\tdiagonalMax = reversePoints.length - 1;\r\n\t\t\t\t}\r\n\t\t\t} while (--historyIndex >= -1);\r\n\r\n\t\t\t// There are cases where the reverse history will find diffs that\r\n\t\t\t// are correct, but not intuitive, so we need shift them.\r\n\t\t\treverseChanges = changeHelper.getChanges();\r\n\t\t}\r\n\r\n\t\treturn this.ConcatenateChanges(forwardChanges, reverseChanges);\r\n\t}\r\n\r\n\t/**\r\n\t * Given the range to compute the diff on, this method finds the point:\r\n\t * (midOriginal, midModified)\r\n\t * that exists in the middle of the LCS of the two sequences and\r\n\t * is the point at which the LCS problem may be broken down recursively.\r\n\t * This method will try to keep the LCS trace in memory. If the LCS recursion\r\n\t * point is calculated and the full trace is available in memory, then this method\r\n\t * will return the change list.\r\n\t * @param originalStart The start bound of the original sequence range\r\n\t * @param originalEnd The end bound of the original sequence range\r\n\t * @param modifiedStart The start bound of the modified sequence range\r\n\t * @param modifiedEnd The end bound of the modified sequence range\r\n\t * @param midOriginal The middle point of the original sequence range\r\n\t * @param midModified The middle point of the modified sequence range\r\n\t * @returns The diff changes, if available, otherwise null\r\n\t */\r\n\tprivate ComputeRecursionPoint(originalStart: number, originalEnd: number, modifiedStart: number, modifiedEnd: number, midOriginalArr: number[], midModifiedArr: number[], quitEarlyArr: boolean[]) {\r\n\t\tlet originalIndex = 0, modifiedIndex = 0;\r\n\t\tlet diagonalForwardStart = 0, diagonalForwardEnd = 0;\r\n\t\tlet diagonalReverseStart = 0, diagonalReverseEnd = 0;\r\n\r\n\t\t// To traverse the edit graph and produce the proper LCS, our actual\r\n\t\t// start position is just outside the given boundary\r\n\t\toriginalStart--;\r\n\t\tmodifiedStart--;\r\n\r\n\t\t// We set these up to make the compiler happy, but they will\r\n\t\t// be replaced before we return with the actual recursion point\r\n\t\tmidOriginalArr[0] = 0;\r\n\t\tmidModifiedArr[0] = 0;\r\n\r\n\t\t// Clear out the history\r\n\t\tthis.m_forwardHistory = [];\r\n\t\tthis.m_reverseHistory = [];\r\n\r\n\t\t// Each cell in the two arrays corresponds to a diagonal in the edit graph.\r\n\t\t// The integer value in the cell represents the originalIndex of the furthest\r\n\t\t// reaching point found so far that ends in that diagonal.\r\n\t\t// The modifiedIndex can be computed mathematically from the originalIndex and the diagonal number.\r\n\t\tconst maxDifferences = (originalEnd - originalStart) + (modifiedEnd - modifiedStart);\r\n\t\tconst numDiagonals = maxDifferences + 1;\r\n\t\tconst forwardPoints = new Int32Array(numDiagonals);\r\n\t\tconst reversePoints = new Int32Array(numDiagonals);\r\n\t\t// diagonalForwardBase: Index into forwardPoints of the diagonal which passes through (originalStart, modifiedStart)\r\n\t\t// diagonalReverseBase: Index into reversePoints of the diagonal which passes through (originalEnd, modifiedEnd)\r\n\t\tconst diagonalForwardBase = (modifiedEnd - modifiedStart);\r\n\t\tconst diagonalReverseBase = (originalEnd - originalStart);\r\n\t\t// diagonalForwardOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\r\n\t\t//    diagonal number (relative to diagonalForwardBase)\r\n\t\t// diagonalReverseOffset: Geometric offset which allows modifiedIndex to be computed from originalIndex and the\r\n\t\t//    diagonal number (relative to diagonalReverseBase)\r\n\t\tconst diagonalForwardOffset = (originalStart - modifiedStart);\r\n\t\tconst diagonalReverseOffset = (originalEnd - modifiedEnd);\r\n\r\n\t\t// delta: The difference between the end diagonal and the start diagonal. This is used to relate diagonal numbers\r\n\t\t//   relative to the start diagonal with diagonal numbers relative to the end diagonal.\r\n\t\t// The Even/Oddn-ness of this delta is important for determining when we should check for overlap\r\n\t\tconst delta = diagonalReverseBase - diagonalForwardBase;\r\n\t\tconst deltaIsEven = (delta % 2 === 0);\r\n\r\n\t\t// Here we set up the start and end points as the furthest points found so far\r\n\t\t// in both the forward and reverse directions, respectively\r\n\t\tforwardPoints[diagonalForwardBase] = originalStart;\r\n\t\treversePoints[diagonalReverseBase] = originalEnd;\r\n\r\n\t\t// Remember if we quit early, and thus need to do a best-effort result instead of a real result.\r\n\t\tquitEarlyArr[0] = false;\r\n\r\n\r\n\r\n\t\t// A couple of points:\r\n\t\t// --With this method, we iterate on the number of differences between the two sequences.\r\n\t\t//   The more differences there actually are, the longer this will take.\r\n\t\t// --Also, as the number of differences increases, we have to search on diagonals further\r\n\t\t//   away from the reference diagonal (which is diagonalForwardBase for forward, diagonalReverseBase for reverse).\r\n\t\t// --We extend on even diagonals (relative to the reference diagonal) only when numDifferences\r\n\t\t//   is even and odd diagonals only when numDifferences is odd.\r\n\t\tfor (let numDifferences = 1; numDifferences <= (maxDifferences / 2) + 1; numDifferences++) {\r\n\t\t\tlet furthestOriginalIndex = 0;\r\n\t\t\tlet furthestModifiedIndex = 0;\r\n\r\n\t\t\t// Run the algorithm in the forward direction\r\n\t\t\tdiagonalForwardStart = this.ClipDiagonalBound(diagonalForwardBase - numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\r\n\t\t\tdiagonalForwardEnd = this.ClipDiagonalBound(diagonalForwardBase + numDifferences, numDifferences, diagonalForwardBase, numDiagonals);\r\n\t\t\tfor (let diagonal = diagonalForwardStart; diagonal <= diagonalForwardEnd; diagonal += 2) {\r\n\t\t\t\t// STEP 1: We extend the furthest reaching point in the present diagonal\r\n\t\t\t\t// by looking at the diagonals above and below and picking the one whose point\r\n\t\t\t\t// is further away from the start point (originalStart, modifiedStart)\r\n\t\t\t\tif (diagonal === diagonalForwardStart || (diagonal < diagonalForwardEnd && forwardPoints[diagonal - 1] < forwardPoints[diagonal + 1])) {\r\n\t\t\t\t\toriginalIndex = forwardPoints[diagonal + 1];\r\n\t\t\t\t} else {\r\n\t\t\t\t\toriginalIndex = forwardPoints[diagonal - 1] + 1;\r\n\t\t\t\t}\r\n\t\t\t\tmodifiedIndex = originalIndex - (diagonal - diagonalForwardBase) - diagonalForwardOffset;\r\n\r\n\t\t\t\t// Save the current originalIndex so we can test for false overlap in step 3\r\n\t\t\t\tconst tempOriginalIndex = originalIndex;\r\n\r\n\t\t\t\t// STEP 2: We can continue to extend the furthest reaching point in the present diagonal\r\n\t\t\t\t// so long as the elements are equal.\r\n\t\t\t\twhile (originalIndex < originalEnd && modifiedIndex < modifiedEnd && this.ElementsAreEqual(originalIndex + 1, modifiedIndex + 1)) {\r\n\t\t\t\t\toriginalIndex++;\r\n\t\t\t\t\tmodifiedIndex++;\r\n\t\t\t\t}\r\n\t\t\t\tforwardPoints[diagonal] = originalIndex;\r\n\r\n\t\t\t\tif (originalIndex + modifiedIndex > furthestOriginalIndex + furthestModifiedIndex) {\r\n\t\t\t\t\tfurthestOriginalIndex = originalIndex;\r\n\t\t\t\t\tfurthestModifiedIndex = modifiedIndex;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// STEP 3: If delta is odd (overlap first happens on forward when delta is odd)\r\n\t\t\t\t// and diagonal is in the range of reverse diagonals computed for numDifferences-1\r\n\t\t\t\t// (the previous iteration; we haven't computed reverse diagonals for numDifferences yet)\r\n\t\t\t\t// then check for overlap.\r\n\t\t\t\tif (!deltaIsEven && Math.abs(diagonal - diagonalReverseBase) <= (numDifferences - 1)) {\r\n\t\t\t\t\tif (originalIndex >= reversePoints[diagonal]) {\r\n\t\t\t\t\t\tmidOriginalArr[0] = originalIndex;\r\n\t\t\t\t\t\tmidModifiedArr[0] = modifiedIndex;\r\n\r\n\t\t\t\t\t\tif (tempOriginalIndex <= reversePoints[diagonal] && LocalConstants.MaxDifferencesHistory > 0 && numDifferences <= (LocalConstants.MaxDifferencesHistory + 1)) {\r\n\t\t\t\t\t\t\t// BINGO! We overlapped, and we have the full trace in memory!\r\n\t\t\t\t\t\t\treturn this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset,\r\n\t\t\t\t\t\t\t\tdiagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset,\r\n\t\t\t\t\t\t\t\tforwardPoints, reversePoints,\r\n\t\t\t\t\t\t\t\toriginalIndex, originalEnd, midOriginalArr,\r\n\t\t\t\t\t\t\t\tmodifiedIndex, modifiedEnd, midModifiedArr,\r\n\t\t\t\t\t\t\t\tdeltaIsEven, quitEarlyArr\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Either false overlap, or we didn't have enough memory for the full trace\r\n\t\t\t\t\t\t\t// Just return the recursion point\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Check to see if we should be quitting early, before moving on to the next iteration.\r\n\t\t\tconst matchLengthOfLongest = ((furthestOriginalIndex - originalStart) + (furthestModifiedIndex - modifiedStart) - numDifferences) / 2;\r\n\r\n\t\t\tif (this.ContinueProcessingPredicate !== null && !this.ContinueProcessingPredicate(furthestOriginalIndex, matchLengthOfLongest)) {\r\n\t\t\t\t// We can't finish, so skip ahead to generating a result from what we have.\r\n\t\t\t\tquitEarlyArr[0] = true;\r\n\r\n\t\t\t\t// Use the furthest distance we got in the forward direction.\r\n\t\t\t\tmidOriginalArr[0] = furthestOriginalIndex;\r\n\t\t\t\tmidModifiedArr[0] = furthestModifiedIndex;\r\n\r\n\t\t\t\tif (matchLengthOfLongest > 0 && LocalConstants.MaxDifferencesHistory > 0 && numDifferences <= (LocalConstants.MaxDifferencesHistory + 1)) {\r\n\t\t\t\t\t// Enough of the history is in memory to walk it backwards\r\n\t\t\t\t\treturn this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset,\r\n\t\t\t\t\t\tdiagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset,\r\n\t\t\t\t\t\tforwardPoints, reversePoints,\r\n\t\t\t\t\t\toriginalIndex, originalEnd, midOriginalArr,\r\n\t\t\t\t\t\tmodifiedIndex, modifiedEnd, midModifiedArr,\r\n\t\t\t\t\t\tdeltaIsEven, quitEarlyArr\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// We didn't actually remember enough of the history.\r\n\r\n\t\t\t\t\t//Since we are quitting the diff early, we need to shift back the originalStart and modified start\r\n\t\t\t\t\t//back into the boundary limits since we decremented their value above beyond the boundary limit.\r\n\t\t\t\t\toriginalStart++;\r\n\t\t\t\t\tmodifiedStart++;\r\n\r\n\t\t\t\t\treturn [\r\n\t\t\t\t\t\tnew DiffChange(originalStart, originalEnd - originalStart + 1,\r\n\t\t\t\t\t\t\tmodifiedStart, modifiedEnd - modifiedStart + 1)\r\n\t\t\t\t\t];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Run the algorithm in the reverse direction\r\n\t\t\tdiagonalReverseStart = this.ClipDiagonalBound(diagonalReverseBase - numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\r\n\t\t\tdiagonalReverseEnd = this.ClipDiagonalBound(diagonalReverseBase + numDifferences, numDifferences, diagonalReverseBase, numDiagonals);\r\n\t\t\tfor (let diagonal = diagonalReverseStart; diagonal <= diagonalReverseEnd; diagonal += 2) {\r\n\t\t\t\t// STEP 1: We extend the furthest reaching point in the present diagonal\r\n\t\t\t\t// by looking at the diagonals above and below and picking the one whose point\r\n\t\t\t\t// is further away from the start point (originalEnd, modifiedEnd)\r\n\t\t\t\tif (diagonal === diagonalReverseStart || (diagonal < diagonalReverseEnd && reversePoints[diagonal - 1] >= reversePoints[diagonal + 1])) {\r\n\t\t\t\t\toriginalIndex = reversePoints[diagonal + 1] - 1;\r\n\t\t\t\t} else {\r\n\t\t\t\t\toriginalIndex = reversePoints[diagonal - 1];\r\n\t\t\t\t}\r\n\t\t\t\tmodifiedIndex = originalIndex - (diagonal - diagonalReverseBase) - diagonalReverseOffset;\r\n\r\n\t\t\t\t// Save the current originalIndex so we can test for false overlap\r\n\t\t\t\tconst tempOriginalIndex = originalIndex;\r\n\r\n\t\t\t\t// STEP 2: We can continue to extend the furthest reaching point in the present diagonal\r\n\t\t\t\t// as long as the elements are equal.\r\n\t\t\t\twhile (originalIndex > originalStart && modifiedIndex > modifiedStart && this.ElementsAreEqual(originalIndex, modifiedIndex)) {\r\n\t\t\t\t\toriginalIndex--;\r\n\t\t\t\t\tmodifiedIndex--;\r\n\t\t\t\t}\r\n\t\t\t\treversePoints[diagonal] = originalIndex;\r\n\r\n\t\t\t\t// STEP 4: If delta is even (overlap first happens on reverse when delta is even)\r\n\t\t\t\t// and diagonal is in the range of forward diagonals computed for numDifferences\r\n\t\t\t\t// then check for overlap.\r\n\t\t\t\tif (deltaIsEven && Math.abs(diagonal - diagonalForwardBase) <= numDifferences) {\r\n\t\t\t\t\tif (originalIndex <= forwardPoints[diagonal]) {\r\n\t\t\t\t\t\tmidOriginalArr[0] = originalIndex;\r\n\t\t\t\t\t\tmidModifiedArr[0] = modifiedIndex;\r\n\r\n\t\t\t\t\t\tif (tempOriginalIndex >= forwardPoints[diagonal] && LocalConstants.MaxDifferencesHistory > 0 && numDifferences <= (LocalConstants.MaxDifferencesHistory + 1)) {\r\n\t\t\t\t\t\t\t// BINGO! We overlapped, and we have the full trace in memory!\r\n\t\t\t\t\t\t\treturn this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset,\r\n\t\t\t\t\t\t\t\tdiagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset,\r\n\t\t\t\t\t\t\t\tforwardPoints, reversePoints,\r\n\t\t\t\t\t\t\t\toriginalIndex, originalEnd, midOriginalArr,\r\n\t\t\t\t\t\t\t\tmodifiedIndex, modifiedEnd, midModifiedArr,\r\n\t\t\t\t\t\t\t\tdeltaIsEven, quitEarlyArr\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Either false overlap, or we didn't have enough memory for the full trace\r\n\t\t\t\t\t\t\t// Just return the recursion point\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Save current vectors to history before the next iteration\r\n\t\t\tif (numDifferences <= LocalConstants.MaxDifferencesHistory) {\r\n\t\t\t\t// We are allocating space for one extra int, which we fill with\r\n\t\t\t\t// the index of the diagonal base index\r\n\t\t\t\tlet temp = new Int32Array(diagonalForwardEnd - diagonalForwardStart + 2);\r\n\t\t\t\ttemp[0] = diagonalForwardBase - diagonalForwardStart + 1;\r\n\t\t\t\tMyArray.Copy2(forwardPoints, diagonalForwardStart, temp, 1, diagonalForwardEnd - diagonalForwardStart + 1);\r\n\t\t\t\tthis.m_forwardHistory.push(temp);\r\n\r\n\t\t\t\ttemp = new Int32Array(diagonalReverseEnd - diagonalReverseStart + 2);\r\n\t\t\t\ttemp[0] = diagonalReverseBase - diagonalReverseStart + 1;\r\n\t\t\t\tMyArray.Copy2(reversePoints, diagonalReverseStart, temp, 1, diagonalReverseEnd - diagonalReverseStart + 1);\r\n\t\t\t\tthis.m_reverseHistory.push(temp);\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// If we got here, then we have the full trace in history. We just have to convert it to a change list\r\n\t\t// NOTE: This part is a bit messy\r\n\t\treturn this.WALKTRACE(diagonalForwardBase, diagonalForwardStart, diagonalForwardEnd, diagonalForwardOffset,\r\n\t\t\tdiagonalReverseBase, diagonalReverseStart, diagonalReverseEnd, diagonalReverseOffset,\r\n\t\t\tforwardPoints, reversePoints,\r\n\t\t\toriginalIndex, originalEnd, midOriginalArr,\r\n\t\t\tmodifiedIndex, modifiedEnd, midModifiedArr,\r\n\t\t\tdeltaIsEven, quitEarlyArr\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Shifts the given changes to provide a more intuitive diff.\r\n\t * While the first element in a diff matches the first element after the diff,\r\n\t * we shift the diff down.\r\n\t *\r\n\t * @param changes The list of changes to shift\r\n\t * @returns The shifted changes\r\n\t */\r\n\tprivate PrettifyChanges(changes: DiffChange[]): DiffChange[] {\r\n\r\n\t\t// Shift all the changes down first\r\n\t\tfor (let i = 0; i < changes.length; i++) {\r\n\t\t\tconst change = changes[i];\r\n\t\t\tconst originalStop = (i < changes.length - 1) ? changes[i + 1].originalStart : this._originalElementsOrHash.length;\r\n\t\t\tconst modifiedStop = (i < changes.length - 1) ? changes[i + 1].modifiedStart : this._modifiedElementsOrHash.length;\r\n\t\t\tconst checkOriginal = change.originalLength > 0;\r\n\t\t\tconst checkModified = change.modifiedLength > 0;\r\n\r\n\t\t\twhile (\r\n\t\t\t\tchange.originalStart + change.originalLength < originalStop\r\n\t\t\t\t&& change.modifiedStart + change.modifiedLength < modifiedStop\r\n\t\t\t\t&& (!checkOriginal || this.OriginalElementsAreEqual(change.originalStart, change.originalStart + change.originalLength))\r\n\t\t\t\t&& (!checkModified || this.ModifiedElementsAreEqual(change.modifiedStart, change.modifiedStart + change.modifiedLength))\r\n\t\t\t) {\r\n\t\t\t\tconst startStrictEqual = this.ElementsAreStrictEqual(change.originalStart, change.modifiedStart);\r\n\t\t\t\tconst endStrictEqual = this.ElementsAreStrictEqual(change.originalStart + change.originalLength, change.modifiedStart + change.modifiedLength);\r\n\t\t\t\tif (endStrictEqual && !startStrictEqual) {\r\n\t\t\t\t\t// moving the change down would create an equal change, but the elements are not strict equal\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tchange.originalStart++;\r\n\t\t\t\tchange.modifiedStart++;\r\n\t\t\t}\r\n\r\n\t\t\tconst mergedChangeArr: Array<DiffChange | null> = [null];\r\n\t\t\tif (i < changes.length - 1 && this.ChangesOverlap(changes[i], changes[i + 1], mergedChangeArr)) {\r\n\t\t\t\tchanges[i] = mergedChangeArr[0]!;\r\n\t\t\t\tchanges.splice(i + 1, 1);\r\n\t\t\t\ti--;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Shift changes back up until we hit empty or whitespace-only lines\r\n\t\tfor (let i = changes.length - 1; i >= 0; i--) {\r\n\t\t\tconst change = changes[i];\r\n\r\n\t\t\tlet originalStop = 0;\r\n\t\t\tlet modifiedStop = 0;\r\n\t\t\tif (i > 0) {\r\n\t\t\t\tconst prevChange = changes[i - 1];\r\n\t\t\t\toriginalStop = prevChange.originalStart + prevChange.originalLength;\r\n\t\t\t\tmodifiedStop = prevChange.modifiedStart + prevChange.modifiedLength;\r\n\t\t\t}\r\n\r\n\t\t\tconst checkOriginal = change.originalLength > 0;\r\n\t\t\tconst checkModified = change.modifiedLength > 0;\r\n\r\n\t\t\tlet bestDelta = 0;\r\n\t\t\tlet bestScore = this._boundaryScore(change.originalStart, change.originalLength, change.modifiedStart, change.modifiedLength);\r\n\r\n\t\t\tfor (let delta = 1; ; delta++) {\r\n\t\t\t\tconst originalStart = change.originalStart - delta;\r\n\t\t\t\tconst modifiedStart = change.modifiedStart - delta;\r\n\r\n\t\t\t\tif (originalStart < originalStop || modifiedStart < modifiedStop) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (checkOriginal && !this.OriginalElementsAreEqual(originalStart, originalStart + change.originalLength)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (checkModified && !this.ModifiedElementsAreEqual(modifiedStart, modifiedStart + change.modifiedLength)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst touchingPreviousChange = (originalStart === originalStop && modifiedStart === modifiedStop);\r\n\t\t\t\tconst score = (\r\n\t\t\t\t\t(touchingPreviousChange ? 5 : 0)\r\n\t\t\t\t\t+ this._boundaryScore(originalStart, change.originalLength, modifiedStart, change.modifiedLength)\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (score > bestScore) {\r\n\t\t\t\t\tbestScore = score;\r\n\t\t\t\t\tbestDelta = delta;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tchange.originalStart -= bestDelta;\r\n\t\t\tchange.modifiedStart -= bestDelta;\r\n\r\n\t\t\tconst mergedChangeArr: Array<DiffChange | null> = [null];\r\n\t\t\tif (i > 0 && this.ChangesOverlap(changes[i - 1], changes[i], mergedChangeArr)) {\r\n\t\t\t\tchanges[i - 1] = mergedChangeArr[0]!;\r\n\t\t\t\tchanges.splice(i, 1);\r\n\t\t\t\ti++;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// There could be multiple longest common substrings.\r\n\t\t// Give preference to the ones containing longer lines\r\n\t\tif (this._hasStrings) {\r\n\t\t\tfor (let i = 1, len = changes.length; i < len; i++) {\r\n\t\t\t\tconst aChange = changes[i - 1];\r\n\t\t\t\tconst bChange = changes[i];\r\n\t\t\t\tconst matchedLength = bChange.originalStart - aChange.originalStart - aChange.originalLength;\r\n\t\t\t\tconst aOriginalStart = aChange.originalStart;\r\n\t\t\t\tconst bOriginalEnd = bChange.originalStart + bChange.originalLength;\r\n\t\t\t\tconst abOriginalLength = bOriginalEnd - aOriginalStart;\r\n\t\t\t\tconst aModifiedStart = aChange.modifiedStart;\r\n\t\t\t\tconst bModifiedEnd = bChange.modifiedStart + bChange.modifiedLength;\r\n\t\t\t\tconst abModifiedLength = bModifiedEnd - aModifiedStart;\r\n\t\t\t\t// Avoid wasting a lot of time with these searches\r\n\t\t\t\tif (matchedLength < 5 && abOriginalLength < 20 && abModifiedLength < 20) {\r\n\t\t\t\t\tconst t = this._findBetterContiguousSequence(\r\n\t\t\t\t\t\taOriginalStart, abOriginalLength,\r\n\t\t\t\t\t\taModifiedStart, abModifiedLength,\r\n\t\t\t\t\t\tmatchedLength\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (t) {\r\n\t\t\t\t\t\tconst [originalMatchStart, modifiedMatchStart] = t;\r\n\t\t\t\t\t\tif (originalMatchStart !== aChange.originalStart + aChange.originalLength || modifiedMatchStart !== aChange.modifiedStart + aChange.modifiedLength) {\r\n\t\t\t\t\t\t\t// switch to another sequence that has a better score\r\n\t\t\t\t\t\t\taChange.originalLength = originalMatchStart - aChange.originalStart;\r\n\t\t\t\t\t\t\taChange.modifiedLength = modifiedMatchStart - aChange.modifiedStart;\r\n\t\t\t\t\t\t\tbChange.originalStart = originalMatchStart + matchedLength;\r\n\t\t\t\t\t\t\tbChange.modifiedStart = modifiedMatchStart + matchedLength;\r\n\t\t\t\t\t\t\tbChange.originalLength = bOriginalEnd - bChange.originalStart;\r\n\t\t\t\t\t\t\tbChange.modifiedLength = bModifiedEnd - bChange.modifiedStart;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn changes;\r\n\t}\r\n\r\n\tprivate _findBetterContiguousSequence(originalStart: number, originalLength: number, modifiedStart: number, modifiedLength: number, desiredLength: number): [number, number] | null {\r\n\t\tif (originalLength < desiredLength || modifiedLength < desiredLength) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst originalMax = originalStart + originalLength - desiredLength + 1;\r\n\t\tconst modifiedMax = modifiedStart + modifiedLength - desiredLength + 1;\r\n\t\tlet bestScore = 0;\r\n\t\tlet bestOriginalStart = 0;\r\n\t\tlet bestModifiedStart = 0;\r\n\t\tfor (let i = originalStart; i < originalMax; i++) {\r\n\t\t\tfor (let j = modifiedStart; j < modifiedMax; j++) {\r\n\t\t\t\tconst score = this._contiguousSequenceScore(i, j, desiredLength);\r\n\t\t\t\tif (score > 0 && score > bestScore) {\r\n\t\t\t\t\tbestScore = score;\r\n\t\t\t\t\tbestOriginalStart = i;\r\n\t\t\t\t\tbestModifiedStart = j;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (bestScore > 0) {\r\n\t\t\treturn [bestOriginalStart, bestModifiedStart];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate _contiguousSequenceScore(originalStart: number, modifiedStart: number, length: number): number {\r\n\t\tlet score = 0;\r\n\t\tfor (let l = 0; l < length; l++) {\r\n\t\t\tif (!this.ElementsAreEqual(originalStart + l, modifiedStart + l)) {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t\tscore += this._originalStringElements[originalStart + l].length;\r\n\t\t}\r\n\t\treturn score;\r\n\t}\r\n\r\n\tprivate _OriginalIsBoundary(index: number): boolean {\r\n\t\tif (index <= 0 || index >= this._originalElementsOrHash.length - 1) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn (this._hasStrings && /^\\s*$/.test(this._originalStringElements[index]));\r\n\t}\r\n\r\n\tprivate _OriginalRegionIsBoundary(originalStart: number, originalLength: number): boolean {\r\n\t\tif (this._OriginalIsBoundary(originalStart) || this._OriginalIsBoundary(originalStart - 1)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (originalLength > 0) {\r\n\t\t\tconst originalEnd = originalStart + originalLength;\r\n\t\t\tif (this._OriginalIsBoundary(originalEnd - 1) || this._OriginalIsBoundary(originalEnd)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate _ModifiedIsBoundary(index: number): boolean {\r\n\t\tif (index <= 0 || index >= this._modifiedElementsOrHash.length - 1) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn (this._hasStrings && /^\\s*$/.test(this._modifiedStringElements[index]));\r\n\t}\r\n\r\n\tprivate _ModifiedRegionIsBoundary(modifiedStart: number, modifiedLength: number): boolean {\r\n\t\tif (this._ModifiedIsBoundary(modifiedStart) || this._ModifiedIsBoundary(modifiedStart - 1)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (modifiedLength > 0) {\r\n\t\t\tconst modifiedEnd = modifiedStart + modifiedLength;\r\n\t\t\tif (this._ModifiedIsBoundary(modifiedEnd - 1) || this._ModifiedIsBoundary(modifiedEnd)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate _boundaryScore(originalStart: number, originalLength: number, modifiedStart: number, modifiedLength: number): number {\r\n\t\tconst originalScore = (this._OriginalRegionIsBoundary(originalStart, originalLength) ? 1 : 0);\r\n\t\tconst modifiedScore = (this._ModifiedRegionIsBoundary(modifiedStart, modifiedLength) ? 1 : 0);\r\n\t\treturn (originalScore + modifiedScore);\r\n\t}\r\n\r\n\t/**\r\n\t * Concatenates the two input DiffChange lists and returns the resulting\r\n\t * list.\r\n\t * @param The left changes\r\n\t * @param The right changes\r\n\t * @returns The concatenated list\r\n\t */\r\n\tprivate ConcatenateChanges(left: DiffChange[], right: DiffChange[]): DiffChange[] {\r\n\t\tconst mergedChangeArr: DiffChange[] = [];\r\n\r\n\t\tif (left.length === 0 || right.length === 0) {\r\n\t\t\treturn (right.length > 0) ? right : left;\r\n\t\t} else if (this.ChangesOverlap(left[left.length - 1], right[0], mergedChangeArr)) {\r\n\t\t\t// Since we break the problem down recursively, it is possible that we\r\n\t\t\t// might recurse in the middle of a change thereby splitting it into\r\n\t\t\t// two changes. Here in the combining stage, we detect and fuse those\r\n\t\t\t// changes back together\r\n\t\t\tconst result = new Array<DiffChange>(left.length + right.length - 1);\r\n\t\t\tMyArray.Copy(left, 0, result, 0, left.length - 1);\r\n\t\t\tresult[left.length - 1] = mergedChangeArr[0];\r\n\t\t\tMyArray.Copy(right, 1, result, left.length, right.length - 1);\r\n\r\n\t\t\treturn result;\r\n\t\t} else {\r\n\t\t\tconst result = new Array<DiffChange>(left.length + right.length);\r\n\t\t\tMyArray.Copy(left, 0, result, 0, left.length);\r\n\t\t\tMyArray.Copy(right, 0, result, left.length, right.length);\r\n\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns true if the two changes overlap and can be merged into a single\r\n\t * change\r\n\t * @param left The left change\r\n\t * @param right The right change\r\n\t * @param mergedChange The merged change if the two overlap, null otherwise\r\n\t * @returns True if the two changes overlap\r\n\t */\r\n\tprivate ChangesOverlap(left: DiffChange, right: DiffChange, mergedChangeArr: Array<DiffChange | null>): boolean {\r\n\t\tDebug.Assert(left.originalStart <= right.originalStart, 'Left change is not less than or equal to right change');\r\n\t\tDebug.Assert(left.modifiedStart <= right.modifiedStart, 'Left change is not less than or equal to right change');\r\n\r\n\t\tif (left.originalStart + left.originalLength >= right.originalStart || left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\r\n\t\t\tconst originalStart = left.originalStart;\r\n\t\t\tlet originalLength = left.originalLength;\r\n\t\t\tconst modifiedStart = left.modifiedStart;\r\n\t\t\tlet modifiedLength = left.modifiedLength;\r\n\r\n\t\t\tif (left.originalStart + left.originalLength >= right.originalStart) {\r\n\t\t\t\toriginalLength = right.originalStart + right.originalLength - left.originalStart;\r\n\t\t\t}\r\n\t\t\tif (left.modifiedStart + left.modifiedLength >= right.modifiedStart) {\r\n\t\t\t\tmodifiedLength = right.modifiedStart + right.modifiedLength - left.modifiedStart;\r\n\t\t\t}\r\n\r\n\t\t\tmergedChangeArr[0] = new DiffChange(originalStart, originalLength, modifiedStart, modifiedLength);\r\n\t\t\treturn true;\r\n\t\t} else {\r\n\t\t\tmergedChangeArr[0] = null;\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Helper method used to clip a diagonal index to the range of valid\r\n\t * diagonals. This also decides whether or not the diagonal index,\r\n\t * if it exceeds the boundary, should be clipped to the boundary or clipped\r\n\t * one inside the boundary depending on the Even/Odd status of the boundary\r\n\t * and numDifferences.\r\n\t * @param diagonal The index of the diagonal to clip.\r\n\t * @param numDifferences The current number of differences being iterated upon.\r\n\t * @param diagonalBaseIndex The base reference diagonal.\r\n\t * @param numDiagonals The total number of diagonals.\r\n\t * @returns The clipped diagonal index.\r\n\t */\r\n\tprivate ClipDiagonalBound(diagonal: number, numDifferences: number, diagonalBaseIndex: number, numDiagonals: number): number {\r\n\t\tif (diagonal >= 0 && diagonal < numDiagonals) {\r\n\t\t\t// Nothing to clip, its in range\r\n\t\t\treturn diagonal;\r\n\t\t}\r\n\r\n\t\t// diagonalsBelow: The number of diagonals below the reference diagonal\r\n\t\t// diagonalsAbove: The number of diagonals above the reference diagonal\r\n\t\tconst diagonalsBelow = diagonalBaseIndex;\r\n\t\tconst diagonalsAbove = numDiagonals - diagonalBaseIndex - 1;\r\n\t\tconst diffEven = (numDifferences % 2 === 0);\r\n\r\n\t\tif (diagonal < 0) {\r\n\t\t\tconst lowerBoundEven = (diagonalsBelow % 2 === 0);\r\n\t\t\treturn (diffEven === lowerBoundEven) ? 0 : 1;\r\n\t\t} else {\r\n\t\t\tconst upperBoundEven = (diagonalsAbove % 2 === 0);\r\n\t\t\treturn (diffEven === upperBoundEven) ? numDiagonals - 1 : numDiagonals - 2;\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/**\r\n * @returns whether the provided parameter is a JavaScript String or not.\r\n */\r\nexport function isString(str: unknown): str is string {\r\n\treturn (typeof str === 'string');\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is of type `object` but **not**\r\n *\t`null`, an `array`, a `regexp`, nor a `date`.\r\n */\r\nexport function isObject(obj: unknown): obj is Object {\r\n\t// The method can't do a type cast since there are type (like strings) which\r\n\t// are subclasses of any put not positvely matched by the function. Hence type\r\n\t// narrowing results in wrong results.\r\n\treturn typeof obj === 'object'\r\n\t\t&& obj !== null\r\n\t\t&& !Array.isArray(obj)\r\n\t\t&& !(obj instanceof RegExp)\r\n\t\t&& !(obj instanceof Date);\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is of type `Buffer` or Uint8Array dervived type\r\n */\r\nexport function isTypedArray(obj: unknown): obj is Object {\r\n\tconst TypedArray = Object.getPrototypeOf(Uint8Array);\r\n\treturn typeof obj === 'object'\r\n\t\t&& obj instanceof TypedArray;\r\n}\r\n\r\n/**\r\n * In **contrast** to just checking `typeof` this will return `false` for `NaN`.\r\n * @returns whether the provided parameter is a JavaScript Number or not.\r\n */\r\nexport function isNumber(obj: unknown): obj is number {\r\n\treturn (typeof obj === 'number' && !isNaN(obj));\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is an Iterable, casting to the given generic\r\n */\r\nexport function isIterable<T>(obj: unknown): obj is Iterable<T> {\r\n\treturn !!obj && typeof (obj as any)[Symbol.iterator] === 'function';\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Boolean or not.\r\n */\r\nexport function isBoolean(obj: unknown): obj is boolean {\r\n\treturn (obj === true || obj === false);\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is undefined.\r\n */\r\nexport function isUndefined(obj: unknown): obj is undefined {\r\n\treturn (typeof obj === 'undefined');\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is defined.\r\n */\r\nexport function isDefined<T>(arg: T | null | undefined): arg is T {\r\n\treturn !isUndefinedOrNull(arg);\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is undefined or null.\r\n */\r\nexport function isUndefinedOrNull(obj: unknown): obj is undefined | null {\r\n\treturn (isUndefined(obj) || obj === null);\r\n}\r\n\r\n\r\nexport function assertType(condition: unknown, type?: string): asserts condition {\r\n\tif (!condition) {\r\n\t\tthrow new Error(type ? `Unexpected type, expected '${type}'` : 'Unexpected type');\r\n\t}\r\n}\r\n\r\n/**\r\n * Asserts that the argument passed in is neither undefined nor null.\r\n */\r\nexport function assertIsDefined<T>(arg: T | null | undefined): T {\r\n\tif (isUndefinedOrNull(arg)) {\r\n\t\tthrow new Error('Assertion Failed: argument is undefined or null');\r\n\t}\r\n\r\n\treturn arg;\r\n}\r\n\r\n/**\r\n * @returns whether the provided parameter is a JavaScript Function or not.\r\n */\r\nexport function isFunction(obj: unknown): obj is Function {\r\n\treturn (typeof obj === 'function');\r\n}\r\n\r\nexport type TypeConstraint = string | Function;\r\n\r\nexport function validateConstraints(args: unknown[], constraints: Array<TypeConstraint | undefined>): void {\r\n\tconst len = Math.min(args.length, constraints.length);\r\n\tfor (let i = 0; i < len; i++) {\r\n\t\tvalidateConstraint(args[i], constraints[i]);\r\n\t}\r\n}\r\n\r\nexport function validateConstraint(arg: unknown, constraint: TypeConstraint | undefined): void {\r\n\r\n\tif (isString(constraint)) {\r\n\t\tif (typeof arg !== constraint) {\r\n\t\t\tthrow new Error(`argument does not match constraint: typeof ${constraint}`);\r\n\t\t}\r\n\t} else if (isFunction(constraint)) {\r\n\t\ttry {\r\n\t\t\tif (arg instanceof constraint) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} catch {\r\n\t\t\t// ignore\r\n\t\t}\r\n\t\tif (!isUndefinedOrNull(arg) && (arg as any).constructor === constraint) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (constraint.length === 1 && constraint.call(undefined, arg) === true) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthrow new Error(`argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true`);\r\n\t}\r\n}\r\n\r\n/**\r\n * Only picks the non-optional properties of a type.\r\n */\r\nexport type OmitOptional<T> = { [K in keyof T as T[K] extends Required<T>[K] ? K : never]: T[K] };\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { ThemeIcon } from 'vs/base/common/themables';\r\nimport { isString } from 'vs/base/common/types';\r\n\r\nconst _codiconFontCharacters: { [id: string]: number } = Object.create(null);\r\n\r\nfunction register(id: string, fontCharacter: number | string): ThemeIcon {\r\n\tif (isString(fontCharacter)) {\r\n\t\tconst val = _codiconFontCharacters[fontCharacter];\r\n\t\tif (val === undefined) {\r\n\t\t\tthrow new Error(`${id} references an unknown codicon: ${fontCharacter}`);\r\n\t\t}\r\n\t\tfontCharacter = val;\r\n\t}\r\n\t_codiconFontCharacters[id] = fontCharacter;\r\n\treturn { id };\r\n}\r\n\r\n/**\r\n * Only to be used by the iconRegistry.\r\n */\r\nexport function getCodiconFontCharacters(): { [id: string]: number } {\r\n\treturn _codiconFontCharacters;\r\n}\r\n\r\n/**\r\n * The Codicon library is a set of default icons that are built-in in VS Code.\r\n *\r\n * In the product (outside of base) Codicons should only be used as defaults. In order to have all icons in VS Code\r\n * themeable, component should define new, UI component specific icons using `iconRegistry.registerIcon`.\r\n * In that call a Codicon can be named as default.\r\n */\r\nexport const Codicon = {\r\n\r\n\t// built-in icons, with image name\r\n\tadd: register('add', 0xea60),\r\n\tplus: register('plus', 0xea60),\r\n\tgistNew: register('gist-new', 0xea60),\r\n\trepoCreate: register('repo-create', 0xea60),\r\n\tlightbulb: register('lightbulb', 0xea61),\r\n\tlightBulb: register('light-bulb', 0xea61),\r\n\trepo: register('repo', 0xea62),\r\n\trepoDelete: register('repo-delete', 0xea62),\r\n\tgistFork: register('gist-fork', 0xea63),\r\n\trepoForked: register('repo-forked', 0xea63),\r\n\tgitPullRequest: register('git-pull-request', 0xea64),\r\n\tgitPullRequestAbandoned: register('git-pull-request-abandoned', 0xea64),\r\n\trecordKeys: register('record-keys', 0xea65),\r\n\tkeyboard: register('keyboard', 0xea65),\r\n\ttag: register('tag', 0xea66),\r\n\ttagAdd: register('tag-add', 0xea66),\r\n\ttagRemove: register('tag-remove', 0xea66),\r\n\tgitPullRequestLabel: register('git-pull-request-label', 0xea66),\r\n\tperson: register('person', 0xea67),\r\n\tpersonFollow: register('person-follow', 0xea67),\r\n\tpersonOutline: register('person-outline', 0xea67),\r\n\tpersonFilled: register('person-filled', 0xea67),\r\n\tgitBranch: register('git-branch', 0xea68),\r\n\tgitBranchCreate: register('git-branch-create', 0xea68),\r\n\tgitBranchDelete: register('git-branch-delete', 0xea68),\r\n\tsourceControl: register('source-control', 0xea68),\r\n\tmirror: register('mirror', 0xea69),\r\n\tmirrorPublic: register('mirror-public', 0xea69),\r\n\tstar: register('star', 0xea6a),\r\n\tstarAdd: register('star-add', 0xea6a),\r\n\tstarDelete: register('star-delete', 0xea6a),\r\n\tstarEmpty: register('star-empty', 0xea6a),\r\n\tcomment: register('comment', 0xea6b),\r\n\tcommentAdd: register('comment-add', 0xea6b),\r\n\talert: register('alert', 0xea6c),\r\n\twarning: register('warning', 0xea6c),\r\n\tsearch: register('search', 0xea6d),\r\n\tsearchSave: register('search-save', 0xea6d),\r\n\tlogOut: register('log-out', 0xea6e),\r\n\tsignOut: register('sign-out', 0xea6e),\r\n\tlogIn: register('log-in', 0xea6f),\r\n\tsignIn: register('sign-in', 0xea6f),\r\n\teye: register('eye', 0xea70),\r\n\teyeUnwatch: register('eye-unwatch', 0xea70),\r\n\teyeWatch: register('eye-watch', 0xea70),\r\n\tcircleFilled: register('circle-filled', 0xea71),\r\n\tprimitiveDot: register('primitive-dot', 0xea71),\r\n\tcloseDirty: register('close-dirty', 0xea71),\r\n\tdebugBreakpoint: register('debug-breakpoint', 0xea71),\r\n\tdebugBreakpointDisabled: register('debug-breakpoint-disabled', 0xea71),\r\n\tdebugHint: register('debug-hint', 0xea71),\r\n\tprimitiveSquare: register('primitive-square', 0xea72),\r\n\tedit: register('edit', 0xea73),\r\n\tpencil: register('pencil', 0xea73),\r\n\tinfo: register('info', 0xea74),\r\n\tissueOpened: register('issue-opened', 0xea74),\r\n\tgistPrivate: register('gist-private', 0xea75),\r\n\tgitForkPrivate: register('git-fork-private', 0xea75),\r\n\tlock: register('lock', 0xea75),\r\n\tmirrorPrivate: register('mirror-private', 0xea75),\r\n\tclose: register('close', 0xea76),\r\n\tremoveClose: register('remove-close', 0xea76),\r\n\tx: register('x', 0xea76),\r\n\trepoSync: register('repo-sync', 0xea77),\r\n\tsync: register('sync', 0xea77),\r\n\tclone: register('clone', 0xea78),\r\n\tdesktopDownload: register('desktop-download', 0xea78),\r\n\tbeaker: register('beaker', 0xea79),\r\n\tmicroscope: register('microscope', 0xea79),\r\n\tvm: register('vm', 0xea7a),\r\n\tdeviceDesktop: register('device-desktop', 0xea7a),\r\n\tfile: register('file', 0xea7b),\r\n\tfileText: register('file-text', 0xea7b),\r\n\tmore: register('more', 0xea7c),\r\n\tellipsis: register('ellipsis', 0xea7c),\r\n\tkebabHorizontal: register('kebab-horizontal', 0xea7c),\r\n\tmailReply: register('mail-reply', 0xea7d),\r\n\treply: register('reply', 0xea7d),\r\n\torganization: register('organization', 0xea7e),\r\n\torganizationFilled: register('organization-filled', 0xea7e),\r\n\torganizationOutline: register('organization-outline', 0xea7e),\r\n\tnewFile: register('new-file', 0xea7f),\r\n\tfileAdd: register('file-add', 0xea7f),\r\n\tnewFolder: register('new-folder', 0xea80),\r\n\tfileDirectoryCreate: register('file-directory-create', 0xea80),\r\n\ttrash: register('trash', 0xea81),\r\n\ttrashcan: register('trashcan', 0xea81),\r\n\thistory: register('history', 0xea82),\r\n\tclock: register('clock', 0xea82),\r\n\tfolder: register('folder', 0xea83),\r\n\tfileDirectory: register('file-directory', 0xea83),\r\n\tsymbolFolder: register('symbol-folder', 0xea83),\r\n\tlogoGithub: register('logo-github', 0xea84),\r\n\tmarkGithub: register('mark-github', 0xea84),\r\n\tgithub: register('github', 0xea84),\r\n\tterminal: register('terminal', 0xea85),\r\n\tconsole: register('console', 0xea85),\r\n\trepl: register('repl', 0xea85),\r\n\tzap: register('zap', 0xea86),\r\n\tsymbolEvent: register('symbol-event', 0xea86),\r\n\terror: register('error', 0xea87),\r\n\tstop: register('stop', 0xea87),\r\n\tvariable: register('variable', 0xea88),\r\n\tsymbolVariable: register('symbol-variable', 0xea88),\r\n\tarray: register('array', 0xea8a),\r\n\tsymbolArray: register('symbol-array', 0xea8a),\r\n\tsymbolModule: register('symbol-module', 0xea8b),\r\n\tsymbolPackage: register('symbol-package', 0xea8b),\r\n\tsymbolNamespace: register('symbol-namespace', 0xea8b),\r\n\tsymbolObject: register('symbol-object', 0xea8b),\r\n\tsymbolMethod: register('symbol-method', 0xea8c),\r\n\tsymbolFunction: register('symbol-function', 0xea8c),\r\n\tsymbolConstructor: register('symbol-constructor', 0xea8c),\r\n\tsymbolBoolean: register('symbol-boolean', 0xea8f),\r\n\tsymbolNull: register('symbol-null', 0xea8f),\r\n\tsymbolNumeric: register('symbol-numeric', 0xea90),\r\n\tsymbolNumber: register('symbol-number', 0xea90),\r\n\tsymbolStructure: register('symbol-structure', 0xea91),\r\n\tsymbolStruct: register('symbol-struct', 0xea91),\r\n\tsymbolParameter: register('symbol-parameter', 0xea92),\r\n\tsymbolTypeParameter: register('symbol-type-parameter', 0xea92),\r\n\tsymbolKey: register('symbol-key', 0xea93),\r\n\tsymbolText: register('symbol-text', 0xea93),\r\n\tsymbolReference: register('symbol-reference', 0xea94),\r\n\tgoToFile: register('go-to-file', 0xea94),\r\n\tsymbolEnum: register('symbol-enum', 0xea95),\r\n\tsymbolValue: register('symbol-value', 0xea95),\r\n\tsymbolRuler: register('symbol-ruler', 0xea96),\r\n\tsymbolUnit: register('symbol-unit', 0xea96),\r\n\tactivateBreakpoints: register('activate-breakpoints', 0xea97),\r\n\tarchive: register('archive', 0xea98),\r\n\tarrowBoth: register('arrow-both', 0xea99),\r\n\tarrowDown: register('arrow-down', 0xea9a),\r\n\tarrowLeft: register('arrow-left', 0xea9b),\r\n\tarrowRight: register('arrow-right', 0xea9c),\r\n\tarrowSmallDown: register('arrow-small-down', 0xea9d),\r\n\tarrowSmallLeft: register('arrow-small-left', 0xea9e),\r\n\tarrowSmallRight: register('arrow-small-right', 0xea9f),\r\n\tarrowSmallUp: register('arrow-small-up', 0xeaa0),\r\n\tarrowUp: register('arrow-up', 0xeaa1),\r\n\tbell: register('bell', 0xeaa2),\r\n\tbold: register('bold', 0xeaa3),\r\n\tbook: register('book', 0xeaa4),\r\n\tbookmark: register('bookmark', 0xeaa5),\r\n\tdebugBreakpointConditionalUnverified: register('debug-breakpoint-conditional-unverified', 0xeaa6),\r\n\tdebugBreakpointConditional: register('debug-breakpoint-conditional', 0xeaa7),\r\n\tdebugBreakpointConditionalDisabled: register('debug-breakpoint-conditional-disabled', 0xeaa7),\r\n\tdebugBreakpointDataUnverified: register('debug-breakpoint-data-unverified', 0xeaa8),\r\n\tdebugBreakpointData: register('debug-breakpoint-data', 0xeaa9),\r\n\tdebugBreakpointDataDisabled: register('debug-breakpoint-data-disabled', 0xeaa9),\r\n\tdebugBreakpointLogUnverified: register('debug-breakpoint-log-unverified', 0xeaaa),\r\n\tdebugBreakpointLog: register('debug-breakpoint-log', 0xeaab),\r\n\tdebugBreakpointLogDisabled: register('debug-breakpoint-log-disabled', 0xeaab),\r\n\tbriefcase: register('briefcase', 0xeaac),\r\n\tbroadcast: register('broadcast', 0xeaad),\r\n\tbrowser: register('browser', 0xeaae),\r\n\tbug: register('bug', 0xeaaf),\r\n\tcalendar: register('calendar', 0xeab0),\r\n\tcaseSensitive: register('case-sensitive', 0xeab1),\r\n\tcheck: register('check', 0xeab2),\r\n\tchecklist: register('checklist', 0xeab3),\r\n\tchevronDown: register('chevron-down', 0xeab4),\r\n\tdropDownButton: register('drop-down-button', 0xeab4),\r\n\tchevronLeft: register('chevron-left', 0xeab5),\r\n\tchevronRight: register('chevron-right', 0xeab6),\r\n\tchevronUp: register('chevron-up', 0xeab7),\r\n\tchromeClose: register('chrome-close', 0xeab8),\r\n\tchromeMaximize: register('chrome-maximize', 0xeab9),\r\n\tchromeMinimize: register('chrome-minimize', 0xeaba),\r\n\tchromeRestore: register('chrome-restore', 0xeabb),\r\n\tcircle: register('circle', 0xeabc),\r\n\tcircleOutline: register('circle-outline', 0xeabc),\r\n\tdebugBreakpointUnverified: register('debug-breakpoint-unverified', 0xeabc),\r\n\tcircleSlash: register('circle-slash', 0xeabd),\r\n\tcircuitBoard: register('circuit-board', 0xeabe),\r\n\tclearAll: register('clear-all', 0xeabf),\r\n\tclippy: register('clippy', 0xeac0),\r\n\tcloseAll: register('close-all', 0xeac1),\r\n\tcloudDownload: register('cloud-download', 0xeac2),\r\n\tcloudUpload: register('cloud-upload', 0xeac3),\r\n\tcode: register('code', 0xeac4),\r\n\tcollapseAll: register('collapse-all', 0xeac5),\r\n\tcolorMode: register('color-mode', 0xeac6),\r\n\tcommentDiscussion: register('comment-discussion', 0xeac7),\r\n\tcompareChanges: register('compare-changes', 0xeafd),\r\n\tcreditCard: register('credit-card', 0xeac9),\r\n\tdash: register('dash', 0xeacc),\r\n\tdashboard: register('dashboard', 0xeacd),\r\n\tdatabase: register('database', 0xeace),\r\n\tdebugContinue: register('debug-continue', 0xeacf),\r\n\tdebugDisconnect: register('debug-disconnect', 0xead0),\r\n\tdebugPause: register('debug-pause', 0xead1),\r\n\tdebugRestart: register('debug-restart', 0xead2),\r\n\tdebugStart: register('debug-start', 0xead3),\r\n\tdebugStepInto: register('debug-step-into', 0xead4),\r\n\tdebugStepOut: register('debug-step-out', 0xead5),\r\n\tdebugStepOver: register('debug-step-over', 0xead6),\r\n\tdebugStop: register('debug-stop', 0xead7),\r\n\tdebug: register('debug', 0xead8),\r\n\tdeviceCameraVideo: register('device-camera-video', 0xead9),\r\n\tdeviceCamera: register('device-camera', 0xeada),\r\n\tdeviceMobile: register('device-mobile', 0xeadb),\r\n\tdiffAdded: register('diff-added', 0xeadc),\r\n\tdiffIgnored: register('diff-ignored', 0xeadd),\r\n\tdiffModified: register('diff-modified', 0xeade),\r\n\tdiffRemoved: register('diff-removed', 0xeadf),\r\n\tdiffRenamed: register('diff-renamed', 0xeae0),\r\n\tdiff: register('diff', 0xeae1),\r\n\tdiscard: register('discard', 0xeae2),\r\n\teditorLayout: register('editor-layout', 0xeae3),\r\n\temptyWindow: register('empty-window', 0xeae4),\r\n\texclude: register('exclude', 0xeae5),\r\n\textensions: register('extensions', 0xeae6),\r\n\teyeClosed: register('eye-closed', 0xeae7),\r\n\tfileBinary: register('file-binary', 0xeae8),\r\n\tfileCode: register('file-code', 0xeae9),\r\n\tfileMedia: register('file-media', 0xeaea),\r\n\tfilePdf: register('file-pdf', 0xeaeb),\r\n\tfileSubmodule: register('file-submodule', 0xeaec),\r\n\tfileSymlinkDirectory: register('file-symlink-directory', 0xeaed),\r\n\tfileSymlinkFile: register('file-symlink-file', 0xeaee),\r\n\tfileZip: register('file-zip', 0xeaef),\r\n\tfiles: register('files', 0xeaf0),\r\n\tfilter: register('filter', 0xeaf1),\r\n\tflame: register('flame', 0xeaf2),\r\n\tfoldDown: register('fold-down', 0xeaf3),\r\n\tfoldUp: register('fold-up', 0xeaf4),\r\n\tfold: register('fold', 0xeaf5),\r\n\tfolderActive: register('folder-active', 0xeaf6),\r\n\tfolderOpened: register('folder-opened', 0xeaf7),\r\n\tgear: register('gear', 0xeaf8),\r\n\tgift: register('gift', 0xeaf9),\r\n\tgistSecret: register('gist-secret', 0xeafa),\r\n\tgist: register('gist', 0xeafb),\r\n\tgitCommit: register('git-commit', 0xeafc),\r\n\tgitCompare: register('git-compare', 0xeafd),\r\n\tgitMerge: register('git-merge', 0xeafe),\r\n\tgithubAction: register('github-action', 0xeaff),\r\n\tgithubAlt: register('github-alt', 0xeb00),\r\n\tglobe: register('globe', 0xeb01),\r\n\tgrabber: register('grabber', 0xeb02),\r\n\tgraph: register('graph', 0xeb03),\r\n\tgripper: register('gripper', 0xeb04),\r\n\theart: register('heart', 0xeb05),\r\n\thome: register('home', 0xeb06),\r\n\thorizontalRule: register('horizontal-rule', 0xeb07),\r\n\thubot: register('hubot', 0xeb08),\r\n\tinbox: register('inbox', 0xeb09),\r\n\tissueClosed: register('issue-closed', 0xeba4),\r\n\tissueReopened: register('issue-reopened', 0xeb0b),\r\n\tissues: register('issues', 0xeb0c),\r\n\titalic: register('italic', 0xeb0d),\r\n\tjersey: register('jersey', 0xeb0e),\r\n\tjson: register('json', 0xeb0f),\r\n\tbracket: register('bracket', 0xeb0f),\r\n\tkebabVertical: register('kebab-vertical', 0xeb10),\r\n\tkey: register('key', 0xeb11),\r\n\tlaw: register('law', 0xeb12),\r\n\tlightbulbAutofix: register('lightbulb-autofix', 0xeb13),\r\n\tlinkExternal: register('link-external', 0xeb14),\r\n\tlink: register('link', 0xeb15),\r\n\tlistOrdered: register('list-ordered', 0xeb16),\r\n\tlistUnordered: register('list-unordered', 0xeb17),\r\n\tliveShare: register('live-share', 0xeb18),\r\n\tloading: register('loading', 0xeb19),\r\n\tlocation: register('location', 0xeb1a),\r\n\tmailRead: register('mail-read', 0xeb1b),\r\n\tmail: register('mail', 0xeb1c),\r\n\tmarkdown: register('markdown', 0xeb1d),\r\n\tmegaphone: register('megaphone', 0xeb1e),\r\n\tmention: register('mention', 0xeb1f),\r\n\tmilestone: register('milestone', 0xeb20),\r\n\tgitPullRequestMilestone: register('git-pull-request-milestone', 0xeb20),\r\n\tmortarBoard: register('mortar-board', 0xeb21),\r\n\tmove: register('move', 0xeb22),\r\n\tmultipleWindows: register('multiple-windows', 0xeb23),\r\n\tmute: register('mute', 0xeb24),\r\n\tnoNewline: register('no-newline', 0xeb25),\r\n\tnote: register('note', 0xeb26),\r\n\toctoface: register('octoface', 0xeb27),\r\n\topenPreview: register('open-preview', 0xeb28),\r\n\tpackage_: register('package', 0xeb29),\r\n\tpaintcan: register('paintcan', 0xeb2a),\r\n\tpin: register('pin', 0xeb2b),\r\n\tplay: register('play', 0xeb2c),\r\n\trun: register('run', 0xeb2c),\r\n\tplug: register('plug', 0xeb2d),\r\n\tpreserveCase: register('preserve-case', 0xeb2e),\r\n\tpreview: register('preview', 0xeb2f),\r\n\tproject: register('project', 0xeb30),\r\n\tpulse: register('pulse', 0xeb31),\r\n\tquestion: register('question', 0xeb32),\r\n\tquote: register('quote', 0xeb33),\r\n\tradioTower: register('radio-tower', 0xeb34),\r\n\treactions: register('reactions', 0xeb35),\r\n\treferences: register('references', 0xeb36),\r\n\trefresh: register('refresh', 0xeb37),\r\n\tregex: register('regex', 0xeb38),\r\n\tremoteExplorer: register('remote-explorer', 0xeb39),\r\n\tremote: register('remote', 0xeb3a),\r\n\tremove: register('remove', 0xeb3b),\r\n\treplaceAll: register('replace-all', 0xeb3c),\r\n\treplace: register('replace', 0xeb3d),\r\n\trepoClone: register('repo-clone', 0xeb3e),\r\n\trepoForcePush: register('repo-force-push', 0xeb3f),\r\n\trepoPull: register('repo-pull', 0xeb40),\r\n\trepoPush: register('repo-push', 0xeb41),\r\n\treport: register('report', 0xeb42),\r\n\trequestChanges: register('request-changes', 0xeb43),\r\n\trocket: register('rocket', 0xeb44),\r\n\trootFolderOpened: register('root-folder-opened', 0xeb45),\r\n\trootFolder: register('root-folder', 0xeb46),\r\n\trss: register('rss', 0xeb47),\r\n\truby: register('ruby', 0xeb48),\r\n\tsaveAll: register('save-all', 0xeb49),\r\n\tsaveAs: register('save-as', 0xeb4a),\r\n\tsave: register('save', 0xeb4b),\r\n\tscreenFull: register('screen-full', 0xeb4c),\r\n\tscreenNormal: register('screen-normal', 0xeb4d),\r\n\tsearchStop: register('search-stop', 0xeb4e),\r\n\tserver: register('server', 0xeb50),\r\n\tsettingsGear: register('settings-gear', 0xeb51),\r\n\tsettings: register('settings', 0xeb52),\r\n\tshield: register('shield', 0xeb53),\r\n\tsmiley: register('smiley', 0xeb54),\r\n\tsortPrecedence: register('sort-precedence', 0xeb55),\r\n\tsplitHorizontal: register('split-horizontal', 0xeb56),\r\n\tsplitVertical: register('split-vertical', 0xeb57),\r\n\tsquirrel: register('squirrel', 0xeb58),\r\n\tstarFull: register('star-full', 0xeb59),\r\n\tstarHalf: register('star-half', 0xeb5a),\r\n\tsymbolClass: register('symbol-class', 0xeb5b),\r\n\tsymbolColor: register('symbol-color', 0xeb5c),\r\n\tsymbolCustomColor: register('symbol-customcolor', 0xeb5c),\r\n\tsymbolConstant: register('symbol-constant', 0xeb5d),\r\n\tsymbolEnumMember: register('symbol-enum-member', 0xeb5e),\r\n\tsymbolField: register('symbol-field', 0xeb5f),\r\n\tsymbolFile: register('symbol-file', 0xeb60),\r\n\tsymbolInterface: register('symbol-interface', 0xeb61),\r\n\tsymbolKeyword: register('symbol-keyword', 0xeb62),\r\n\tsymbolMisc: register('symbol-misc', 0xeb63),\r\n\tsymbolOperator: register('symbol-operator', 0xeb64),\r\n\tsymbolProperty: register('symbol-property', 0xeb65),\r\n\twrench: register('wrench', 0xeb65),\r\n\twrenchSubaction: register('wrench-subaction', 0xeb65),\r\n\tsymbolSnippet: register('symbol-snippet', 0xeb66),\r\n\ttasklist: register('tasklist', 0xeb67),\r\n\ttelescope: register('telescope', 0xeb68),\r\n\ttextSize: register('text-size', 0xeb69),\r\n\tthreeBars: register('three-bars', 0xeb6a),\r\n\tthumbsdown: register('thumbsdown', 0xeb6b),\r\n\tthumbsup: register('thumbsup', 0xeb6c),\r\n\ttools: register('tools', 0xeb6d),\r\n\ttriangleDown: register('triangle-down', 0xeb6e),\r\n\ttriangleLeft: register('triangle-left', 0xeb6f),\r\n\ttriangleRight: register('triangle-right', 0xeb70),\r\n\ttriangleUp: register('triangle-up', 0xeb71),\r\n\ttwitter: register('twitter', 0xeb72),\r\n\tunfold: register('unfold', 0xeb73),\r\n\tunlock: register('unlock', 0xeb74),\r\n\tunmute: register('unmute', 0xeb75),\r\n\tunverified: register('unverified', 0xeb76),\r\n\tverified: register('verified', 0xeb77),\r\n\tversions: register('versions', 0xeb78),\r\n\tvmActive: register('vm-active', 0xeb79),\r\n\tvmOutline: register('vm-outline', 0xeb7a),\r\n\tvmRunning: register('vm-running', 0xeb7b),\r\n\twatch: register('watch', 0xeb7c),\r\n\twhitespace: register('whitespace', 0xeb7d),\r\n\twholeWord: register('whole-word', 0xeb7e),\r\n\twindow: register('window', 0xeb7f),\r\n\twordWrap: register('word-wrap', 0xeb80),\r\n\tzoomIn: register('zoom-in', 0xeb81),\r\n\tzoomOut: register('zoom-out', 0xeb82),\r\n\tlistFilter: register('list-filter', 0xeb83),\r\n\tlistFlat: register('list-flat', 0xeb84),\r\n\tlistSelection: register('list-selection', 0xeb85),\r\n\tselection: register('selection', 0xeb85),\r\n\tlistTree: register('list-tree', 0xeb86),\r\n\tdebugBreakpointFunctionUnverified: register('debug-breakpoint-function-unverified', 0xeb87),\r\n\tdebugBreakpointFunction: register('debug-breakpoint-function', 0xeb88),\r\n\tdebugBreakpointFunctionDisabled: register('debug-breakpoint-function-disabled', 0xeb88),\r\n\tdebugStackframeActive: register('debug-stackframe-active', 0xeb89),\r\n\tcircleSmallFilled: register('circle-small-filled', 0xeb8a),\r\n\tdebugStackframeDot: register('debug-stackframe-dot', 0xeb8a),\r\n\tdebugStackframe: register('debug-stackframe', 0xeb8b),\r\n\tdebugStackframeFocused: register('debug-stackframe-focused', 0xeb8b),\r\n\tdebugBreakpointUnsupported: register('debug-breakpoint-unsupported', 0xeb8c),\r\n\tsymbolString: register('symbol-string', 0xeb8d),\r\n\tdebugReverseContinue: register('debug-reverse-continue', 0xeb8e),\r\n\tdebugStepBack: register('debug-step-back', 0xeb8f),\r\n\tdebugRestartFrame: register('debug-restart-frame', 0xeb90),\r\n\tcallIncoming: register('call-incoming', 0xeb92),\r\n\tcallOutgoing: register('call-outgoing', 0xeb93),\r\n\tmenu: register('menu', 0xeb94),\r\n\texpandAll: register('expand-all', 0xeb95),\r\n\tfeedback: register('feedback', 0xeb96),\r\n\tgitPullRequestReviewer: register('git-pull-request-reviewer', 0xeb96),\r\n\tgroupByRefType: register('group-by-ref-type', 0xeb97),\r\n\tungroupByRefType: register('ungroup-by-ref-type', 0xeb98),\r\n\taccount: register('account', 0xeb99),\r\n\tgitPullRequestAssignee: register('git-pull-request-assignee', 0xeb99),\r\n\tbellDot: register('bell-dot', 0xeb9a),\r\n\tdebugConsole: register('debug-console', 0xeb9b),\r\n\tlibrary: register('library', 0xeb9c),\r\n\toutput: register('output', 0xeb9d),\r\n\trunAll: register('run-all', 0xeb9e),\r\n\tsyncIgnored: register('sync-ignored', 0xeb9f),\r\n\tpinned: register('pinned', 0xeba0),\r\n\tgithubInverted: register('github-inverted', 0xeba1),\r\n\tdebugAlt: register('debug-alt', 0xeb91),\r\n\tserverProcess: register('server-process', 0xeba2),\r\n\tserverEnvironment: register('server-environment', 0xeba3),\r\n\tpass: register('pass', 0xeba4),\r\n\tstopCircle: register('stop-circle', 0xeba5),\r\n\tplayCircle: register('play-circle', 0xeba6),\r\n\trecord: register('record', 0xeba7),\r\n\tdebugAltSmall: register('debug-alt-small', 0xeba8),\r\n\tvmConnect: register('vm-connect', 0xeba9),\r\n\tcloud: register('cloud', 0xebaa),\r\n\tmerge: register('merge', 0xebab),\r\n\texportIcon: register('export', 0xebac),\r\n\tgraphLeft: register('graph-left', 0xebad),\r\n\tmagnet: register('magnet', 0xebae),\r\n\tnotebook: register('notebook', 0xebaf),\r\n\tredo: register('redo', 0xebb0),\r\n\tcheckAll: register('check-all', 0xebb1),\r\n\tpinnedDirty: register('pinned-dirty', 0xebb2),\r\n\tpassFilled: register('pass-filled', 0xebb3),\r\n\tcircleLargeFilled: register('circle-large-filled', 0xebb4),\r\n\tcircleLarge: register('circle-large', 0xebb5),\r\n\tcircleLargeOutline: register('circle-large-outline', 0xebb5),\r\n\tcombine: register('combine', 0xebb6),\r\n\tgather: register('gather', 0xebb6),\r\n\ttable: register('table', 0xebb7),\r\n\tvariableGroup: register('variable-group', 0xebb8),\r\n\ttypeHierarchy: register('type-hierarchy', 0xebb9),\r\n\ttypeHierarchySub: register('type-hierarchy-sub', 0xebba),\r\n\ttypeHierarchySuper: register('type-hierarchy-super', 0xebbb),\r\n\tgitPullRequestCreate: register('git-pull-request-create', 0xebbc),\r\n\trunAbove: register('run-above', 0xebbd),\r\n\trunBelow: register('run-below', 0xebbe),\r\n\tnotebookTemplate: register('notebook-template', 0xebbf),\r\n\tdebugRerun: register('debug-rerun', 0xebc0),\r\n\tworkspaceTrusted: register('workspace-trusted', 0xebc1),\r\n\tworkspaceUntrusted: register('workspace-untrusted', 0xebc2),\r\n\tworkspaceUnspecified: register('workspace-unspecified', 0xebc3),\r\n\tterminalCmd: register('terminal-cmd', 0xebc4),\r\n\tterminalDebian: register('terminal-debian', 0xebc5),\r\n\tterminalLinux: register('terminal-linux', 0xebc6),\r\n\tterminalPowershell: register('terminal-powershell', 0xebc7),\r\n\tterminalTmux: register('terminal-tmux', 0xebc8),\r\n\tterminalUbuntu: register('terminal-ubuntu', 0xebc9),\r\n\tterminalBash: register('terminal-bash', 0xebca),\r\n\tarrowSwap: register('arrow-swap', 0xebcb),\r\n\tcopy: register('copy', 0xebcc),\r\n\tpersonAdd: register('person-add', 0xebcd),\r\n\tfilterFilled: register('filter-filled', 0xebce),\r\n\twand: register('wand', 0xebcf),\r\n\tdebugLineByLine: register('debug-line-by-line', 0xebd0),\r\n\tinspect: register('inspect', 0xebd1),\r\n\tlayers: register('layers', 0xebd2),\r\n\tlayersDot: register('layers-dot', 0xebd3),\r\n\tlayersActive: register('layers-active', 0xebd4),\r\n\tcompass: register('compass', 0xebd5),\r\n\tcompassDot: register('compass-dot', 0xebd6),\r\n\tcompassActive: register('compass-active', 0xebd7),\r\n\tazure: register('azure', 0xebd8),\r\n\tissueDraft: register('issue-draft', 0xebd9),\r\n\tgitPullRequestClosed: register('git-pull-request-closed', 0xebda),\r\n\tgitPullRequestDraft: register('git-pull-request-draft', 0xebdb),\r\n\tdebugAll: register('debug-all', 0xebdc),\r\n\tdebugCoverage: register('debug-coverage', 0xebdd),\r\n\trunErrors: register('run-errors', 0xebde),\r\n\tfolderLibrary: register('folder-library', 0xebdf),\r\n\tdebugContinueSmall: register('debug-continue-small', 0xebe0),\r\n\tbeakerStop: register('beaker-stop', 0xebe1),\r\n\tgraphLine: register('graph-line', 0xebe2),\r\n\tgraphScatter: register('graph-scatter', 0xebe3),\r\n\tpieChart: register('pie-chart', 0xebe4),\r\n\tbracketDot: register('bracket-dot', 0xebe5),\r\n\tbracketError: register('bracket-error', 0xebe6),\r\n\tlockSmall: register('lock-small', 0xebe7),\r\n\tazureDevops: register('azure-devops', 0xebe8),\r\n\tverifiedFilled: register('verified-filled', 0xebe9),\r\n\tnewLine: register('newline', 0xebea),\r\n\tlayout: register('layout', 0xebeb),\r\n\tlayoutActivitybarLeft: register('layout-activitybar-left', 0xebec),\r\n\tlayoutActivitybarRight: register('layout-activitybar-right', 0xebed),\r\n\tlayoutPanelLeft: register('layout-panel-left', 0xebee),\r\n\tlayoutPanelCenter: register('layout-panel-center', 0xebef),\r\n\tlayoutPanelJustify: register('layout-panel-justify', 0xebf0),\r\n\tlayoutPanelRight: register('layout-panel-right', 0xebf1),\r\n\tlayoutPanel: register('layout-panel', 0xebf2),\r\n\tlayoutSidebarLeft: register('layout-sidebar-left', 0xebf3),\r\n\tlayoutSidebarRight: register('layout-sidebar-right', 0xebf4),\r\n\tlayoutStatusbar: register('layout-statusbar', 0xebf5),\r\n\tlayoutMenubar: register('layout-menubar', 0xebf6),\r\n\tlayoutCentered: register('layout-centered', 0xebf7),\r\n\tlayoutSidebarRightOff: register('layout-sidebar-right-off', 0xec00),\r\n\tlayoutPanelOff: register('layout-panel-off', 0xec01),\r\n\tlayoutSidebarLeftOff: register('layout-sidebar-left-off', 0xec02),\r\n\ttarget: register('target', 0xebf8),\r\n\tindent: register('indent', 0xebf9),\r\n\trecordSmall: register('record-small', 0xebfa),\r\n\terrorSmall: register('error-small', 0xebfb),\r\n\tarrowCircleDown: register('arrow-circle-down', 0xebfc),\r\n\tarrowCircleLeft: register('arrow-circle-left', 0xebfd),\r\n\tarrowCircleRight: register('arrow-circle-right', 0xebfe),\r\n\tarrowCircleUp: register('arrow-circle-up', 0xebff),\r\n\theartFilled: register('heart-filled', 0xec04),\r\n\tmap: register('map', 0xec05),\r\n\tmapFilled: register('map-filled', 0xec06),\r\n\tcircleSmall: register('circle-small', 0xec07),\r\n\tbellSlash: register('bell-slash', 0xec08),\r\n\tbellSlashDot: register('bell-slash-dot', 0xec09),\r\n\tcommentUnresolved: register('comment-unresolved', 0xec0a),\r\n\tgitPullRequestGoToChanges: register('git-pull-request-go-to-changes', 0xec0b),\r\n\tgitPullRequestNewChanges: register('git-pull-request-new-changes', 0xec0c),\r\n\tsearchFuzzy: register('search-fuzzy', 0xec0d),\r\n\tcommentDraft: register('comment-draft', 0xec0e),\r\n\tsend: register('send', 0xec0f),\r\n\tsparkle: register('sparkle', 0xec10),\r\n\tinsert: register('insert', 0xec11),\r\n\tmic: register('mic', 0xec12),\r\n\r\n\r\n\t// derived icons, that could become separate icons\r\n\r\n\tdialogError: register('dialog-error', 'error'),\r\n\tdialogWarning: register('dialog-warning', 'warning'),\r\n\tdialogInfo: register('dialog-info', 'info'),\r\n\tdialogClose: register('dialog-close', 'close'),\r\n\r\n\ttreeItemExpanded: register('tree-item-expanded', 'chevron-down'), // collapsed is done with rotation\r\n\r\n\ttreeFilterOnTypeOn: register('tree-filter-on-type-on', 'list-filter'),\r\n\ttreeFilterOnTypeOff: register('tree-filter-on-type-off', 'list-selection'),\r\n\ttreeFilterClear: register('tree-filter-clear', 'close'),\r\n\r\n\ttreeItemLoading: register('tree-item-loading', 'loading'),\r\n\r\n\tmenuSelection: register('menu-selection', 'check'),\r\n\tmenuSubmenu: register('menu-submenu', 'chevron-right'),\r\n\r\n\tmenuBarMore: register('menubar-more', 'more'),\r\n\r\n\tscrollbarButtonLeft: register('scrollbar-button-left', 'triangle-left'),\r\n\tscrollbarButtonRight: register('scrollbar-button-right', 'triangle-right'),\r\n\r\n\tscrollbarButtonUp: register('scrollbar-button-up', 'triangle-up'),\r\n\tscrollbarButtonDown: register('scrollbar-button-down', 'triangle-down'),\r\n\r\n\ttoolBarMore: register('toolbar-more', 'more'),\r\n\r\n\tquickInputBack: register('quick-input-back', 'arrow-left')\r\n\r\n} as const;\r\n\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { isTypedArray, isObject, isUndefinedOrNull } from 'vs/base/common/types';\r\n\r\nexport function deepClone<T>(obj: T): T {\r\n\tif (!obj || typeof obj !== 'object') {\r\n\t\treturn obj;\r\n\t}\r\n\tif (obj instanceof RegExp) {\r\n\t\treturn obj;\r\n\t}\r\n\tconst result: any = Array.isArray(obj) ? [] : {};\r\n\tObject.entries(obj).forEach(([key, value]) => {\r\n\t\tresult[key] = value && typeof value === 'object' ? deepClone(value) : value;\r\n\t});\r\n\treturn result;\r\n}\r\n\r\nexport function deepFreeze<T>(obj: T): T {\r\n\tif (!obj || typeof obj !== 'object') {\r\n\t\treturn obj;\r\n\t}\r\n\tconst stack: any[] = [obj];\r\n\twhile (stack.length > 0) {\r\n\t\tconst obj = stack.shift();\r\n\t\tObject.freeze(obj);\r\n\t\tfor (const key in obj) {\r\n\t\t\tif (_hasOwnProperty.call(obj, key)) {\r\n\t\t\t\tconst prop = obj[key];\r\n\t\t\t\tif (typeof prop === 'object' && !Object.isFrozen(prop) && !isTypedArray(prop)) {\r\n\t\t\t\t\tstack.push(prop);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn obj;\r\n}\r\n\r\nconst _hasOwnProperty = Object.prototype.hasOwnProperty;\r\n\r\n\r\nexport function cloneAndChange(obj: any, changer: (orig: any) => any): any {\r\n\treturn _cloneAndChange(obj, changer, new Set());\r\n}\r\n\r\nfunction _cloneAndChange(obj: any, changer: (orig: any) => any, seen: Set<any>): any {\r\n\tif (isUndefinedOrNull(obj)) {\r\n\t\treturn obj;\r\n\t}\r\n\r\n\tconst changed = changer(obj);\r\n\tif (typeof changed !== 'undefined') {\r\n\t\treturn changed;\r\n\t}\r\n\r\n\tif (Array.isArray(obj)) {\r\n\t\tconst r1: any[] = [];\r\n\t\tfor (const e of obj) {\r\n\t\t\tr1.push(_cloneAndChange(e, changer, seen));\r\n\t\t}\r\n\t\treturn r1;\r\n\t}\r\n\r\n\tif (isObject(obj)) {\r\n\t\tif (seen.has(obj)) {\r\n\t\t\tthrow new Error('Cannot clone recursive data-structure');\r\n\t\t}\r\n\t\tseen.add(obj);\r\n\t\tconst r2 = {};\r\n\t\tfor (const i2 in obj) {\r\n\t\t\tif (_hasOwnProperty.call(obj, i2)) {\r\n\t\t\t\t(r2 as any)[i2] = _cloneAndChange(obj[i2], changer, seen);\r\n\t\t\t}\r\n\t\t}\r\n\t\tseen.delete(obj);\r\n\t\treturn r2;\r\n\t}\r\n\r\n\treturn obj;\r\n}\r\n\r\n/**\r\n * Copies all properties of source into destination. The optional parameter \"overwrite\" allows to control\r\n * if existing properties on the destination should be overwritten or not. Defaults to true (overwrite).\r\n */\r\nexport function mixin(destination: any, source: any, overwrite: boolean = true): any {\r\n\tif (!isObject(destination)) {\r\n\t\treturn source;\r\n\t}\r\n\r\n\tif (isObject(source)) {\r\n\t\tObject.keys(source).forEach(key => {\r\n\t\t\tif (key in destination) {\r\n\t\t\t\tif (overwrite) {\r\n\t\t\t\t\tif (isObject(destination[key]) && isObject(source[key])) {\r\n\t\t\t\t\t\tmixin(destination[key], source[key], overwrite);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdestination[key] = source[key];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tdestination[key] = source[key];\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\treturn destination;\r\n}\r\n\r\nexport function equals(one: any, other: any): boolean {\r\n\tif (one === other) {\r\n\t\treturn true;\r\n\t}\r\n\tif (one === null || one === undefined || other === null || other === undefined) {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof one !== typeof other) {\r\n\t\treturn false;\r\n\t}\r\n\tif (typeof one !== 'object') {\r\n\t\treturn false;\r\n\t}\r\n\tif ((Array.isArray(one)) !== (Array.isArray(other))) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tlet i: number;\r\n\tlet key: string;\r\n\r\n\tif (Array.isArray(one)) {\r\n\t\tif (one.length !== other.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor (i = 0; i < one.length; i++) {\r\n\t\t\tif (!equals(one[i], other[i])) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\tconst oneKeys: string[] = [];\r\n\r\n\t\tfor (key in one) {\r\n\t\t\toneKeys.push(key);\r\n\t\t}\r\n\t\toneKeys.sort();\r\n\t\tconst otherKeys: string[] = [];\r\n\t\tfor (key in other) {\r\n\t\t\totherKeys.push(key);\r\n\t\t}\r\n\t\totherKeys.sort();\r\n\t\tif (!equals(oneKeys, otherKeys)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor (i = 0; i < oneKeys.length; i++) {\r\n\t\t\tif (!equals(one[oneKeys[i]], other[oneKeys[i]])) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\nexport function getAllPropertyNames(obj: object): string[] {\r\n\tlet res: string[] = [];\r\n\twhile (Object.prototype !== obj) {\r\n\t\tres = res.concat(Object.getOwnPropertyNames(obj));\r\n\t\tobj = Object.getPrototypeOf(obj);\r\n\t}\r\n\treturn res;\r\n}\r\n\r\nexport function getAllMethodNames(obj: object): string[] {\r\n\tconst methods: string[] = [];\r\n\tfor (const prop of getAllPropertyNames(obj)) {\r\n\t\tif (typeof (obj as any)[prop] === 'function') {\r\n\t\t\tmethods.push(prop);\r\n\t\t}\r\n\t}\r\n\treturn methods;\r\n}\r\n\r\nexport function createProxyObject<T extends object>(methodNames: string[], invoke: (method: string, args: unknown[]) => unknown): T {\r\n\tconst createProxyMethod = (method: string): () => unknown => {\r\n\t\treturn function () {\r\n\t\t\tconst args = Array.prototype.slice.call(arguments, 0);\r\n\t\t\treturn invoke(method, args);\r\n\t\t};\r\n\t};\r\n\r\n\tconst result = {} as T;\r\n\tfor (const methodName of methodNames) {\r\n\t\t(<any>result)[methodName] = createProxyMethod(methodName);\r\n\t}\r\n\treturn result;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nexport const enum Constants {\r\n\t/**\r\n\t * MAX SMI (SMall Integer) as defined in v8.\r\n\t * one bit is lost for boxing/unboxing flag.\r\n\t * one bit is lost for sign flag.\r\n\t * See https://thibaultlaurens.github.io/javascript/2013/04/29/how-the-v8-engine-works/#tagged-values\r\n\t */\r\n\tMAX_SAFE_SMALL_INTEGER = 1 << 30,\r\n\r\n\t/**\r\n\t * MIN SMI (SMall Integer) as defined in v8.\r\n\t * one bit is lost for boxing/unboxing flag.\r\n\t * one bit is lost for sign flag.\r\n\t * See https://thibaultlaurens.github.io/javascript/2013/04/29/how-the-v8-engine-works/#tagged-values\r\n\t */\r\n\tMIN_SAFE_SMALL_INTEGER = -(1 << 30),\r\n\r\n\t/**\r\n\t * Max unsigned integer that fits on 8 bits.\r\n\t */\r\n\tMAX_UINT_8 = 255, // 2^8 - 1\r\n\r\n\t/**\r\n\t * Max unsigned integer that fits on 16 bits.\r\n\t */\r\n\tMAX_UINT_16 = 65535, // 2^16 - 1\r\n\r\n\t/**\r\n\t * Max unsigned integer that fits on 32 bits.\r\n\t */\r\n\tMAX_UINT_32 = 4294967295, // 2^32 - 1\r\n\r\n\tUNICODE_SUPPLEMENTARY_PLANE_BEGIN = 0x010000\r\n}\r\n\r\nexport function toUint8(v: number): number {\r\n\tif (v < 0) {\r\n\t\treturn 0;\r\n\t}\r\n\tif (v > Constants.MAX_UINT_8) {\r\n\t\treturn Constants.MAX_UINT_8;\r\n\t}\r\n\treturn v | 0;\r\n}\r\n\r\nexport function toUint32(v: number): number {\r\n\tif (v < 0) {\r\n\t\treturn 0;\r\n\t}\r\n\tif (v > Constants.MAX_UINT_32) {\r\n\t\treturn Constants.MAX_UINT_32;\r\n\t}\r\n\treturn v | 0;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { toUint8 } from 'vs/base/common/uint';\r\n\r\n/**\r\n * A fast character classifier that uses a compact array for ASCII values.\r\n */\r\nexport class CharacterClassifier<T extends number> {\r\n\t/**\r\n\t * Maintain a compact (fully initialized ASCII map for quickly classifying ASCII characters - used more often in code).\r\n\t */\r\n\tprotected readonly _asciiMap: Uint8Array;\r\n\r\n\t/**\r\n\t * The entire map (sparse array).\r\n\t */\r\n\tprotected readonly _map: Map<number, number>;\r\n\r\n\tprotected readonly _defaultValue: number;\r\n\r\n\tconstructor(_defaultValue: T) {\r\n\t\tconst defaultValue = toUint8(_defaultValue);\r\n\r\n\t\tthis._defaultValue = defaultValue;\r\n\t\tthis._asciiMap = CharacterClassifier._createAsciiMap(defaultValue);\r\n\t\tthis._map = new Map<number, number>();\r\n\t}\r\n\r\n\tprivate static _createAsciiMap(defaultValue: number): Uint8Array {\r\n\t\tconst asciiMap = new Uint8Array(256);\r\n\t\tasciiMap.fill(defaultValue);\r\n\t\treturn asciiMap;\r\n\t}\r\n\r\n\tpublic set(charCode: number, _value: T): void {\r\n\t\tconst value = toUint8(_value);\r\n\r\n\t\tif (charCode >= 0 && charCode < 256) {\r\n\t\t\tthis._asciiMap[charCode] = value;\r\n\t\t} else {\r\n\t\t\tthis._map.set(charCode, value);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic get(charCode: number): T {\r\n\t\tif (charCode >= 0 && charCode < 256) {\r\n\t\t\treturn <T>this._asciiMap[charCode];\r\n\t\t} else {\r\n\t\t\treturn <T>(this._map.get(charCode) || this._defaultValue);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic clear() {\r\n\t\tthis._asciiMap.fill(this._defaultValue);\r\n\t\tthis._map.clear();\r\n\t}\r\n}\r\n\r\nconst enum Boolean {\r\n\tFalse = 0,\r\n\tTrue = 1\r\n}\r\n\r\nexport class CharacterSet {\r\n\r\n\tprivate readonly _actual: CharacterClassifier<Boolean>;\r\n\r\n\tconstructor() {\r\n\t\tthis._actual = new CharacterClassifier<Boolean>(Boolean.False);\r\n\t}\r\n\r\n\tpublic add(charCode: number): void {\r\n\t\tthis._actual.set(charCode, Boolean.True);\r\n\t}\r\n\r\n\tpublic has(charCode: number): boolean {\r\n\t\treturn (this._actual.get(charCode) === Boolean.True);\r\n\t}\r\n\r\n\tpublic clear(): void {\r\n\t\treturn this._actual.clear();\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export class OffsetRange\r\n * export class OffsetRangeSet\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { BugIndicatingError } from 'vs/base/common/errors';\r\n\r\n/**\r\n * A range of offsets (0-based).\r\n*/\r\nexport class OffsetRange {\r\n\tpublic static addRange(range: OffsetRange, sortedRanges: OffsetRange[]): void {\r\n\t\tlet i = 0;\r\n\t\twhile (i < sortedRanges.length && sortedRanges[i].endExclusive < range.start) {\r\n\t\t\ti++;\r\n\t\t}\r\n\t\tlet j = i;\r\n\t\twhile (j < sortedRanges.length && sortedRanges[j].start <= range.endExclusive) {\r\n\t\t\tj++;\r\n\t\t}\r\n\t\tif (i === j) {\r\n\t\t\tsortedRanges.splice(i, 0, range);\r\n\t\t} else {\r\n\t\t\tconst start = Math.min(range.start, sortedRanges[i].start);\r\n\t\t\tconst end = Math.max(range.endExclusive, sortedRanges[j - 1].endExclusive);\r\n\t\t\tsortedRanges.splice(i, j - i, new OffsetRange(start, end));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static tryCreate(start: number, endExclusive: number): OffsetRange | undefined {\r\n\t\tif (start > endExclusive) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\treturn new OffsetRange(start, endExclusive);\r\n\t}\r\n\r\n\tpublic static ofLength(length: number): OffsetRange {\r\n\t\treturn new OffsetRange(0, length);\r\n\t}\r\n\r\n\t// \r\n\tconstructor(public readonly start: number, public readonly endExclusive: number) {\r\n\t\tif (start > endExclusive) {\r\n\t\t\tthrow new BugIndicatingError(`Invalid range: ${this.toString()}`);\r\n\t\t}\r\n\t}\r\n\r\n\tget isEmpty(): boolean {\r\n\t\treturn this.start === this.endExclusive;\r\n\t}\r\n\r\n\tpublic delta(offset: number): OffsetRange {\r\n\t\treturn new OffsetRange(this.start + offset, this.endExclusive + offset);\r\n\t}\r\n\r\n\tpublic deltaStart(offset: number): OffsetRange {\r\n\t\treturn new OffsetRange(this.start + offset, this.endExclusive);\r\n\t}\r\n\r\n\tpublic deltaEnd(offset: number): OffsetRange {\r\n\t\treturn new OffsetRange(this.start, this.endExclusive + offset);\r\n\t}\r\n\r\n\tpublic get length(): number {\r\n\t\treturn this.endExclusive - this.start;\r\n\t}\r\n\r\n\tpublic toString() {\r\n\t\treturn `[${this.start}, ${this.endExclusive})`;\r\n\t}\r\n\r\n\tpublic equals(other: OffsetRange): boolean {\r\n\t\treturn this.start === other.start && this.endExclusive === other.endExclusive;\r\n\t}\r\n\r\n\tpublic containsRange(other: OffsetRange): boolean {\r\n\t\treturn this.start <= other.start && other.endExclusive <= this.endExclusive;\r\n\t}\r\n\r\n\tpublic contains(offset: number): boolean {\r\n\t\treturn this.start <= offset && offset < this.endExclusive;\r\n\t}\r\n\r\n\t/**\r\n\t * for all numbers n: range1.contains(n) or range2.contains(n) => range1.join(range2).contains(n)\r\n\t * The joined range is the smallest range that contains both ranges.\r\n\t */\r\n\tpublic join(other: OffsetRange): OffsetRange {\r\n\t\treturn new OffsetRange(Math.min(this.start, other.start), Math.max(this.endExclusive, other.endExclusive));\r\n\t}\r\n\r\n\t/**\r\n\t * for all numbers n: range1.contains(n) and range2.contains(n) <=> range1.intersect(range2).contains(n)\r\n\t *\r\n\t * The resulting range is empty if the ranges do not intersect, but touch.\r\n\t * If the ranges don't even touch, the result is undefined.\r\n\t */\r\n\tpublic intersect(other: OffsetRange): OffsetRange | undefined {\r\n\t\tconst start = Math.max(this.start, other.start);\r\n\t\tconst end = Math.min(this.endExclusive, other.endExclusive);\r\n\t\tif (start <= end) {\r\n\t\t\treturn new OffsetRange(start, end);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic slice<T>(arr: T[]): T[] {\r\n\t\treturn arr.slice(this.start, this.endExclusive);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the given value if it is contained in this instance, otherwise the closest value that is contained.\r\n\t * The range must not be empty.\r\n\t */\r\n\tpublic clip(value: number): number {\r\n\t\tif (this.isEmpty) {\r\n\t\t\tthrow new BugIndicatingError(`Invalid clipping range: ${this.toString()}`);\r\n\t\t}\r\n\t\treturn Math.max(this.start, Math.min(this.endExclusive - 1, value));\r\n\t}\r\n\r\n\t/**\r\n\t * Returns `r := value + k * length` such that `r` is contained in this range.\r\n\t * The range must not be empty.\r\n\t *\r\n\t * E.g. `[5, 10).clipCyclic(10) === 5`, `[5, 10).clipCyclic(11) === 6` and `[5, 10).clipCyclic(4) === 9`.\r\n\t */\r\n\tpublic clipCyclic(value: number): number {\r\n\t\tif (this.isEmpty) {\r\n\t\t\tthrow new BugIndicatingError(`Invalid clipping range: ${this.toString()}`);\r\n\t\t}\r\n\t\tif (value < this.start) {\r\n\t\t\treturn this.endExclusive - ((this.start - value) % this.length);\r\n\t\t}\r\n\t\tif (value >= this.endExclusive) {\r\n\t\t\treturn this.start + ((value - this.start) % this.length);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n}\r\n\r\nexport class OffsetRangeSet {\r\n\tprivate readonly _sortedRanges: OffsetRange[] = [];\r\n\r\n\tpublic addRange(range: OffsetRange): void {\r\n\t\tlet i = 0;\r\n\t\twhile (i < this._sortedRanges.length && this._sortedRanges[i].endExclusive < range.start) {\r\n\t\t\ti++;\r\n\t\t}\r\n\t\tlet j = i;\r\n\t\twhile (j < this._sortedRanges.length && this._sortedRanges[j].start <= range.endExclusive) {\r\n\t\t\tj++;\r\n\t\t}\r\n\t\tif (i === j) {\r\n\t\t\tthis._sortedRanges.splice(i, 0, range);\r\n\t\t} else {\r\n\t\t\tconst start = Math.min(range.start, this._sortedRanges[i].start);\r\n\t\t\tconst end = Math.max(range.endExclusive, this._sortedRanges[j - 1].endExclusive);\r\n\t\t\tthis._sortedRanges.splice(i, j - i, new OffsetRange(start, end));\r\n\t\t}\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn this._sortedRanges.map(r => r.toString()).join(', ');\r\n\t}\r\n\r\n\t/**\r\n\t * Returns of there is a value that is contained in this instance and the given range.\r\n\t */\r\n\tpublic intersectsStrict(other: OffsetRange): boolean {\r\n\t\t// TODO use binary search\r\n\t\tlet i = 0;\r\n\t\twhile (i < this._sortedRanges.length && this._sortedRanges[i].endExclusive <= other.start) {\r\n\t\t\ti++;\r\n\t\t}\r\n\t\treturn i < this._sortedRanges.length && this._sortedRanges[i].start < other.endExclusive;\r\n\t}\r\n\r\n\tpublic intersectWithRange(other: OffsetRange): OffsetRangeSet {\r\n\t\t// TODO use binary search + slice\r\n\t\tconst result = new OffsetRangeSet();\r\n\t\tfor (const range of this._sortedRanges) {\r\n\t\t\tconst intersection = range.intersect(other);\r\n\t\t\tif (intersection) {\r\n\t\t\t\tresult.addRange(intersection);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic intersectWithRangeLength(other: OffsetRange): number {\r\n\t\treturn this.intersectWithRange(other).length;\r\n\t}\r\n\r\n\tpublic get length(): number {\r\n\t\treturn this._sortedRanges.reduce((prev, cur) => prev + cur.length, 0);\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export interface IPosition\r\n * export class Position\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/**\r\n *  (position)\r\n *\r\n * This interface is suitable for serialization.\r\n */\r\nexport interface IPosition {\r\n\t/**\r\n\t * line  (`1` )\r\n\t */\r\n\treadonly lineNumber: number;\r\n\t/**\r\n\t * column  ( line   column `1` column `2`  )\r\n\t*/\r\n\treadonly column: number;\r\n}\r\n\r\n/**\r\n *  (position)\r\n*/\r\nexport class Position {\r\n\t/**\r\n\t * line  (`1` )\r\n\t*/\r\n\tpublic readonly lineNumber: number;\r\n\t/**\r\n\t * column  ( line   column `1` column `2`  )\r\n\t */\r\n\tpublic readonly column: number;\r\n\r\n\tconstructor(lineNumber: number, column: number) {\r\n\t\tthis.lineNumber = lineNumber;\r\n\t\tthis.column = column;\r\n\t}\r\n\r\n\t/**\r\n\t *  Position \r\n\t *\r\n\t * @param newLineNumber  line \r\n\t * @param newColumn  column \r\n\t */\r\n\twith(newLineNumber: number = this.lineNumber, newColumn: number = this.column): Position {\r\n\t\tif (newLineNumber === this.lineNumber && newColumn === this.column) {\r\n\t\t\treturn this;\r\n\t\t} else {\r\n\t\t\treturn new Position(newLineNumber, newColumn);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * delta  \r\n\t *\r\n\t * @param deltaLineNumber line delta\r\n\t * @param deltaColumn column delta\r\n\t */\r\n\tdelta(deltaLineNumber: number = 0, deltaColumn: number = 0): Position {\r\n\t\treturn this.with(this.lineNumber + deltaLineNumber, this.column + deltaColumn);\r\n\t}\r\n\r\n\t/**\r\n\t * position `this` position `other`  \r\n\t */\r\n\tpublic equals(other: IPosition): boolean {\r\n\t\treturn Position.equals(this, other);\r\n\t}\r\n\r\n\t/**\r\n\t * position `a` position `b`  \r\n\t */\r\n\tpublic static equals(a: IPosition | null, b: IPosition | null): boolean {\r\n\t\tif (!a && !b) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t!!a &&\r\n\t\t\t!!b &&\r\n\t\t\ta.lineNumber === b.lineNumber &&\r\n\t\t\ta.column === b.column\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * position `this` position `other`   \r\n\t *\r\n\t *     `false` \r\n\t */\r\n\tpublic isBefore(other: IPosition): boolean {\r\n\t\treturn Position.isBefore(this, other);\r\n\t}\r\n\r\n\t/**\r\n\t * position `a` position `b`   \r\n\t *\r\n\t *     `false` \r\n\t */\r\n\tpublic static isBefore(a: IPosition, b: IPosition): boolean {\r\n\t\tif (a.lineNumber < b.lineNumber) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (b.lineNumber < a.lineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn a.column < b.column;\r\n\t}\r\n\r\n\t/**\r\n\t * position `this` position `other`   \r\n\t *\r\n\t *     `true` \r\n\t */\r\n\tpublic isBeforeOrEqual(other: IPosition): boolean {\r\n\t\treturn Position.isBeforeOrEqual(this, other);\r\n\t}\r\n\r\n\t/**\r\n\t * position `a` position `b`   \r\n\t *\r\n\t *     `true` \r\n\t */\r\n\tpublic static isBeforeOrEqual(a: IPosition, b: IPosition): boolean {\r\n\t\tif (a.lineNumber < b.lineNumber) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (b.lineNumber < a.lineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn a.column <= b.column;\r\n\t}\r\n\r\n\t/**\r\n\t * position  , (sort)  .\r\n\t */\r\n\tpublic static compare(a: IPosition, b: IPosition): number {\r\n\t\tconst aLineNumber = a.lineNumber | 0;\r\n\t\tconst bLineNumber = b.lineNumber | 0;\r\n\r\n\t\tif (aLineNumber === bLineNumber) {\r\n\t\t\tconst aColumn = a.column | 0;\r\n\t\t\tconst bColumn = b.column | 0;\r\n\t\t\treturn aColumn - bColumn;\r\n\t\t}\r\n\r\n\t\treturn aLineNumber - bLineNumber;\r\n\t}\r\n\r\n\t/**\r\n\t * `this`  \r\n\t */\r\n\tpublic clone(): Position {\r\n\t\treturn new Position(this.lineNumber, this.column);\r\n\t}\r\n\r\n\t/**\r\n\t * `\"(line,column)\"`    (human-readable)\r\n\t */\r\n\tpublic toString(): string {\r\n\t\treturn '(' + this.lineNumber + ',' + this.column + ')';\r\n\t}\r\n\r\n\t// ---\r\n\r\n\t/**\r\n\t * `IPosition` `Position`  .\r\n\t */\r\n\tpublic static lift(pos: IPosition): Position {\r\n\t\treturn new Position(pos.lineNumber, pos.column);\r\n\t}\r\n\r\n\t/**\r\n\t * `obj` `IPosition`  .\r\n\t */\r\n\tpublic static isIPosition(obj: any): obj is IPosition {\r\n\t\treturn (\r\n\t\t\tobj\r\n\t\t\t&& (typeof obj.lineNumber === 'number')\r\n\t\t\t&& (typeof obj.column === 'number')\r\n\t\t);\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export interface IRange\r\n * export class Range\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { IPosition, Position } from 'vs/editor/common/core/position';\r\n\r\n/**\r\n *  (range)\r\n *\r\n * This interface is suitable for serialization.\r\n */\r\nexport interface IRange {\r\n\t/**\r\n\t * range  line  (`1` )\r\n\t */\r\n\treadonly startLineNumber: number;\r\n\t/**\r\n\t * range  line `startLineNumber` Column  (`1` )\r\n\t */\r\n\treadonly startColumn: number;\r\n\t/**\r\n\t * range  line \r\n\t */\r\n\treadonly endLineNumber: number;\r\n\t/**\r\n\t * range  line `endLineNumber` Column \r\n\t */\r\n\treadonly endColumn: number;\r\n}\r\n\r\n/**\r\n *  (range)\r\n * - (startLineNumber, startColumn) <= (endLineNumber, endColumn)\r\n */\r\nexport class Range {\r\n\r\n\t/**\r\n\t * range  line  (`1` )\r\n\t */\r\n\tpublic readonly startLineNumber: number;\r\n\t/**\r\n\t * range  line `startLineNumber` Column  (`1` ).\r\n\t */\r\n\tpublic readonly startColumn: number;\r\n\t/**\r\n\t * range  line \r\n\t */\r\n\tpublic readonly endLineNumber: number;\r\n\t/**\r\n\t * range  line `endLineNumber` Column \r\n\t */\r\n\tpublic readonly endColumn: number;\r\n\r\n\tconstructor(startLineNumber: number, startColumn: number, endLineNumber: number, endColumn: number) {\r\n\t\tif ((startLineNumber > endLineNumber) || (startLineNumber === endLineNumber && startColumn > endColumn)) {\r\n\t\t\tthis.startLineNumber = endLineNumber;\r\n\t\t\tthis.startColumn = endColumn;\r\n\t\t\tthis.endLineNumber = startLineNumber;\r\n\t\t\tthis.endColumn = startColumn;\r\n\t\t} else {\r\n\t\t\tthis.startLineNumber = startLineNumber;\r\n\t\t\tthis.startColumn = startColumn;\r\n\t\t\tthis.endLineNumber = endLineNumber;\r\n\t\t\tthis.endColumn = endColumn;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * `range` 0 \r\n\t */\r\n\tpublic isEmpty(): boolean {\r\n\t\treturn Range.isEmpty(this);\r\n\t}\r\n\r\n\t/**\r\n\t * `range` 0 \r\n\t */\r\n\tpublic static isEmpty(range: IRange): boolean {\r\n\t\treturn (range.startLineNumber === range.endLineNumber && range.startColumn === range.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t * `position` range `this`    \r\n\t *\r\n\t * - `position`   true \r\n\t */\r\n\tpublic containsPosition(position: IPosition): boolean {\r\n\t\treturn Range.containsPosition(this, position);\r\n\t}\r\n\r\n\t/**\r\n\t * `position` `range`    \r\n\t *\r\n\t * - `position`   true \r\n\t */\r\n\tpublic static containsPosition(range: IRange, position: IPosition): boolean {\r\n\t\tif (position.lineNumber < range.startLineNumber || position.lineNumber > range.endLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (position.lineNumber === range.startLineNumber && position.column < range.startColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (position.lineNumber === range.endLineNumber && position.column > range.endColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * `position` `range`    \r\n\t *\r\n\t * - `position`   false \r\n\t * @internal\r\n\t */\r\n\tpublic static strictContainsPosition(range: IRange, position: IPosition): boolean {\r\n\t\tif (position.lineNumber < range.startLineNumber || position.lineNumber > range.endLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (position.lineNumber === range.startLineNumber && position.column <= range.startColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (position.lineNumber === range.endLineNumber && position.column >= range.endColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * `otherRange` `this` range    \r\n\t *\r\n\t * -  range  true \r\n\t */\r\n\tpublic containsRange(range: IRange): boolean {\r\n\t\treturn Range.containsRange(this, range);\r\n\t}\r\n\r\n\t/**\r\n\t * `otherRange` `range`    \r\n\t *\r\n\t * -  range  true \r\n\t */\r\n\tpublic static containsRange(range: IRange, otherRange: IRange): boolean {\r\n\t\tif (otherRange.startLineNumber < range.startLineNumber || otherRange.endLineNumber < range.startLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.startLineNumber > range.endLineNumber || otherRange.endLineNumber > range.endLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.startLineNumber === range.startLineNumber && otherRange.startColumn < range.startColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.endLineNumber === range.endLineNumber && otherRange.endColumn > range.endColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * Test if `range` is strictly in this range.\r\n\t *\r\n\t * - `this` range `range`  ,   true .\r\n\t */\r\n\tpublic strictContainsRange(range: IRange): boolean {\r\n\t\treturn Range.strictContainsRange(this, range);\r\n\t}\r\n\r\n\t/**\r\n\t * Test if `otherRange` is strictly in `range`\r\n\t *\r\n\t * - `this` range `range`  ,   true \r\n\t * -  range  false \r\n\t */\r\n\tpublic static strictContainsRange(range: IRange, otherRange: IRange): boolean {\r\n\t\tif (otherRange.startLineNumber < range.startLineNumber || otherRange.endLineNumber < range.startLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.startLineNumber > range.endLineNumber || otherRange.endLineNumber > range.endLineNumber) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.startLineNumber === range.startLineNumber && otherRange.startColumn <= range.startColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (otherRange.endLineNumber === range.endLineNumber && otherRange.endColumn >= range.endColumn) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t *  `range` \r\n\t *\r\n\t * -   position  ,   position  \r\n\t */\r\n\tpublic plusRange(range: IRange): Range {\r\n\t\treturn Range.plusRange(this, range);\r\n\t}\r\n\r\n\t/**\r\n\t *  `range` \r\n\t *\r\n\t * -   position  ,   position  \r\n\t */\r\n\tpublic static plusRange(a: IRange, b: IRange): Range {\r\n\t\tlet startLineNumber: number;\r\n\t\tlet startColumn: number;\r\n\t\tlet endLineNumber: number;\r\n\t\tlet endColumn: number;\r\n\r\n\t\tif (b.startLineNumber < a.startLineNumber) {\r\n\t\t\tstartLineNumber = b.startLineNumber;\r\n\t\t\tstartColumn = b.startColumn;\r\n\t\t} else if (b.startLineNumber === a.startLineNumber) {\r\n\t\t\tstartLineNumber = b.startLineNumber;\r\n\t\t\tstartColumn = Math.min(b.startColumn, a.startColumn);\r\n\t\t} else {\r\n\t\t\tstartLineNumber = a.startLineNumber;\r\n\t\t\tstartColumn = a.startColumn;\r\n\t\t}\r\n\r\n\t\tif (b.endLineNumber > a.endLineNumber) {\r\n\t\t\tendLineNumber = b.endLineNumber;\r\n\t\t\tendColumn = b.endColumn;\r\n\t\t} else if (b.endLineNumber === a.endLineNumber) {\r\n\t\t\tendLineNumber = b.endLineNumber;\r\n\t\t\tendColumn = Math.max(b.endColumn, a.endColumn);\r\n\t\t} else {\r\n\t\t\tendLineNumber = a.endLineNumber;\r\n\t\t\tendColumn = a.endColumn;\r\n\t\t}\r\n\r\n\t\treturn new Range(startLineNumber, startColumn, endLineNumber, endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  range   \r\n\t */\r\n\tpublic intersectRanges(range: IRange): Range | null {\r\n\t\treturn Range.intersectRanges(this, range);\r\n\t}\r\n\r\n\t/**\r\n\t *  range   \r\n\t */\r\n\tpublic static intersectRanges(a: IRange, b: IRange): Range | null {\r\n\t\tlet resultStartLineNumber = a.startLineNumber;\r\n\t\tlet resultStartColumn = a.startColumn;\r\n\t\tlet resultEndLineNumber = a.endLineNumber;\r\n\t\tlet resultEndColumn = a.endColumn;\r\n\t\tconst otherStartLineNumber = b.startLineNumber;\r\n\t\tconst otherStartColumn = b.startColumn;\r\n\t\tconst otherEndLineNumber = b.endLineNumber;\r\n\t\tconst otherEndColumn = b.endColumn;\r\n\r\n\t\tif (resultStartLineNumber < otherStartLineNumber) {\r\n\t\t\tresultStartLineNumber = otherStartLineNumber;\r\n\t\t\tresultStartColumn = otherStartColumn;\r\n\t\t} else if (resultStartLineNumber === otherStartLineNumber) {\r\n\t\t\tresultStartColumn = Math.max(resultStartColumn, otherStartColumn);\r\n\t\t}\r\n\r\n\t\tif (resultEndLineNumber > otherEndLineNumber) {\r\n\t\t\tresultEndLineNumber = otherEndLineNumber;\r\n\t\t\tresultEndColumn = otherEndColumn;\r\n\t\t} else if (resultEndLineNumber === otherEndLineNumber) {\r\n\t\t\tresultEndColumn = Math.min(resultEndColumn, otherEndColumn);\r\n\t\t}\r\n\r\n\t\t// (selection) 0 \r\n\t\tif (resultStartLineNumber > resultEndLineNumber) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (resultStartLineNumber === resultEndLineNumber && resultStartColumn > resultEndColumn) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn new Range(resultStartLineNumber, resultStartColumn, resultEndLineNumber, resultEndColumn);\r\n\t}\r\n\r\n\t/**\r\n\t * range `this` range `other`  \r\n\t */\r\n\tpublic equalsRange(other: IRange | null | undefined): boolean {\r\n\t\treturn Range.equalsRange(this, other);\r\n\t}\r\n\r\n\t/**\r\n\t * range `a` range `b`  \r\n\t */\r\n\tpublic static equalsRange(a: IRange | null | undefined, b: IRange | null | undefined): boolean {\r\n\t\tif (!a && !b) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn (\r\n\t\t\t!!a &&\r\n\t\t\t!!b &&\r\n\t\t\ta.startLineNumber === b.startLineNumber &&\r\n\t\t\ta.startColumn === b.startColumn &&\r\n\t\t\ta.endLineNumber === b.endLineNumber &&\r\n\t\t\ta.endColumn === b.endColumn\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *  (position) \r\n\t *\r\n\t * (    )\r\n\t */\r\n\tpublic getEndPosition(): Position {\r\n\t\treturn Range.getEndPosition(this);\r\n\t}\r\n\r\n\t/**\r\n\t *  (position) \r\n\t *\r\n\t * (    )\r\n\t */\r\n\tpublic static getEndPosition(range: IRange): Position {\r\n\t\treturn new Position(range.endLineNumber, range.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  (position) \r\n\t *\r\n\t * (    )\r\n\t */\r\n\tpublic getStartPosition(): Position {\r\n\t\treturn Range.getStartPosition(this);\r\n\t}\r\n\r\n\t/**\r\n\t *  (position) \r\n\t *\r\n\t * (    )\r\n\t */\r\n\tpublic static getStartPosition(range: IRange): Position {\r\n\t\treturn new Position(range.startLineNumber, range.startColumn);\r\n\t}\r\n\r\n\t/**\r\n\t * `\"[line,column -> line,column]\"`    (user presentable string)\r\n\t */\r\n\tpublic toString(): string {\r\n\t\treturn '[' + this.startLineNumber + ',' + this.startColumn + ' -> ' + this.endLineNumber + ',' + this.endColumn + ']';\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new range using `this` range's start position, and using `endLineNumber` and `endColumn` as the end position.\r\n\t */\r\n\tpublic setEndPosition(endLineNumber: number, endColumn: number): Range {\r\n\t\treturn new Range(this.startLineNumber, this.startColumn, endLineNumber, endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new range using `this` range's end position, and using `startLineNumber` and `startColumn` as the start position.\r\n\t */\r\n\tpublic setStartPosition(startLineNumber: number, startColumn: number): Range {\r\n\t\treturn new Range(startLineNumber, startColumn, this.endLineNumber, this.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new empty range using `this` range's start position.\r\n\t */\r\n\tpublic collapseToStart(): Range {\r\n\t\treturn Range.collapseToStart(this);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new empty range using `this` range's start position.\r\n\t */\r\n\tpublic static collapseToStart(range: IRange): Range {\r\n\t\treturn new Range(range.startLineNumber, range.startColumn, range.startLineNumber, range.startColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new empty range using `this` range's end position.\r\n\t */\r\n\tpublic collapseToEnd(): Range {\r\n\t\treturn Range.collapseToEnd(this);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Create a new empty range using `this` range's end position.\r\n\t */\r\n\tpublic static collapseToEnd(range: IRange): Range {\r\n\t\treturn new Range(range.endLineNumber, range.endColumn, range.endLineNumber, range.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t * Moves `this` range by the given amount of lines.\r\n\t */\r\n\tpublic delta(lineCount: number): Range {\r\n\t\treturn new Range(this.startLineNumber + lineCount, this.startColumn, this.endLineNumber + lineCount, this.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Range \r\n\t *\r\n\t *   `start`,   `end` Range \r\n\t */\r\n\tpublic static fromPositions(start: IPosition, end: IPosition = start): Range {\r\n\t\treturn new Range(start.lineNumber, start.column, end.lineNumber, end.column);\r\n\t}\r\n\r\n\t/**\r\n\t * `IRange` `Range`  \r\n\t */\r\n\tpublic static lift(range: undefined | null): null;\r\n\tpublic static lift(range: IRange): Range;\r\n\tpublic static lift(range: IRange | undefined | null): Range | null;\r\n\tpublic static lift(range: IRange | undefined | null): Range | null {\r\n\t\tif (!range) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn new Range(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n\t}\r\n\r\n\t/**\r\n\t * `obj` `IRange` .\r\n\t */\r\n\tpublic static isIRange(obj: any): obj is IRange {\r\n\t\treturn (\r\n\t\t\tobj\r\n\t\t\t&& (typeof obj.startLineNumber === 'number')\r\n\t\t\t&& (typeof obj.startColumn === 'number')\r\n\t\t\t&& (typeof obj.endLineNumber === 'number')\r\n\t\t\t&& (typeof obj.endColumn === 'number')\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *  range    \r\n\t */\r\n\tpublic static areIntersectingOrTouching(a: IRange, b: IRange): boolean {\r\n\t\t// Check if `a` is before `b`\r\n\t\tif (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn < b.startColumn)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Check if `b` is before `a`\r\n\t\tif (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn < a.startColumn)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// These ranges must intersect\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t *  range   \r\n\t *\r\n\t * -  range     false .\r\n\t */\r\n\tpublic static areIntersecting(a: IRange, b: IRange): boolean {\r\n\t\t// Check if `a` is before `b`\r\n\t\tif (a.endLineNumber < b.startLineNumber || (a.endLineNumber === b.startLineNumber && a.endColumn <= b.startColumn)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Check if `b` is before `a`\r\n\t\tif (b.endLineNumber < a.startLineNumber || (b.endLineNumber === a.startLineNumber && b.endColumn <= a.startColumn)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// These ranges must intersect\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * range  , (sort)  \r\n\t * -   :\r\n\t * 1. start Line Number\r\n\t * 2. start Column\r\n\t * 3. end Line Number\r\n\t * 4. end Column\r\n\t */\r\n\tpublic static compareRangesUsingStarts(a: IRange | null | undefined, b: IRange | null | undefined): number {\r\n\t\tif (a && b) {\r\n\t\t\tconst aStartLineNumber = a.startLineNumber | 0;\r\n\t\t\tconst bStartLineNumber = b.startLineNumber | 0;\r\n\r\n\t\t\tif (aStartLineNumber === bStartLineNumber) {\r\n\t\t\t\tconst aStartColumn = a.startColumn | 0;\r\n\t\t\t\tconst bStartColumn = b.startColumn | 0;\r\n\r\n\t\t\t\tif (aStartColumn === bStartColumn) {\r\n\t\t\t\t\tconst aEndLineNumber = a.endLineNumber | 0;\r\n\t\t\t\t\tconst bEndLineNumber = b.endLineNumber | 0;\r\n\r\n\t\t\t\t\tif (aEndLineNumber === bEndLineNumber) {\r\n\t\t\t\t\t\tconst aEndColumn = a.endColumn | 0;\r\n\t\t\t\t\t\tconst bEndColumn = b.endColumn | 0;\r\n\t\t\t\t\t\treturn aEndColumn - bEndColumn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn aEndLineNumber - bEndLineNumber;\r\n\t\t\t\t}\r\n\t\t\t\treturn aStartColumn - bStartColumn;\r\n\t\t\t}\r\n\t\t\treturn aStartLineNumber - bStartLineNumber;\r\n\t\t}\r\n\t\tconst aExists = (a ? 1 : 0);\r\n\t\tconst bExists = (b ? 1 : 0);\r\n\t\treturn aExists - bExists;\r\n\t}\r\n\r\n\t/**\r\n\t * range  , (sort)  \r\n\t * -   :\r\n\t * 1. end Line Number\r\n\t * 2. end Column\r\n\t * 3. start Line Number\r\n\t * 4. start Column\r\n\t */\r\n\tpublic static compareRangesUsingEnds(a: IRange, b: IRange): number {\r\n\t\tif (a.endLineNumber === b.endLineNumber) {\r\n\t\t\tif (a.endColumn === b.endColumn) {\r\n\t\t\t\tif (a.startLineNumber === b.startLineNumber) {\r\n\t\t\t\t\treturn a.startColumn - b.startColumn;\r\n\t\t\t\t}\r\n\t\t\t\treturn a.startLineNumber - b.startLineNumber;\r\n\t\t\t}\r\n\t\t\treturn a.endColumn - b.endColumn;\r\n\t\t}\r\n\t\treturn a.endLineNumber - b.endLineNumber;\r\n\t}\r\n\r\n\t/**\r\n\t * `range`    \r\n\t */\r\n\tpublic static spansMultipleLines(range: IRange): boolean {\r\n\t\treturn range.endLineNumber > range.startLineNumber;\r\n\t}\r\n\r\n\tpublic toJSON(): IRange {\r\n\t\treturn this;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export class LineRange\r\n * export type ISerializedLineRange\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { BugIndicatingError } from 'vs/base/common/errors';\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\nimport { Range } from 'vs/editor/common/core/range';\r\n\r\n/**\r\n * A range of lines (1-based).\r\n */\r\nexport class LineRange {\r\n\t/** `Range`   `LineRange`   */\r\n\tpublic static fromRange(range: Range): LineRange {\r\n\t\treturn new LineRange(range.startLineNumber, range.endLineNumber);\r\n\t}\r\n\r\n\t/** `a`  `b`    */\r\n\tpublic static subtract(a: LineRange, b: LineRange | undefined): LineRange[] {\r\n\t\tif (!b) {\r\n\t\t\treturn [a];\r\n\t\t}\r\n\t\tif (a.startLineNumber < b.startLineNumber && b.endLineNumberExclusive < a.endLineNumberExclusive) {\r\n\t\t\t// b a  \r\n\t\t\treturn [\r\n\t\t\t\tnew LineRange(a.startLineNumber, b.startLineNumber),\r\n\t\t\t\tnew LineRange(b.endLineNumberExclusive, a.endLineNumberExclusive)\r\n\t\t\t];\r\n\t\t} else if (b.startLineNumber <= a.startLineNumber && a.endLineNumberExclusive <= b.endLineNumberExclusive) {\r\n\t\t\t// a b  \r\n\t\t\treturn [];\r\n\t\t} else if (b.endLineNumberExclusive < a.endLineNumberExclusive) {\r\n\t\t\treturn [new LineRange(Math.max(b.endLineNumberExclusive, a.startLineNumber), a.endLineNumberExclusive)];\r\n\t\t} else {\r\n\t\t\treturn [new LineRange(a.startLineNumber, Math.min(b.startLineNumber, a.endLineNumberExclusive))];\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t *  LineRange   \r\n\t * @param lineRanges  line range \r\n\t */\r\n\tpublic static joinMany(lineRanges: readonly (readonly LineRange[])[]): readonly LineRange[] {\r\n\t\tif (lineRanges.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tlet result = lineRanges[0];\r\n\t\tfor (let i = 1; i < lineRanges.length; i++) {\r\n\t\t\tresult = this.join(result, lineRanges[i]);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t *  LineRange   \r\n\t * @param lineRanges1  (sort)  \r\n\t * @param lineRanges2  (sort)  \r\n\t */\r\n\tpublic static join(lineRanges1: readonly LineRange[], lineRanges2: readonly LineRange[]): readonly LineRange[] {\r\n\t\tif (lineRanges1.length === 0) {\r\n\t\t\treturn lineRanges2;\r\n\t\t}\r\n\t\tif (lineRanges2.length === 0) {\r\n\t\t\treturn lineRanges1;\r\n\t\t}\r\n\r\n\t\tconst result: LineRange[] = [];\r\n\t\tlet i1 = 0;\r\n\t\tlet i2 = 0;\r\n\t\tlet current: LineRange | null = null;\r\n\t\twhile (i1 < lineRanges1.length || i2 < lineRanges2.length) {\r\n\t\t\tlet next: LineRange | null = null;\r\n\t\t\tif (i1 < lineRanges1.length && i2 < lineRanges2.length) {\r\n\t\t\t\tconst lineRange1 = lineRanges1[i1];\r\n\t\t\t\tconst lineRange2 = lineRanges2[i2];\r\n\t\t\t\tif (lineRange1.startLineNumber < lineRange2.startLineNumber) {\r\n\t\t\t\t\tnext = lineRange1;\r\n\t\t\t\t\ti1++;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnext = lineRange2;\r\n\t\t\t\t\ti2++;\r\n\t\t\t\t}\r\n\t\t\t} else if (i1 < lineRanges1.length) {\r\n\t\t\t\tnext = lineRanges1[i1];\r\n\t\t\t\ti1++;\r\n\t\t\t} else {\r\n\t\t\t\tnext = lineRanges2[i2];\r\n\t\t\t\ti2++;\r\n\t\t\t}\r\n\r\n\t\t\tif (current === null) {\r\n\t\t\t\tcurrent = next;\r\n\t\t\t} else {\r\n\t\t\t\tif (current.endLineNumberExclusive >= next.startLineNumber) {\r\n\t\t\t\t\t// merge\r\n\t\t\t\t\tcurrent = new LineRange(current.startLineNumber, Math.max(current.endLineNumberExclusive, next.endLineNumberExclusive));\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// push\r\n\t\t\t\t\tresult.push(current);\r\n\t\t\t\t\tcurrent = next;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (current !== null) {\r\n\t\t\tresult.push(current);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic static ofLength(startLineNumber: number, length: number): LineRange {\r\n\t\treturn new LineRange(startLineNumber, startLineNumber + length);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tpublic static deserialize(lineRange: ISerializedLineRange): LineRange {\r\n\t\treturn new LineRange(lineRange[0], lineRange[1]);\r\n\t}\r\n\r\n\t/**\r\n\t *  line \r\n\t */\r\n\tpublic readonly startLineNumber: number;\r\n\r\n\t/**\r\n\t *  line  (exclusive).\r\n\t */\r\n\tpublic readonly endLineNumberExclusive: number;\r\n\r\n\t// \r\n\tconstructor(\r\n\t\tstartLineNumber: number,\r\n\t\tendLineNumberExclusive: number,\r\n\t) {\r\n\t\tif (startLineNumber > endLineNumberExclusive) {\r\n\t\t\tthrow new BugIndicatingError(`startLineNumber ${startLineNumber} cannot be after endLineNumberExclusive ${endLineNumberExclusive}`);\r\n\t\t}\r\n\t\tthis.startLineNumber = startLineNumber;\r\n\t\tthis.endLineNumberExclusive = endLineNumberExclusive;\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates if this line range contains the given line number.\r\n\t */\r\n\tpublic contains(lineNumber: number): boolean {\r\n\t\treturn this.startLineNumber <= lineNumber && lineNumber < this.endLineNumberExclusive;\r\n\t}\r\n\r\n\t/**\r\n\t * Indicates if this line range is empty.\r\n\t */\r\n\tget isEmpty(): boolean {\r\n\t\treturn this.startLineNumber === this.endLineNumberExclusive;\r\n\t}\r\n\r\n\t/**\r\n\t * Moves this line range by the given offset of line numbers.\r\n\t */\r\n\tpublic delta(offset: number): LineRange {\r\n\t\treturn new LineRange(this.startLineNumber + offset, this.endLineNumberExclusive + offset);\r\n\t}\r\n\r\n\tpublic deltaLength(offset: number): LineRange {\r\n\t\treturn new LineRange(this.startLineNumber, this.endLineNumberExclusive + offset);\r\n\t}\r\n\r\n\t/**\r\n\t * The number of lines this line range spans.\r\n\t */\r\n\tpublic get length(): number {\r\n\t\treturn this.endLineNumberExclusive - this.startLineNumber;\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a line range that combines this and the given line range.\r\n\t */\r\n\tpublic join(other: LineRange): LineRange {\r\n\t\treturn new LineRange(\r\n\t\t\tMath.min(this.startLineNumber, other.startLineNumber),\r\n\t\t\tMath.max(this.endLineNumberExclusive, other.endLineNumberExclusive)\r\n\t\t);\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn `[${this.startLineNumber},${this.endLineNumberExclusive})`;\r\n\t}\r\n\r\n\t/**\r\n\t * The resulting range is empty if the ranges do not intersect, but touch.\r\n\t * If the ranges don't even touch, the result is undefined.\r\n\t */\r\n\tpublic intersect(other: LineRange): LineRange | undefined {\r\n\t\tconst startLineNumber = Math.max(this.startLineNumber, other.startLineNumber);\r\n\t\tconst endLineNumberExclusive = Math.min(this.endLineNumberExclusive, other.endLineNumberExclusive);\r\n\t\tif (startLineNumber <= endLineNumberExclusive) {\r\n\t\t\treturn new LineRange(startLineNumber, endLineNumberExclusive);\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic intersectsStrict(other: LineRange): boolean {\r\n\t\treturn this.startLineNumber < other.endLineNumberExclusive && other.startLineNumber < this.endLineNumberExclusive;\r\n\t}\r\n\r\n\tpublic overlapOrTouch(other: LineRange): boolean {\r\n\t\treturn this.startLineNumber <= other.endLineNumberExclusive && other.startLineNumber <= this.endLineNumberExclusive;\r\n\t}\r\n\r\n\tpublic equals(b: LineRange): boolean {\r\n\t\treturn this.startLineNumber === b.startLineNumber && this.endLineNumberExclusive === b.endLineNumberExclusive;\r\n\t}\r\n\r\n\tpublic toInclusiveRange(): Range | null {\r\n\t\tif (this.isEmpty) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn new Range(this.startLineNumber, 1, this.endLineNumberExclusive - 1, Number.MAX_SAFE_INTEGER);\r\n\t}\r\n\r\n\tpublic toExclusiveRange(): Range {\r\n\t\treturn new Range(this.startLineNumber, 1, this.endLineNumberExclusive, 1);\r\n\t}\r\n\r\n\tpublic mapToLineArray<T>(f: (lineNumber: number) => T): T[] {\r\n\t\tconst result: T[] = [];\r\n\t\tfor (let lineNumber = this.startLineNumber; lineNumber < this.endLineNumberExclusive; lineNumber++) {\r\n\t\t\tresult.push(f(lineNumber));\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic forEach(f: (lineNumber: number) => void): void {\r\n\t\tfor (let lineNumber = this.startLineNumber; lineNumber < this.endLineNumberExclusive; lineNumber++) {\r\n\t\t\tf(lineNumber);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tpublic serialize(): ISerializedLineRange {\r\n\t\treturn [this.startLineNumber, this.endLineNumberExclusive];\r\n\t}\r\n\r\n\tpublic includes(lineNumber: number): boolean {\r\n\t\treturn this.startLineNumber <= lineNumber && lineNumber < this.endLineNumberExclusive;\r\n\t}\r\n\r\n\t/**\r\n\t * Converts this 1-based line range to a 0-based offset range (subtracts 1!).\r\n\t * @internal\r\n\t */\r\n\tpublic toOffsetRange(): OffsetRange {\r\n\t\treturn new OffsetRange(this.startLineNumber - 1, this.endLineNumberExclusive - 1);\r\n\t}\r\n}\r\n\r\n\r\nexport type ISerializedLineRange = [startLineNumber: number, endLineNumberExclusive: number];\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * []\r\n * export interface ISelection\r\n * export const enum SelectionDirection\r\n * export class Selection extends Range\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { IPosition, Position } from 'vs/editor/common/core/position';\r\nimport { Range } from 'vs/editor/common/core/range';\r\n\r\n/**\r\n *  (selection)\r\n *\r\n *  (orientation)  \r\n */\r\nexport interface ISelection {\r\n\t/**\r\n\t * line  on which the selection has started.\r\n\t */\r\n\treadonly selectionStartLineNumber: number;\r\n\t/**\r\n\t * column  on `selectionStartLineNumber` where the selection has started.\r\n\t */\r\n\treadonly selectionStartColumn: number;\r\n\t/**\r\n\t * line  on which the selection has ended.\r\n\t */\r\n\treadonly positionLineNumber: number;\r\n\t/**\r\n\t * column  on `positionLineNumber` where the selection has ended.\r\n\t */\r\n\treadonly positionColumn: number;\r\n}\r\n\r\n/**\r\n * (selection) \r\n */\r\nexport const enum SelectionDirection {\r\n\t/**\r\n\t *   \r\n\t */\r\n\tLTR,\r\n\t/**\r\n\t *   \r\n\t */\r\n\tRTL\r\n}\r\n\r\n/**\r\n *  (selection)\r\n *\r\n *  (orientation)  \r\n */\r\nexport class Selection extends Range {\r\n\t/**\r\n\t * line  on which the selection has started.\r\n\t */\r\n\tpublic readonly selectionStartLineNumber: number;\r\n\t/**\r\n\t * column  on `selectionStartLineNumber` where the selection has started.\r\n\t */\r\n\tpublic readonly selectionStartColumn: number;\r\n\t/**\r\n\t * line  on which the selection has ended.\r\n\t */\r\n\tpublic readonly positionLineNumber: number;\r\n\t/**\r\n\t * column  on `positionLineNumber` where the selection has ended.\r\n\t */\r\n\tpublic readonly positionColumn: number;\r\n\r\n\tconstructor(selectionStartLineNumber: number, selectionStartColumn: number, positionLineNumber: number, positionColumn: number) {\r\n\t\tsuper(selectionStartLineNumber, selectionStartColumn, positionLineNumber, positionColumn);\r\n\t\tthis.selectionStartLineNumber = selectionStartLineNumber;\r\n\t\tthis.selectionStartColumn = selectionStartColumn;\r\n\t\tthis.positionLineNumber = positionLineNumber;\r\n\t\tthis.positionColumn = positionColumn;\r\n\t}\r\n\r\n\t/**\r\n\t * `\"[line,column -> line,column]\"`    (human-readable)\r\n\t */\r\n\tpublic override toString(): string {\r\n\t\treturn '[' + this.selectionStartLineNumber + ',' + this.selectionStartColumn + ' -> ' + this.positionLineNumber + ',' + this.positionColumn + ']';\r\n\t}\r\n\r\n\t/**\r\n\t *  if equals other selection.\r\n\t */\r\n\tpublic equalsSelection(other: ISelection): boolean {\r\n\t\treturn (\r\n\t\t\tSelection.selectionsEqual(this, other)\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *  if the two selections are equal.\r\n\t */\r\n\tpublic static selectionsEqual(a: ISelection, b: ISelection): boolean {\r\n\t\treturn (\r\n\t\t\ta.selectionStartLineNumber === b.selectionStartLineNumber &&\r\n\t\t\ta.selectionStartColumn === b.selectionStartColumn &&\r\n\t\t\ta.positionLineNumber === b.positionLineNumber &&\r\n\t\t\ta.positionColumn === b.positionColumn\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *    (`LTR`  `RTL`).\r\n\t */\r\n\tpublic getDirection(): SelectionDirection {\r\n\t\tif (this.selectionStartLineNumber === this.startLineNumber && this.selectionStartColumn === this.startColumn) {\r\n\t\t\treturn SelectionDirection.LTR;\r\n\t\t}\r\n\t\treturn SelectionDirection.RTL;\r\n\t}\r\n\r\n\t/**\r\n\t *  Selection \r\n\t *\r\n\t *    ,  (`positionLineNumber`, `positionColumn`)   \r\n\t */\r\n\tpublic override setEndPosition(endLineNumber: number, endColumn: number): Selection {\r\n\t\tif (this.getDirection() === SelectionDirection.LTR) {\r\n\t\t\treturn new Selection(this.startLineNumber, this.startColumn, endLineNumber, endColumn);\r\n\t\t}\r\n\t\treturn new Selection(endLineNumber, endColumn, this.startLineNumber, this.startColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *   (`positionLineNumber`, `positionColumn`) \r\n\t */\r\n\tpublic getPosition(): Position {\r\n\t\treturn new Position(this.positionLineNumber, this.positionColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *    \r\n\t */\r\n\tpublic getSelectionStart(): Position {\r\n\t\treturn new Position(this.selectionStartLineNumber, this.selectionStartColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *  Selection \r\n\t *\r\n\t * Create a new selection with a different `selectionStartLineNumber` and `selectionStartColumn`.\r\n\t */\r\n\tpublic override setStartPosition(startLineNumber: number, startColumn: number): Selection {\r\n\t\tif (this.getDirection() === SelectionDirection.LTR) {\r\n\t\t\treturn new Selection(startLineNumber, startColumn, this.endLineNumber, this.endColumn);\r\n\t\t}\r\n\t\treturn new Selection(this.endLineNumber, this.endColumn, startLineNumber, startColumn);\r\n\t}\r\n\r\n\t// ----\r\n\r\n\t/**\r\n\t *  Selection \r\n\t *\r\n\t * Create a `Selection` from one or two positions\r\n\t */\r\n\tpublic static override fromPositions(start: IPosition, end: IPosition = start): Selection {\r\n\t\treturn new Selection(start.lineNumber, start.column, end.lineNumber, end.column);\r\n\t}\r\n\r\n\t/**\r\n\t *  Selection \r\n\t *\r\n\t * Creates a `Selection` from a range, given a direction.\r\n\t */\r\n\tpublic static fromRange(range: Range, direction: SelectionDirection): Selection {\r\n\t\tif (direction === SelectionDirection.LTR) {\r\n\t\t\treturn new Selection(range.startLineNumber, range.startColumn, range.endLineNumber, range.endColumn);\r\n\t\t} else {\r\n\t\t\treturn new Selection(range.endLineNumber, range.endColumn, range.startLineNumber, range.startColumn);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * `ISelection` `Selection` \r\n\t */\r\n\tpublic static liftSelection(sel: ISelection): Selection {\r\n\t\treturn new Selection(sel.selectionStartLineNumber, sel.selectionStartColumn, sel.positionLineNumber, sel.positionColumn);\r\n\t}\r\n\r\n\t/**\r\n\t *    `a` `b`  \r\n\t */\r\n\tpublic static selectionsArrEqual(a: ISelection[], b: ISelection[]): boolean {\r\n\t\tif (a && !b || !a && b) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!a && !b) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (a.length !== b.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor (let i = 0, len = a.length; i < len; i++) {\r\n\t\t\tif (!this.selectionsEqual(a[i], b[i])) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t/**\r\n\t * `obj` `ISelection` \r\n\t */\r\n\tpublic static isISelection(obj: any): obj is ISelection {\r\n\t\treturn (\r\n\t\t\tobj\r\n\t\t\t&& (typeof obj.selectionStartLineNumber === 'number')\r\n\t\t\t&& (typeof obj.selectionStartColumn === 'number')\r\n\t\t\t&& (typeof obj.positionLineNumber === 'number')\r\n\t\t\t&& (typeof obj.positionColumn === 'number')\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t *  Selection \r\n\t * -   \r\n\t */\r\n\tpublic static createWithDirection(startLineNumber: number, startColumn: number, endLineNumber: number, endColumn: number, direction: SelectionDirection): Selection {\r\n\r\n\t\tif (direction === SelectionDirection.LTR) {\r\n\t\t\treturn new Selection(startLineNumber, startColumn, endLineNumber, endColumn);\r\n\t\t}\r\n\r\n\t\treturn new Selection(endLineNumber, endColumn, startLineNumber, startColumn);\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { CharacterClassifier } from 'vs/editor/common/core/characterClassifier';\r\n\r\nexport const enum WordCharacterClass {\r\n\tRegular = 0,\r\n\tWhitespace = 1,\r\n\tWordSeparator = 2\r\n}\r\n\r\nexport class WordCharacterClassifier extends CharacterClassifier<WordCharacterClass> {\r\n\r\n\tconstructor(wordSeparators: string) {\r\n\t\tsuper(WordCharacterClass.Regular);\r\n\r\n\t\tfor (let i = 0, len = wordSeparators.length; i < len; i++) {\r\n\t\t\tthis.set(wordSeparators.charCodeAt(i), WordCharacterClass.WordSeparator);\r\n\t\t}\r\n\r\n\t\tthis.set(CharCode.Space, WordCharacterClass.Whitespace);\r\n\t\tthis.set(CharCode.Tab, WordCharacterClass.Whitespace);\r\n\t}\r\n\r\n}\r\n\r\nfunction once<R>(computeFn: (input: string) => R): (input: string) => R {\r\n\tconst cache: { [key: string]: R } = {}; // TODO@Alex unbounded cache\r\n\treturn (input: string): R => {\r\n\t\tif (!cache.hasOwnProperty(input)) {\r\n\t\t\tcache[input] = computeFn(input);\r\n\t\t}\r\n\t\treturn cache[input];\r\n\t};\r\n}\r\n\r\nexport const getMapForWordSeparators = once<WordCharacterClassifier>(\r\n\t(input) => new WordCharacterClassifier(input)\r\n);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { Iterable } from 'vs/base/common/iterator';\r\nimport { LinkedList } from 'vs/base/common/linkedList';\r\n\r\nexport const USUAL_WORD_SEPARATORS = '`~!@#$%^&*()-=+[{]}\\\\|;:\\'\",.<>/?';\r\n\r\n/**\r\n * Word inside a model.\r\n */\r\nexport interface IWordAtPosition {\r\n\t/**\r\n\t * The word.\r\n\t */\r\n\treadonly word: string;\r\n\t/**\r\n\t * The column where the word starts.\r\n\t */\r\n\treadonly startColumn: number;\r\n\t/**\r\n\t * The column where the word ends.\r\n\t */\r\n\treadonly endColumn: number;\r\n}\r\n\r\n/**\r\n *   \r\n * Create a word definition regular expression based on default word separators.\r\n * Optionally provide allowed separators that should be included in words.\r\n *\r\n * The default would look like this:\r\n * /(-?\\d*\\.\\d\\w*)|([^\\`\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\=\\+\\[\\{\\]\\}\\\\\\|\\;\\:\\'\\\"\\,\\.\\<\\>\\/\\?\\s]+)/g\r\n */\r\nfunction createWordRegExp(allowInWords: string = ''): RegExp {\r\n\tlet source = '(-?\\\\d*\\\\.\\\\d\\\\w*)|([^';\r\n\tfor (const sep of USUAL_WORD_SEPARATORS) {\r\n\t\tif (allowInWords.indexOf(sep) >= 0) {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tsource += '\\\\' + sep;\r\n\t}\r\n\tsource += '\\\\s]+)';\r\n\treturn new RegExp(source, 'g');\r\n}\r\n\r\n// catches numbers (including floating numbers) in the first group, and alphanum in the second\r\nexport const DEFAULT_WORD_REGEXP = createWordRegExp();\r\n\r\nexport function ensureValidWordDefinition(wordDefinition?: RegExp | null): RegExp {\r\n\tlet result: RegExp = DEFAULT_WORD_REGEXP;\r\n\r\n\tif (wordDefinition && (wordDefinition instanceof RegExp)) {\r\n\t\tif (!wordDefinition.global) {\r\n\t\t\tlet flags = 'g';\r\n\t\t\tif (wordDefinition.ignoreCase) {\r\n\t\t\t\tflags += 'i';\r\n\t\t\t}\r\n\t\t\tif (wordDefinition.multiline) {\r\n\t\t\t\tflags += 'm';\r\n\t\t\t}\r\n\t\t\tif (wordDefinition.unicode) {\r\n\t\t\t\tflags += 'u';\r\n\t\t\t}\r\n\t\t\tresult = new RegExp(wordDefinition.source, flags);\r\n\t\t} else {\r\n\t\t\tresult = wordDefinition;\r\n\t\t}\r\n\t}\r\n\r\n\tresult.lastIndex = 0;\r\n\r\n\treturn result;\r\n}\r\n\r\n\r\nexport interface IGetWordAtTextConfig {\r\n\tmaxLen: number;\r\n\twindowSize: number;\r\n\ttimeBudget: number;\r\n}\r\n\r\n\r\nconst _defaultConfig = new LinkedList<IGetWordAtTextConfig>();\r\n_defaultConfig.unshift({\r\n\tmaxLen: 1000,\r\n\twindowSize: 15,\r\n\ttimeBudget: 150\r\n});\r\n\r\nexport function getWordAtText(column: number, wordDefinition: RegExp, text: string, textOffset: number, config?: IGetWordAtTextConfig): IWordAtPosition | null {\r\n\r\n\tif (!config) {\r\n\t\tconfig = Iterable.first(_defaultConfig)!;\r\n\t}\r\n\r\n\tif (text.length > config.maxLen) {\r\n\t\t// don't throw strings that long at the regexp\r\n\t\t// but use a sub-string in which a word must occur\r\n\t\tlet start = column - config.maxLen / 2;\r\n\t\tif (start < 0) {\r\n\t\t\tstart = 0;\r\n\t\t} else {\r\n\t\t\ttextOffset += start;\r\n\t\t}\r\n\t\ttext = text.substring(start, column + config.maxLen / 2);\r\n\t\treturn getWordAtText(column, wordDefinition, text, textOffset, config);\r\n\t}\r\n\r\n\tconst t1 = Date.now();\r\n\tconst pos = column - 1 - textOffset;\r\n\r\n\tlet prevRegexIndex = -1;\r\n\tlet match: RegExpExecArray | null = null;\r\n\r\n\tfor (let i = 1; ; i++) {\r\n\t\t// check time budget\r\n\t\tif (Date.now() - t1 >= config.timeBudget) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t// reset the index at which the regexp should start matching, also know where it\r\n\t\t// should stop so that subsequent search don't repeat previous searches\r\n\t\tconst regexIndex = pos - config.windowSize * i;\r\n\t\twordDefinition.lastIndex = Math.max(0, regexIndex);\r\n\t\tconst thisMatch = _findRegexMatchEnclosingPosition(wordDefinition, text, pos, prevRegexIndex);\r\n\r\n\t\tif (!thisMatch && match) {\r\n\t\t\t// stop: we have something\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tmatch = thisMatch;\r\n\r\n\t\t// stop: searched at start\r\n\t\tif (regexIndex <= 0) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tprevRegexIndex = regexIndex;\r\n\t}\r\n\r\n\tif (match) {\r\n\t\tconst result = {\r\n\t\t\tword: match[0],\r\n\t\t\tstartColumn: textOffset + 1 + match.index!,\r\n\t\t\tendColumn: textOffset + 1 + match.index! + match[0].length\r\n\t\t};\r\n\t\twordDefinition.lastIndex = 0;\r\n\t\treturn result;\r\n\t}\r\n\r\n\treturn null;\r\n}\r\n\r\nfunction _findRegexMatchEnclosingPosition(wordDefinition: RegExp, text: string, pos: number, stopPos: number): RegExpExecArray | null {\r\n\tlet match: RegExpExecArray | null;\r\n\twhile (match = wordDefinition.exec(text)) {\r\n\t\tconst matchIndex = match.index || 0;\r\n\t\tif (matchIndex <= pos && wordDefinition.lastIndex >= pos) {\r\n\t\t\treturn match;\r\n\t\t} else if (stopPos > 0 && matchIndex > stopPos) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\treturn null;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { BugIndicatingError } from 'vs/base/common/errors';\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\n\r\n/**\r\n * Represents a synchronous diff algorithm. Should be executed in a worker.\r\n*/\r\nexport interface IDiffAlgorithm {\r\n}\r\n\r\nexport class DiffAlgorithmResult {\r\n\tstatic trivial(seq1: ISequence, seq2: ISequence): DiffAlgorithmResult {\r\n\t\treturn new DiffAlgorithmResult([new SequenceDiff(new OffsetRange(0, seq1.length), new OffsetRange(0, seq2.length))], false);\r\n\t}\r\n\r\n\tstatic trivialTimedOut(seq1: ISequence, seq2: ISequence): DiffAlgorithmResult {\r\n\t\treturn new DiffAlgorithmResult([new SequenceDiff(new OffsetRange(0, seq1.length), new OffsetRange(0, seq2.length))], true);\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tpublic readonly diffs: SequenceDiff[],\r\n\t\t/**\r\n\t\t * Indicates if the time out was reached.\r\n\t\t * In that case, the diffs might be an approximation and the user should be asked to rerun the diff with more time.\r\n\t\t */\r\n\t\tpublic readonly hitTimeout: boolean,\r\n\t) { }\r\n}\r\n\r\nexport class SequenceDiff {\r\n\tconstructor(\r\n\t\tpublic readonly seq1Range: OffsetRange,\r\n\t\tpublic readonly seq2Range: OffsetRange,\r\n\t) { }\r\n\r\n\tpublic reverse(): SequenceDiff {\r\n\t\treturn new SequenceDiff(this.seq2Range, this.seq1Range);\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn `${this.seq1Range} <-> ${this.seq2Range}`;\r\n\t}\r\n\r\n\tpublic join(other: SequenceDiff): SequenceDiff {\r\n\t\treturn new SequenceDiff(this.seq1Range.join(other.seq1Range), this.seq2Range.join(other.seq2Range));\r\n\t}\r\n\r\n\tpublic delta(offset: number): SequenceDiff {\r\n\t\tif (offset === 0) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\t\treturn new SequenceDiff(this.seq1Range.delta(offset), this.seq2Range.delta(offset));\r\n\t}\r\n}\r\n\r\nexport interface ISequence {\r\n\tgetElement(offset: number): number;\r\n\tget length(): number;\r\n\r\n\t/**\r\n\t * The higher the score, the better that offset can be used to split the sequence.\r\n\t * Is used to optimize insertions.\r\n\t * Must not be negative.\r\n\t*/\r\n\tgetBoundaryScore?(length: number): number;\r\n\r\n\t/**\r\n\t * For line sequences, getElement returns a number representing trimmed lines.\r\n\t * This however checks equality for the original lines.\r\n\t * It prevents shifting to less matching lines.\r\n\t */\r\n\tisStronglyEqual(offset1: number, offset2: number): boolean;\r\n}\r\n\r\nexport interface ITimeout {\r\n\tisValid(): boolean;\r\n}\r\n\r\nexport class InfiniteTimeout implements ITimeout {\r\n\tpublic static instance = new InfiniteTimeout();\r\n\r\n\tisValid(): boolean {\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nexport class DateTimeout implements ITimeout {\r\n\tprivate readonly startTime = Date.now();\r\n\tprivate valid = true;\r\n\r\n\tconstructor(private timeout: number) {\r\n\t\tif (timeout <= 0) {\r\n\t\t\tthrow new BugIndicatingError('timeout must be positive');\r\n\t\t}\r\n\t}\r\n\r\n\t// Recommendation: Set a log-point `{this.disable()}` in the body\r\n\tpublic isValid(): boolean {\r\n\t\tconst valid = Date.now() - this.startTime < this.timeout;\r\n\t\tif (!valid && this.valid) {\r\n\t\t\tthis.valid = false; // timeout reached\r\n\t\t\t// eslint-disable-next-line no-debugger\r\n\t\t\tdebugger; // WARNING: Most likely debugging caused the timeout. Call `this.disable()` to continue without timing out.\r\n\t\t}\r\n\t\treturn this.valid;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\nimport { ISequence, SequenceDiff } from 'vs/editor/common/diff/algorithms/diffAlgorithm';\r\nimport { LineSequence, LinesSliceCharSequence } from 'vs/editor/common/diff/advancedLinesDiffComputer';\r\n\r\nexport function optimizeSequenceDiffs(sequence1: ISequence, sequence2: ISequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tlet result = sequenceDiffs;\r\n\tresult = joinSequenceDiffs(sequence1, sequence2, result);\r\n\tresult = shiftSequenceDiffs(sequence1, sequence2, result);\r\n\treturn result;\r\n}\r\n\r\nexport function smoothenSequenceDiffs(sequence1: ISequence, sequence2: ISequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tconst result: SequenceDiff[] = [];\r\n\tfor (const s of sequenceDiffs) {\r\n\t\tconst last = result[result.length - 1];\r\n\t\tif (!last) {\r\n\t\t\tresult.push(s);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\r\n\t\tif (s.seq1Range.start - last.seq1Range.endExclusive <= 2 || s.seq2Range.start - last.seq2Range.endExclusive <= 2) {\r\n\t\t\tresult[result.length - 1] = new SequenceDiff(last.seq1Range.join(s.seq1Range), last.seq2Range.join(s.seq2Range));\r\n\t\t} else {\r\n\t\t\tresult.push(s);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function removeRandomLineMatches(sequence1: LineSequence, _sequence2: LineSequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tlet diffs = sequenceDiffs;\r\n\tif (diffs.length === 0) {\r\n\t\treturn diffs;\r\n\t}\r\n\r\n\tlet counter = 0;\r\n\tlet shouldRepeat: boolean;\r\n\tdo {\r\n\t\tshouldRepeat = false;\r\n\r\n\t\tconst result: SequenceDiff[] = [\r\n\t\t\tdiffs[0]\r\n\t\t];\r\n\r\n\t\tfor (let i = 1; i < diffs.length; i++) {\r\n\t\t\tconst cur = diffs[i];\r\n\t\t\tconst lastResult = result[result.length - 1];\r\n\r\n\t\t\tfunction shouldJoinDiffs(before: SequenceDiff, after: SequenceDiff): boolean {\r\n\t\t\t\tconst unchangedRange = new OffsetRange(lastResult.seq1Range.endExclusive, cur.seq1Range.start);\r\n\r\n\t\t\t\tconst unchangedText = sequence1.getText(unchangedRange);\r\n\t\t\t\tconst unchangedTextWithoutWs = unchangedText.replace(/\\s/g, '');\r\n\t\t\t\tif (unchangedTextWithoutWs.length <= 4\r\n\t\t\t\t\t&& (before.seq1Range.length + before.seq2Range.length > 5 || after.seq1Range.length + after.seq2Range.length > 5)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tconst shouldJoin = shouldJoinDiffs(lastResult, cur);\r\n\t\t\tif (shouldJoin) {\r\n\t\t\t\tshouldRepeat = true;\r\n\t\t\t\tresult[result.length - 1] = result[result.length - 1].join(cur);\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(cur);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdiffs = result;\r\n\t} while (counter++ < 10 && shouldRepeat);\r\n\r\n\treturn diffs;\r\n}\r\n\r\n\r\nexport function removeRandomMatches(sequence1: LinesSliceCharSequence, sequence2: LinesSliceCharSequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tlet diffs = sequenceDiffs;\r\n\tif (diffs.length === 0) {\r\n\t\treturn diffs;\r\n\t}\r\n\r\n\tlet counter = 0;\r\n\tlet shouldRepeat: boolean;\r\n\tdo {\r\n\t\tshouldRepeat = false;\r\n\r\n\t\tconst result: SequenceDiff[] = [\r\n\t\t\tdiffs[0]\r\n\t\t];\r\n\r\n\t\tfor (let i = 1; i < diffs.length; i++) {\r\n\t\t\tconst cur = diffs[i];\r\n\t\t\tconst lastResult = result[result.length - 1];\r\n\r\n\t\t\tfunction shouldJoinDiffs(before: SequenceDiff, after: SequenceDiff): boolean {\r\n\t\t\t\tconst unchangedRange = new OffsetRange(lastResult.seq1Range.endExclusive, cur.seq1Range.start);\r\n\r\n\t\t\t\tconst unchangedLineCount = sequence1.countLinesIn(unchangedRange);\r\n\t\t\t\tif (unchangedLineCount > 5 || unchangedRange.length > 500) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst unchangedText = sequence1.getText(unchangedRange).trim();\r\n\t\t\t\tif (unchangedText.length > 20 || unchangedText.split(/\\r\\n|\\r|\\n/).length > 1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst beforeLineCount1 = sequence1.countLinesIn(before.seq1Range);\r\n\t\t\t\tconst beforeSeq1Length = before.seq1Range.length;\r\n\t\t\t\tconst beforeLineCount2 = sequence2.countLinesIn(before.seq2Range);\r\n\t\t\t\tconst beforeSeq2Length = before.seq2Range.length;\r\n\r\n\t\t\t\tconst afterLineCount1 = sequence1.countLinesIn(after.seq1Range);\r\n\t\t\t\tconst afterSeq1Length = after.seq1Range.length;\r\n\t\t\t\tconst afterLineCount2 = sequence2.countLinesIn(after.seq2Range);\r\n\t\t\t\tconst afterSeq2Length = after.seq2Range.length;\r\n\r\n\t\t\t\t// TODO: Maybe a neural net can be used to derive the result from these numbers\r\n\r\n\t\t\t\tconst max = 2 * 40 + 50;\r\n\t\t\t\tfunction cap(v: number): number {\r\n\t\t\t\t\treturn Math.min(v, max);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (Math.pow(Math.pow(cap(beforeLineCount1 * 40 + beforeSeq1Length), 1.5) + Math.pow(cap(beforeLineCount2 * 40 + beforeSeq2Length), 1.5), 1.5)\r\n\t\t\t\t\t+ Math.pow(Math.pow(cap(afterLineCount1 * 40 + afterSeq1Length), 1.5) + Math.pow(cap(afterLineCount2 * 40 + afterSeq2Length), 1.5), 1.5) > ((max ** 1.5) ** 1.5) * 1.3) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\tconst shouldJoin = shouldJoinDiffs(lastResult, cur);\r\n\t\t\tif (shouldJoin) {\r\n\t\t\t\tshouldRepeat = true;\r\n\t\t\t\tresult[result.length - 1] = result[result.length - 1].join(cur);\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(cur);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tdiffs = result;\r\n\t} while (counter++ < 10 && shouldRepeat);\r\n\r\n\t// Remove short suffixes/prefixes\r\n\tfor (let i = 0; i < diffs.length; i++) {\r\n\t\tconst cur = diffs[i];\r\n\r\n\t\tlet range1 = cur.seq1Range;\r\n\t\tlet range2 = cur.seq2Range;\r\n\r\n\t\tconst fullRange1 = sequence1.extendToFullLines(cur.seq1Range);\r\n\t\tconst prefix = sequence1.getText(new OffsetRange(fullRange1.start, cur.seq1Range.start));\r\n\t\tif (prefix.length > 0 && prefix.trim().length <= 3 && cur.seq1Range.length + cur.seq2Range.length > 100) {\r\n\t\t\trange1 = cur.seq1Range.deltaStart(-prefix.length);\r\n\t\t\trange2 = cur.seq2Range.deltaStart(-prefix.length);\r\n\t\t}\r\n\r\n\t\tconst suffix = sequence1.getText(new OffsetRange(cur.seq1Range.endExclusive, fullRange1.endExclusive));\r\n\t\tif (suffix.length > 0 && (suffix.trim().length <= 3 && cur.seq1Range.length + cur.seq2Range.length > 150)) {\r\n\t\t\trange1 = range1.deltaEnd(suffix.length);\r\n\t\t\trange2 = range2.deltaEnd(suffix.length);\r\n\t\t}\r\n\r\n\t\tdiffs[i] = new SequenceDiff(range1, range2);\r\n\t}\r\n\r\n\treturn diffs;\r\n}\r\n\r\n/**\r\n * This function fixes issues like this:\r\n * ```\r\n * import { Baz, Bar } from \"foo\";\r\n * ```\r\n * <->\r\n * ```\r\n * import { Baz, Bar, Foo } from \"foo\";\r\n * ```\r\n * Computed diff: [ {Add \",\" after Bar}, {Add \"Foo \" after space} }\r\n * Improved diff: [{Add \", Foo\" after Bar}]\r\n */\r\nexport function joinSequenceDiffs(sequence1: ISequence, sequence2: ISequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tif (sequenceDiffs.length === 0) {\r\n\t\treturn sequenceDiffs;\r\n\t}\r\n\r\n\tconst result: SequenceDiff[] = [];\r\n\tresult.push(sequenceDiffs[0]);\r\n\r\n\t// First move them all to the left as much as possible and join them if possible\r\n\tfor (let i = 1; i < sequenceDiffs.length; i++) {\r\n\t\tconst prevResult = result[result.length - 1];\r\n\t\tlet cur = sequenceDiffs[i];\r\n\r\n\t\tif (cur.seq1Range.isEmpty || cur.seq2Range.isEmpty) {\r\n\t\t\tconst length = cur.seq1Range.start - prevResult.seq1Range.endExclusive;\r\n\t\t\tlet d;\r\n\t\t\tfor (d = 1; d <= length; d++) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tsequence1.getElement(cur.seq1Range.start - d) !== sequence1.getElement(cur.seq1Range.endExclusive - d) ||\r\n\t\t\t\t\tsequence2.getElement(cur.seq2Range.start - d) !== sequence2.getElement(cur.seq2Range.endExclusive - d)) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\td--;\r\n\r\n\t\t\tif (d === length) {\r\n\t\t\t\t// Merge previous and current diff\r\n\t\t\t\tresult[result.length - 1] = new SequenceDiff(\r\n\t\t\t\t\tnew OffsetRange(prevResult.seq1Range.start, cur.seq1Range.endExclusive - length),\r\n\t\t\t\t\tnew OffsetRange(prevResult.seq2Range.start, cur.seq2Range.endExclusive - length),\r\n\t\t\t\t);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tcur = cur.delta(-d);\r\n\t\t}\r\n\r\n\t\tresult.push(cur);\r\n\t}\r\n\r\n\tconst result2: SequenceDiff[] = [];\r\n\t// Then move them all to the right and join them again if possible\r\n\tfor (let i = 0; i < result.length - 1; i++) {\r\n\t\tconst nextResult = result[i + 1];\r\n\t\tlet cur = result[i];\r\n\r\n\t\tif (cur.seq1Range.isEmpty || cur.seq2Range.isEmpty) {\r\n\t\t\tconst length = nextResult.seq1Range.start - cur.seq1Range.endExclusive;\r\n\t\t\tlet d;\r\n\t\t\tfor (d = 0; d < length; d++) {\r\n\t\t\t\tif (\r\n\t\t\t\t\tsequence1.getElement(cur.seq1Range.start + d) !== sequence1.getElement(cur.seq1Range.endExclusive + d) ||\r\n\t\t\t\t\tsequence2.getElement(cur.seq2Range.start + d) !== sequence2.getElement(cur.seq2Range.endExclusive + d)\r\n\t\t\t\t) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (d === length) {\r\n\t\t\t\t// Merge previous and current diff, write to result!\r\n\t\t\t\tresult[i + 1] = new SequenceDiff(\r\n\t\t\t\t\tnew OffsetRange(cur.seq1Range.start + length, nextResult.seq1Range.endExclusive),\r\n\t\t\t\t\tnew OffsetRange(cur.seq2Range.start + length, nextResult.seq2Range.endExclusive),\r\n\t\t\t\t);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (d > 0) {\r\n\t\t\t\tcur = cur.delta(d);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tresult2.push(cur);\r\n\t}\r\n\r\n\tif (result.length > 0) {\r\n\t\tresult2.push(result[result.length - 1]);\r\n\t}\r\n\r\n\treturn result2;\r\n}\r\n\r\n// align character level diffs at whitespace characters\r\n// import { IBar } from \"foo\";\r\n// import { I[Arr, I]Bar } from \"foo\";\r\n// ->\r\n// import { [IArr, ]IBar } from \"foo\";\r\n\r\n// import { ITransaction, observableValue, transaction } from 'vs/base/common/observable';\r\n// import { ITransaction, observable[FromEvent, observable]Value, transaction } from 'vs/base/common/observable';\r\n// ->\r\n// import { ITransaction, [observableFromEvent, ]observableValue, transaction } from 'vs/base/common/observable';\r\n\r\n// collectBrackets(level + 1, levelPerBracketType);\r\n// collectBrackets(level + 1, levelPerBracket[ + 1, levelPerBracket]Type);\r\n// ->\r\n// collectBrackets(level + 1, [levelPerBracket + 1, ]levelPerBracketType);\r\n\r\nexport function shiftSequenceDiffs(sequence1: ISequence, sequence2: ISequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tif (!sequence1.getBoundaryScore || !sequence2.getBoundaryScore) {\r\n\t\treturn sequenceDiffs;\r\n\t}\r\n\r\n\tfor (let i = 0; i < sequenceDiffs.length; i++) {\r\n\t\tconst prevDiff = (i > 0 ? sequenceDiffs[i - 1] : undefined);\r\n\t\tconst diff = sequenceDiffs[i];\r\n\t\tconst nextDiff = (i + 1 < sequenceDiffs.length ? sequenceDiffs[i + 1] : undefined);\r\n\r\n\t\tconst seq1ValidRange = new OffsetRange(prevDiff ? prevDiff.seq1Range.start + 1 : 0, nextDiff ? nextDiff.seq1Range.endExclusive - 1 : sequence1.length);\r\n\t\tconst seq2ValidRange = new OffsetRange(prevDiff ? prevDiff.seq2Range.start + 1 : 0, nextDiff ? nextDiff.seq2Range.endExclusive - 1 : sequence2.length);\r\n\r\n\t\tif (diff.seq1Range.isEmpty) {\r\n\t\t\tsequenceDiffs[i] = shiftDiffToBetterPosition(diff, sequence1, sequence2, seq1ValidRange, seq2ValidRange);\r\n\t\t} else if (diff.seq2Range.isEmpty) {\r\n\t\t\tsequenceDiffs[i] = shiftDiffToBetterPosition(diff.reverse(), sequence2, sequence1, seq2ValidRange, seq1ValidRange).reverse();\r\n\t\t}\r\n\t}\r\n\r\n\treturn sequenceDiffs;\r\n}\r\n\r\nfunction shiftDiffToBetterPosition(diff: SequenceDiff, sequence1: ISequence, sequence2: ISequence, seq1ValidRange: OffsetRange, seq2ValidRange: OffsetRange,) {\r\n\tconst maxShiftLimit = 100; // To prevent performance issues\r\n\r\n\t// don't touch previous or next!\r\n\tlet deltaBefore = 1;\r\n\twhile (\r\n\t\tdiff.seq1Range.start - deltaBefore >= seq1ValidRange.start &&\r\n\t\tdiff.seq2Range.start - deltaBefore >= seq2ValidRange.start &&\r\n\t\tsequence2.isStronglyEqual(diff.seq2Range.start - deltaBefore, diff.seq2Range.endExclusive - deltaBefore) && deltaBefore < maxShiftLimit\r\n\t) {\r\n\t\tdeltaBefore++;\r\n\t}\r\n\tdeltaBefore--;\r\n\r\n\tlet deltaAfter = 0;\r\n\twhile (\r\n\t\tdiff.seq1Range.start + deltaAfter < seq1ValidRange.endExclusive &&\r\n\t\tdiff.seq2Range.endExclusive + deltaAfter < seq2ValidRange.endExclusive &&\r\n\t\tsequence2.isStronglyEqual(diff.seq2Range.start + deltaAfter, diff.seq2Range.endExclusive + deltaAfter) && deltaAfter < maxShiftLimit\r\n\t) {\r\n\t\tdeltaAfter++;\r\n\t}\r\n\r\n\tif (deltaBefore === 0 && deltaAfter === 0) {\r\n\t\treturn diff;\r\n\t}\r\n\r\n\t// Visualize `[sequence1.text, diff.seq1Range.start + deltaAfter]`\r\n\t// and `[sequence2.text, diff.seq2Range.start + deltaAfter, diff.seq2Range.endExclusive + deltaAfter]`\r\n\r\n\tlet bestDelta = 0;\r\n\tlet bestScore = -1;\r\n\t// find best scored delta\r\n\tfor (let delta = -deltaBefore; delta <= deltaAfter; delta++) {\r\n\t\tconst seq2OffsetStart = diff.seq2Range.start + delta;\r\n\t\tconst seq2OffsetEndExclusive = diff.seq2Range.endExclusive + delta;\r\n\t\tconst seq1Offset = diff.seq1Range.start + delta;\r\n\r\n\t\tconst score = sequence1.getBoundaryScore!(seq1Offset) + sequence2.getBoundaryScore!(seq2OffsetStart) + sequence2.getBoundaryScore!(seq2OffsetEndExclusive);\r\n\t\tif (score > bestScore) {\r\n\t\t\tbestScore = score;\r\n\t\t\tbestDelta = delta;\r\n\t\t}\r\n\t}\r\n\r\n\treturn diff.delta(bestDelta);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\nimport { DiffAlgorithmResult, IDiffAlgorithm, ISequence, ITimeout, InfiniteTimeout, SequenceDiff } from 'vs/editor/common/diff/algorithms/diffAlgorithm';\r\n\r\n/**\r\n * An O(ND) diff algorithm that has a quadratic space worst-case complexity.\r\n*/\r\nexport class MyersDiffAlgorithm implements IDiffAlgorithm {\r\n\tcompute(seq1: ISequence, seq2: ISequence, timeout: ITimeout = InfiniteTimeout.instance): DiffAlgorithmResult {\r\n\t\t// These are common special cases.\r\n\t\t// The early return improves performance dramatically.\r\n\t\tif (seq1.length === 0 || seq2.length === 0) {\r\n\t\t\treturn DiffAlgorithmResult.trivial(seq1, seq2);\r\n\t\t}\r\n\r\n\t\tfunction getXAfterSnake(x: number, y: number): number {\r\n\t\t\twhile (x < seq1.length && y < seq2.length && seq1.getElement(x) === seq2.getElement(y)) {\r\n\t\t\t\tx++;\r\n\t\t\t\ty++;\r\n\t\t\t}\r\n\t\t\treturn x;\r\n\t\t}\r\n\r\n\t\tlet d = 0;\r\n\t\t// V[k]: X value of longest d-line that ends in diagonal k.\r\n\t\t// d-line: path from (0,0) to (x,y) that uses exactly d non-diagonals.\r\n\t\t// diagonal k: Set of points (x,y) with x-y = k.\r\n\t\tconst V = new FastInt32Array();\r\n\t\tV.set(0, getXAfterSnake(0, 0));\r\n\r\n\t\tconst paths = new FastArrayNegativeIndices<SnakePath | null>();\r\n\t\tpaths.set(0, V.get(0) === 0 ? null : new SnakePath(null, 0, 0, V.get(0)));\r\n\r\n\t\tlet k = 0;\r\n\r\n\t\tloop: while (true) {\r\n\t\t\td++;\r\n\t\t\tif (!timeout.isValid()) {\r\n\t\t\t\treturn DiffAlgorithmResult.trivialTimedOut(seq1, seq2);\r\n\t\t\t}\r\n\t\t\t// The paper has `for (k = -d; k <= d; k += 2)`, but we can ignore diagonals that cannot influence the result.\r\n\t\t\tconst lowerBound = -Math.min(d, seq2.length + (d % 2));\r\n\t\t\tconst upperBound = Math.min(d, seq1.length + (d % 2));\r\n\t\t\tfor (k = lowerBound; k <= upperBound; k += 2) {\r\n\t\t\t\t// We can use the X values of (d-1)-lines to compute X value of the longest d-lines.\r\n\t\t\t\tconst maxXofDLineTop = k === upperBound ? -1 : V.get(k + 1); // We take a vertical non-diagonal (add a symbol in seq1)\r\n\t\t\t\tconst maxXofDLineLeft = k === lowerBound ? -1 : V.get(k - 1) + 1; // We take a horizontal non-diagonal (+1 x) (delete a symbol in seq1)\r\n\t\t\t\tconst x = Math.min(Math.max(maxXofDLineTop, maxXofDLineLeft), seq1.length);\r\n\t\t\t\tconst y = x - k;\r\n\t\t\t\tif (x > seq1.length || y > seq2.length) {\r\n\t\t\t\t\t// This diagonal is irrelevant for the result.\r\n\t\t\t\t\t// TODO: Don't pay the cost for this in the next iteration.\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst newMaxX = getXAfterSnake(x, y);\r\n\t\t\t\tV.set(k, newMaxX);\r\n\t\t\t\tconst lastPath = x === maxXofDLineTop ? paths.get(k + 1) : paths.get(k - 1);\r\n\t\t\t\tpaths.set(k, newMaxX !== x ? new SnakePath(lastPath, x, y, newMaxX - x) : lastPath);\r\n\r\n\t\t\t\tif (V.get(k) === seq1.length && V.get(k) - k === seq2.length) {\r\n\t\t\t\t\tbreak loop;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet path = paths.get(k);\r\n\t\tconst result: SequenceDiff[] = [];\r\n\t\tlet lastAligningPosS1: number = seq1.length;\r\n\t\tlet lastAligningPosS2: number = seq2.length;\r\n\r\n\t\twhile (true) {\r\n\t\t\tconst endX = path ? path.x + path.length : 0;\r\n\t\t\tconst endY = path ? path.y + path.length : 0;\r\n\r\n\t\t\tif (endX !== lastAligningPosS1 || endY !== lastAligningPosS2) {\r\n\t\t\t\tresult.push(new SequenceDiff(\r\n\t\t\t\t\tnew OffsetRange(endX, lastAligningPosS1),\r\n\t\t\t\t\tnew OffsetRange(endY, lastAligningPosS2),\r\n\t\t\t\t));\r\n\t\t\t}\r\n\t\t\tif (!path) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tlastAligningPosS1 = path.x;\r\n\t\t\tlastAligningPosS2 = path.y;\r\n\r\n\t\t\tpath = path.prev;\r\n\t\t}\r\n\r\n\t\tresult.reverse();\r\n\t\treturn new DiffAlgorithmResult(result, false);\r\n\t}\r\n}\r\n\r\nclass SnakePath {\r\n\tconstructor(\r\n\t\tpublic readonly prev: SnakePath | null,\r\n\t\tpublic readonly x: number,\r\n\t\tpublic readonly y: number,\r\n\t\tpublic readonly length: number\r\n\t) {\r\n\t}\r\n}\r\n\r\n/**\r\n * An array that supports fast negative indices.\r\n*/\r\nclass FastInt32Array {\r\n\tprivate positiveArr: Int32Array = new Int32Array(10);\r\n\tprivate negativeArr: Int32Array = new Int32Array(10);\r\n\r\n\tget(idx: number): number {\r\n\t\tif (idx < 0) {\r\n\t\t\tidx = -idx - 1;\r\n\t\t\treturn this.negativeArr[idx];\r\n\t\t} else {\r\n\t\t\treturn this.positiveArr[idx];\r\n\t\t}\r\n\t}\r\n\r\n\tset(idx: number, value: number): void {\r\n\t\tif (idx < 0) {\r\n\t\t\tidx = -idx - 1;\r\n\t\t\tif (idx >= this.negativeArr.length) {\r\n\t\t\t\tconst arr = this.negativeArr;\r\n\t\t\t\tthis.negativeArr = new Int32Array(arr.length * 2);\r\n\t\t\t\tthis.negativeArr.set(arr);\r\n\t\t\t}\r\n\t\t\tthis.negativeArr[idx] = value;\r\n\t\t} else {\r\n\t\t\tif (idx >= this.positiveArr.length) {\r\n\t\t\t\tconst arr = this.positiveArr;\r\n\t\t\t\tthis.positiveArr = new Int32Array(arr.length * 2);\r\n\t\t\t\tthis.positiveArr.set(arr);\r\n\t\t\t}\r\n\t\t\tthis.positiveArr[idx] = value;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * An array that supports fast negative indices.\r\n*/\r\nclass FastArrayNegativeIndices<T> {\r\n\tprivate readonly positiveArr: T[] = [];\r\n\tprivate readonly negativeArr: T[] = [];\r\n\r\n\tget(idx: number): T {\r\n\t\tif (idx < 0) {\r\n\t\t\tidx = -idx - 1;\r\n\t\t\treturn this.negativeArr[idx];\r\n\t\t} else {\r\n\t\t\treturn this.positiveArr[idx];\r\n\t\t}\r\n\t}\r\n\r\n\tset(idx: number, value: T): void {\r\n\t\tif (idx < 0) {\r\n\t\t\tidx = -idx - 1;\r\n\t\t\tthis.negativeArr[idx] = value;\r\n\t\t} else {\r\n\t\t\tthis.positiveArr[idx] = value;\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n/** 2  */\r\nexport class Array2D<T> {\r\n\tprivate readonly array: T[] = [];\r\n\r\n\tconstructor(public readonly width: number, public readonly height: number) {\r\n\t\tthis.array = new Array<T>(width * height);\r\n\t}\r\n\r\n\tget(x: number, y: number): T {\r\n\t\treturn this.array[x + y * this.width];\r\n\t}\r\n\r\n\tset(x: number, y: number, value: T): void {\r\n\t\tthis.array[x + y * this.width] = value;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\nimport { IDiffAlgorithm, SequenceDiff, ISequence, ITimeout, InfiniteTimeout, DiffAlgorithmResult } from 'vs/editor/common/diff/algorithms/diffAlgorithm';\r\nimport { Array2D } from 'vs/editor/common/diff/algorithms/utils';\r\n\r\n/**\r\n * A O(MN) diffing algorithm that supports a score function.\r\n * The algorithm can be improved by processing the 2d array diagonally.\r\n*/\r\nexport class DynamicProgrammingDiffing implements IDiffAlgorithm {\r\n\tcompute(sequence1: ISequence, sequence2: ISequence, timeout: ITimeout = InfiniteTimeout.instance, equalityScore?: (offset1: number, offset2: number) => number): DiffAlgorithmResult {\r\n\t\tif (sequence1.length === 0 || sequence2.length === 0) {\r\n\t\t\treturn DiffAlgorithmResult.trivial(sequence1, sequence2);\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * lcsLengths.get(i, j): Length of the longest common subsequence of sequence1.substring(0, i + 1) and sequence2.substring(0, j + 1).\r\n\t\t */\r\n\t\tconst lcsLengths = new Array2D<number>(sequence1.length, sequence2.length);\r\n\t\tconst directions = new Array2D<number>(sequence1.length, sequence2.length);\r\n\t\tconst lengths = new Array2D<number>(sequence1.length, sequence2.length);\r\n\r\n\t\t// ==== Initializing lcsLengths ====\r\n\t\tfor (let s1 = 0; s1 < sequence1.length; s1++) {\r\n\t\t\tfor (let s2 = 0; s2 < sequence2.length; s2++) {\r\n\t\t\t\tif (!timeout.isValid()) {\r\n\t\t\t\t\treturn DiffAlgorithmResult.trivialTimedOut(sequence1, sequence2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst horizontalLen = s1 === 0 ? 0 : lcsLengths.get(s1 - 1, s2);\r\n\t\t\t\tconst verticalLen = s2 === 0 ? 0 : lcsLengths.get(s1, s2 - 1);\r\n\r\n\t\t\t\tlet extendedSeqScore: number;\r\n\t\t\t\tif (sequence1.getElement(s1) === sequence2.getElement(s2)) {\r\n\t\t\t\t\tif (s1 === 0 || s2 === 0) {\r\n\t\t\t\t\t\textendedSeqScore = 0;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\textendedSeqScore = lcsLengths.get(s1 - 1, s2 - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (s1 > 0 && s2 > 0 && directions.get(s1 - 1, s2 - 1) === 3) {\r\n\t\t\t\t\t\t// Prefer consecutive diagonals\r\n\t\t\t\t\t\textendedSeqScore += lengths.get(s1 - 1, s2 - 1);\r\n\t\t\t\t\t}\r\n\t\t\t\t\textendedSeqScore += (equalityScore ? equalityScore(s1, s2) : 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\textendedSeqScore = -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst newValue = Math.max(horizontalLen, verticalLen, extendedSeqScore);\r\n\r\n\t\t\t\tif (newValue === extendedSeqScore) {\r\n\t\t\t\t\t// Prefer diagonals\r\n\t\t\t\t\tconst prevLen = s1 > 0 && s2 > 0 ? lengths.get(s1 - 1, s2 - 1) : 0;\r\n\t\t\t\t\tlengths.set(s1, s2, prevLen + 1);\r\n\t\t\t\t\tdirections.set(s1, s2, 3);\r\n\t\t\t\t} else if (newValue === horizontalLen) {\r\n\t\t\t\t\tlengths.set(s1, s2, 0);\r\n\t\t\t\t\tdirections.set(s1, s2, 1);\r\n\t\t\t\t} else if (newValue === verticalLen) {\r\n\t\t\t\t\tlengths.set(s1, s2, 0);\r\n\t\t\t\t\tdirections.set(s1, s2, 2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlcsLengths.set(s1, s2, newValue);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// ==== Backtracking ====\r\n\t\tconst result: SequenceDiff[] = [];\r\n\t\tlet lastAligningPosS1: number = sequence1.length;\r\n\t\tlet lastAligningPosS2: number = sequence2.length;\r\n\r\n\t\tfunction reportDecreasingAligningPositions(s1: number, s2: number): void {\r\n\t\t\tif (s1 + 1 !== lastAligningPosS1 || s2 + 1 !== lastAligningPosS2) {\r\n\t\t\t\tresult.push(new SequenceDiff(\r\n\t\t\t\t\tnew OffsetRange(s1 + 1, lastAligningPosS1),\r\n\t\t\t\t\tnew OffsetRange(s2 + 1, lastAligningPosS2),\r\n\t\t\t\t));\r\n\t\t\t}\r\n\t\t\tlastAligningPosS1 = s1;\r\n\t\t\tlastAligningPosS2 = s2;\r\n\t\t}\r\n\r\n\t\tlet s1 = sequence1.length - 1;\r\n\t\tlet s2 = sequence2.length - 1;\r\n\t\twhile (s1 >= 0 && s2 >= 0) {\r\n\t\t\tif (directions.get(s1, s2) === 3) {\r\n\t\t\t\treportDecreasingAligningPositions(s1, s2);\r\n\t\t\t\ts1--;\r\n\t\t\t\ts2--;\r\n\t\t\t} else {\r\n\t\t\t\tif (directions.get(s1, s2) === 1) {\r\n\t\t\t\t\ts1--;\r\n\t\t\t\t} else {\r\n\t\t\t\t\ts2--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treportDecreasingAligningPositions(-1, -1);\r\n\t\tresult.reverse();\r\n\t\treturn new DiffAlgorithmResult(result, false);\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { LineRange } from 'vs/editor/common/core/lineRange';\r\nimport { Range } from 'vs/editor/common/core/range';\r\n\r\nexport interface ILinesDiffComputer {\r\n\tcomputeDiff(originalLines: string[], modifiedLines: string[], options: ILinesDiffComputerOptions): LinesDiff;\r\n}\r\n\r\nexport interface ILinesDiffComputerOptions {\r\n\treadonly ignoreTrimWhitespace: boolean;\r\n\treadonly maxComputationTimeMs: number;\r\n\treadonly computeMoves: boolean;\r\n}\r\n\r\nexport class LinesDiff {\r\n\tconstructor(\r\n\t\treadonly changes: readonly LineRangeMapping[],\r\n\r\n\t\t/**\r\n\t\t * Sorted by original line ranges.\r\n\t\t * The original line ranges and the modified line ranges must be disjoint (but can be touching).\r\n\t\t */\r\n\t\treadonly moves: readonly MovedText[],\r\n\r\n\t\t/**\r\n\t\t * Indicates if the time out was reached.\r\n\t\t * In that case, the diffs might be an approximation and the user should be asked to rerun the diff with more time.\r\n\t\t */\r\n\t\treadonly hitTimeout: boolean,\r\n\t) {\r\n\t}\r\n}\r\n\r\n/**\r\n * Maps a line range in the original text model to a line range in the modified text model.\r\n */\r\nexport class LineRangeMapping {\r\n\tpublic static inverse(mapping: readonly LineRangeMapping[], originalLineCount: number, modifiedLineCount: number): LineRangeMapping[] {\r\n\t\tconst result: LineRangeMapping[] = [];\r\n\t\tlet lastOriginalEndLineNumber = 1;\r\n\t\tlet lastModifiedEndLineNumber = 1;\r\n\r\n\t\tfor (const m of mapping) {\r\n\t\t\tconst r = new LineRangeMapping(\r\n\t\t\t\tnew LineRange(lastOriginalEndLineNumber, m.originalRange.startLineNumber),\r\n\t\t\t\tnew LineRange(lastModifiedEndLineNumber, m.modifiedRange.startLineNumber),\r\n\t\t\t\tundefined\r\n\t\t\t);\r\n\t\t\tif (!r.modifiedRange.isEmpty) {\r\n\t\t\t\tresult.push(r);\r\n\t\t\t}\r\n\t\t\tlastOriginalEndLineNumber = m.originalRange.endLineNumberExclusive;\r\n\t\t\tlastModifiedEndLineNumber = m.modifiedRange.endLineNumberExclusive;\r\n\t\t}\r\n\t\tconst r = new LineRangeMapping(\r\n\t\t\tnew LineRange(lastOriginalEndLineNumber, originalLineCount + 1),\r\n\t\t\tnew LineRange(lastModifiedEndLineNumber, modifiedLineCount + 1),\r\n\t\t\tundefined\r\n\t\t);\r\n\t\tif (!r.modifiedRange.isEmpty) {\r\n\t\t\tresult.push(r);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * The line range in the original text model.\r\n\t */\r\n\tpublic readonly originalRange: LineRange;\r\n\r\n\t/**\r\n\t * The line range in the modified text model.\r\n\t */\r\n\tpublic readonly modifiedRange: LineRange;\r\n\r\n\t/**\r\n\t * If inner changes have not been computed, this is set to undefined.\r\n\t * Otherwise, it represents the character-level diff in this line range.\r\n\t * The original range of each range mapping should be contained in the original line range (same for modified), exceptions are new-lines.\r\n\t * Must not be an empty array.\r\n\t */\r\n\tpublic readonly innerChanges: RangeMapping[] | undefined;\r\n\r\n\tconstructor(\r\n\t\toriginalRange: LineRange,\r\n\t\tmodifiedRange: LineRange,\r\n\t\tinnerChanges: RangeMapping[] | undefined,\r\n\t) {\r\n\t\tthis.originalRange = originalRange;\r\n\t\tthis.modifiedRange = modifiedRange;\r\n\t\tthis.innerChanges = innerChanges;\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn `{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`;\r\n\t}\r\n\r\n\tpublic get changedLineCount() {\r\n\t\treturn Math.max(this.originalRange.length, this.modifiedRange.length);\r\n\t}\r\n\r\n\tpublic flip(): LineRangeMapping {\r\n\t\treturn new LineRangeMapping(this.modifiedRange, this.originalRange, this.innerChanges?.map(c => c.flip()));\r\n\t}\r\n}\r\n\r\n/**\r\n * Maps a range in the original text model to a range in the modified text model.\r\n */\r\nexport class RangeMapping {\r\n\t/**\r\n\t * The original range.\r\n\t */\r\n\treadonly originalRange: Range;\r\n\r\n\t/**\r\n\t * The modified range.\r\n\t */\r\n\treadonly modifiedRange: Range;\r\n\r\n\tconstructor(\r\n\t\toriginalRange: Range,\r\n\r\n\t\tmodifiedRange: Range,\r\n\t) {\r\n\t\tthis.originalRange = originalRange;\r\n\t\tthis.modifiedRange = modifiedRange;\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn `{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`;\r\n\t}\r\n\r\n\tpublic flip(): RangeMapping {\r\n\t\treturn new RangeMapping(this.modifiedRange, this.originalRange);\r\n\t}\r\n}\r\n\r\n// TODO@hediet: Make LineRangeMapping extend from this!\r\nexport class SimpleLineRangeMapping {\r\n\tconstructor(\r\n\t\tpublic readonly original: LineRange,\r\n\t\tpublic readonly modified: LineRange,\r\n\t) {\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn `{${this.original.toString()}->${this.modified.toString()}}`;\r\n\t}\r\n\r\n\tpublic flip(): SimpleLineRangeMapping {\r\n\t\treturn new SimpleLineRangeMapping(this.modified, this.original);\r\n\t}\r\n\r\n\tpublic join(other: SimpleLineRangeMapping): SimpleLineRangeMapping {\r\n\t\treturn new SimpleLineRangeMapping(\r\n\t\t\tthis.original.join(other.original),\r\n\t\t\tthis.modified.join(other.modified),\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport class MovedText {\r\n\tpublic readonly lineRangeMapping: SimpleLineRangeMapping;\r\n\r\n\t/**\r\n\t * The diff from the original text to the moved text.\r\n\t * Must be contained in the original/modified line range.\r\n\t * Can be empty if the text didn't change (only moved).\r\n\t */\r\n\tpublic readonly changes: readonly LineRangeMapping[];\r\n\r\n\tconstructor(\r\n\t\tlineRangeMapping: SimpleLineRangeMapping,\r\n\t\tchanges: readonly LineRangeMapping[],\r\n\t) {\r\n\t\tthis.lineRangeMapping = lineRangeMapping;\r\n\t\tthis.changes = changes;\r\n\t}\r\n\r\n\tpublic flip(): MovedText {\r\n\t\treturn new MovedText(this.lineRangeMapping.flip(), this.changes.map(c => c.flip()));\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { Comparator, CompareResult, compareBy, equals, findLastIndex, numberComparator, reverseOrder } from 'vs/base/common/arrays';\r\nimport { assertFn, checkAdjacentItems } from 'vs/base/common/assert';\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { SetMap } from 'vs/base/common/collections';\r\nimport { BugIndicatingError } from 'vs/base/common/errors';\r\nimport { LineRange } from 'vs/editor/common/core/lineRange';\r\nimport { OffsetRange } from 'vs/editor/common/core/offsetRange';\r\nimport { Position } from 'vs/editor/common/core/position';\r\nimport { Range } from 'vs/editor/common/core/range';\r\nimport { DateTimeout, ISequence, ITimeout, InfiniteTimeout, SequenceDiff } from 'vs/editor/common/diff/algorithms/diffAlgorithm';\r\nimport { DynamicProgrammingDiffing } from 'vs/editor/common/diff/algorithms/dynamicProgrammingDiffing';\r\nimport { optimizeSequenceDiffs, removeRandomLineMatches, removeRandomMatches, smoothenSequenceDiffs } from 'vs/editor/common/diff/algorithms/joinSequenceDiffs';\r\nimport { MyersDiffAlgorithm } from 'vs/editor/common/diff/algorithms/myersDiffAlgorithm';\r\nimport { ILinesDiffComputer, ILinesDiffComputerOptions, LineRangeMapping, LinesDiff, MovedText, RangeMapping, SimpleLineRangeMapping } from 'vs/editor/common/diff/linesDiffComputer';\r\n\r\nexport class AdvancedLinesDiffComputer implements ILinesDiffComputer {\r\n\tprivate readonly dynamicProgrammingDiffing = new DynamicProgrammingDiffing();\r\n\tprivate readonly myersDiffingAlgorithm = new MyersDiffAlgorithm();\r\n\r\n\tcomputeDiff(originalLines: string[], modifiedLines: string[], options: ILinesDiffComputerOptions): LinesDiff {\r\n\t\tif (originalLines.length <= 1 && equals(originalLines, modifiedLines, (a, b) => a === b)) {\r\n\t\t\treturn new LinesDiff([], [], false);\r\n\t\t}\r\n\r\n\t\tif (originalLines.length === 1 && originalLines[0].length === 0 || modifiedLines.length === 1 && modifiedLines[0].length === 0) {\r\n\t\t\treturn new LinesDiff([\r\n\t\t\t\tnew LineRangeMapping(\r\n\t\t\t\t\tnew LineRange(1, originalLines.length + 1),\r\n\t\t\t\t\tnew LineRange(1, modifiedLines.length + 1),\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\tnew RangeMapping(\r\n\t\t\t\t\t\t\tnew Range(1, 1, originalLines.length, originalLines[0].length + 1),\r\n\t\t\t\t\t\t\tnew Range(1, 1, modifiedLines.length, modifiedLines[0].length + 1)\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t]\r\n\t\t\t\t)\r\n\t\t\t], [], false);\r\n\t\t}\r\n\r\n\t\tconst timeout = options.maxComputationTimeMs === 0 ? InfiniteTimeout.instance : new DateTimeout(options.maxComputationTimeMs);\r\n\t\tconst considerWhitespaceChanges = !options.ignoreTrimWhitespace;\r\n\r\n\t\tconst perfectHashes = new Map<string, number>();\r\n\t\tfunction getOrCreateHash(text: string): number {\r\n\t\t\tlet hash = perfectHashes.get(text);\r\n\t\t\tif (hash === undefined) {\r\n\t\t\t\thash = perfectHashes.size;\r\n\t\t\t\tperfectHashes.set(text, hash);\r\n\t\t\t}\r\n\t\t\treturn hash;\r\n\t\t}\r\n\r\n\t\tconst srcDocLines = originalLines.map((l) => getOrCreateHash(l.trim()));\r\n\t\tconst tgtDocLines = modifiedLines.map((l) => getOrCreateHash(l.trim()));\r\n\r\n\t\tconst sequence1 = new LineSequence(srcDocLines, originalLines);\r\n\t\tconst sequence2 = new LineSequence(tgtDocLines, modifiedLines);\r\n\r\n\t\tconst lineAlignmentResult = (() => {\r\n\t\t\tif (sequence1.length + sequence2.length < 1700) {\r\n\t\t\t\t// Use the improved algorithm for small files\r\n\t\t\t\treturn this.dynamicProgrammingDiffing.compute(\r\n\t\t\t\t\tsequence1,\r\n\t\t\t\t\tsequence2,\r\n\t\t\t\t\ttimeout,\r\n\t\t\t\t\t(offset1, offset2) =>\r\n\t\t\t\t\t\toriginalLines[offset1] === modifiedLines[offset2]\r\n\t\t\t\t\t\t\t? modifiedLines[offset2].length === 0\r\n\t\t\t\t\t\t\t\t? 0.1\r\n\t\t\t\t\t\t\t\t: 1 + Math.log(1 + modifiedLines[offset2].length)\r\n\t\t\t\t\t\t\t: 0.99\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\treturn this.myersDiffingAlgorithm.compute(\r\n\t\t\t\tsequence1,\r\n\t\t\t\tsequence2\r\n\t\t\t);\r\n\t\t})();\r\n\r\n\t\tlet lineAlignments = lineAlignmentResult.diffs;\r\n\t\tlet hitTimeout = lineAlignmentResult.hitTimeout;\r\n\t\tlineAlignments = optimizeSequenceDiffs(sequence1, sequence2, lineAlignments);\r\n\t\tlineAlignments = removeRandomLineMatches(sequence1, sequence2, lineAlignments);\r\n\r\n\t\tconst alignments: RangeMapping[] = [];\r\n\r\n\t\tconst scanForWhitespaceChanges = (equalLinesCount: number) => {\r\n\t\t\tif (!considerWhitespaceChanges) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i < equalLinesCount; i++) {\r\n\t\t\t\tconst seq1Offset = seq1LastStart + i;\r\n\t\t\t\tconst seq2Offset = seq2LastStart + i;\r\n\t\t\t\tif (originalLines[seq1Offset] !== modifiedLines[seq2Offset]) {\r\n\t\t\t\t\t// This is because of whitespace changes, diff these lines\r\n\t\t\t\t\tconst characterDiffs = this.refineDiff(originalLines, modifiedLines, new SequenceDiff(\r\n\t\t\t\t\t\tnew OffsetRange(seq1Offset, seq1Offset + 1),\r\n\t\t\t\t\t\tnew OffsetRange(seq2Offset, seq2Offset + 1),\r\n\t\t\t\t\t), timeout, considerWhitespaceChanges);\r\n\t\t\t\t\tfor (const a of characterDiffs.mappings) {\r\n\t\t\t\t\t\talignments.push(a);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (characterDiffs.hitTimeout) {\r\n\t\t\t\t\t\thitTimeout = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tlet seq1LastStart = 0;\r\n\t\tlet seq2LastStart = 0;\r\n\r\n\t\tfor (const diff of lineAlignments) {\r\n\t\t\tassertFn(() => diff.seq1Range.start - seq1LastStart === diff.seq2Range.start - seq2LastStart);\r\n\r\n\t\t\tconst equalLinesCount = diff.seq1Range.start - seq1LastStart;\r\n\r\n\t\t\tscanForWhitespaceChanges(equalLinesCount);\r\n\r\n\t\t\tseq1LastStart = diff.seq1Range.endExclusive;\r\n\t\t\tseq2LastStart = diff.seq2Range.endExclusive;\r\n\r\n\t\t\tconst characterDiffs = this.refineDiff(originalLines, modifiedLines, diff, timeout, considerWhitespaceChanges);\r\n\t\t\tif (characterDiffs.hitTimeout) {\r\n\t\t\t\thitTimeout = true;\r\n\t\t\t}\r\n\t\t\tfor (const a of characterDiffs.mappings) {\r\n\t\t\t\talignments.push(a);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tscanForWhitespaceChanges(originalLines.length - seq1LastStart);\r\n\r\n\t\tconst changes = lineRangeMappingFromRangeMappings(alignments, originalLines, modifiedLines);\r\n\r\n\t\tlet moves: MovedText[] = [];\r\n\t\tif (options.computeMoves) {\r\n\t\t\tmoves = this.computeMoves(changes, originalLines, modifiedLines, srcDocLines, tgtDocLines, timeout, considerWhitespaceChanges);\r\n\t\t}\r\n\r\n\t\t// Make sure all ranges are valid\r\n\t\tassertFn(() => {\r\n\t\t\tfunction validatePosition(pos: Position, lines: string[]): boolean {\r\n\t\t\t\tif (pos.lineNumber < 1 || pos.lineNumber > lines.length) { return false; }\r\n\t\t\t\tconst line = lines[pos.lineNumber - 1];\r\n\t\t\t\tif (pos.column < 1 || pos.column > line.length + 1) { return false; }\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfunction validateRange(range: LineRange, lines: string[]): boolean {\r\n\t\t\t\tif (range.startLineNumber < 1 || range.startLineNumber > lines.length + 1) { return false; }\r\n\t\t\t\tif (range.endLineNumberExclusive < 1 || range.endLineNumberExclusive > lines.length + 1) { return false; }\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tfor (const c of changes) {\r\n\t\t\t\tif (!c.innerChanges) { return false; }\r\n\t\t\t\tfor (const ic of c.innerChanges) {\r\n\t\t\t\t\tconst valid = validatePosition(ic.modifiedRange.getStartPosition(), modifiedLines) && validatePosition(ic.modifiedRange.getEndPosition(), modifiedLines) &&\r\n\t\t\t\t\t\tvalidatePosition(ic.originalRange.getStartPosition(), originalLines) && validatePosition(ic.originalRange.getEndPosition(), originalLines);\r\n\t\t\t\t\tif (!valid) { return false; }\r\n\t\t\t\t}\r\n\t\t\t\tif (!validateRange(c.modifiedRange, modifiedLines) || !validateRange(c.originalRange, originalLines)) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t});\r\n\r\n\t\treturn new LinesDiff(changes, moves, hitTimeout);\r\n\t}\r\n\r\n\tprivate computeMoves(changes: LineRangeMapping[], originalLines: string[], modifiedLines: string[], hashedOriginalLines: number[], hashedModifiedLines: number[], timeout: ITimeout, considerWhitespaceChanges: boolean): MovedText[] {\r\n\t\tconst moves: SimpleLineRangeMapping[] = [];\r\n\t\tconst deletions = changes\r\n\t\t\t.filter(c => c.modifiedRange.isEmpty && c.originalRange.length >= 3)\r\n\t\t\t.map(d => new LineRangeFragment(d.originalRange, originalLines, d));\r\n\t\tconst insertions = new Set(changes\r\n\t\t\t.filter(c => c.originalRange.isEmpty && c.modifiedRange.length >= 3)\r\n\t\t\t.map(d => new LineRangeFragment(d.modifiedRange, modifiedLines, d)));\r\n\r\n\t\tconst excludedChanges = new Set<LineRangeMapping>();\r\n\r\n\t\tfor (const deletion of deletions) {\r\n\t\t\tlet highestSimilarity = -1;\r\n\t\t\tlet best: LineRangeFragment | undefined;\r\n\t\t\tfor (const insertion of insertions) {\r\n\t\t\t\tconst similarity = deletion.computeSimilarity(insertion);\r\n\t\t\t\tif (similarity > highestSimilarity) {\r\n\t\t\t\t\thighestSimilarity = similarity;\r\n\t\t\t\t\tbest = insertion;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (highestSimilarity > 0.90 && best) {\r\n\t\t\t\tinsertions.delete(best);\r\n\t\t\t\tmoves.push(new SimpleLineRangeMapping(deletion.range, best.range));\r\n\t\t\t\texcludedChanges.add(deletion.source);\r\n\t\t\t\texcludedChanges.add(best.source);\r\n\t\t\t}\r\n\r\n\t\t\tif (!timeout.isValid()) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst original3LineHashes = new SetMap<string, { range: LineRange }>();\r\n\r\n\t\tfor (const change of changes) {\r\n\t\t\tif (excludedChanges.has(change)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = change.originalRange.startLineNumber; i < change.originalRange.endLineNumberExclusive - 2; i++) {\r\n\t\t\t\tconst key = `${hashedOriginalLines[i - 1]}:${hashedOriginalLines[i + 1 - 1]}:${hashedOriginalLines[i + 2 - 1]}`;\r\n\t\t\t\toriginal3LineHashes.add(key, { range: new LineRange(i, i + 3) });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tinterface PossibleMapping {\r\n\t\t\tmodifiedLineRange: LineRange;\r\n\t\t\toriginalLineRange: LineRange;\r\n\t\t}\r\n\r\n\t\tconst possibleMappings: PossibleMapping[] = [];\r\n\r\n\t\tchanges.sort(compareBy(c => c.modifiedRange.startLineNumber, numberComparator));\r\n\r\n\t\tfor (const change of changes) {\r\n\t\t\tif (excludedChanges.has(change)) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tlet lastMappings: PossibleMapping[] = [];\r\n\t\t\tfor (let i = change.modifiedRange.startLineNumber; i < change.modifiedRange.endLineNumberExclusive - 2; i++) {\r\n\t\t\t\tconst key = `${hashedModifiedLines[i - 1]}:${hashedModifiedLines[i + 1 - 1]}:${hashedModifiedLines[i + 2 - 1]}`;\r\n\t\t\t\tconst currentModifiedRange = new LineRange(i, i + 3);\r\n\r\n\t\t\t\tconst nextMappings: PossibleMapping[] = [];\r\n\t\t\t\toriginal3LineHashes.forEach(key, ({ range }) => {\r\n\t\t\t\t\tfor (const lastMapping of lastMappings) {\r\n\t\t\t\t\t\t// does this match extend some last match?\r\n\t\t\t\t\t\tif (lastMapping.originalLineRange.endLineNumberExclusive + 1 === range.endLineNumberExclusive &&\r\n\t\t\t\t\t\t\tlastMapping.modifiedLineRange.endLineNumberExclusive + 1 === currentModifiedRange.endLineNumberExclusive) {\r\n\t\t\t\t\t\t\tlastMapping.originalLineRange = new LineRange(lastMapping.originalLineRange.startLineNumber, range.endLineNumberExclusive);\r\n\t\t\t\t\t\t\tlastMapping.modifiedLineRange = new LineRange(lastMapping.modifiedLineRange.startLineNumber, currentModifiedRange.endLineNumberExclusive);\r\n\t\t\t\t\t\t\tnextMappings.push(lastMapping);\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst mapping: PossibleMapping = {\r\n\t\t\t\t\t\tmodifiedLineRange: currentModifiedRange,\r\n\t\t\t\t\t\toriginalLineRange: range,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tpossibleMappings.push(mapping);\r\n\t\t\t\t\tnextMappings.push(mapping);\r\n\t\t\t\t});\r\n\t\t\t\tlastMappings = nextMappings;\r\n\t\t\t}\r\n\r\n\t\t\tif (!timeout.isValid()) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tpossibleMappings.sort(reverseOrder(compareBy(m => m.modifiedLineRange.length, numberComparator)));\r\n\r\n\t\tconst modifiedSet = new LineRangeSet();\r\n\t\tconst originalSet = new LineRangeSet();\r\n\r\n\t\tfor (const mapping of possibleMappings) {\r\n\r\n\t\t\tconst diffOrigToMod = mapping.modifiedLineRange.startLineNumber - mapping.originalLineRange.startLineNumber;\r\n\t\t\tconst modifiedSections = modifiedSet.subtractFrom(mapping.modifiedLineRange);\r\n\t\t\tconst originalTranslatedSections = originalSet.subtractFrom(mapping.originalLineRange).map(r => r.delta(diffOrigToMod));\r\n\r\n\t\t\tconst modifiedIntersectedSections = intersectRanges(modifiedSections, originalTranslatedSections);\r\n\r\n\t\t\tfor (const s of modifiedIntersectedSections) {\r\n\t\t\t\tif (s.length < 3) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tconst modifiedLineRange = s;\r\n\t\t\t\tconst originalLineRange = s.delta(-diffOrigToMod);\r\n\r\n\t\t\t\tmoves.push(new SimpleLineRangeMapping(originalLineRange, modifiedLineRange));\r\n\r\n\t\t\t\tmodifiedSet.addRange(modifiedLineRange);\r\n\t\t\t\toriginalSet.addRange(originalLineRange);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// join moves\r\n\t\tmoves.sort(compareBy(m => m.original.startLineNumber, numberComparator));\r\n\t\tif (moves.length === 0) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tlet joinedMoves = [moves[0]];\r\n\t\tfor (let i = 1; i < moves.length; i++) {\r\n\t\t\tconst last = joinedMoves[joinedMoves.length - 1];\r\n\t\t\tconst current = moves[i];\r\n\r\n\t\t\tconst originalDist = current.original.startLineNumber - last.original.endLineNumberExclusive;\r\n\t\t\tconst modifiedDist = current.modified.startLineNumber - last.modified.endLineNumberExclusive;\r\n\t\t\tconst currentMoveAfterLast = originalDist >= 0 && modifiedDist >= 0;\r\n\r\n\t\t\tif (currentMoveAfterLast && originalDist + modifiedDist <= 2) {\r\n\t\t\t\tjoinedMoves[joinedMoves.length - 1] = last.join(current);\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst originalText = current.original.toOffsetRange().slice(originalLines).map(l => l.trim()).join('\\n');\r\n\t\t\tif (originalText.length <= 10) {\r\n\t\t\t\t// Ignore small moves\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tjoinedMoves.push(current);\r\n\t\t}\r\n\r\n\t\t// Ignore non moves\r\n\t\tconst originalChanges = MonotonousFinder.createOfSorted(changes, c => c.originalRange.endLineNumberExclusive, numberComparator);\r\n\t\tjoinedMoves = joinedMoves.filter(m => {\r\n\t\t\tconst diffBeforeOriginalMove = originalChanges.findLastItemBeforeOrEqual(m.original.startLineNumber)\r\n\t\t\t\t|| new LineRangeMapping(new LineRange(1, 1), new LineRange(1, 1), []);\r\n\r\n\t\t\tconst modifiedDistToPrevDiff = m.modified.startLineNumber - diffBeforeOriginalMove.modifiedRange.endLineNumberExclusive;\r\n\t\t\tconst originalDistToPrevDiff = m.original.startLineNumber - diffBeforeOriginalMove.originalRange.endLineNumberExclusive;\r\n\r\n\t\t\tconst differentDistances = modifiedDistToPrevDiff !== originalDistToPrevDiff;\r\n\t\t\treturn differentDistances;\r\n\t\t});\r\n\r\n\t\tconst fullMoves = joinedMoves.map(m => {\r\n\t\t\tconst moveChanges = this.refineDiff(originalLines, modifiedLines, new SequenceDiff(\r\n\t\t\t\tm.original.toOffsetRange(),\r\n\t\t\t\tm.modified.toOffsetRange(),\r\n\t\t\t), timeout, considerWhitespaceChanges);\r\n\t\t\tconst mappings = lineRangeMappingFromRangeMappings(moveChanges.mappings, originalLines, modifiedLines, true);\r\n\t\t\treturn new MovedText(m, mappings);\r\n\t\t});\r\n\t\treturn fullMoves;\r\n\t}\r\n\r\n\tprivate refineDiff(originalLines: string[], modifiedLines: string[], diff: SequenceDiff, timeout: ITimeout, considerWhitespaceChanges: boolean): { mappings: RangeMapping[]; hitTimeout: boolean } {\r\n\t\tconst slice1 = new LinesSliceCharSequence(originalLines, diff.seq1Range, considerWhitespaceChanges);\r\n\t\tconst slice2 = new LinesSliceCharSequence(modifiedLines, diff.seq2Range, considerWhitespaceChanges);\r\n\r\n\t\tconst diffResult = slice1.length + slice2.length < 500\r\n\t\t\t? this.dynamicProgrammingDiffing.compute(slice1, slice2, timeout)\r\n\t\t\t: this.myersDiffingAlgorithm.compute(slice1, slice2, timeout);\r\n\r\n\t\tlet diffs = diffResult.diffs;\r\n\t\tdiffs = optimizeSequenceDiffs(slice1, slice2, diffs);\r\n\t\tdiffs = coverFullWords(slice1, slice2, diffs);\r\n\t\tdiffs = smoothenSequenceDiffs(slice1, slice2, diffs);\r\n\t\tdiffs = removeRandomMatches(slice1, slice2, diffs);\r\n\r\n\t\tconst result = diffs.map(\r\n\t\t\t(d) =>\r\n\t\t\t\tnew RangeMapping(\r\n\t\t\t\t\tslice1.translateRange(d.seq1Range),\r\n\t\t\t\t\tslice2.translateRange(d.seq2Range)\r\n\t\t\t\t)\r\n\t\t);\r\n\r\n\t\t// Assert: result applied on original should be the same as diff applied to original\r\n\r\n\t\treturn {\r\n\t\t\tmappings: result,\r\n\t\t\thitTimeout: diffResult.hitTimeout,\r\n\t\t};\r\n\t}\r\n}\r\n\r\nclass MonotonousFinder<TItem, TDomain> {\r\n\r\n\tpublic static createOfSorted<TItem, TDomain>(\r\n\t\titems: TItem[],\r\n\t\titemToDomain: (item: TItem) => TDomain,\r\n\t\tdomainComparator: Comparator<TDomain>,\r\n\t): MonotonousFinder<TItem, TDomain> {\r\n\t\treturn new MonotonousFinder(items, itemToDomain, domainComparator);\r\n\t}\r\n\r\n\tprivate _currentIdx = 0; // All values with index lower than this are smaller than or equal to _lastValue and vice versa.\r\n\tprivate _lastValue: TDomain | undefined = undefined; // Represents a smallest value.\r\n\tprivate _hasLastValue = false;\r\n\r\n\tprivate constructor(\r\n\t\tprivate readonly _items: TItem[],\r\n\t\tprivate readonly _itemToDomain: (item: TItem) => TDomain,\r\n\t\tprivate readonly _domainComparator: Comparator<TDomain>,\r\n\t) {\r\n\t}\r\n\r\n\t/**\r\n\t * Assumes the values are monotonously increasing.\r\n\t */\r\n\tfindLastItemBeforeOrEqual(value: TDomain): TItem | undefined {\r\n\t\tif (this._hasLastValue && CompareResult.isLessThan(this._domainComparator(value, this._lastValue!))) {\r\n\t\t\t// Values must be monotonously increasing\r\n\t\t\tthrow new BugIndicatingError();\r\n\t\t}\r\n\t\tthis._lastValue = value;\r\n\t\tthis._hasLastValue = true;\r\n\r\n\t\twhile (\r\n\t\t\tthis._currentIdx < this._items.length\r\n\t\t\t&& CompareResult.isLessThanOrEqual(this._domainComparator(\r\n\t\t\t\tthis._itemToDomain(this._items[this._currentIdx]),\r\n\t\t\t\tvalue\r\n\t\t\t))\r\n\t\t) {\r\n\t\t\tthis._currentIdx++;\r\n\t\t}\r\n\r\n\t\treturn this._currentIdx === 0 ? undefined : this._items[this._currentIdx - 1];\r\n\t}\r\n}\r\n\r\nfunction intersectRanges(ranges1: LineRange[], ranges2: LineRange[]): LineRange[] {\r\n\tconst result: LineRange[] = [];\r\n\r\n\tlet i1 = 0;\r\n\tlet i2 = 0;\r\n\twhile (i1 < ranges1.length && i2 < ranges2.length) {\r\n\t\tconst r1 = ranges1[i1];\r\n\t\tconst r2 = ranges2[i2];\r\n\r\n\t\tconst i = r1.intersect(r2);\r\n\t\tif (i && !i.isEmpty) {\r\n\t\t\tresult.push(i);\r\n\t\t}\r\n\r\n\t\tif (r1.endLineNumberExclusive < r2.endLineNumberExclusive) {\r\n\t\t\ti1++;\r\n\t\t} else {\r\n\t\t\ti2++;\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\n// TODO make this fast\r\nclass LineRangeSet {\r\n\tprivate readonly _normalizedRanges: LineRange[] = [];\r\n\r\n\taddRange(range: LineRange): void {\r\n\t\t// Idea: Find joinRange such that:\r\n\t\t// replaceRange = _normalizedRanges.replaceRange(joinRange, range.joinAll(joinRange.map(idx => this._normalizedRanges[idx])))\r\n\r\n\t\t// idx of first element that touches range or that is after range\r\n\t\tconst joinRangeStartIdx = mapMinusOne(this._normalizedRanges.findIndex(r => r.endLineNumberExclusive >= range.startLineNumber), this._normalizedRanges.length);\r\n\t\t// idx of element after { last element that touches range or that is before range }\r\n\t\tconst joinRangeEndIdxExclusive = findLastIndex(this._normalizedRanges, r => r.startLineNumber <= range.endLineNumberExclusive) + 1;\r\n\r\n\t\tif (joinRangeStartIdx === joinRangeEndIdxExclusive) {\r\n\t\t\t// If there is no element that touches range, then joinRangeStartIdx === joinRangeEndIdxExclusive and that value is the index of the element after range\r\n\t\t\tthis._normalizedRanges.splice(joinRangeStartIdx, 0, range);\r\n\t\t} else if (joinRangeStartIdx === joinRangeEndIdxExclusive - 1) {\r\n\t\t\t// Else, there is an element that touches range and in this case it is both the first and last element. Thus we can replace it\r\n\t\t\tconst joinRange = this._normalizedRanges[joinRangeStartIdx];\r\n\t\t\tthis._normalizedRanges[joinRangeStartIdx] = joinRange.join(range);\r\n\t\t} else {\r\n\t\t\t// First and last element are different - we need to replace the entire range\r\n\t\t\tconst joinRange = this._normalizedRanges[joinRangeStartIdx].join(this._normalizedRanges[joinRangeEndIdxExclusive - 1]).join(range);\r\n\t\t\tthis._normalizedRanges.splice(joinRangeStartIdx, joinRangeEndIdxExclusive - joinRangeStartIdx, joinRange);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Subtracts all ranges in this set from `range` and returns the result.\r\n\t */\r\n\tsubtractFrom(range: LineRange): LineRange[] {\r\n\t\t// idx of first element that touches range or that is after range\r\n\t\tconst joinRangeStartIdx = mapMinusOne(this._normalizedRanges.findIndex(r => r.endLineNumberExclusive >= range.startLineNumber), this._normalizedRanges.length);\r\n\t\t// idx of element after { last element that touches range or that is before range }\r\n\t\tconst joinRangeEndIdxExclusive = findLastIndex(this._normalizedRanges, r => r.startLineNumber <= range.endLineNumberExclusive) + 1;\r\n\r\n\t\tif (joinRangeStartIdx === joinRangeEndIdxExclusive) {\r\n\t\t\treturn [range];\r\n\t\t}\r\n\r\n\t\tconst result: LineRange[] = [];\r\n\t\tlet startLineNumber = range.startLineNumber;\r\n\t\tfor (let i = joinRangeStartIdx; i < joinRangeEndIdxExclusive; i++) {\r\n\t\t\tconst r = this._normalizedRanges[i];\r\n\t\t\tif (r.startLineNumber > startLineNumber) {\r\n\t\t\t\tresult.push(new LineRange(startLineNumber, r.startLineNumber));\r\n\t\t\t}\r\n\t\t\tstartLineNumber = r.endLineNumberExclusive;\r\n\t\t}\r\n\t\tif (startLineNumber < range.endLineNumberExclusive) {\r\n\t\t\tresult.push(new LineRange(startLineNumber, range.endLineNumberExclusive));\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\nfunction mapMinusOne(idx: number, mapTo: number): number {\r\n\treturn idx === -1 ? mapTo : idx;\r\n}\r\n\r\nfunction coverFullWords(sequence1: LinesSliceCharSequence, sequence2: LinesSliceCharSequence, sequenceDiffs: SequenceDiff[]): SequenceDiff[] {\r\n\tconst additional: SequenceDiff[] = [];\r\n\r\n\tlet lastModifiedWord: { added: number; deleted: number; count: number; s1Range: OffsetRange; s2Range: OffsetRange } | undefined = undefined;\r\n\r\n\tfunction maybePushWordToAdditional() {\r\n\t\tif (!lastModifiedWord) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst originalLength1 = lastModifiedWord.s1Range.length - lastModifiedWord.deleted;\r\n\t\tconst originalLength2 = lastModifiedWord.s2Range.length - lastModifiedWord.added;\r\n\t\tif (originalLength1 !== originalLength2) {\r\n\t\t\t// TODO figure out why this happens\r\n\t\t}\r\n\r\n\t\tif (Math.max(lastModifiedWord.deleted, lastModifiedWord.added) + (lastModifiedWord.count - 1) > originalLength1) {\r\n\t\t\tadditional.push(new SequenceDiff(lastModifiedWord.s1Range, lastModifiedWord.s2Range));\r\n\t\t}\r\n\r\n\t\tlastModifiedWord = undefined;\r\n\t}\r\n\r\n\tfor (const s of sequenceDiffs) {\r\n\t\tfunction processWord(s1Range: OffsetRange, s2Range: OffsetRange) {\r\n\t\t\tif (!lastModifiedWord || !lastModifiedWord.s1Range.containsRange(s1Range) || !lastModifiedWord.s2Range.containsRange(s2Range)) {\r\n\t\t\t\tif (lastModifiedWord && !(lastModifiedWord.s1Range.endExclusive < s1Range.start && lastModifiedWord.s2Range.endExclusive < s2Range.start)) {\r\n\t\t\t\t\tconst s1Added = OffsetRange.tryCreate(lastModifiedWord.s1Range.endExclusive, s1Range.start);\r\n\t\t\t\t\tconst s2Added = OffsetRange.tryCreate(lastModifiedWord.s2Range.endExclusive, s2Range.start);\r\n\t\t\t\t\tlastModifiedWord.deleted += s1Added?.length ?? 0;\r\n\t\t\t\t\tlastModifiedWord.added += s2Added?.length ?? 0;\r\n\r\n\t\t\t\t\tlastModifiedWord.s1Range = lastModifiedWord.s1Range.join(s1Range);\r\n\t\t\t\t\tlastModifiedWord.s2Range = lastModifiedWord.s2Range.join(s2Range);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmaybePushWordToAdditional();\r\n\t\t\t\t\tlastModifiedWord = { added: 0, deleted: 0, count: 0, s1Range: s1Range, s2Range: s2Range };\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst changedS1 = s1Range.intersect(s.seq1Range);\r\n\t\t\tconst changedS2 = s2Range.intersect(s.seq2Range);\r\n\t\t\tlastModifiedWord.count++;\r\n\t\t\tlastModifiedWord.deleted += changedS1?.length ?? 0;\r\n\t\t\tlastModifiedWord.added += changedS2?.length ?? 0;\r\n\t\t}\r\n\r\n\t\tconst w1Before = sequence1.findWordContaining(s.seq1Range.start - 1);\r\n\t\tconst w2Before = sequence2.findWordContaining(s.seq2Range.start - 1);\r\n\r\n\t\tconst w1After = sequence1.findWordContaining(s.seq1Range.endExclusive);\r\n\t\tconst w2After = sequence2.findWordContaining(s.seq2Range.endExclusive);\r\n\r\n\t\tif (w1Before && w1After && w2Before && w2After && w1Before.equals(w1After) && w2Before.equals(w2After)) {\r\n\t\t\tprocessWord(w1Before, w2Before);\r\n\t\t} else {\r\n\t\t\tif (w1Before && w2Before) {\r\n\t\t\t\tprocessWord(w1Before, w2Before);\r\n\t\t\t}\r\n\t\t\tif (w1After && w2After) {\r\n\t\t\t\tprocessWord(w1After, w2After);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tmaybePushWordToAdditional();\r\n\r\n\tconst merged = mergeSequenceDiffs(sequenceDiffs, additional);\r\n\treturn merged;\r\n}\r\n\r\nfunction mergeSequenceDiffs(sequenceDiffs1: SequenceDiff[], sequenceDiffs2: SequenceDiff[]): SequenceDiff[] {\r\n\tconst result: SequenceDiff[] = [];\r\n\r\n\twhile (sequenceDiffs1.length > 0 || sequenceDiffs2.length > 0) {\r\n\t\tconst sd1 = sequenceDiffs1[0];\r\n\t\tconst sd2 = sequenceDiffs2[0];\r\n\r\n\t\tlet next: SequenceDiff;\r\n\t\tif (sd1 && (!sd2 || sd1.seq1Range.start < sd2.seq1Range.start)) {\r\n\t\t\tnext = sequenceDiffs1.shift()!;\r\n\t\t} else {\r\n\t\t\tnext = sequenceDiffs2.shift()!;\r\n\t\t}\r\n\r\n\t\tif (result.length > 0 && result[result.length - 1].seq1Range.endExclusive >= next.seq1Range.start) {\r\n\t\t\tresult[result.length - 1] = result[result.length - 1].join(next);\r\n\t\t} else {\r\n\t\t\tresult.push(next);\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nexport function lineRangeMappingFromRangeMappings(alignments: RangeMapping[], originalLines: string[], modifiedLines: string[], dontAssertStartLine: boolean = false): LineRangeMapping[] {\r\n\tconst changes: LineRangeMapping[] = [];\r\n\tfor (const g of group(\r\n\t\talignments.map(a => getLineRangeMapping(a, originalLines, modifiedLines)),\r\n\t\t(a1, a2) =>\r\n\t\t\ta1.originalRange.overlapOrTouch(a2.originalRange)\r\n\t\t\t|| a1.modifiedRange.overlapOrTouch(a2.modifiedRange)\r\n\t)) {\r\n\t\tconst first = g[0];\r\n\t\tconst last = g[g.length - 1];\r\n\r\n\t\tchanges.push(new LineRangeMapping(\r\n\t\t\tfirst.originalRange.join(last.originalRange),\r\n\t\t\tfirst.modifiedRange.join(last.modifiedRange),\r\n\t\t\tg.map(a => a.innerChanges![0]),\r\n\t\t));\r\n\t}\r\n\r\n\tassertFn(() => {\r\n\t\tif (!dontAssertStartLine) {\r\n\t\t\tif (changes.length > 0 && changes[0].originalRange.startLineNumber !== changes[0].modifiedRange.startLineNumber) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn checkAdjacentItems(changes,\r\n\t\t\t(m1, m2) => m2.originalRange.startLineNumber - m1.originalRange.endLineNumberExclusive === m2.modifiedRange.startLineNumber - m1.modifiedRange.endLineNumberExclusive &&\r\n\t\t\t\t// There has to be an unchanged line in between (otherwise both diffs should have been joined)\r\n\t\t\t\tm1.originalRange.endLineNumberExclusive < m2.originalRange.startLineNumber &&\r\n\t\t\t\tm1.modifiedRange.endLineNumberExclusive < m2.modifiedRange.startLineNumber,\r\n\t\t);\r\n\t});\r\n\r\n\treturn changes;\r\n}\r\n\r\nexport function getLineRangeMapping(rangeMapping: RangeMapping, originalLines: string[], modifiedLines: string[]): LineRangeMapping {\r\n\tlet lineStartDelta = 0;\r\n\tlet lineEndDelta = 0;\r\n\r\n\t// rangeMapping describes the edit that replaces `rangeMapping.originalRange` with `newText := getText(modifiedLines, rangeMapping.modifiedRange)`.\r\n\r\n\t// original: ]xxx \\n <- this line is not modified\r\n\t// modified: ]xx  \\n\r\n\tif (rangeMapping.modifiedRange.endColumn === 1 && rangeMapping.originalRange.endColumn === 1\r\n\t\t&& rangeMapping.originalRange.startLineNumber + lineStartDelta <= rangeMapping.originalRange.endLineNumber\r\n\t\t&& rangeMapping.modifiedRange.startLineNumber + lineStartDelta <= rangeMapping.modifiedRange.endLineNumber) {\r\n\t\t// We can only do this if the range is not empty yet\r\n\t\tlineEndDelta = -1;\r\n\t}\r\n\r\n\t// original: xxx[ \\n <- this line is not modified\r\n\t// modified: xxx[ \\n\r\n\tif (rangeMapping.modifiedRange.startColumn - 1 >= modifiedLines[rangeMapping.modifiedRange.startLineNumber - 1].length\r\n\t\t&& rangeMapping.originalRange.startColumn - 1 >= originalLines[rangeMapping.originalRange.startLineNumber - 1].length\r\n\t\t&& rangeMapping.originalRange.startLineNumber <= rangeMapping.originalRange.endLineNumber + lineEndDelta\r\n\t\t&& rangeMapping.modifiedRange.startLineNumber <= rangeMapping.modifiedRange.endLineNumber + lineEndDelta) {\r\n\t\t// We can only do this if the range is not empty yet\r\n\t\tlineStartDelta = 1;\r\n\t}\r\n\r\n\tconst originalLineRange = new LineRange(\r\n\t\trangeMapping.originalRange.startLineNumber + lineStartDelta,\r\n\t\trangeMapping.originalRange.endLineNumber + 1 + lineEndDelta\r\n\t);\r\n\tconst modifiedLineRange = new LineRange(\r\n\t\trangeMapping.modifiedRange.startLineNumber + lineStartDelta,\r\n\t\trangeMapping.modifiedRange.endLineNumber + 1 + lineEndDelta\r\n\t);\r\n\r\n\treturn new LineRangeMapping(originalLineRange, modifiedLineRange, [rangeMapping]);\r\n}\r\n\r\nfunction* group<T>(items: Iterable<T>, shouldBeGrouped: (item1: T, item2: T) => boolean): Iterable<T[]> {\r\n\tlet currentGroup: T[] | undefined;\r\n\tlet last: T | undefined;\r\n\tfor (const item of items) {\r\n\t\tif (last !== undefined && shouldBeGrouped(last, item)) {\r\n\t\t\tcurrentGroup!.push(item);\r\n\t\t} else {\r\n\t\t\tif (currentGroup) {\r\n\t\t\t\tyield currentGroup;\r\n\t\t\t}\r\n\t\t\tcurrentGroup = [item];\r\n\t\t}\r\n\t\tlast = item;\r\n\t}\r\n\tif (currentGroup) {\r\n\t\tyield currentGroup;\r\n\t}\r\n}\r\n\r\nexport class LineSequence implements ISequence {\r\n\tconstructor(\r\n\t\tprivate readonly trimmedHash: number[],\r\n\t\tprivate readonly lines: string[]\r\n\t) { }\r\n\r\n\tgetElement(offset: number): number {\r\n\t\treturn this.trimmedHash[offset];\r\n\t}\r\n\r\n\tget length(): number {\r\n\t\treturn this.trimmedHash.length;\r\n\t}\r\n\r\n\tgetBoundaryScore(length: number): number {\r\n\t\tconst indentationBefore = length === 0 ? 0 : getIndentation(this.lines[length - 1]);\r\n\t\tconst indentationAfter = length === this.lines.length ? 0 : getIndentation(this.lines[length]);\r\n\t\treturn 1000 - (indentationBefore + indentationAfter);\r\n\t}\r\n\r\n\tgetText(range: OffsetRange): string {\r\n\t\treturn this.lines.slice(range.start, range.endExclusive).join('\\n');\r\n\t}\r\n\r\n\tisStronglyEqual(offset1: number, offset2: number): boolean {\r\n\t\treturn this.lines[offset1] === this.lines[offset2];\r\n\t}\r\n}\r\n\r\nfunction getIndentation(str: string): number {\r\n\tlet i = 0;\r\n\twhile (i < str.length && (str.charCodeAt(i) === CharCode.Space || str.charCodeAt(i) === CharCode.Tab)) {\r\n\t\ti++;\r\n\t}\r\n\treturn i;\r\n}\r\n\r\nexport class LinesSliceCharSequence implements ISequence {\r\n\tprivate readonly elements: number[] = [];\r\n\tprivate readonly firstCharOffsetByLineMinusOne: number[] = [];\r\n\tpublic readonly lineRange: OffsetRange;\r\n\t// To account for trimming\r\n\tprivate readonly additionalOffsetByLine: number[] = [];\r\n\r\n\tconstructor(public readonly lines: string[], lineRange: OffsetRange, public readonly considerWhitespaceChanges: boolean) {\r\n\t\t// This slice has to have lineRange.length many \\n! (otherwise diffing against an empty slice will be problematic)\r\n\t\t// (Unless it covers the entire document, in that case the other slice also has to cover the entire document ands it's okay)\r\n\r\n\t\t// If the slice covers the end, but does not start at the beginning, we include just the \\n of the previous line.\r\n\t\tlet trimFirstLineFully = false;\r\n\t\tif (lineRange.start > 0 && lineRange.endExclusive >= lines.length) {\r\n\t\t\tlineRange = new OffsetRange(lineRange.start - 1, lineRange.endExclusive);\r\n\t\t\ttrimFirstLineFully = true;\r\n\t\t}\r\n\r\n\t\tthis.lineRange = lineRange;\r\n\r\n\t\tfor (let i = this.lineRange.start; i < this.lineRange.endExclusive; i++) {\r\n\t\t\tlet line = lines[i];\r\n\t\t\tlet offset = 0;\r\n\t\t\tif (trimFirstLineFully) {\r\n\t\t\t\toffset = line.length;\r\n\t\t\t\tline = '';\r\n\t\t\t\ttrimFirstLineFully = false;\r\n\t\t\t} else if (!considerWhitespaceChanges) {\r\n\t\t\t\tconst trimmedStartLine = line.trimStart();\r\n\t\t\t\toffset = line.length - trimmedStartLine.length;\r\n\t\t\t\tline = trimmedStartLine.trimEnd();\r\n\t\t\t}\r\n\r\n\t\t\tthis.additionalOffsetByLine.push(offset);\r\n\r\n\t\t\tfor (let i = 0; i < line.length; i++) {\r\n\t\t\t\tthis.elements.push(line.charCodeAt(i));\r\n\t\t\t}\r\n\r\n\t\t\t// Don't add an \\n that does not exist in the document.\r\n\t\t\tif (i < lines.length - 1) {\r\n\t\t\t\tthis.elements.push('\\n'.charCodeAt(0));\r\n\t\t\t\tthis.firstCharOffsetByLineMinusOne[i - this.lineRange.start] = this.elements.length;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// To account for the last line\r\n\t\tthis.additionalOffsetByLine.push(0);\r\n\t}\r\n\r\n\ttoString() {\r\n\t\treturn `Slice: \"${this.text}\"`;\r\n\t}\r\n\r\n\tget text(): string {\r\n\t\treturn this.getText(new OffsetRange(0, this.length));\r\n\t}\r\n\r\n\tgetText(range: OffsetRange): string {\r\n\t\treturn this.elements.slice(range.start, range.endExclusive).map(e => String.fromCharCode(e)).join('');\r\n\t}\r\n\r\n\tgetElement(offset: number): number {\r\n\t\treturn this.elements[offset];\r\n\t}\r\n\r\n\tget length(): number {\r\n\t\treturn this.elements.length;\r\n\t}\r\n\r\n\tpublic getBoundaryScore(length: number): number {\r\n\t\t//   a   b   c   ,           d   e   f\r\n\t\t// 11  0   0   12  15  6   13  0   0   11\r\n\r\n\t\tconst prevCategory = getCategory(length > 0 ? this.elements[length - 1] : -1);\r\n\t\tconst nextCategory = getCategory(length < this.elements.length ? this.elements[length] : -1);\r\n\r\n\t\tif (prevCategory === CharBoundaryCategory.LineBreakCR && nextCategory === CharBoundaryCategory.LineBreakLF) {\r\n\t\t\t// don't break between \\r and \\n\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tlet score = 0;\r\n\t\tif (prevCategory !== nextCategory) {\r\n\t\t\tscore += 10;\r\n\t\t\tif (nextCategory === CharBoundaryCategory.WordUpper) {\r\n\t\t\t\tscore += 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tscore += getCategoryBoundaryScore(prevCategory);\r\n\t\tscore += getCategoryBoundaryScore(nextCategory);\r\n\r\n\t\treturn score;\r\n\t}\r\n\r\n\tpublic translateOffset(offset: number): Position {\r\n\t\t// find smallest i, so that lineBreakOffsets[i] <= offset using binary search\r\n\t\tif (this.lineRange.isEmpty) {\r\n\t\t\treturn new Position(this.lineRange.start + 1, 1);\r\n\t\t}\r\n\r\n\t\tlet i = 0;\r\n\t\tlet j = this.firstCharOffsetByLineMinusOne.length;\r\n\t\twhile (i < j) {\r\n\t\t\tconst k = Math.floor((i + j) / 2);\r\n\t\t\tif (this.firstCharOffsetByLineMinusOne[k] > offset) {\r\n\t\t\t\tj = k;\r\n\t\t\t} else {\r\n\t\t\t\ti = k + 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst offsetOfFirstCharInLine = i === 0 ? 0 : this.firstCharOffsetByLineMinusOne[i - 1];\r\n\t\treturn new Position(this.lineRange.start + i + 1, offset - offsetOfFirstCharInLine + 1 + this.additionalOffsetByLine[i]);\r\n\t}\r\n\r\n\tpublic translateRange(range: OffsetRange): Range {\r\n\t\treturn Range.fromPositions(this.translateOffset(range.start), this.translateOffset(range.endExclusive));\r\n\t}\r\n\r\n\t/**\r\n\t * Finds the word that contains the character at the given offset\r\n\t */\r\n\tpublic findWordContaining(offset: number): OffsetRange | undefined {\r\n\t\tif (offset < 0 || offset >= this.elements.length) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tif (!isWordChar(this.elements[offset])) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\t// find start\r\n\t\tlet start = offset;\r\n\t\twhile (start > 0 && isWordChar(this.elements[start - 1])) {\r\n\t\t\tstart--;\r\n\t\t}\r\n\r\n\t\t// find end\r\n\t\tlet end = offset;\r\n\t\twhile (end < this.elements.length && isWordChar(this.elements[end])) {\r\n\t\t\tend++;\r\n\t\t}\r\n\r\n\t\treturn new OffsetRange(start, end);\r\n\t}\r\n\r\n\tpublic countLinesIn(range: OffsetRange): number {\r\n\t\treturn this.translateOffset(range.endExclusive).lineNumber - this.translateOffset(range.start).lineNumber;\r\n\t}\r\n\r\n\tpublic isStronglyEqual(offset1: number, offset2: number): boolean {\r\n\t\treturn this.elements[offset1] === this.elements[offset2];\r\n\t}\r\n\r\n\tpublic extendToFullLines(range: OffsetRange): OffsetRange {\r\n\t\tconst start = findLastMonotonous(this.firstCharOffsetByLineMinusOne, x => x <= range.start) ?? 0;\r\n\t\tconst end = findFirstMonotonous(this.firstCharOffsetByLineMinusOne, x => range.endExclusive <= x) ?? this.elements.length;\r\n\t\treturn new OffsetRange(start, end);\r\n\t}\r\n}\r\n\r\n/**\r\n * `arr.map(predicate)` must be like `[true, ..., true, false, ..., false]`!\r\n *\r\n * @returns -1 if predicate is false for all items\r\n */\r\nfunction findLastIdxMonotonous<T>(arr: T[], predicate: (item: T) => boolean): number {\r\n\tlet i = 0;\r\n\tlet j = arr.length;\r\n\twhile (i < j) {\r\n\t\tconst k = Math.floor((i + j) / 2);\r\n\t\tif (predicate(arr[k])) {\r\n\t\t\ti = k + 1;\r\n\t\t} else {\r\n\t\t\tj = k;\r\n\t\t}\r\n\t}\r\n\treturn i - 1;\r\n}\r\n\r\nexport function findLastMonotonous<T>(arr: T[], predicate: (item: T) => boolean): T | undefined {\r\n\tconst idx = findLastIdxMonotonous(arr, predicate);\r\n\treturn idx === -1 ? undefined : arr[idx];\r\n}\r\n\r\n/**\r\n * `arr.map(predicate)` must be like `[false, ..., false, true, ..., true]`!\r\n *\r\n * @returns arr.length if predicate is false for all items\r\n */\r\nfunction findFirstIdxMonotonous<T>(arr: T[], predicate: (item: T) => boolean): number {\r\n\tlet i = 0;\r\n\tlet j = arr.length;\r\n\twhile (i < j) {\r\n\t\tconst k = Math.floor((i + j) / 2);\r\n\t\tif (predicate(arr[k])) {\r\n\t\t\tj = k;\r\n\t\t} else {\r\n\t\t\ti = k + 1;\r\n\t\t}\r\n\t}\r\n\treturn i;\r\n}\r\n\r\nexport function findFirstMonotonous<T>(arr: T[], predicate: (item: T) => boolean): T | undefined {\r\n\tconst idx = findFirstIdxMonotonous(arr, predicate);\r\n\treturn idx === arr.length ? undefined : arr[idx];\r\n}\r\n\r\nfunction isWordChar(charCode: number): boolean {\r\n\treturn charCode >= CharCode.a && charCode <= CharCode.z\r\n\t\t|| charCode >= CharCode.A && charCode <= CharCode.Z\r\n\t\t|| charCode >= CharCode.Digit0 && charCode <= CharCode.Digit9;\r\n}\r\n\r\nconst enum CharBoundaryCategory {\r\n\tWordLower,\r\n\tWordUpper,\r\n\tWordNumber,\r\n\tEnd,\r\n\tOther,\r\n\tSpace,\r\n\tLineBreakCR,\r\n\tLineBreakLF,\r\n}\r\n\r\nconst score: Record<CharBoundaryCategory, number> = {\r\n\t[CharBoundaryCategory.WordLower]: 0,\r\n\t[CharBoundaryCategory.WordUpper]: 0,\r\n\t[CharBoundaryCategory.WordNumber]: 0,\r\n\t[CharBoundaryCategory.End]: 10,\r\n\t[CharBoundaryCategory.Other]: 2,\r\n\t[CharBoundaryCategory.Space]: 3,\r\n\t[CharBoundaryCategory.LineBreakCR]: 10,\r\n\t[CharBoundaryCategory.LineBreakLF]: 10,\r\n};\r\n\r\nfunction getCategoryBoundaryScore(category: CharBoundaryCategory): number {\r\n\treturn score[category];\r\n}\r\n\r\nfunction getCategory(charCode: number): CharBoundaryCategory {\r\n\tif (charCode === CharCode.LineFeed) {\r\n\t\treturn CharBoundaryCategory.LineBreakLF;\r\n\t} else if (charCode === CharCode.CarriageReturn) {\r\n\t\treturn CharBoundaryCategory.LineBreakCR;\r\n\t} else if (isSpace(charCode)) {\r\n\t\treturn CharBoundaryCategory.Space;\r\n\t} else if (charCode >= CharCode.a && charCode <= CharCode.z) {\r\n\t\treturn CharBoundaryCategory.WordLower;\r\n\t} else if (charCode >= CharCode.A && charCode <= CharCode.Z) {\r\n\t\treturn CharBoundaryCategory.WordUpper;\r\n\t} else if (charCode >= CharCode.Digit0 && charCode <= CharCode.Digit9) {\r\n\t\treturn CharBoundaryCategory.WordNumber;\r\n\t} else if (charCode === -1) {\r\n\t\treturn CharBoundaryCategory.End;\r\n\t} else {\r\n\t\treturn CharBoundaryCategory.Other;\r\n\t}\r\n}\r\n\r\nfunction isSpace(charCode: number): boolean {\r\n\treturn charCode === CharCode.Space || charCode === CharCode.Tab;\r\n}\r\n\r\nconst chrKeys = new Map<string, number>();\r\nfunction getKey(chr: string): number {\r\n\tlet key = chrKeys.get(chr);\r\n\tif (key === undefined) {\r\n\t\tkey = chrKeys.size;\r\n\t\tchrKeys.set(chr, key);\r\n\t}\r\n\treturn key;\r\n}\r\n\r\nclass LineRangeFragment {\r\n\tprivate readonly totalCount: number;\r\n\tprivate readonly histogram: number[] = [];\r\n\tconstructor(\r\n\t\tpublic readonly range: LineRange,\r\n\t\tpublic readonly lines: string[],\r\n\t\tpublic readonly source: LineRangeMapping,\r\n\t) {\r\n\t\tlet counter = 0;\r\n\t\tfor (let i = range.startLineNumber - 1; i < range.endLineNumberExclusive - 1; i++) {\r\n\t\t\tconst line = lines[i];\r\n\t\t\tfor (let j = 0; j < line.length; j++) {\r\n\t\t\t\tcounter++;\r\n\t\t\t\tconst chr = line[j];\r\n\t\t\t\tconst key = getKey(chr);\r\n\t\t\t\tthis.histogram[key] = (this.histogram[key] || 0) + 1;\r\n\t\t\t}\r\n\t\t\tcounter++;\r\n\t\t\tconst key = getKey('\\n');\r\n\t\t\tthis.histogram[key] = (this.histogram[key] || 0) + 1;\r\n\t\t}\r\n\r\n\t\tthis.totalCount = counter;\r\n\t}\r\n\r\n\tpublic computeSimilarity(other: LineRangeFragment): number {\r\n\t\tlet sumDifferences = 0;\r\n\t\tconst maxLength = Math.max(this.histogram.length, other.histogram.length);\r\n\t\tfor (let i = 0; i < maxLength; i++) {\r\n\t\t\tsumDifferences += Math.abs((this.histogram[i] ?? 0) - (other.histogram[i] ?? 0));\r\n\t\t}\r\n\t\treturn 1 - (sumDifferences / (this.totalCount + other.totalCount));\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { IDiffChange, ISequence, LcsDiff, IDiffResult } from 'vs/base/common/diff/diff';\r\nimport { ILinesDiffComputer, ILinesDiffComputerOptions, RangeMapping, LineRangeMapping, LinesDiff } from 'vs/editor/common/diff/linesDiffComputer';\r\nimport * as strings from 'vs/base/common/strings';\r\nimport { Range } from 'vs/editor/common/core/range';\r\nimport { assertFn, checkAdjacentItems } from 'vs/base/common/assert';\r\nimport { LineRange } from 'vs/editor/common/core/lineRange';\r\n\r\nconst MINIMUM_MATCHING_CHARACTER_LENGTH = 3;\r\n\r\nexport class LegacyLinesDiffComputer implements ILinesDiffComputer {\r\n\tcomputeDiff(originalLines: string[], modifiedLines: string[], options: ILinesDiffComputerOptions): LinesDiff {\r\n\t\tconst diffComputer = new DiffComputer(originalLines, modifiedLines, {\r\n\t\t\tmaxComputationTime: options.maxComputationTimeMs,\r\n\t\t\tshouldIgnoreTrimWhitespace: options.ignoreTrimWhitespace,\r\n\t\t\tshouldComputeCharChanges: true,\r\n\t\t\tshouldMakePrettyDiff: true,\r\n\t\t\tshouldPostProcessCharChanges: true,\r\n\t\t});\r\n\t\tconst result = diffComputer.computeDiff();\r\n\t\tconst changes: LineRangeMapping[] = [];\r\n\t\tlet lastChange: LineRangeMapping | null = null;\r\n\r\n\r\n\t\tfor (const c of result.changes) {\r\n\t\t\tlet originalRange: LineRange;\r\n\t\t\tif (c.originalEndLineNumber === 0) {\r\n\t\t\t\t// Insertion\r\n\t\t\t\toriginalRange = new LineRange(c.originalStartLineNumber + 1, c.originalStartLineNumber + 1);\r\n\t\t\t} else {\r\n\t\t\t\toriginalRange = new LineRange(c.originalStartLineNumber, c.originalEndLineNumber + 1);\r\n\t\t\t}\r\n\r\n\t\t\tlet modifiedRange: LineRange;\r\n\t\t\tif (c.modifiedEndLineNumber === 0) {\r\n\t\t\t\t// Deletion\r\n\t\t\t\tmodifiedRange = new LineRange(c.modifiedStartLineNumber + 1, c.modifiedStartLineNumber + 1);\r\n\t\t\t} else {\r\n\t\t\t\tmodifiedRange = new LineRange(c.modifiedStartLineNumber, c.modifiedEndLineNumber + 1);\r\n\t\t\t}\r\n\r\n\t\t\tlet change = new LineRangeMapping(originalRange, modifiedRange, c.charChanges?.map(c => new RangeMapping(\r\n\t\t\t\tnew Range(c.originalStartLineNumber, c.originalStartColumn, c.originalEndLineNumber, c.originalEndColumn),\r\n\t\t\t\tnew Range(c.modifiedStartLineNumber, c.modifiedStartColumn, c.modifiedEndLineNumber, c.modifiedEndColumn),\r\n\t\t\t)));\r\n\t\t\tif (lastChange) {\r\n\t\t\t\tif (lastChange.modifiedRange.endLineNumberExclusive === change.modifiedRange.startLineNumber\r\n\t\t\t\t\t|| lastChange.originalRange.endLineNumberExclusive === change.originalRange.startLineNumber) {\r\n\t\t\t\t\t// join touching diffs. Probably moving diffs up/down in the algorithm causes touching diffs.\r\n\t\t\t\t\tchange = new LineRangeMapping(\r\n\t\t\t\t\t\tlastChange.originalRange.join(change.originalRange),\r\n\t\t\t\t\t\tlastChange.modifiedRange.join(change.modifiedRange),\r\n\t\t\t\t\t\tlastChange.innerChanges && change.innerChanges ?\r\n\t\t\t\t\t\t\tlastChange.innerChanges.concat(change.innerChanges) : undefined\r\n\t\t\t\t\t);\r\n\t\t\t\t\tchanges.pop();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tchanges.push(change);\r\n\t\t\tlastChange = change;\r\n\t\t}\r\n\r\n\t\tassertFn(() => {\r\n\t\t\treturn checkAdjacentItems(changes,\r\n\t\t\t\t(m1, m2) => m2.originalRange.startLineNumber - m1.originalRange.endLineNumberExclusive === m2.modifiedRange.startLineNumber - m1.modifiedRange.endLineNumberExclusive &&\r\n\t\t\t\t\t// There has to be an unchanged line in between (otherwise both diffs should have been joined)\r\n\t\t\t\t\tm1.originalRange.endLineNumberExclusive < m2.originalRange.startLineNumber &&\r\n\t\t\t\t\tm1.modifiedRange.endLineNumberExclusive < m2.modifiedRange.startLineNumber,\r\n\t\t\t);\r\n\t\t});\r\n\r\n\t\treturn new LinesDiff(changes, [], result.quitEarly);\r\n\t}\r\n}\r\n\r\nexport interface IDiffComputationResult {\r\n\tquitEarly: boolean;\r\n\tidentical: boolean;\r\n\r\n\t/**\r\n\t * The changes as (legacy) line change array.\r\n\t * @deprecated Use `changes2` instead.\r\n\t */\r\n\tchanges: ILineChange[];\r\n\r\n\t/**\r\n\t * The changes as (modern) line range mapping array.\r\n\t */\r\n\tchanges2: readonly LineRangeMapping[];\r\n}\r\n\r\n/**\r\n * A change\r\n */\r\nexport interface IChange {\r\n\treadonly originalStartLineNumber: number;\r\n\treadonly originalEndLineNumber: number;\r\n\treadonly modifiedStartLineNumber: number;\r\n\treadonly modifiedEndLineNumber: number;\r\n}\r\n\r\n/**\r\n * A character level change.\r\n */\r\nexport interface ICharChange extends IChange {\r\n\treadonly originalStartColumn: number;\r\n\treadonly originalEndColumn: number;\r\n\treadonly modifiedStartColumn: number;\r\n\treadonly modifiedEndColumn: number;\r\n}\r\n\r\n/**\r\n * A line change\r\n */\r\nexport interface ILineChange extends IChange {\r\n\treadonly charChanges: ICharChange[] | undefined;\r\n}\r\n\r\nexport interface IDiffComputerResult {\r\n\tquitEarly: boolean;\r\n\tchanges: ILineChange[];\r\n}\r\n\r\nfunction computeDiff(originalSequence: ISequence, modifiedSequence: ISequence, continueProcessingPredicate: () => boolean, pretty: boolean): IDiffResult {\r\n\tconst diffAlgo = new LcsDiff(originalSequence, modifiedSequence, continueProcessingPredicate);\r\n\treturn diffAlgo.ComputeDiff(pretty);\r\n}\r\n\r\nclass LineSequence implements ISequence {\r\n\r\n\tpublic readonly lines: string[];\r\n\tprivate readonly _startColumns: number[];\r\n\tprivate readonly _endColumns: number[];\r\n\r\n\tconstructor(lines: string[]) {\r\n\t\tconst startColumns: number[] = [];\r\n\t\tconst endColumns: number[] = [];\r\n\t\tfor (let i = 0, length = lines.length; i < length; i++) {\r\n\t\t\tstartColumns[i] = getFirstNonBlankColumn(lines[i], 1);\r\n\t\t\tendColumns[i] = getLastNonBlankColumn(lines[i], 1);\r\n\t\t}\r\n\t\tthis.lines = lines;\r\n\t\tthis._startColumns = startColumns;\r\n\t\tthis._endColumns = endColumns;\r\n\t}\r\n\r\n\tpublic getElements(): Int32Array | number[] | string[] {\r\n\t\tconst elements: string[] = [];\r\n\t\tfor (let i = 0, len = this.lines.length; i < len; i++) {\r\n\t\t\telements[i] = this.lines[i].substring(this._startColumns[i] - 1, this._endColumns[i] - 1);\r\n\t\t}\r\n\t\treturn elements;\r\n\t}\r\n\r\n\tpublic getStrictElement(index: number): string {\r\n\t\treturn this.lines[index];\r\n\t}\r\n\r\n\tpublic getStartLineNumber(i: number): number {\r\n\t\treturn i + 1;\r\n\t}\r\n\r\n\tpublic getEndLineNumber(i: number): number {\r\n\t\treturn i + 1;\r\n\t}\r\n\r\n\tpublic createCharSequence(shouldIgnoreTrimWhitespace: boolean, startIndex: number, endIndex: number): CharSequence {\r\n\t\tconst charCodes: number[] = [];\r\n\t\tconst lineNumbers: number[] = [];\r\n\t\tconst columns: number[] = [];\r\n\t\tlet len = 0;\r\n\t\tfor (let index = startIndex; index <= endIndex; index++) {\r\n\t\t\tconst lineContent = this.lines[index];\r\n\t\t\tconst startColumn = (shouldIgnoreTrimWhitespace ? this._startColumns[index] : 1);\r\n\t\t\tconst endColumn = (shouldIgnoreTrimWhitespace ? this._endColumns[index] : lineContent.length + 1);\r\n\t\t\tfor (let col = startColumn; col < endColumn; col++) {\r\n\t\t\t\tcharCodes[len] = lineContent.charCodeAt(col - 1);\r\n\t\t\t\tlineNumbers[len] = index + 1;\r\n\t\t\t\tcolumns[len] = col;\r\n\t\t\t\tlen++;\r\n\t\t\t}\r\n\t\t\tif (!shouldIgnoreTrimWhitespace && index < endIndex) {\r\n\t\t\t\t// Add \\n if trim whitespace is not ignored\r\n\t\t\t\tcharCodes[len] = CharCode.LineFeed;\r\n\t\t\t\tlineNumbers[len] = index + 1;\r\n\t\t\t\tcolumns[len] = lineContent.length + 1;\r\n\t\t\t\tlen++;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn new CharSequence(charCodes, lineNumbers, columns);\r\n\t}\r\n}\r\n\r\nclass CharSequence implements ISequence {\r\n\r\n\tprivate readonly _charCodes: number[];\r\n\tprivate readonly _lineNumbers: number[];\r\n\tprivate readonly _columns: number[];\r\n\r\n\tconstructor(charCodes: number[], lineNumbers: number[], columns: number[]) {\r\n\t\tthis._charCodes = charCodes;\r\n\t\tthis._lineNumbers = lineNumbers;\r\n\t\tthis._columns = columns;\r\n\t}\r\n\r\n\tpublic toString() {\r\n\t\treturn (\r\n\t\t\t'[' + this._charCodes.map((s, idx) => (s === CharCode.LineFeed ? '\\\\n' : String.fromCharCode(s)) + `-(${this._lineNumbers[idx]},${this._columns[idx]})`).join(', ') + ']'\r\n\t\t);\r\n\t}\r\n\r\n\tprivate _assertIndex(index: number, arr: number[]): void {\r\n\t\tif (index < 0 || index >= arr.length) {\r\n\t\t\tthrow new Error(`Illegal index`);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getElements(): Int32Array | number[] | string[] {\r\n\t\treturn this._charCodes;\r\n\t}\r\n\r\n\tpublic getStartLineNumber(i: number): number {\r\n\t\tif (i > 0 && i === this._lineNumbers.length) {\r\n\t\t\t// the start line number of the element after the last element\r\n\t\t\t// is the end line number of the last element\r\n\t\t\treturn this.getEndLineNumber(i - 1);\r\n\t\t}\r\n\t\tthis._assertIndex(i, this._lineNumbers);\r\n\r\n\t\treturn this._lineNumbers[i];\r\n\t}\r\n\r\n\tpublic getEndLineNumber(i: number): number {\r\n\t\tif (i === -1) {\r\n\t\t\t// the end line number of the element before the first element\r\n\t\t\t// is the start line number of the first element\r\n\t\t\treturn this.getStartLineNumber(i + 1);\r\n\t\t}\r\n\t\tthis._assertIndex(i, this._lineNumbers);\r\n\r\n\t\tif (this._charCodes[i] === CharCode.LineFeed) {\r\n\t\t\treturn this._lineNumbers[i] + 1;\r\n\t\t}\r\n\t\treturn this._lineNumbers[i];\r\n\t}\r\n\r\n\tpublic getStartColumn(i: number): number {\r\n\t\tif (i > 0 && i === this._columns.length) {\r\n\t\t\t// the start column of the element after the last element\r\n\t\t\t// is the end column of the last element\r\n\t\t\treturn this.getEndColumn(i - 1);\r\n\t\t}\r\n\t\tthis._assertIndex(i, this._columns);\r\n\t\treturn this._columns[i];\r\n\t}\r\n\r\n\tpublic getEndColumn(i: number): number {\r\n\t\tif (i === -1) {\r\n\t\t\t// the end column of the element before the first element\r\n\t\t\t// is the start column of the first element\r\n\t\t\treturn this.getStartColumn(i + 1);\r\n\t\t}\r\n\t\tthis._assertIndex(i, this._columns);\r\n\r\n\t\tif (this._charCodes[i] === CharCode.LineFeed) {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\treturn this._columns[i] + 1;\r\n\t}\r\n}\r\n\r\nclass CharChange implements ICharChange {\r\n\r\n\tpublic originalStartLineNumber: number;\r\n\tpublic originalStartColumn: number;\r\n\tpublic originalEndLineNumber: number;\r\n\tpublic originalEndColumn: number;\r\n\r\n\tpublic modifiedStartLineNumber: number;\r\n\tpublic modifiedStartColumn: number;\r\n\tpublic modifiedEndLineNumber: number;\r\n\tpublic modifiedEndColumn: number;\r\n\r\n\tconstructor(\r\n\t\toriginalStartLineNumber: number,\r\n\t\toriginalStartColumn: number,\r\n\t\toriginalEndLineNumber: number,\r\n\t\toriginalEndColumn: number,\r\n\t\tmodifiedStartLineNumber: number,\r\n\t\tmodifiedStartColumn: number,\r\n\t\tmodifiedEndLineNumber: number,\r\n\t\tmodifiedEndColumn: number\r\n\t) {\r\n\t\tthis.originalStartLineNumber = originalStartLineNumber;\r\n\t\tthis.originalStartColumn = originalStartColumn;\r\n\t\tthis.originalEndLineNumber = originalEndLineNumber;\r\n\t\tthis.originalEndColumn = originalEndColumn;\r\n\t\tthis.modifiedStartLineNumber = modifiedStartLineNumber;\r\n\t\tthis.modifiedStartColumn = modifiedStartColumn;\r\n\t\tthis.modifiedEndLineNumber = modifiedEndLineNumber;\r\n\t\tthis.modifiedEndColumn = modifiedEndColumn;\r\n\t}\r\n\r\n\tpublic static createFromDiffChange(diffChange: IDiffChange, originalCharSequence: CharSequence, modifiedCharSequence: CharSequence): CharChange {\r\n\t\tconst originalStartLineNumber = originalCharSequence.getStartLineNumber(diffChange.originalStart);\r\n\t\tconst originalStartColumn = originalCharSequence.getStartColumn(diffChange.originalStart);\r\n\t\tconst originalEndLineNumber = originalCharSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\r\n\t\tconst originalEndColumn = originalCharSequence.getEndColumn(diffChange.originalStart + diffChange.originalLength - 1);\r\n\r\n\t\tconst modifiedStartLineNumber = modifiedCharSequence.getStartLineNumber(diffChange.modifiedStart);\r\n\t\tconst modifiedStartColumn = modifiedCharSequence.getStartColumn(diffChange.modifiedStart);\r\n\t\tconst modifiedEndLineNumber = modifiedCharSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n\t\tconst modifiedEndColumn = modifiedCharSequence.getEndColumn(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n\r\n\t\treturn new CharChange(\r\n\t\t\toriginalStartLineNumber, originalStartColumn, originalEndLineNumber, originalEndColumn,\r\n\t\t\tmodifiedStartLineNumber, modifiedStartColumn, modifiedEndLineNumber, modifiedEndColumn,\r\n\t\t);\r\n\t}\r\n}\r\n\r\nfunction postProcessCharChanges(rawChanges: IDiffChange[]): IDiffChange[] {\r\n\tif (rawChanges.length <= 1) {\r\n\t\treturn rawChanges;\r\n\t}\r\n\r\n\tconst result = [rawChanges[0]];\r\n\tlet prevChange = result[0];\r\n\r\n\tfor (let i = 1, len = rawChanges.length; i < len; i++) {\r\n\t\tconst currChange = rawChanges[i];\r\n\r\n\t\tconst originalMatchingLength = currChange.originalStart - (prevChange.originalStart + prevChange.originalLength);\r\n\t\tconst modifiedMatchingLength = currChange.modifiedStart - (prevChange.modifiedStart + prevChange.modifiedLength);\r\n\t\t// Both of the above should be equal, but the continueProcessingPredicate may prevent this from being true\r\n\t\tconst matchingLength = Math.min(originalMatchingLength, modifiedMatchingLength);\r\n\r\n\t\tif (matchingLength < MINIMUM_MATCHING_CHARACTER_LENGTH) {\r\n\t\t\t// Merge the current change into the previous one\r\n\t\t\tprevChange.originalLength = (currChange.originalStart + currChange.originalLength) - prevChange.originalStart;\r\n\t\t\tprevChange.modifiedLength = (currChange.modifiedStart + currChange.modifiedLength) - prevChange.modifiedStart;\r\n\t\t} else {\r\n\t\t\t// Add the current change\r\n\t\t\tresult.push(currChange);\r\n\t\t\tprevChange = currChange;\r\n\t\t}\r\n\t}\r\n\r\n\treturn result;\r\n}\r\n\r\nclass LineChange implements ILineChange {\r\n\tpublic originalStartLineNumber: number;\r\n\tpublic originalEndLineNumber: number;\r\n\tpublic modifiedStartLineNumber: number;\r\n\tpublic modifiedEndLineNumber: number;\r\n\tpublic charChanges: CharChange[] | undefined;\r\n\r\n\tconstructor(\r\n\t\toriginalStartLineNumber: number,\r\n\t\toriginalEndLineNumber: number,\r\n\t\tmodifiedStartLineNumber: number,\r\n\t\tmodifiedEndLineNumber: number,\r\n\t\tcharChanges: CharChange[] | undefined\r\n\t) {\r\n\t\tthis.originalStartLineNumber = originalStartLineNumber;\r\n\t\tthis.originalEndLineNumber = originalEndLineNumber;\r\n\t\tthis.modifiedStartLineNumber = modifiedStartLineNumber;\r\n\t\tthis.modifiedEndLineNumber = modifiedEndLineNumber;\r\n\t\tthis.charChanges = charChanges;\r\n\t}\r\n\r\n\tpublic static createFromDiffResult(shouldIgnoreTrimWhitespace: boolean, diffChange: IDiffChange, originalLineSequence: LineSequence, modifiedLineSequence: LineSequence, continueCharDiff: () => boolean, shouldComputeCharChanges: boolean, shouldPostProcessCharChanges: boolean): LineChange {\r\n\t\tlet originalStartLineNumber: number;\r\n\t\tlet originalEndLineNumber: number;\r\n\t\tlet modifiedStartLineNumber: number;\r\n\t\tlet modifiedEndLineNumber: number;\r\n\t\tlet charChanges: CharChange[] | undefined = undefined;\r\n\r\n\t\tif (diffChange.originalLength === 0) {\r\n\t\t\toriginalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart) - 1;\r\n\t\t\toriginalEndLineNumber = 0;\r\n\t\t} else {\r\n\t\t\toriginalStartLineNumber = originalLineSequence.getStartLineNumber(diffChange.originalStart);\r\n\t\t\toriginalEndLineNumber = originalLineSequence.getEndLineNumber(diffChange.originalStart + diffChange.originalLength - 1);\r\n\t\t}\r\n\r\n\t\tif (diffChange.modifiedLength === 0) {\r\n\t\t\tmodifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart) - 1;\r\n\t\t\tmodifiedEndLineNumber = 0;\r\n\t\t} else {\r\n\t\t\tmodifiedStartLineNumber = modifiedLineSequence.getStartLineNumber(diffChange.modifiedStart);\r\n\t\t\tmodifiedEndLineNumber = modifiedLineSequence.getEndLineNumber(diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n\t\t}\r\n\r\n\t\tif (shouldComputeCharChanges && diffChange.originalLength > 0 && diffChange.originalLength < 20 && diffChange.modifiedLength > 0 && diffChange.modifiedLength < 20 && continueCharDiff()) {\r\n\t\t\t// Compute character changes for diff chunks of at most 20 lines...\r\n\t\t\tconst originalCharSequence = originalLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.originalStart, diffChange.originalStart + diffChange.originalLength - 1);\r\n\t\t\tconst modifiedCharSequence = modifiedLineSequence.createCharSequence(shouldIgnoreTrimWhitespace, diffChange.modifiedStart, diffChange.modifiedStart + diffChange.modifiedLength - 1);\r\n\r\n\t\t\tif (originalCharSequence.getElements().length > 0 && modifiedCharSequence.getElements().length > 0) {\r\n\t\t\t\tlet rawChanges = computeDiff(originalCharSequence, modifiedCharSequence, continueCharDiff, true).changes;\r\n\r\n\t\t\t\tif (shouldPostProcessCharChanges) {\r\n\t\t\t\t\trawChanges = postProcessCharChanges(rawChanges);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcharChanges = [];\r\n\t\t\t\tfor (let i = 0, length = rawChanges.length; i < length; i++) {\r\n\t\t\t\t\tcharChanges.push(CharChange.createFromDiffChange(rawChanges[i], originalCharSequence, modifiedCharSequence));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new LineChange(originalStartLineNumber, originalEndLineNumber, modifiedStartLineNumber, modifiedEndLineNumber, charChanges);\r\n\t}\r\n}\r\n\r\nexport interface IDiffComputerOpts {\r\n\tshouldComputeCharChanges: boolean;\r\n\tshouldPostProcessCharChanges: boolean;\r\n\tshouldIgnoreTrimWhitespace: boolean;\r\n\tshouldMakePrettyDiff: boolean;\r\n\tmaxComputationTime: number;\r\n}\r\n\r\nexport class DiffComputer {\r\n\r\n\tprivate readonly shouldComputeCharChanges: boolean;\r\n\tprivate readonly shouldPostProcessCharChanges: boolean;\r\n\tprivate readonly shouldIgnoreTrimWhitespace: boolean;\r\n\tprivate readonly shouldMakePrettyDiff: boolean;\r\n\tprivate readonly originalLines: string[];\r\n\tprivate readonly modifiedLines: string[];\r\n\tprivate readonly original: LineSequence;\r\n\tprivate readonly modified: LineSequence;\r\n\tprivate readonly continueLineDiff: () => boolean;\r\n\tprivate readonly continueCharDiff: () => boolean;\r\n\r\n\tconstructor(originalLines: string[], modifiedLines: string[], opts: IDiffComputerOpts) {\r\n\t\tthis.shouldComputeCharChanges = opts.shouldComputeCharChanges;\r\n\t\tthis.shouldPostProcessCharChanges = opts.shouldPostProcessCharChanges;\r\n\t\tthis.shouldIgnoreTrimWhitespace = opts.shouldIgnoreTrimWhitespace;\r\n\t\tthis.shouldMakePrettyDiff = opts.shouldMakePrettyDiff;\r\n\t\tthis.originalLines = originalLines;\r\n\t\tthis.modifiedLines = modifiedLines;\r\n\t\tthis.original = new LineSequence(originalLines);\r\n\t\tthis.modified = new LineSequence(modifiedLines);\r\n\r\n\t\tthis.continueLineDiff = createContinueProcessingPredicate(opts.maxComputationTime);\r\n\t\tthis.continueCharDiff = createContinueProcessingPredicate(opts.maxComputationTime === 0 ? 0 : Math.min(opts.maxComputationTime, 5000)); // never run after 5s for character changes...\r\n\t}\r\n\r\n\tpublic computeDiff(): IDiffComputerResult {\r\n\r\n\t\tif (this.original.lines.length === 1 && this.original.lines[0].length === 0) {\r\n\t\t\t// empty original => fast path\r\n\t\t\tif (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tquitEarly: false,\r\n\t\t\t\t\tchanges: []\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\treturn {\r\n\t\t\t\tquitEarly: false,\r\n\t\t\t\tchanges: [{\r\n\t\t\t\t\toriginalStartLineNumber: 1,\r\n\t\t\t\t\toriginalEndLineNumber: 1,\r\n\t\t\t\t\tmodifiedStartLineNumber: 1,\r\n\t\t\t\t\tmodifiedEndLineNumber: this.modified.lines.length,\r\n\t\t\t\t\tcharChanges: undefined\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tif (this.modified.lines.length === 1 && this.modified.lines[0].length === 0) {\r\n\t\t\t// empty modified => fast path\r\n\t\t\treturn {\r\n\t\t\t\tquitEarly: false,\r\n\t\t\t\tchanges: [{\r\n\t\t\t\t\toriginalStartLineNumber: 1,\r\n\t\t\t\t\toriginalEndLineNumber: this.original.lines.length,\r\n\t\t\t\t\tmodifiedStartLineNumber: 1,\r\n\t\t\t\t\tmodifiedEndLineNumber: 1,\r\n\t\t\t\t\tcharChanges: undefined\r\n\t\t\t\t}]\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst diffResult = computeDiff(this.original, this.modified, this.continueLineDiff, this.shouldMakePrettyDiff);\r\n\t\tconst rawChanges = diffResult.changes;\r\n\t\tconst quitEarly = diffResult.quitEarly;\r\n\r\n\t\t// The diff is always computed with ignoring trim whitespace\r\n\t\t// This ensures we get the prettiest diff\r\n\r\n\t\tif (this.shouldIgnoreTrimWhitespace) {\r\n\t\t\tconst lineChanges: LineChange[] = [];\r\n\t\t\tfor (let i = 0, length = rawChanges.length; i < length; i++) {\r\n\t\t\t\tlineChanges.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, rawChanges[i], this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\r\n\t\t\t}\r\n\t\t\treturn {\r\n\t\t\t\tquitEarly: quitEarly,\r\n\t\t\t\tchanges: lineChanges\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Need to post-process and introduce changes where the trim whitespace is different\r\n\t\t// Note that we are looping starting at -1 to also cover the lines before the first change\r\n\t\tconst result: LineChange[] = [];\r\n\r\n\t\tlet originalLineIndex = 0;\r\n\t\tlet modifiedLineIndex = 0;\r\n\t\tfor (let i = -1 /* !!!! */, len = rawChanges.length; i < len; i++) {\r\n\t\t\tconst nextChange = (i + 1 < len ? rawChanges[i + 1] : null);\r\n\t\t\tconst originalStop = (nextChange ? nextChange.originalStart : this.originalLines.length);\r\n\t\t\tconst modifiedStop = (nextChange ? nextChange.modifiedStart : this.modifiedLines.length);\r\n\r\n\t\t\twhile (originalLineIndex < originalStop && modifiedLineIndex < modifiedStop) {\r\n\t\t\t\tconst originalLine = this.originalLines[originalLineIndex];\r\n\t\t\t\tconst modifiedLine = this.modifiedLines[modifiedLineIndex];\r\n\r\n\t\t\t\tif (originalLine !== modifiedLine) {\r\n\t\t\t\t\t// These lines differ only in trim whitespace\r\n\r\n\t\t\t\t\t// Check the leading whitespace\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet originalStartColumn = getFirstNonBlankColumn(originalLine, 1);\r\n\t\t\t\t\t\tlet modifiedStartColumn = getFirstNonBlankColumn(modifiedLine, 1);\r\n\t\t\t\t\t\twhile (originalStartColumn > 1 && modifiedStartColumn > 1) {\r\n\t\t\t\t\t\t\tconst originalChar = originalLine.charCodeAt(originalStartColumn - 2);\r\n\t\t\t\t\t\t\tconst modifiedChar = modifiedLine.charCodeAt(modifiedStartColumn - 2);\r\n\t\t\t\t\t\t\tif (originalChar !== modifiedChar) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\toriginalStartColumn--;\r\n\t\t\t\t\t\t\tmodifiedStartColumn--;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (originalStartColumn > 1 || modifiedStartColumn > 1) {\r\n\t\t\t\t\t\t\tthis._pushTrimWhitespaceCharChange(result,\r\n\t\t\t\t\t\t\t\toriginalLineIndex + 1, 1, originalStartColumn,\r\n\t\t\t\t\t\t\t\tmodifiedLineIndex + 1, 1, modifiedStartColumn\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Check the trailing whitespace\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tlet originalEndColumn = getLastNonBlankColumn(originalLine, 1);\r\n\t\t\t\t\t\tlet modifiedEndColumn = getLastNonBlankColumn(modifiedLine, 1);\r\n\t\t\t\t\t\tconst originalMaxColumn = originalLine.length + 1;\r\n\t\t\t\t\t\tconst modifiedMaxColumn = modifiedLine.length + 1;\r\n\t\t\t\t\t\twhile (originalEndColumn < originalMaxColumn && modifiedEndColumn < modifiedMaxColumn) {\r\n\t\t\t\t\t\t\tconst originalChar = originalLine.charCodeAt(originalEndColumn - 1);\r\n\t\t\t\t\t\t\tconst modifiedChar = originalLine.charCodeAt(modifiedEndColumn - 1);\r\n\t\t\t\t\t\t\tif (originalChar !== modifiedChar) {\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\toriginalEndColumn++;\r\n\t\t\t\t\t\t\tmodifiedEndColumn++;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (originalEndColumn < originalMaxColumn || modifiedEndColumn < modifiedMaxColumn) {\r\n\t\t\t\t\t\t\tthis._pushTrimWhitespaceCharChange(result,\r\n\t\t\t\t\t\t\t\toriginalLineIndex + 1, originalEndColumn, originalMaxColumn,\r\n\t\t\t\t\t\t\t\tmodifiedLineIndex + 1, modifiedEndColumn, modifiedMaxColumn\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\toriginalLineIndex++;\r\n\t\t\t\tmodifiedLineIndex++;\r\n\t\t\t}\r\n\r\n\t\t\tif (nextChange) {\r\n\t\t\t\t// Emit the actual change\r\n\t\t\t\tresult.push(LineChange.createFromDiffResult(this.shouldIgnoreTrimWhitespace, nextChange, this.original, this.modified, this.continueCharDiff, this.shouldComputeCharChanges, this.shouldPostProcessCharChanges));\r\n\r\n\t\t\t\toriginalLineIndex += nextChange.originalLength;\r\n\t\t\t\tmodifiedLineIndex += nextChange.modifiedLength;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tquitEarly: quitEarly,\r\n\t\t\tchanges: result\r\n\t\t};\r\n\t}\r\n\r\n\tprivate _pushTrimWhitespaceCharChange(\r\n\t\tresult: LineChange[],\r\n\t\toriginalLineNumber: number, originalStartColumn: number, originalEndColumn: number,\r\n\t\tmodifiedLineNumber: number, modifiedStartColumn: number, modifiedEndColumn: number\r\n\t): void {\r\n\t\tif (this._mergeTrimWhitespaceCharChange(result, originalLineNumber, originalStartColumn, originalEndColumn, modifiedLineNumber, modifiedStartColumn, modifiedEndColumn)) {\r\n\t\t\t// Merged into previous\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlet charChanges: CharChange[] | undefined = undefined;\r\n\t\tif (this.shouldComputeCharChanges) {\r\n\t\t\tcharChanges = [new CharChange(\r\n\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\r\n\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\r\n\t\t\t)];\r\n\t\t}\r\n\t\tresult.push(new LineChange(\r\n\t\t\toriginalLineNumber, originalLineNumber,\r\n\t\t\tmodifiedLineNumber, modifiedLineNumber,\r\n\t\t\tcharChanges\r\n\t\t));\r\n\t}\r\n\r\n\tprivate _mergeTrimWhitespaceCharChange(\r\n\t\tresult: LineChange[],\r\n\t\toriginalLineNumber: number, originalStartColumn: number, originalEndColumn: number,\r\n\t\tmodifiedLineNumber: number, modifiedStartColumn: number, modifiedEndColumn: number\r\n\t): boolean {\r\n\t\tconst len = result.length;\r\n\t\tif (len === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst prevChange = result[len - 1];\r\n\r\n\t\tif (prevChange.originalEndLineNumber === 0 || prevChange.modifiedEndLineNumber === 0) {\r\n\t\t\t// Don't merge with inserts/deletes\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (prevChange.originalEndLineNumber === originalLineNumber && prevChange.modifiedEndLineNumber === modifiedLineNumber) {\r\n\t\t\tif (this.shouldComputeCharChanges && prevChange.charChanges) {\r\n\t\t\t\tprevChange.charChanges.push(new CharChange(\r\n\t\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\r\n\t\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\r\n\t\t\t\t));\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (prevChange.originalEndLineNumber + 1 === originalLineNumber && prevChange.modifiedEndLineNumber + 1 === modifiedLineNumber) {\r\n\t\t\tprevChange.originalEndLineNumber = originalLineNumber;\r\n\t\t\tprevChange.modifiedEndLineNumber = modifiedLineNumber;\r\n\t\t\tif (this.shouldComputeCharChanges && prevChange.charChanges) {\r\n\t\t\t\tprevChange.charChanges.push(new CharChange(\r\n\t\t\t\t\toriginalLineNumber, originalStartColumn, originalLineNumber, originalEndColumn,\r\n\t\t\t\t\tmodifiedLineNumber, modifiedStartColumn, modifiedLineNumber, modifiedEndColumn\r\n\t\t\t\t));\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n}\r\n\r\nfunction getFirstNonBlankColumn(txt: string, defaultValue: number): number {\r\n\tconst r = strings.firstNonWhitespaceIndex(txt);\r\n\tif (r === -1) {\r\n\t\treturn defaultValue;\r\n\t}\r\n\treturn r + 1;\r\n}\r\n\r\nfunction getLastNonBlankColumn(txt: string, defaultValue: number): number {\r\n\tconst r = strings.lastNonWhitespaceIndex(txt);\r\n\tif (r === -1) {\r\n\t\treturn defaultValue;\r\n\t}\r\n\treturn r + 2;\r\n}\r\n\r\nfunction createContinueProcessingPredicate(maximumRuntime: number): () => boolean {\r\n\tif (maximumRuntime === 0) {\r\n\t\treturn () => true;\r\n\t}\r\n\r\n\tconst startTime = Date.now();\r\n\treturn () => {\r\n\t\treturn Date.now() - startTime < maximumRuntime;\r\n\t};\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { LegacyLinesDiffComputer } from 'vs/editor/common/diff/legacyLinesDiffComputer';\r\nimport { AdvancedLinesDiffComputer } from 'vs/editor/common/diff/advancedLinesDiffComputer';\r\n\r\nexport const linesDiffComputers = {\r\n\tgetLegacy: () => new LegacyLinesDiffComputer(),\r\n\tgetAdvanced: () => new AdvancedLinesDiffComputer(),\r\n};\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport { Color, HSLA } from 'vs/base/common/color';\r\nimport { IPosition } from 'vs/editor/common/core/position';\r\nimport { IRange } from 'vs/editor/common/core/range';\r\nimport { IColor, IColorInformation } from 'vs/editor/common/languages';\r\n\r\nexport interface IDocumentColorComputerTarget {\r\n\tgetValue(): string;\r\n\tpositionAt(offset: number): IPosition;\r\n\tfindMatches(regex: RegExp): RegExpMatchArray[];\r\n}\r\n\r\nfunction _parseCaptureGroups(captureGroups: IterableIterator<string>) {\r\n\tconst values = [];\r\n\tfor (const captureGroup of captureGroups) {\r\n\t\tconst parsedNumber = Number(captureGroup);\r\n\t\tif (parsedNumber || parsedNumber === 0 && captureGroup.replace(/\\s/g, '') !== '') {\r\n\t\t\tvalues.push(parsedNumber);\r\n\t\t}\r\n\t}\r\n\treturn values;\r\n}\r\n\r\nfunction _toIColor(r: number, g: number, b: number, a: number): IColor {\r\n\treturn {\r\n\t\tred: r / 255,\r\n\t\tblue: b / 255,\r\n\t\tgreen: g / 255,\r\n\t\talpha: a\r\n\t};\r\n}\r\n\r\nfunction _findRange(model: IDocumentColorComputerTarget, match: RegExpMatchArray): IRange | undefined {\r\n\tconst index = match.index;\r\n\tconst length = match[0].length;\r\n\tif (!index) {\r\n\t\treturn;\r\n\t}\r\n\tconst startPosition = model.positionAt(index);\r\n\tconst range: IRange = {\r\n\t\tstartLineNumber: startPosition.lineNumber,\r\n\t\tstartColumn: startPosition.column,\r\n\t\tendLineNumber: startPosition.lineNumber,\r\n\t\tendColumn: startPosition.column + length\r\n\t};\r\n\treturn range;\r\n}\r\n\r\nfunction _findHexColorInformation(range: IRange | undefined, hexValue: string) {\r\n\tif (!range) {\r\n\t\treturn;\r\n\t}\r\n\tconst parsedHexColor = Color.Format.CSS.parseHex(hexValue);\r\n\tif (!parsedHexColor) {\r\n\t\treturn;\r\n\t}\r\n\treturn {\r\n\t\trange: range,\r\n\t\tcolor: _toIColor(parsedHexColor.rgba.r, parsedHexColor.rgba.g, parsedHexColor.rgba.b, parsedHexColor.rgba.a)\r\n\t};\r\n}\r\n\r\nfunction _findRGBColorInformation(range: IRange | undefined, matches: RegExpMatchArray[], isAlpha: boolean) {\r\n\tif (!range || matches.length !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tconst match = matches[0]!;\r\n\tconst captureGroups = match.values();\r\n\tconst parsedRegex = _parseCaptureGroups(captureGroups);\r\n\treturn {\r\n\t\trange: range,\r\n\t\tcolor: _toIColor(parsedRegex[0], parsedRegex[1], parsedRegex[2], isAlpha ? parsedRegex[3] : 1)\r\n\t};\r\n}\r\n\r\nfunction _findHSLColorInformation(range: IRange | undefined, matches: RegExpMatchArray[], isAlpha: boolean) {\r\n\tif (!range || matches.length !== 1) {\r\n\t\treturn;\r\n\t}\r\n\tconst match = matches[0]!;\r\n\tconst captureGroups = match.values();\r\n\tconst parsedRegex = _parseCaptureGroups(captureGroups);\r\n\tconst colorEquivalent = new Color(new HSLA(parsedRegex[0], parsedRegex[1] / 100, parsedRegex[2] / 100, isAlpha ? parsedRegex[3] : 1));\r\n\treturn {\r\n\t\trange: range,\r\n\t\tcolor: _toIColor(colorEquivalent.rgba.r, colorEquivalent.rgba.g, colorEquivalent.rgba.b, colorEquivalent.rgba.a)\r\n\t};\r\n}\r\n\r\nfunction _findMatches(model: IDocumentColorComputerTarget | string, regex: RegExp): RegExpMatchArray[] {\r\n\tif (typeof model === 'string') {\r\n\t\treturn [...model.matchAll(regex)];\r\n\t} else {\r\n\t\treturn model.findMatches(regex);\r\n\t}\r\n}\r\n\r\nfunction computeColors(model: IDocumentColorComputerTarget): IColorInformation[] {\r\n\tconst result: IColorInformation[] = [];\r\n\t// Early validation for RGB and HSL\r\n\tconst initialValidationRegex = /\\b(rgb|rgba|hsl|hsla)(\\([0-9\\s,.\\%]*\\))|(#)([A-Fa-f0-9]{3})\\b|(#)([A-Fa-f0-9]{4})\\b|(#)([A-Fa-f0-9]{6})\\b|(#)([A-Fa-f0-9]{8})\\b/gm;\r\n\tconst initialValidationMatches = _findMatches(model, initialValidationRegex);\r\n\r\n\t// Potential colors have been found, validate the parameters\r\n\tif (initialValidationMatches.length > 0) {\r\n\t\tfor (const initialMatch of initialValidationMatches) {\r\n\t\t\tconst initialCaptureGroups = initialMatch.filter(captureGroup => captureGroup !== undefined);\r\n\t\t\tconst colorScheme = initialCaptureGroups[1];\r\n\t\t\tconst colorParameters = initialCaptureGroups[2];\r\n\t\t\tif (!colorParameters) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tlet colorInformation;\r\n\t\t\tif (colorScheme === 'rgb') {\r\n\t\t\t\tconst regexParameters = /^\\(\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*,\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*,\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*\\)$/gm;\r\n\t\t\t\tcolorInformation = _findRGBColorInformation(_findRange(model, initialMatch), _findMatches(colorParameters, regexParameters), false);\r\n\t\t\t} else if (colorScheme === 'rgba') {\r\n\t\t\t\tconst regexParameters = /^\\(\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*,\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*,\\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\\s*,\\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\\s*\\)$/gm;\r\n\t\t\t\tcolorInformation = _findRGBColorInformation(_findRange(model, initialMatch), _findMatches(colorParameters, regexParameters), true);\r\n\t\t\t} else if (colorScheme === 'hsl') {\r\n\t\t\t\tconst regexParameters = /^\\(\\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\\s*,\\s*(100|\\d{1,2}[.]\\d*|\\d{1,2})%\\s*,\\s*(100|\\d{1,2}[.]\\d*|\\d{1,2})%\\s*\\)$/gm;\r\n\t\t\t\tcolorInformation = _findHSLColorInformation(_findRange(model, initialMatch), _findMatches(colorParameters, regexParameters), false);\r\n\t\t\t} else if (colorScheme === 'hsla') {\r\n\t\t\t\tconst regexParameters = /^\\(\\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\\s*,\\s*(100|\\d{1,2}[.]\\d*|\\d{1,2})%\\s*,\\s*(100|\\d{1,2}[.]\\d*|\\d{1,2})%\\s*,\\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\\s*\\)$/gm;\r\n\t\t\t\tcolorInformation = _findHSLColorInformation(_findRange(model, initialMatch), _findMatches(colorParameters, regexParameters), true);\r\n\t\t\t} else if (colorScheme === '#') {\r\n\t\t\t\tcolorInformation = _findHexColorInformation(_findRange(model, initialMatch), colorScheme + colorParameters);\r\n\t\t\t}\r\n\t\t\tif (colorInformation) {\r\n\t\t\t\tresult.push(colorInformation);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\n/**\r\n * Returns an array of all default document colors in the provided document\r\n */\r\nexport function computeDefaultDocumentColors(model: IDocumentColorComputerTarget): IColorInformation[] {\r\n\tif (!model || typeof model.getValue !== 'function' || typeof model.positionAt !== 'function') {\r\n\t\t// Unknown caller!\r\n\t\treturn [];\r\n\t}\r\n\treturn computeColors(model);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { CharacterClassifier } from 'vs/editor/common/core/characterClassifier';\r\nimport { ILink } from 'vs/editor/common/languages';\r\n\r\nexport interface ILinkComputerTarget {\r\n\tgetLineCount(): number;\r\n\tgetLineContent(lineNumber: number): string;\r\n}\r\n\r\nexport const enum State {\r\n\tInvalid = 0,\r\n\tStart = 1,\r\n\tH = 2,\r\n\tHT = 3,\r\n\tHTT = 4,\r\n\tHTTP = 5,\r\n\tF = 6,\r\n\tFI = 7,\r\n\tFIL = 8,\r\n\tBeforeColon = 9,\r\n\tAfterColon = 10,\r\n\tAlmostThere = 11,\r\n\tEnd = 12,\r\n\tAccept = 13,\r\n\tLastKnownState = 14 // marker, custom states may follow\r\n}\r\n\r\nexport type Edge = [State, number, State];\r\n\r\nclass Uint8Matrix {\r\n\r\n\tprivate readonly _data: Uint8Array;\r\n\tpublic readonly rows: number;\r\n\tpublic readonly cols: number;\r\n\r\n\tconstructor(rows: number, cols: number, defaultValue: number) {\r\n\t\tconst data = new Uint8Array(rows * cols);\r\n\t\tfor (let i = 0, len = rows * cols; i < len; i++) {\r\n\t\t\tdata[i] = defaultValue;\r\n\t\t}\r\n\r\n\t\tthis._data = data;\r\n\t\tthis.rows = rows;\r\n\t\tthis.cols = cols;\r\n\t}\r\n\r\n\tpublic get(row: number, col: number): number {\r\n\t\treturn this._data[row * this.cols + col];\r\n\t}\r\n\r\n\tpublic set(row: number, col: number, value: number): void {\r\n\t\tthis._data[row * this.cols + col] = value;\r\n\t}\r\n}\r\n\r\nexport class StateMachine {\r\n\r\n\tprivate readonly _states: Uint8Matrix;\r\n\tprivate readonly _maxCharCode: number;\r\n\r\n\tconstructor(edges: Edge[]) {\r\n\t\tlet maxCharCode = 0;\r\n\t\tlet maxState = State.Invalid;\r\n\t\tfor (let i = 0, len = edges.length; i < len; i++) {\r\n\t\t\tconst [from, chCode, to] = edges[i];\r\n\t\t\tif (chCode > maxCharCode) {\r\n\t\t\t\tmaxCharCode = chCode;\r\n\t\t\t}\r\n\t\t\tif (from > maxState) {\r\n\t\t\t\tmaxState = from;\r\n\t\t\t}\r\n\t\t\tif (to > maxState) {\r\n\t\t\t\tmaxState = to;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tmaxCharCode++;\r\n\t\tmaxState++;\r\n\r\n\t\tconst states = new Uint8Matrix(maxState, maxCharCode, State.Invalid);\r\n\t\tfor (let i = 0, len = edges.length; i < len; i++) {\r\n\t\t\tconst [from, chCode, to] = edges[i];\r\n\t\t\tstates.set(from, chCode, to);\r\n\t\t}\r\n\r\n\t\tthis._states = states;\r\n\t\tthis._maxCharCode = maxCharCode;\r\n\t}\r\n\r\n\tpublic nextState(currentState: State, chCode: number): State {\r\n\t\tif (chCode < 0 || chCode >= this._maxCharCode) {\r\n\t\t\treturn State.Invalid;\r\n\t\t}\r\n\t\treturn this._states.get(currentState, chCode);\r\n\t}\r\n}\r\n\r\n// State machine for http:// or https:// or file://\r\nlet _stateMachine: StateMachine | null = null;\r\nfunction getStateMachine(): StateMachine {\r\n\tif (_stateMachine === null) {\r\n\t\t_stateMachine = new StateMachine([\r\n\t\t\t[State.Start, CharCode.h, State.H],\r\n\t\t\t[State.Start, CharCode.H, State.H],\r\n\t\t\t[State.Start, CharCode.f, State.F],\r\n\t\t\t[State.Start, CharCode.F, State.F],\r\n\r\n\t\t\t[State.H, CharCode.t, State.HT],\r\n\t\t\t[State.H, CharCode.T, State.HT],\r\n\r\n\t\t\t[State.HT, CharCode.t, State.HTT],\r\n\t\t\t[State.HT, CharCode.T, State.HTT],\r\n\r\n\t\t\t[State.HTT, CharCode.p, State.HTTP],\r\n\t\t\t[State.HTT, CharCode.P, State.HTTP],\r\n\r\n\t\t\t[State.HTTP, CharCode.s, State.BeforeColon],\r\n\t\t\t[State.HTTP, CharCode.S, State.BeforeColon],\r\n\t\t\t[State.HTTP, CharCode.Colon, State.AfterColon],\r\n\r\n\t\t\t[State.F, CharCode.i, State.FI],\r\n\t\t\t[State.F, CharCode.I, State.FI],\r\n\r\n\t\t\t[State.FI, CharCode.l, State.FIL],\r\n\t\t\t[State.FI, CharCode.L, State.FIL],\r\n\r\n\t\t\t[State.FIL, CharCode.e, State.BeforeColon],\r\n\t\t\t[State.FIL, CharCode.E, State.BeforeColon],\r\n\r\n\t\t\t[State.BeforeColon, CharCode.Colon, State.AfterColon],\r\n\r\n\t\t\t[State.AfterColon, CharCode.Slash, State.AlmostThere],\r\n\r\n\t\t\t[State.AlmostThere, CharCode.Slash, State.End],\r\n\t\t]);\r\n\t}\r\n\treturn _stateMachine;\r\n}\r\n\r\n\r\nconst enum CharacterClass {\r\n\tNone = 0,\r\n\tForceTermination = 1,\r\n\tCannotEndIn = 2\r\n}\r\n\r\nlet _classifier: CharacterClassifier<CharacterClass> | null = null;\r\nfunction getClassifier(): CharacterClassifier<CharacterClass> {\r\n\tif (_classifier === null) {\r\n\t\t_classifier = new CharacterClassifier<CharacterClass>(CharacterClass.None);\r\n\r\n\t\t// allow-any-unicode-next-line\r\n\t\tconst FORCE_TERMINATION_CHARACTERS = ' \\t<>\\'\\\"';\r\n\t\tfor (let i = 0; i < FORCE_TERMINATION_CHARACTERS.length; i++) {\r\n\t\t\t_classifier.set(FORCE_TERMINATION_CHARACTERS.charCodeAt(i), CharacterClass.ForceTermination);\r\n\t\t}\r\n\r\n\t\tconst CANNOT_END_WITH_CHARACTERS = '.,;:';\r\n\t\tfor (let i = 0; i < CANNOT_END_WITH_CHARACTERS.length; i++) {\r\n\t\t\t_classifier.set(CANNOT_END_WITH_CHARACTERS.charCodeAt(i), CharacterClass.CannotEndIn);\r\n\t\t}\r\n\t}\r\n\treturn _classifier;\r\n}\r\n\r\nexport class LinkComputer {\r\n\r\n\tprivate static _createLink(classifier: CharacterClassifier<CharacterClass>, line: string, lineNumber: number, linkBeginIndex: number, linkEndIndex: number): ILink {\r\n\t\t// Do not allow to end link in certain characters...\r\n\t\tlet lastIncludedCharIndex = linkEndIndex - 1;\r\n\t\tdo {\r\n\t\t\tconst chCode = line.charCodeAt(lastIncludedCharIndex);\r\n\t\t\tconst chClass = classifier.get(chCode);\r\n\t\t\tif (chClass !== CharacterClass.CannotEndIn) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tlastIncludedCharIndex--;\r\n\t\t} while (lastIncludedCharIndex > linkBeginIndex);\r\n\r\n\t\t// Handle links enclosed in parens, square brackets and curlys.\r\n\t\tif (linkBeginIndex > 0) {\r\n\t\t\tconst charCodeBeforeLink = line.charCodeAt(linkBeginIndex - 1);\r\n\t\t\tconst lastCharCodeInLink = line.charCodeAt(lastIncludedCharIndex);\r\n\r\n\t\t\tif (\r\n\t\t\t\t(charCodeBeforeLink === CharCode.OpenParen && lastCharCodeInLink === CharCode.CloseParen)\r\n\t\t\t\t|| (charCodeBeforeLink === CharCode.OpenSquareBracket && lastCharCodeInLink === CharCode.CloseSquareBracket)\r\n\t\t\t\t|| (charCodeBeforeLink === CharCode.OpenCurlyBrace && lastCharCodeInLink === CharCode.CloseCurlyBrace)\r\n\t\t\t) {\r\n\t\t\t\t// Do not end in ) if ( is before the link start\r\n\t\t\t\t// Do not end in ] if [ is before the link start\r\n\t\t\t\t// Do not end in } if { is before the link start\r\n\t\t\t\tlastIncludedCharIndex--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\trange: {\r\n\t\t\t\tstartLineNumber: lineNumber,\r\n\t\t\t\tstartColumn: linkBeginIndex + 1,\r\n\t\t\t\tendLineNumber: lineNumber,\r\n\t\t\t\tendColumn: lastIncludedCharIndex + 2\r\n\t\t\t},\r\n\t\t\turl: line.substring(linkBeginIndex, lastIncludedCharIndex + 1)\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static computeLinks(model: ILinkComputerTarget, stateMachine: StateMachine = getStateMachine()): ILink[] {\r\n\t\tconst classifier = getClassifier();\r\n\r\n\t\tconst result: ILink[] = [];\r\n\t\tfor (let i = 1, lineCount = model.getLineCount(); i <= lineCount; i++) {\r\n\t\t\tconst line = model.getLineContent(i);\r\n\t\t\tconst len = line.length;\r\n\r\n\t\t\tlet j = 0;\r\n\t\t\tlet linkBeginIndex = 0;\r\n\t\t\tlet linkBeginChCode = 0;\r\n\t\t\tlet state = State.Start;\r\n\t\t\tlet hasOpenParens = false;\r\n\t\t\tlet hasOpenSquareBracket = false;\r\n\t\t\tlet inSquareBrackets = false;\r\n\t\t\tlet hasOpenCurlyBracket = false;\r\n\r\n\t\t\twhile (j < len) {\r\n\r\n\t\t\t\tlet resetStateMachine = false;\r\n\t\t\t\tconst chCode = line.charCodeAt(j);\r\n\r\n\t\t\t\tif (state === State.Accept) {\r\n\t\t\t\t\tlet chClass: CharacterClass;\r\n\t\t\t\t\tswitch (chCode) {\r\n\t\t\t\t\t\tcase CharCode.OpenParen:\r\n\t\t\t\t\t\t\thasOpenParens = true;\r\n\t\t\t\t\t\t\tchClass = CharacterClass.None;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.CloseParen:\r\n\t\t\t\t\t\t\tchClass = (hasOpenParens ? CharacterClass.None : CharacterClass.ForceTermination);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.OpenSquareBracket:\r\n\t\t\t\t\t\t\tinSquareBrackets = true;\r\n\t\t\t\t\t\t\thasOpenSquareBracket = true;\r\n\t\t\t\t\t\t\tchClass = CharacterClass.None;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.CloseSquareBracket:\r\n\t\t\t\t\t\t\tinSquareBrackets = false;\r\n\t\t\t\t\t\t\tchClass = (hasOpenSquareBracket ? CharacterClass.None : CharacterClass.ForceTermination);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.OpenCurlyBrace:\r\n\t\t\t\t\t\t\thasOpenCurlyBracket = true;\r\n\t\t\t\t\t\t\tchClass = CharacterClass.None;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.CloseCurlyBrace:\r\n\t\t\t\t\t\t\tchClass = (hasOpenCurlyBracket ? CharacterClass.None : CharacterClass.ForceTermination);\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t// The following three rules make it that ' or \" or ` are allowed inside links\r\n\t\t\t\t\t\t// only if the link is wrapped by some other quote character\r\n\t\t\t\t\t\tcase CharCode.SingleQuote:\r\n\t\t\t\t\t\tcase CharCode.DoubleQuote:\r\n\t\t\t\t\t\tcase CharCode.BackTick:\r\n\t\t\t\t\t\t\tif (linkBeginChCode === chCode) {\r\n\t\t\t\t\t\t\t\tchClass = CharacterClass.ForceTermination;\r\n\t\t\t\t\t\t\t} else if (linkBeginChCode === CharCode.SingleQuote || linkBeginChCode === CharCode.DoubleQuote || linkBeginChCode === CharCode.BackTick) {\r\n\t\t\t\t\t\t\t\tchClass = CharacterClass.None;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tchClass = CharacterClass.ForceTermination;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.Asterisk:\r\n\t\t\t\t\t\t\t// `*` terminates a link if the link began with `*`\r\n\t\t\t\t\t\t\tchClass = (linkBeginChCode === CharCode.Asterisk) ? CharacterClass.ForceTermination : CharacterClass.None;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.Pipe:\r\n\t\t\t\t\t\t\t// `|` terminates a link if the link began with `|`\r\n\t\t\t\t\t\t\tchClass = (linkBeginChCode === CharCode.Pipe) ? CharacterClass.ForceTermination : CharacterClass.None;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase CharCode.Space:\r\n\t\t\t\t\t\t\t// ` ` allow space in between [ and ]\r\n\t\t\t\t\t\t\tchClass = (inSquareBrackets ? CharacterClass.None : CharacterClass.ForceTermination);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tchClass = classifier.get(chCode);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Check if character terminates link\r\n\t\t\t\t\tif (chClass === CharacterClass.ForceTermination) {\r\n\t\t\t\t\t\tresult.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, j));\r\n\t\t\t\t\t\tresetStateMachine = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (state === State.End) {\r\n\r\n\t\t\t\t\tlet chClass: CharacterClass;\r\n\t\t\t\t\tif (chCode === CharCode.OpenSquareBracket) {\r\n\t\t\t\t\t\t// Allow for the authority part to contain ipv6 addresses which contain [ and ]\r\n\t\t\t\t\t\thasOpenSquareBracket = true;\r\n\t\t\t\t\t\tchClass = CharacterClass.None;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tchClass = classifier.get(chCode);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Check if character terminates link\r\n\t\t\t\t\tif (chClass === CharacterClass.ForceTermination) {\r\n\t\t\t\t\t\tresetStateMachine = true;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tstate = State.Accept;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstate = stateMachine.nextState(state, chCode);\r\n\t\t\t\t\tif (state === State.Invalid) {\r\n\t\t\t\t\t\tresetStateMachine = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (resetStateMachine) {\r\n\t\t\t\t\tstate = State.Start;\r\n\t\t\t\t\thasOpenParens = false;\r\n\t\t\t\t\thasOpenSquareBracket = false;\r\n\t\t\t\t\thasOpenCurlyBracket = false;\r\n\r\n\t\t\t\t\t// Record where the link started\r\n\t\t\t\t\tlinkBeginIndex = j + 1;\r\n\t\t\t\t\tlinkBeginChCode = chCode;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tj++;\r\n\t\t\t}\r\n\r\n\t\t\tif (state === State.Accept) {\r\n\t\t\t\tresult.push(LinkComputer._createLink(classifier, line, i, linkBeginIndex, len));\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n}\r\n\r\n/**\r\n * Returns an array of all links contains in the provided\r\n * document. *Note* that this operation is computational\r\n * expensive and should not run in the UI thread.\r\n */\r\nexport function computeLinks(model: ILinkComputerTarget | null): ILink[] {\r\n\tif (!model || typeof model.getLineCount !== 'function' || typeof model.getLineContent !== 'function') {\r\n\t\t// Unknown caller!\r\n\t\treturn [];\r\n\t}\r\n\treturn LinkComputer.computeLinks(model);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { IRange } from 'vs/editor/common/core/range';\r\nimport { IInplaceReplaceSupportResult } from 'vs/editor/common/languages';\r\n\r\nexport class BasicInplaceReplace {\r\n\r\n\tpublic static readonly INSTANCE = new BasicInplaceReplace();\r\n\r\n\tpublic navigateValueSet(range1: IRange, text1: string, range2: IRange, text2: string | null, up: boolean): IInplaceReplaceSupportResult | null {\r\n\r\n\t\tif (range1 && text1) {\r\n\t\t\tconst result = this.doNavigateValueSet(text1, up);\r\n\t\t\tif (result) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\trange: range1,\r\n\t\t\t\t\tvalue: result\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (range2 && text2) {\r\n\t\t\tconst result = this.doNavigateValueSet(text2, up);\r\n\t\t\tif (result) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\trange: range2,\r\n\t\t\t\t\tvalue: result\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate doNavigateValueSet(text: string, up: boolean): string | null {\r\n\t\tconst numberResult = this.numberReplace(text, up);\r\n\t\tif (numberResult !== null) {\r\n\t\t\treturn numberResult;\r\n\t\t}\r\n\t\treturn this.textReplace(text, up);\r\n\t}\r\n\r\n\tprivate numberReplace(value: string, up: boolean): string | null {\r\n\t\tconst precision = Math.pow(10, value.length - (value.lastIndexOf('.') + 1));\r\n\t\tlet n1 = Number(value);\r\n\t\tconst n2 = parseFloat(value);\r\n\r\n\t\tif (!isNaN(n1) && !isNaN(n2) && n1 === n2) {\r\n\r\n\t\t\tif (n1 === 0 && !up) {\r\n\t\t\t\treturn null; // don't do negative\r\n\t\t\t\t//\t\t\t} else if(n1 === 9 && up) {\r\n\t\t\t\t//\t\t\t\treturn null; // don't insert 10 into a number\r\n\t\t\t} else {\r\n\t\t\t\tn1 = Math.floor(n1 * precision);\r\n\t\t\t\tn1 += up ? precision : -precision;\r\n\t\t\t\treturn String(n1 / precision);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate readonly _defaultValueSet: string[][] = [\r\n\t\t['true', 'false'],\r\n\t\t['True', 'False'],\r\n\t\t['Private', 'Public', 'Friend', 'ReadOnly', 'Partial', 'Protected', 'WriteOnly'],\r\n\t\t['public', 'protected', 'private'],\r\n\t];\r\n\r\n\tprivate textReplace(value: string, up: boolean): string | null {\r\n\t\treturn this.valueSetsReplace(this._defaultValueSet, value, up);\r\n\t}\r\n\r\n\tprivate valueSetsReplace(valueSets: string[][], value: string, up: boolean): string | null {\r\n\t\tlet result: string | null = null;\r\n\t\tfor (let i = 0, len = valueSets.length; result === null && i < len; i++) {\r\n\t\t\tresult = this.valueSetReplace(valueSets[i], value, up);\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate valueSetReplace(valueSet: string[], value: string, up: boolean): string | null {\r\n\t\tlet idx = valueSet.indexOf(value);\r\n\t\tif (idx >= 0) {\r\n\t\t\tidx += up ? +1 : -1;\r\n\t\t\tif (idx < 0) {\r\n\t\t\t\tidx = valueSet.length - 1;\r\n\t\t\t} else {\r\n\t\t\t\tidx %= valueSet.length;\r\n\t\t\t}\r\n\t\t\treturn valueSet[idx];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * [] export interface & class\r\n * export interface IDecorationOptions\r\n * export interface IModelDecorationGlyphMarginOptions\r\n * export interface IModelDecorationOverviewRulerOptions extends IDecorationOptions\r\n * export interface IModelDecorationMinimapOptions extends IDecorationOptions\r\n * export interface IModelDecorationOptions\r\n * export interface InjectedTextOptions\r\n * export interface IModelDeltaDecoration\r\n * export interface IModelDecoration\r\n * export interface IModelDecorationsChangeAccessor\r\n *\r\n * export interface ISingleEditOperationIdentifier\r\n * export interface IIdentifiedSingleEditOperation extends ISingleEditOperation\r\n * export interface IValidEditOperation\r\n * export interface ICursorStateComputer\r\n *\r\n * export class TextModelResolvedOptions\r\n * export interface ITextModelCreationOptions\r\n * export interface BracketPairColorizationOptions\r\n * export interface ITextModelUpdateOptions\r\n *\r\n * export class FindMatch\r\n *\r\n * export interface ITextSnapshot\r\n *\r\n[*]export interface ITextModel\r\n * export interface IAttachedView\r\n * export interface ITextBufferBuilder\r\n * export interface ITextBufferFactory\r\n *\r\n * export class ValidAnnotatedEditOperation implements IIdentifiedSingleEditOperation\r\n *\r\n[*]export interface IReadonlyTextBuffer\r\n * export class SearchData\r\n[*]export interface `ITextBuffer` extends IReadonlyTextBuffer\r\n * export class ApplyEditsResult\r\n * export interface IInternalModelContentChange extends IModelContentChange\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { Event } from 'vs/base/common/event';\r\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\r\nimport { IDisposable } from 'vs/base/common/lifecycle';\r\nimport { equals } from 'vs/base/common/objects';\r\nimport { ThemeColor } from 'vs/base/common/themables';\r\nimport { URI } from 'vs/base/common/uri';\r\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\r\nimport { IPosition, Position } from 'vs/editor/common/core/position';\r\nimport { IRange, Range } from 'vs/editor/common/core/range';\r\nimport { Selection } from 'vs/editor/common/core/selection';\r\nimport { TextChange } from 'vs/editor/common/core/textChange';\r\nimport { WordCharacterClassifier } from 'vs/editor/common/core/wordCharacterClassifier';\r\nimport { IWordAtPosition } from 'vs/editor/common/core/wordHelper';\r\nimport { FormattingOptions } from 'vs/editor/common/languages';\r\nimport { ILanguageSelection } from 'vs/editor/common/languages/language';\r\nimport { IBracketPairsTextModelPart } from 'vs/editor/common/textModelBracketPairs';\r\nimport { IModelContentChange, IModelContentChangedEvent, IModelDecorationsChangedEvent, IModelLanguageChangedEvent, IModelLanguageConfigurationChangedEvent, IModelOptionsChangedEvent, IModelTokensChangedEvent, InternalModelContentChangeEvent, ModelInjectedTextChangedEvent } from 'vs/editor/common/textModelEvents';\r\nimport { IGuidesTextModelPart } from 'vs/editor/common/textModelGuides';\r\nimport { ITokenizationTextModelPart } from 'vs/editor/common/tokenizationTextModelPart';\r\nimport { UndoRedoGroup } from 'vs/platform/undoRedo/common/undoRedo';\r\n\r\n/**\r\n * Vertical Lane in the overview ruler of the editor.\r\n *\r\n * `Left` = 1, `Center` = 2, `Right` = 4, `Full` = 7\r\n * - : `overview ruler` - https://stackoverflow.com/questions/50593516/colored-pixels-in-scrollbar-in-vs-code/51684408#51684408\r\n */\r\nexport enum OverviewRulerLane {\r\n\tLeft = 1,\r\n\tCenter = 2,\r\n\tRight = 4,\r\n\tFull = 7\r\n}\r\n\r\n/**\r\n * Vertical Lane in the glyph margin of the editor.\r\n *\r\n * `Left` = 1, `Right` = 2\r\n * - : `glyph margin` - https://microchipdeveloper.com/mplabx:glyph-margin\r\n */\r\nexport enum GlyphMarginLane {\r\n\tLeft = 1,\r\n\tRight = 2\r\n}\r\n\r\n/**\r\n * Position in the minimap to render the decoration.\r\n *\r\n * `Inline` = 1, `Gutter` = 2\r\n * - : `Gutter` - https://support.smartbear.com/testcomplete/docs/scripting/code-editor/window/gutter.html\r\n */\r\nexport enum MinimapPosition {\r\n\tInline = 1,\r\n\tGutter = 2\r\n}\r\n\r\nexport interface IDecorationOptions {\r\n\t/**\r\n\t * CSS color to render.\r\n\t *\r\n\t * e.g.: rgba(100, 100, 100, 0.5) or a color from the color registry\r\n\t */\r\n\tcolor: string | ThemeColor | undefined;\r\n\t/**\r\n\t * CSS color to render.\r\n\t *\r\n\t * e.g.: rgba(100, 100, 100, 0.5) or a color from the color registry\r\n\t */\r\n\tdarkColor?: string | ThemeColor;\r\n}\r\n\r\nexport interface IModelDecorationGlyphMarginOptions {\r\n\t/**\r\n\t * The position in the glyph margin.\r\n\t */\r\n\tposition: GlyphMarginLane;\r\n}\r\n\r\n/**\r\n * Options for rendering a model decoration in the overview ruler.\r\n */\r\nexport interface IModelDecorationOverviewRulerOptions extends IDecorationOptions {\r\n\t/**\r\n\t * The position in the overview ruler.\r\n\t */\r\n\tposition: OverviewRulerLane;\r\n}\r\n\r\n/**\r\n * Options for rendering a model decoration in the minimap.\r\n */\r\nexport interface IModelDecorationMinimapOptions extends IDecorationOptions {\r\n\t/**\r\n\t * The position in the minimap.\r\n\t */\r\n\tposition: MinimapPosition;\r\n}\r\n\r\n/**\r\n * Options for a model decoration.\r\n */\r\nexport interface IModelDecorationOptions {\r\n\t/**\r\n\t * A debug description that can be used for inspecting model decorations.\r\n\t * @internal\r\n\t */\r\n\tdescription: string;\r\n\t/**\r\n\t * Customize the growing behavior of the decoration when typing at the edges of the decoration.\r\n\t * Defaults to TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges\r\n\t */\r\n\tstickiness?: TrackedRangeStickiness;\r\n\t/**\r\n\t * CSS class name describing the decoration.\r\n\t */\r\n\tclassName?: string | null;\r\n\t/**\r\n\t * Indicates whether the decoration should span across the entire line when it continues onto the next line.\r\n\t */\r\n\tshouldFillLineOnLineBreak?: boolean | null;\r\n\tblockClassName?: string | null;\r\n\t/**\r\n\t * Indicates if this block should be rendered after the last line.\r\n\t * In this case, the range must be empty and set to the last line.\r\n\t */\r\n\tblockIsAfterEnd?: boolean | null;\r\n\tblockDoesNotCollapse?: boolean | null;\r\n\tblockPadding?: [top: number, right: number, bottom: number, left: number] | null;\r\n\r\n\t/**\r\n\t * Message to be rendered when hovering over the glyph margin decoration.\r\n\t */\r\n\tglyphMarginHoverMessage?: IMarkdownString | IMarkdownString[] | null;\r\n\t/**\r\n\t * Array of MarkdownString to render as the decoration message.\r\n\t */\r\n\thoverMessage?: IMarkdownString | IMarkdownString[] | null;\r\n\t/**\r\n\t * Should the decoration expand to encompass a whole line.\r\n\t */\r\n\tisWholeLine?: boolean;\r\n\t/**\r\n\t * Always render the decoration (even when the range it encompasses is collapsed).\r\n\t */\r\n\tshowIfCollapsed?: boolean;\r\n\t/**\r\n\t * Collapse the decoration if its entire range is being replaced via an edit.\r\n\t * @internal\r\n\t */\r\n\tcollapseOnReplaceEdit?: boolean;\r\n\t/**\r\n\t * Specifies the stack order of a decoration.\r\n\t * A decoration with greater stack order is always in front of a decoration with\r\n\t * a lower stack order when the decorations are on the same line.\r\n\t */\r\n\tzIndex?: number;\r\n\t/**\r\n\t * If set, render this decoration in the overview ruler.\r\n\t */\r\n\toverviewRuler?: IModelDecorationOverviewRulerOptions | null;\r\n\t/**\r\n\t * If set, render this decoration in the minimap.\r\n\t */\r\n\tminimap?: IModelDecorationMinimapOptions | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered in the glyph margin with this CSS class name.\r\n\t */\r\n\tglyphMarginClassName?: string | null;\r\n\t/**\r\n\t * If set and the decoration has {@link glyphMarginClassName} set, render this decoration\r\n\t * with the specified {@link IModelDecorationGlyphMarginOptions} in the glyph margin.\r\n\t */\r\n\tglyphMargin?: IModelDecorationGlyphMarginOptions | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered in the lines decorations with this CSS class name.\r\n\t */\r\n\tlinesDecorationsClassName?: string | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered in the lines decorations with this CSS class name, but only for the first line in case of line wrapping.\r\n\t */\r\n\tfirstLineDecorationClassName?: string | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered in the margin (covering its full width) with this CSS class name.\r\n\t */\r\n\tmarginClassName?: string | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered inline with the text with this CSS class name.\r\n\t * Please use this only for CSS rules that must impact the text. For example, use `className`\r\n\t * to have a background color decoration.\r\n\t */\r\n\tinlineClassName?: string | null;\r\n\t/**\r\n\t * If there is an `inlineClassName` which affects letter spacing.\r\n\t */\r\n\tinlineClassNameAffectsLetterSpacing?: boolean;\r\n\t/**\r\n\t * If set, the decoration will be rendered before the text with this CSS class name.\r\n\t */\r\n\tbeforeContentClassName?: string | null;\r\n\t/**\r\n\t * If set, the decoration will be rendered after the text with this CSS class name.\r\n\t */\r\n\tafterContentClassName?: string | null;\r\n\t/**\r\n\t * If set, text will be injected in the view after the range.\r\n\t */\r\n\tafter?: InjectedTextOptions | null;\r\n\r\n\t/**\r\n\t * If set, text will be injected in the view before the range.\r\n\t */\r\n\tbefore?: InjectedTextOptions | null;\r\n\r\n\t/**\r\n\t * If set, this decoration will not be rendered for comment tokens.\r\n\t * @internal\r\n\t*/\r\n\thideInCommentTokens?: boolean | null;\r\n\r\n\t/**\r\n\t * If set, this decoration will not be rendered for string tokens.\r\n\t * @internal\r\n\t*/\r\n\thideInStringTokens?: boolean | null;\r\n}\r\n\r\n/**\r\n * Configures text that is injected into the view without changing the underlying document.\r\n*/\r\nexport interface InjectedTextOptions {\r\n\t/**\r\n\t * Sets the text to inject. Must be a single line.\r\n\t */\r\n\treadonly content: string;\r\n\r\n\t/**\r\n\t * If set, the decoration will be rendered inline with the text with this CSS class name.\r\n\t */\r\n\treadonly inlineClassName?: string | null;\r\n\r\n\t/**\r\n\t * If there is an `inlineClassName` which affects letter spacing.\r\n\t */\r\n\treadonly inlineClassNameAffectsLetterSpacing?: boolean;\r\n\r\n\t/**\r\n\t * This field allows to attach data to this injected text.\r\n\t * The data can be read when injected texts at a given position are queried.\r\n\t */\r\n\treadonly attachedData?: unknown;\r\n\r\n\t/**\r\n\t * Configures cursor stops around injected text.\r\n\t * Defaults to {@link InjectedTextCursorStops.Both}.\r\n\t*/\r\n\treadonly cursorStops?: InjectedTextCursorStops | null;\r\n}\r\n\r\nexport enum InjectedTextCursorStops {\r\n\tBoth,\r\n\tRight,\r\n\tLeft,\r\n\tNone\r\n}\r\n\r\n/**\r\n * New model decorations.\r\n */\r\nexport interface IModelDeltaDecoration {\r\n\t/**\r\n\t * Range that this decoration covers.\r\n\t */\r\n\trange: IRange;\r\n\t/**\r\n\t * Options associated with this decoration.\r\n\t */\r\n\toptions: IModelDecorationOptions;\r\n}\r\n\r\n/**\r\n * A decoration in the model.\r\n */\r\nexport interface IModelDecoration {\r\n\t/**\r\n\t * Identifier for a decoration.\r\n\t */\r\n\treadonly id: string;\r\n\t/**\r\n\t * Identifier for a decoration's owner.\r\n\t */\r\n\treadonly ownerId: number;\r\n\t/**\r\n\t * Range that this decoration covers.\r\n\t */\r\n\treadonly range: Range;\r\n\t/**\r\n\t * Options associated with this decoration.\r\n\t */\r\n\treadonly options: IModelDecorationOptions;\r\n}\r\n\r\n/**\r\n * An accessor that can add, change or remove model decorations.\r\n * @internal\r\n */\r\nexport interface IModelDecorationsChangeAccessor {\r\n\t/**\r\n\t * Add a new decoration.\r\n\t * @param range Range that this decoration covers.\r\n\t * @param options Options associated with this decoration.\r\n\t * @return An unique identifier associated with this decoration.\r\n\t */\r\n\taddDecoration(range: IRange, options: IModelDecorationOptions): string;\r\n\t/**\r\n\t * Change the range that an existing decoration covers.\r\n\t * @param id The unique identifier associated with the decoration.\r\n\t * @param newRange The new range that this decoration covers.\r\n\t */\r\n\tchangeDecoration(id: string, newRange: IRange): void;\r\n\t/**\r\n\t * Change the options associated with an existing decoration.\r\n\t * @param id The unique identifier associated with the decoration.\r\n\t * @param newOptions The new options associated with this decoration.\r\n\t */\r\n\tchangeDecorationOptions(id: string, newOptions: IModelDecorationOptions): void;\r\n\t/**\r\n\t * Remove an existing decoration.\r\n\t * @param id The unique identifier associated with the decoration.\r\n\t */\r\n\tremoveDecoration(id: string): void;\r\n\t/**\r\n\t * Perform a minimum amount of operations, in order to transform the decorations\r\n\t * identified by `oldDecorations` to the decorations described by `newDecorations`\r\n\t * and returns the new identifiers associated with the resulting decorations.\r\n\t *\r\n\t * @param oldDecorations Array containing previous decorations identifiers.\r\n\t * @param newDecorations Array describing what decorations should result after the call.\r\n\t * @return An array containing the new decorations identifiers.\r\n\t */\r\n\tdeltaDecorations(oldDecorations: readonly string[], newDecorations: readonly IModelDeltaDecoration[]): string[];\r\n}\r\n\r\n/**\r\n * EOL character preference.\r\n *\r\n * `TextDefined` = 0, `LF` = 1, `CRLF` = 2\r\n */\r\nexport const enum EndOfLinePreference {\r\n\t/**\r\n\t * Use the end of line character identified in the text buffer.\r\n\t */\r\n\tTextDefined = 0,\r\n\t/**\r\n\t * Use line feed (\\n) as the end of line character.\r\n\t */\r\n\tLF = 1,\r\n\t/**\r\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n\t */\r\n\tCRLF = 2\r\n}\r\n\r\n/**\r\n * The default end of line to use when instantiating models.\r\n *\r\n * `LF` = 1, `CRLF` = 2\r\n */\r\nexport const enum DefaultEndOfLine {\r\n\t/**\r\n\t * Use line feed (\\n) as the end of line character.\r\n\t */\r\n\tLF = 1,\r\n\t/**\r\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n\t */\r\n\tCRLF = 2\r\n}\r\n\r\n/**\r\n * End of line character preference.\r\n *\r\n * `LF` = 0, `CRLF` = 1\r\n */\r\nexport const enum EndOfLineSequence {\r\n\t/**\r\n\t * Use line feed (\\n) as the end of line character.\r\n\t */\r\n\tLF = 0,\r\n\t/**\r\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\r\n\t */\r\n\tCRLF = 1\r\n}\r\n\r\n/**\r\n * An identifier for a single edit operation.\r\n * @internal\r\n */\r\nexport interface ISingleEditOperationIdentifier {\r\n\t/**\r\n\t * Identifier major\r\n\t */\r\n\tmajor: number;\r\n\t/**\r\n\t * Identifier minor\r\n\t */\r\n\tminor: number;\r\n}\r\n\r\n/**\r\n * A single edit operation, that has an identifier.\r\n */\r\nexport interface IIdentifiedSingleEditOperation extends ISingleEditOperation {\r\n\t/**\r\n\t * An identifier associated with this single edit operation.\r\n\t * @internal\r\n\t */\r\n\tidentifier?: ISingleEditOperationIdentifier | null;\r\n\t/**\r\n\t * This indicates that this operation is inserting automatic whitespace\r\n\t * that can be removed on next model edit operation if `config.trimAutoWhitespace` is true.\r\n\t * @internal\r\n\t */\r\n\tisAutoWhitespaceEdit?: boolean;\r\n\t/**\r\n\t * This indicates that this operation is in a set of operations that are tracked and should not be \"simplified\".\r\n\t * @internal\r\n\t */\r\n\t_isTracked?: boolean;\r\n}\r\n\r\nexport interface IValidEditOperation {\r\n\t/**\r\n\t * An identifier associated with this single edit operation.\r\n\t * @internal\r\n\t */\r\n\tidentifier: ISingleEditOperationIdentifier | null;\r\n\t/**\r\n\t * The range to replace. \\\r\n\t * This can be empty to emulate a simple insert.\r\n\t */\r\n\trange: Range;\r\n\t/**\r\n\t * The text to replace with. \\\r\n\t * This can be empty to emulate a simple delete.\r\n\t */\r\n\ttext: string;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\ttextChange: TextChange;\r\n}\r\n\r\n/**\r\n * A callback that can compute the cursor state after applying a series of edit operations.\r\n */\r\nexport interface ICursorStateComputer {\r\n\t/**\r\n\t * A callback that can compute the resulting cursors state after some edit operations have been executed.\r\n\t */\r\n\t(inverseEditOperations: IValidEditOperation[]): Selection[] | null;\r\n}\r\n\r\nexport class TextModelResolvedOptions {\r\n\t_textModelResolvedOptionsBrand: void = undefined;\r\n\r\n\treadonly tabSize: number;\r\n\treadonly indentSize: number;\r\n\tprivate readonly _indentSizeIsTabSize: boolean;\r\n\treadonly insertSpaces: boolean;\r\n\treadonly defaultEOL: DefaultEndOfLine;\r\n\treadonly trimAutoWhitespace: boolean;\r\n\treadonly bracketPairColorizationOptions: BracketPairColorizationOptions;\r\n\r\n\tpublic get originalIndentSize(): number | 'tabSize' {\r\n\t\treturn this._indentSizeIsTabSize ? 'tabSize' : this.indentSize;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tconstructor(src: {\r\n\t\ttabSize: number;\r\n\t\tindentSize: number | 'tabSize';\r\n\t\tinsertSpaces: boolean;\r\n\t\tdefaultEOL: DefaultEndOfLine;\r\n\t\ttrimAutoWhitespace: boolean;\r\n\t\tbracketPairColorizationOptions: BracketPairColorizationOptions;\r\n\t}) {\r\n\t\tthis.tabSize = Math.max(1, src.tabSize | 0);\r\n\t\tif (src.indentSize === 'tabSize') {\r\n\t\t\tthis.indentSize = this.tabSize;\r\n\t\t\tthis._indentSizeIsTabSize = true;\r\n\t\t} else {\r\n\t\t\tthis.indentSize = Math.max(1, src.indentSize | 0);\r\n\t\t\tthis._indentSizeIsTabSize = false;\r\n\t\t}\r\n\t\tthis.insertSpaces = Boolean(src.insertSpaces);\r\n\t\tthis.defaultEOL = src.defaultEOL | 0;\r\n\t\tthis.trimAutoWhitespace = Boolean(src.trimAutoWhitespace);\r\n\t\tthis.bracketPairColorizationOptions = src.bracketPairColorizationOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tpublic equals(other: TextModelResolvedOptions): boolean {\r\n\t\treturn (\r\n\t\t\tthis.tabSize === other.tabSize\r\n\t\t\t&& this._indentSizeIsTabSize === other._indentSizeIsTabSize\r\n\t\t\t&& this.indentSize === other.indentSize\r\n\t\t\t&& this.insertSpaces === other.insertSpaces\r\n\t\t\t&& this.defaultEOL === other.defaultEOL\r\n\t\t\t&& this.trimAutoWhitespace === other.trimAutoWhitespace\r\n\t\t\t&& equals(this.bracketPairColorizationOptions, other.bracketPairColorizationOptions)\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tpublic createChangeEvent(newOpts: TextModelResolvedOptions): IModelOptionsChangedEvent {\r\n\t\treturn {\r\n\t\t\ttabSize: this.tabSize !== newOpts.tabSize,\r\n\t\t\tindentSize: this.indentSize !== newOpts.indentSize,\r\n\t\t\tinsertSpaces: this.insertSpaces !== newOpts.insertSpaces,\r\n\t\t\ttrimAutoWhitespace: this.trimAutoWhitespace !== newOpts.trimAutoWhitespace,\r\n\t\t};\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITextModelCreationOptions {\r\n\ttabSize: number;\r\n\tindentSize: number | 'tabSize';\r\n\tinsertSpaces: boolean;\r\n\tdetectIndentation: boolean;\r\n\ttrimAutoWhitespace: boolean;\r\n\tdefaultEOL: DefaultEndOfLine;\r\n\tisForSimpleWidget: boolean;\r\n\tlargeFileOptimizations: boolean;\r\n\tbracketPairColorizationOptions: BracketPairColorizationOptions;\r\n}\r\n\r\nexport interface BracketPairColorizationOptions {\r\n\tenabled: boolean;\r\n\tindependentColorPoolPerBracketType: boolean;\r\n}\r\n\r\nexport interface ITextModelUpdateOptions {\r\n\ttabSize?: number;\r\n\tindentSize?: number | 'tabSize';\r\n\tinsertSpaces?: boolean;\r\n\ttrimAutoWhitespace?: boolean;\r\n\tbracketColorizationOptions?: BracketPairColorizationOptions;\r\n}\r\n/**\r\n *  \\\r\n * -`_findMatchBrand`: void = undefined \\\r\n * -public readonly `range`: Range \\\r\n * -public readonly `matches`: string[] | null\r\n */\r\nexport class FindMatch {\r\n\t_findMatchBrand: void = undefined;\r\n\r\n\tpublic readonly range: Range;\r\n\tpublic readonly matches: string[] | null;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tconstructor(range: Range, matches: string[] | null) {\r\n\t\tthis.range = range;\r\n\t\tthis.matches = matches;\r\n\t}\r\n}\r\n\r\n/**\r\n * Describes the behavior of decorations when typing/editing near their edges.\r\n * Note: Please do not edit the values, as they very carefully match `DecorationRangeBehavior`\r\n */\r\nexport const enum TrackedRangeStickiness {\r\n\tAlwaysGrowsWhenTypingAtEdges = 0,\r\n\tNeverGrowsWhenTypingAtEdges = 1,\r\n\tGrowsOnlyWhenTypingBefore = 2,\r\n\tGrowsOnlyWhenTypingAfter = 3,\r\n}\r\n\r\n/**\r\n * Text snapshot that works like an iterator.\r\n * Will try to return chunks of roughly ~64KB size.\r\n * Will return null when finished.\r\n */\r\nexport interface ITextSnapshot {\r\n\tread(): string | null;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function isITextSnapshot(obj: any): obj is ITextSnapshot {\r\n\treturn (obj && typeof obj.read === 'function');\r\n}\r\n\r\n/**\r\n *  (A model)\r\n */\r\nexport interface ITextModel {\r\n\r\n\t/**\r\n\t * Gets the resource associated with this editor model.\r\n\t */\r\n\treadonly uri: URI;\r\n\r\n\t/**\r\n\t * A unique identifier associated with this model.\r\n\t */\r\n\treadonly id: string;\r\n\r\n\t/**\r\n\t * This model is constructed for a simple widget code editor.\r\n\t * @internal\r\n\t */\r\n\treadonly isForSimpleWidget: boolean;\r\n\r\n\t/**\r\n\t * If true, the text model might contain RTL.\r\n\t * If false, the text model **contains only** contain LTR.\r\n\t * @internal\r\n\t */\r\n\tmightContainRTL(): boolean;\r\n\r\n\t/**\r\n\t * If true, the text model might contain LINE SEPARATOR (LS), PARAGRAPH SEPARATOR (PS).\r\n\t * If false, the text model definitely does not contain these.\r\n\t * @internal\r\n\t */\r\n\tmightContainUnusualLineTerminators(): boolean;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tremoveUnusualLineTerminators(selections?: Selection[]): void;\r\n\r\n\t/**\r\n\t * If true, the text model might contain non basic ASCII.\r\n\t * If false, the text model **contains only** basic ASCII.\r\n\t * @internal\r\n\t */\r\n\tmightContainNonBasicASCII(): boolean;\r\n\r\n\t/**\r\n\t * Get the resolved options for this model.\r\n\t */\r\n\tgetOptions(): TextModelResolvedOptions;\r\n\r\n\t/**\r\n\t * Get the formatting options for this model.\r\n\t * @internal\r\n\t */\r\n\tgetFormattingOptions(): FormattingOptions;\r\n\r\n\t/**\r\n\t * Get the current version id of the model.\r\n\t * Anytime a change happens to the model (even undo/redo),\r\n\t * the version id is incremented.\r\n\t */\r\n\tgetVersionId(): number;\r\n\r\n\t/**\r\n\t * Get the alternative version id of the model.\r\n\t * This alternative version id is not always incremented,\r\n\t * it will return the same values in the case of undo-redo.\r\n\t */\r\n\tgetAlternativeVersionId(): number;\r\n\r\n\t/**\r\n\t * Replace the entire text buffer value contained in this model.\r\n\t */\r\n\tsetValue(newValue: string | ITextSnapshot): void;\r\n\r\n\t/**\r\n\t * Get the text stored in this model.\r\n\t * @param eol The end of line character preference. Defaults to `EndOfLinePreference.TextDefined`.\r\n\t * @param preserverBOM Preserve a BOM character if it was detected when the model was constructed.\r\n\t * @return The text.\r\n\t */\r\n\tgetValue(eol?: EndOfLinePreference, preserveBOM?: boolean): string;\r\n\r\n\t/**\r\n\t * Get the text stored in this model.\r\n\t * @param preserverBOM Preserve a BOM character if it was detected when the model was constructed.\r\n\t * @return The text snapshot (it is safe to consume it asynchronously).\r\n\t */\r\n\tcreateSnapshot(preserveBOM?: boolean): ITextSnapshot;\r\n\r\n\t/**\r\n\t * Get the length of the text stored in this model.\r\n\t */\r\n\tgetValueLength(eol?: EndOfLinePreference, preserveBOM?: boolean): number;\r\n\r\n\t/**\r\n\t * Get the text in a certain range.\r\n\t * @param range The range describing what text to get.\r\n\t * @param eol The end of line character preference. This will only be used for multiline ranges. Defaults to `EndOfLinePreference.TextDefined`.\r\n\t * @return The text.\r\n\t */\r\n\tgetValueInRange(range: IRange, eol?: EndOfLinePreference): string;\r\n\r\n\t/**\r\n\t * Get the length of text in a certain range.\r\n\t * @param range The range describing what text length to get.\r\n\t * @return The text length.\r\n\t */\r\n\tgetValueLengthInRange(range: IRange, eol?: EndOfLinePreference): number;\r\n\r\n\t/**\r\n\t * Get the character count of text in a certain range.\r\n\t * @param range The range describing what text length to get.\r\n\t */\r\n\tgetCharacterCountInRange(range: IRange, eol?: EndOfLinePreference): number;\r\n\r\n\t/**\r\n\t * Splits characters in two buckets. First bucket (A) is of characters that\r\n\t * sit in lines with length < `LONG_LINE_BOUNDARY`. Second bucket (B) is of\r\n\t * characters that sit in lines with length >= `LONG_LINE_BOUNDARY`.\r\n\t * If count(B) > count(A) return true. Returns false otherwise.\r\n\t * @internal\r\n\t */\r\n\tisDominatedByLongLines(): boolean;\r\n\r\n\t/**\r\n\t * Get the number of lines in the model.\r\n\t */\r\n\tgetLineCount(): number;\r\n\r\n\t/**\r\n\t * Get the text for a certain line.\r\n\t */\r\n\tgetLineContent(lineNumber: number): string;\r\n\r\n\t/**\r\n\t * Get the text length for a certain line.\r\n\t */\r\n\tgetLineLength(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Get the text for all lines.\r\n\t */\r\n\tgetLinesContent(): string[];\r\n\r\n\t/**\r\n\t * Get the end of line sequence predominantly used in the text buffer.\r\n\t * @return EOL char sequence (e.g.: '\\n' or '\\r\\n').\r\n\t */\r\n\tgetEOL(): string;\r\n\r\n\t/**\r\n\t * Get the end of line sequence predominantly used in the text buffer.\r\n\t */\r\n\tgetEndOfLineSequence(): EndOfLineSequence;\r\n\r\n\t/**\r\n\t * Get the minimum legal column for line at `lineNumber`\r\n\t */\r\n\tgetLineMinColumn(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Get the maximum legal column for line at `lineNumber`\r\n\t */\r\n\tgetLineMaxColumn(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Returns the column before the first non whitespace character for line at `lineNumber`.\r\n\t * Returns 0 if line is empty or contains only whitespace.\r\n\t */\r\n\tgetLineFirstNonWhitespaceColumn(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Returns the column after the last non whitespace character for line at `lineNumber`.\r\n\t * Returns 0 if line is empty or contains only whitespace.\r\n\t */\r\n\tgetLineLastNonWhitespaceColumn(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Create a valid position.\r\n\t */\r\n\tvalidatePosition(position: IPosition): Position;\r\n\r\n\t/**\r\n\t * Advances the given position by the given offset (negative offsets are also accepted)\r\n\t * and returns it as a new valid position.\r\n\t *\r\n\t * If the offset and position are such that their combination goes beyond the beginning or\r\n\t * end of the model, throws an exception.\r\n\t *\r\n\t * If the offset is such that the new position would be in the middle of a multi-byte\r\n\t * line terminator, throws an exception.\r\n\t */\r\n\tmodifyPosition(position: IPosition, offset: number): Position;\r\n\r\n\t/**\r\n\t * Create a valid range.\r\n\t */\r\n\tvalidateRange(range: IRange): Range;\r\n\r\n\t/**\r\n\t * Converts the position to a zero-based offset.\r\n\t *\r\n\t * The position will be [adjusted](#TextDocument.validatePosition).\r\n\t *\r\n\t * @param position A position.\r\n\t * @return A valid zero-based offset.\r\n\t */\r\n\tgetOffsetAt(position: IPosition): number;\r\n\r\n\t/**\r\n\t * Converts a zero-based offset to a position.\r\n\t *\r\n\t * @param offset A zero-based offset.\r\n\t * @return A valid [position](#Position).\r\n\t */\r\n\tgetPositionAt(offset: number): Position;\r\n\r\n\t/**\r\n\t * Get a range covering the entire model.\r\n\t */\r\n\tgetFullModelRange(): Range;\r\n\r\n\t/**\r\n\t * Returns if the model was disposed or not.\r\n\t */\r\n\tisDisposed(): boolean;\r\n\r\n\t/**\r\n\t * This model is so large that it would not be a good idea to sync it over\r\n\t * to web workers or other places.\r\n\t * @internal\r\n\t */\r\n\tisTooLargeForSyncing(): boolean;\r\n\r\n\t/**\r\n\t * The file is so large, that even tokenization is disabled.\r\n\t * @internal\r\n\t */\r\n\tisTooLargeForTokenization(): boolean;\r\n\r\n\t/**\r\n\t * Search the model.\r\n\t * @param searchString The string used to search. If it is a regular expression, set `isRegex` to true.\r\n\t * @param searchOnlyEditableRange Limit the searching to only search inside the editable range of the model.\r\n\t * @param isRegex Used to indicate that `searchString` is a regular expression.\r\n\t * @param matchCase Force the matching to match lower/upper case exactly.\r\n\t * @param wordSeparators Force the matching to match entire words only. Pass null otherwise.\r\n\t * @param captureMatches The result will contain the captured groups.\r\n\t * @param limitResultCount Limit the number of results\r\n\t * @return The ranges where the matches are. It is empty if not matches have been found.\r\n\t */\r\n\tfindMatches(searchString: string, searchOnlyEditableRange: boolean, isRegex: boolean, matchCase: boolean, wordSeparators: string | null, captureMatches: boolean, limitResultCount?: number): FindMatch[];\r\n\t/**\r\n\t * Search the model.\r\n\t * @param searchString The string used to search. If it is a regular expression, set `isRegex` to true.\r\n\t * @param searchScope Limit the searching to only search inside these ranges.\r\n\t * @param isRegex Used to indicate that `searchString` is a regular expression.\r\n\t * @param matchCase Force the matching to match lower/upper case exactly.\r\n\t * @param wordSeparators Force the matching to match entire words only. Pass null otherwise.\r\n\t * @param captureMatches The result will contain the captured groups.\r\n\t * @param limitResultCount Limit the number of results\r\n\t * @return The ranges where the matches are. It is empty if no matches have been found.\r\n\t */\r\n\tfindMatches(searchString: string, searchScope: IRange | IRange[], isRegex: boolean, matchCase: boolean, wordSeparators: string | null, captureMatches: boolean, limitResultCount?: number): FindMatch[];\r\n\t/**\r\n\t * Search the model for the next match. Loops to the beginning of the model if needed.\r\n\t * @param searchString The string used to search. If it is a regular expression, set `isRegex` to true.\r\n\t * @param searchStart Start the searching at the specified position.\r\n\t * @param isRegex Used to indicate that `searchString` is a regular expression.\r\n\t * @param matchCase Force the matching to match lower/upper case exactly.\r\n\t * @param wordSeparators Force the matching to match entire words only. Pass null otherwise.\r\n\t * @param captureMatches The result will contain the captured groups.\r\n\t * @return The range where the next match is. It is null if no next match has been found.\r\n\t */\r\n\tfindNextMatch(searchString: string, searchStart: IPosition, isRegex: boolean, matchCase: boolean, wordSeparators: string | null, captureMatches: boolean): FindMatch | null;\r\n\t/**\r\n\t * Search the model for the previous match. Loops to the end of the model if needed.\r\n\t * @param searchString The string used to search. If it is a regular expression, set `isRegex` to true.\r\n\t * @param searchStart Start the searching at the specified position.\r\n\t * @param isRegex Used to indicate that `searchString` is a regular expression.\r\n\t * @param matchCase Force the matching to match lower/upper case exactly.\r\n\t * @param wordSeparators Force the matching to match entire words only. Pass null otherwise.\r\n\t * @param captureMatches The result will contain the captured groups.\r\n\t * @return The range where the previous match is. It is null if no previous match has been found.\r\n\t */\r\n\tfindPreviousMatch(searchString: string, searchStart: IPosition, isRegex: boolean, matchCase: boolean, wordSeparators: string | null, captureMatches: boolean): FindMatch | null;\r\n\r\n\r\n\t/**\r\n\t * Get the language associated with this model.\r\n\t */\r\n\tgetLanguageId(): string;\r\n\r\n\t/**\r\n\t * Set the current language mode associated with the model.\r\n\t * @param languageId The new language.\r\n\t * @param source The source of the call that set the language.\r\n\t * @internal\r\n\t */\r\n\tsetLanguage(languageId: string, source?: string): void;\r\n\r\n\t/**\r\n\t * Set the current language mode associated with the model.\r\n\t * @param languageSelection The new language selection.\r\n\t * @param source The source of the call that set the language.\r\n\t * @internal\r\n\t */\r\n\tsetLanguage(languageSelection: ILanguageSelection, source?: string): void;\r\n\r\n\t/**\r\n\t * Returns the real (inner-most) language mode at a given position.\r\n\t * The result might be inaccurate. Use `forceTokenization` to ensure accurate tokens.\r\n\t * @internal\r\n\t */\r\n\tgetLanguageIdAtPosition(lineNumber: number, column: number): string;\r\n\r\n\t/**\r\n\t * Get the word under or besides `position`.\r\n\t * @param position The position to look for a word.\r\n\t * @return The word under or besides `position`. Might be null.\r\n\t */\r\n\tgetWordAtPosition(position: IPosition): IWordAtPosition | null;\r\n\r\n\t/**\r\n\t * Get the word under or besides `position` trimmed to `position`.column\r\n\t * @param position The position to look for a word.\r\n\t * @return The word under or besides `position`. Will never be null.\r\n\t */\r\n\tgetWordUntilPosition(position: IPosition): IWordAtPosition;\r\n\r\n\t/**\r\n\t * Change the decorations. The callback will be called with a change accessor\r\n\t * that becomes invalid as soon as the callback finishes executing.\r\n\t * This allows for all events to be queued up until the change\r\n\t * is completed. Returns whatever the callback returns.\r\n\t * @param ownerId Identifies the editor id in which these decorations should appear. If no `ownerId` is provided, the decorations will appear in all editors that attach this model.\r\n\t * @internal\r\n\t */\r\n\tchangeDecorations<T>(callback: (changeAccessor: IModelDecorationsChangeAccessor) => T, ownerId?: number): T | null;\r\n\r\n\t/**\r\n\t * Perform a minimum amount of operations, in order to transform the decorations\r\n\t * identified by `oldDecorations` to the decorations described by `newDecorations`\r\n\t * and returns the new identifiers associated with the resulting decorations.\r\n\t *\r\n\t * @param oldDecorations Array containing previous decorations identifiers.\r\n\t * @param newDecorations Array describing what decorations should result after the call.\r\n\t * @param ownerId Identifies the editor id in which these decorations should appear. If no `ownerId` is provided, the decorations will appear in all editors that attach this model.\r\n\t * @return An array containing the new decorations identifiers.\r\n\t */\r\n\tdeltaDecorations(oldDecorations: string[], newDecorations: IModelDeltaDecoration[], ownerId?: number): string[];\r\n\r\n\t/**\r\n\t * Remove all decorations that have been added with this specific ownerId.\r\n\t * @param ownerId The owner id to search for.\r\n\t * @internal\r\n\t */\r\n\tremoveAllDecorationsWithOwnerId(ownerId: number): void;\r\n\r\n\t/**\r\n\t * Get the options associated with a decoration.\r\n\t * @param id The decoration id.\r\n\t * @return The decoration options or null if the decoration was not found.\r\n\t */\r\n\tgetDecorationOptions(id: string): IModelDecorationOptions | null;\r\n\r\n\t/**\r\n\t * Get the range associated with a decoration.\r\n\t * @param id The decoration id.\r\n\t * @return The decoration range or null if the decoration was not found.\r\n\t */\r\n\tgetDecorationRange(id: string): Range | null;\r\n\r\n\t/**\r\n\t * Gets all the decorations for the line `lineNumber` as an array.\r\n\t * @param lineNumber The line number\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t * @param filterOutValidation If set, it will ignore decorations specific to validation (i.e. warnings, errors).\r\n\t * @return An array with the decorations\r\n\t */\r\n\tgetLineDecorations(lineNumber: number, ownerId?: number, filterOutValidation?: boolean): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all the decorations for the lines between `startLineNumber` and `endLineNumber` as an array.\r\n\t * @param startLineNumber The start line number\r\n\t * @param endLineNumber The end line number\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t * @param filterOutValidation If set, it will ignore decorations specific to validation (i.e. warnings, errors).\r\n\t * @return An array with the decorations\r\n\t */\r\n\tgetLinesDecorations(startLineNumber: number, endLineNumber: number, ownerId?: number, filterOutValidation?: boolean): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all the decorations in a range as an array. Only `startLineNumber` and `endLineNumber` from `range` are used for filtering.\r\n\t * So for now it returns all the decorations on the same line as `range`.\r\n\t * @param range The range to search in\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t * @param filterOutValidation If set, it will ignore decorations specific to validation (i.e. warnings, errors).\r\n\t * @param onlyMinimapDecorations If set, it will return only decorations that render in the minimap.\r\n\t * @param onlyMarginDecorations If set, it will return only decorations that render in the glyph margin.\r\n\t * @return An array with the decorations\r\n\t */\r\n\tgetDecorationsInRange(range: IRange, ownerId?: number, filterOutValidation?: boolean, onlyMinimapDecorations?: boolean, onlyMarginDecorations?: boolean): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all the decorations as an array.\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t * @param filterOutValidation If set, it will ignore decorations specific to validation (i.e. warnings, errors).\r\n\t */\r\n\tgetAllDecorations(ownerId?: number, filterOutValidation?: boolean): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all decorations that render in the glyph margin as an array.\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t */\r\n\tgetAllMarginDecorations(ownerId?: number): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all the decorations that should be rendered in the overview ruler as an array.\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t * @param filterOutValidation If set, it will ignore decorations specific to validation (i.e. warnings, errors).\r\n\t */\r\n\tgetOverviewRulerDecorations(ownerId?: number, filterOutValidation?: boolean): IModelDecoration[];\r\n\r\n\t/**\r\n\t * Gets all the decorations that contain injected text.\r\n\t * @param ownerId If set, it will ignore decorations belonging to other owners.\r\n\t */\r\n\tgetInjectedTextDecorations(ownerId?: number): IModelDecoration[];\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_getTrackedRange(id: string): Range | null;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_setTrackedRange(id: string | null, newRange: null, newStickiness: TrackedRangeStickiness): null;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_setTrackedRange(id: string | null, newRange: Range, newStickiness: TrackedRangeStickiness): string;\r\n\r\n\t/**\r\n\t * Normalize a string containing whitespace according to indentation rules (converts to spaces or to tabs).\r\n\t */\r\n\tnormalizeIndentation(str: string): string;\r\n\r\n\t/**\r\n\t * Change the options of this model.\r\n\t */\r\n\tupdateOptions(newOpts: ITextModelUpdateOptions): void;\r\n\r\n\t/**\r\n\t * Detect the indentation options for this model from its content.\r\n\t */\r\n\tdetectIndentation(defaultInsertSpaces: boolean, defaultTabSize: number): void;\r\n\r\n\t/**\r\n\t * Close the current undo-redo element.\r\n\t * This offers a way to create an undo/redo stop point.\r\n\t */\r\n\tpushStackElement(): void;\r\n\r\n\t/**\r\n\t * Open the current undo-redo element.\r\n\t * This offers a way to remove the current undo/redo stop point.\r\n\t */\r\n\tpopStackElement(): void;\r\n\r\n\t/**\r\n\t * Push edit operations, basically editing the model. This is the preferred way\r\n\t * of editing the model. The edit operations will land on the undo stack.\r\n\t * @param beforeCursorState The cursor state before the edit operations. This cursor state will be returned when `undo` or `redo` are invoked.\r\n\t * @param editOperations The edit operations.\r\n\t * @param cursorStateComputer A callback that can compute the resulting cursors state after the edit operations have been executed.\r\n\t * @return The cursor state returned by the `cursorStateComputer`.\r\n\t */\r\n\tpushEditOperations(beforeCursorState: Selection[] | null, editOperations: IIdentifiedSingleEditOperation[], cursorStateComputer: ICursorStateComputer): Selection[] | null;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tpushEditOperations(beforeCursorState: Selection[] | null, editOperations: IIdentifiedSingleEditOperation[], cursorStateComputer: ICursorStateComputer, group?: UndoRedoGroup): Selection[] | null;\r\n\r\n\t/**\r\n\t * Change the end of line sequence. This is the preferred way of\r\n\t * changing the eol sequence. This will land on the undo stack.\r\n\t */\r\n\tpushEOL(eol: EndOfLineSequence): void;\r\n\r\n\t/**\r\n\t * Edit the model without adding the edits to the undo stack.\r\n\t * This can have dire consequences on the undo stack! See @pushEditOperations for the preferred way.\r\n\t * @param operations The edit operations.\r\n\t * @return If desired, the inverse edit operations, that, when applied, will bring the model back to the previous state.\r\n\t */\r\n\tapplyEdits(operations: IIdentifiedSingleEditOperation[]): void;\r\n\tapplyEdits(operations: IIdentifiedSingleEditOperation[], computeUndoEdits: false): void;\r\n\tapplyEdits(operations: IIdentifiedSingleEditOperation[], computeUndoEdits: true): IValidEditOperation[];\r\n\r\n\t/**\r\n\t * Change the end of line sequence without recording in the undo stack.\r\n\t * This can have dire consequences on the undo stack! See @pushEOL for the preferred way.\r\n\t */\r\n\tsetEOL(eol: EndOfLineSequence): void;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_applyUndo(changes: TextChange[], eol: EndOfLineSequence, resultingAlternativeVersionId: number, resultingSelection: Selection[] | null): void;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_applyRedo(changes: TextChange[], eol: EndOfLineSequence, resultingAlternativeVersionId: number, resultingSelection: Selection[] | null): void;\r\n\r\n\t/**\r\n\t * Undo edit operations until the previous undo/redo point.\r\n\t * The inverse edit operations will be pushed on the redo stack.\r\n\t * @internal\r\n\t */\r\n\tundo(): void | Promise<void>;\r\n\r\n\t/**\r\n\t * Is there anything in the undo stack?\r\n\t * @internal\r\n\t */\r\n\tcanUndo(): boolean;\r\n\r\n\t/**\r\n\t * Redo edit operations until the next undo/redo point.\r\n\t * The inverse edit operations will be pushed on the undo stack.\r\n\t * @internal\r\n\t */\r\n\tredo(): void | Promise<void>;\r\n\r\n\t/**\r\n\t * Is there anything in the redo stack?\r\n\t * @internal\r\n\t */\r\n\tcanRedo(): boolean;\r\n\r\n\t/**\r\n\t * @deprecated Please use `onDidChangeContent` instead.\r\n\t * An event emitted when the contents of the model have changed.\r\n\t * @internal\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeContentOrInjectedText: Event<InternalModelContentChangeEvent | ModelInjectedTextChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the contents of the model have changed.\r\n\t * @event\r\n\t */\r\n\tonDidChangeContent(listener: (e: IModelContentChangedEvent) => void): IDisposable;\r\n\t/**\r\n\t * An event emitted when decorations of the model have changed.\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeDecorations: Event<IModelDecorationsChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the model options have changed.\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeOptions: Event<IModelOptionsChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the language associated with the model has changed.\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeLanguage: Event<IModelLanguageChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the language configuration associated with the model has changed.\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeLanguageConfiguration: Event<IModelLanguageConfigurationChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the tokens associated with the model have changed.\r\n\t * @event\r\n\t * @internal\r\n\t */\r\n\treadonly onDidChangeTokens: Event<IModelTokensChangedEvent>;\r\n\t/**\r\n\t * An event emitted when the model has been attached to the first editor or detached from the last editor.\r\n\t * @event\r\n\t */\r\n\treadonly onDidChangeAttached: Event<void>;\r\n\t/**\r\n\t * An event emitted right before disposing the model.\r\n\t * @event\r\n\t */\r\n\treadonly onWillDispose: Event<void>;\r\n\r\n\t/**\r\n\t * Destroy this model.\r\n\t */\r\n\tdispose(): void;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tonBeforeAttached(): IAttachedView;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tonBeforeDetached(view: IAttachedView): void;\r\n\r\n\t/**\r\n\t * Returns if this model is attached to an editor or not.\r\n\t */\r\n\tisAttachedToEditor(): boolean;\r\n\r\n\t/**\r\n\t * Returns the count of editors this model is attached to.\r\n\t * @internal\r\n\t */\r\n\tgetAttachedEditorCount(): number;\r\n\r\n\t/**\r\n\t * Among all positions that are projected to the same position in the underlying text model as\r\n\t * the given position, select a unique position as indicated by the affinity.\r\n\t *\r\n\t * PositionAffinity.Left:\r\n\t * The normalized position must be equal or left to the requested position.\r\n\t *\r\n\t * PositionAffinity.Right:\r\n\t * The normalized position must be equal or right to the requested position.\r\n\t *\r\n\t * @internal\r\n\t */\r\n\tnormalizePosition(position: Position, affinity: PositionAffinity): Position;\r\n\r\n\t/**\r\n\t * Gets the column at which indentation stops at a given line.\r\n\t * @internal\r\n\t*/\r\n\tgetLineIndentColumn(lineNumber: number): number;\r\n\r\n\t/**\r\n\t * Returns an object that can be used to query brackets.\r\n\t * @internal\r\n\t*/\r\n\treadonly bracketPairs: IBracketPairsTextModelPart;\r\n\r\n\t/**\r\n\t * Returns an object that can be used to query indent guides.\r\n\t * @internal\r\n\t*/\r\n\treadonly guides: IGuidesTextModelPart;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\treadonly tokenization: ITokenizationTextModelPart;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IAttachedView {\r\n\t/**\r\n\t * @param stabilized Indicates if the visible lines are probably going to change soon or can be considered stable.\r\n\t * Is true on reveal range and false on scroll.\r\n\t * Tokenizers should tokenize synchronously if stabilized is true.\r\n\t */\r\n\tsetVisibleLines(visibleLines: { startLineNumber: number; endLineNumber: number }[], stabilized: boolean): void;\r\n}\r\n\r\nexport const enum PositionAffinity {\r\n\t/**\r\n\t * Prefers the left most position.\r\n\t*/\r\n\tLeft = 0,\r\n\r\n\t/**\r\n\t * Prefers the right most position.\r\n\t*/\r\n\tRight = 1,\r\n\r\n\t/**\r\n\t * No preference.\r\n\t*/\r\n\tNone = 2,\r\n\r\n\t/**\r\n\t * If the given position is on injected text, prefers the position left of it.\r\n\t*/\r\n\tLeftOfInjectedText = 3,\r\n\r\n\t/**\r\n\t * If the given position is on injected text, prefers the position right of it.\r\n\t*/\r\n\tRightOfInjectedText = 4,\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITextBufferBuilder {\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITextBufferFactory {\r\n\tcreate(defaultEOL: DefaultEndOfLine): { textBuffer: ITextBuffer; disposable: IDisposable };\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class ValidAnnotatedEditOperation implements IIdentifiedSingleEditOperation {\r\n\tconstructor(\r\n\t\tpublic readonly identifier: ISingleEditOperationIdentifier | null,\r\n\t\tpublic readonly range: Range,\r\n\t\tpublic readonly text: string | null,\r\n\t\tpublic readonly forceMoveMarkers: boolean,\r\n\t\tpublic readonly isAutoWhitespaceEdit: boolean,\r\n\t\tpublic readonly _isTracked: boolean,\r\n\t) { }\r\n}\r\n\r\n/**\r\n * @internal\r\n *\r\n *    \\\r\n * `lineNumber` is 1 based.\r\n */\r\nexport interface IReadonlyTextBuffer {\r\n\tmightContainRTL(): boolean;\r\n\tmightContainUnusualLineTerminators(): boolean;\r\n\tresetMightContainUnusualLineTerminators(): void;\r\n\tmightContainNonBasicASCII(): boolean;\r\n\tgetBOM(): string;\r\n\tgetEOL(): string;\r\n\r\n\tgetOffsetAt(lineNumber: number, column: number): number;\r\n\tgetPositionAt(offset: number): Position;\r\n\tgetRangeAt(offset: number, length: number): Range;\r\n\r\n\tgetValueInRange(range: Range, eol: EndOfLinePreference): string;\r\n\tcreateSnapshot(preserveBOM: boolean): ITextSnapshot;\r\n\tgetValueLengthInRange(range: Range, eol: EndOfLinePreference): number;\r\n\tgetCharacterCountInRange(range: Range, eol: EndOfLinePreference): number;\r\n\tgetLength(): number;\r\n\tgetLineCount(): number;\r\n\tgetLinesContent(): string[];\r\n\tgetLineContent(lineNumber: number): string;\r\n\tgetLineCharCode(lineNumber: number, index: number): number;\r\n\tgetLineLength(lineNumber: number): number;\r\n\tgetLineFirstNonWhitespaceColumn(lineNumber: number): number;\r\n\tgetLineLastNonWhitespaceColumn(lineNumber: number): number;\r\n\tfindMatchesLineByLine(searchRange: Range, searchData: SearchData, captureMatches: boolean, limitResultCount: number): FindMatch[];\r\n}\r\n\r\n/**\r\n * @internal\r\n *\r\n *  \r\n * -`regex`: RegExp -   \\\r\n * -`wordSeparators`: WordCharacterClassifier | null - \\\r\n * -`simpleSearch`: string | null -\r\n */\r\nexport class SearchData {\r\n\r\n\t/**\r\n\t *  \r\n\t */\r\n\tpublic readonly regex: RegExp;\r\n\t/**\r\n\t * The word separator classifier.\r\n\t */\r\n\tpublic readonly wordSeparators: WordCharacterClassifier | null;\r\n\t/**\r\n\t * The simple string to search for (if possible).\r\n\t */\r\n\tpublic readonly simpleSearch: string | null;\r\n\r\n\tconstructor(regex: RegExp, wordSeparators: WordCharacterClassifier | null, simpleSearch: string | null) {\r\n\t\tthis.regex = regex;\r\n\t\tthis.wordSeparators = wordSeparators;\r\n\t\tthis.simpleSearch = simpleSearch;\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n *\r\n *  \r\n */\r\nexport interface ITextBuffer extends IReadonlyTextBuffer {\r\n\tsetEOL(newEOL: '\\r\\n' | '\\n'): void;\r\n\tapplyEdits(rawOperations: ValidAnnotatedEditOperation[], recordTrimAutoWhitespace: boolean, computeUndoEdits: boolean): ApplyEditsResult;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class ApplyEditsResult {\r\n\r\n\tconstructor(\r\n\t\tpublic readonly reverseEdits: IValidEditOperation[] | null,\r\n\t\tpublic readonly changes: IInternalModelContentChange[],\r\n\t\tpublic readonly trimAutoWhitespaceLineNumbers: number[] | null\r\n\t) { }\r\n\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IInternalModelContentChange extends IModelContentChange {\r\n\trange: Range;\r\n\tforceMoveMarkers: boolean;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function shouldSynchronizeModel(model: ITextModel): boolean {\r\n\treturn (\r\n\t\t!model.isTooLargeForSyncing() && !model.isForSimpleWidget\r\n\t);\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { arrayInsert } from 'vs/base/common/arrays';\r\nimport { toUint32 } from 'vs/base/common/uint';\r\n\r\nexport class PrefixSumComputer {\r\n\r\n\t/**\r\n\t * values[i] is the value at index i\r\n\t */\r\n\tprivate values: Uint32Array;\r\n\r\n\t/**\r\n\t * prefixSum[i] = SUM(heights[j]), 0 <= j <= i\r\n\t */\r\n\tprivate prefixSum: Uint32Array;\r\n\r\n\t/**\r\n\t * prefixSum[i], 0 <= i <= prefixSumValidIndex can be trusted\r\n\t */\r\n\tprivate readonly prefixSumValidIndex: Int32Array;\r\n\r\n\tconstructor(values: Uint32Array) {\r\n\t\tthis.values = values;\r\n\t\tthis.prefixSum = new Uint32Array(values.length);\r\n\t\tthis.prefixSumValidIndex = new Int32Array(1);\r\n\t\tthis.prefixSumValidIndex[0] = -1;\r\n\t}\r\n\r\n\tpublic insertValues(insertIndex: number, insertValues: Uint32Array): boolean {\r\n\t\tinsertIndex = toUint32(insertIndex);\r\n\t\tconst oldValues = this.values;\r\n\t\tconst oldPrefixSum = this.prefixSum;\r\n\t\tconst insertValuesLen = insertValues.length;\r\n\r\n\t\tif (insertValuesLen === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.values = new Uint32Array(oldValues.length + insertValuesLen);\r\n\t\tthis.values.set(oldValues.subarray(0, insertIndex), 0);\r\n\t\tthis.values.set(oldValues.subarray(insertIndex), insertIndex + insertValuesLen);\r\n\t\tthis.values.set(insertValues, insertIndex);\r\n\r\n\t\tif (insertIndex - 1 < this.prefixSumValidIndex[0]) {\r\n\t\t\tthis.prefixSumValidIndex[0] = insertIndex - 1;\r\n\t\t}\r\n\r\n\t\tthis.prefixSum = new Uint32Array(this.values.length);\r\n\t\tif (this.prefixSumValidIndex[0] >= 0) {\r\n\t\t\tthis.prefixSum.set(oldPrefixSum.subarray(0, this.prefixSumValidIndex[0] + 1));\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic setValue(index: number, value: number): boolean {\r\n\t\tindex = toUint32(index);\r\n\t\tvalue = toUint32(value);\r\n\r\n\t\tif (this.values[index] === value) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.values[index] = value;\r\n\t\tif (index - 1 < this.prefixSumValidIndex[0]) {\r\n\t\t\tthis.prefixSumValidIndex[0] = index - 1;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic removeValues(startIndex: number, count: number): boolean {\r\n\t\tstartIndex = toUint32(startIndex);\r\n\t\tcount = toUint32(count);\r\n\r\n\t\tconst oldValues = this.values;\r\n\t\tconst oldPrefixSum = this.prefixSum;\r\n\r\n\t\tif (startIndex >= oldValues.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst maxCount = oldValues.length - startIndex;\r\n\t\tif (count >= maxCount) {\r\n\t\t\tcount = maxCount;\r\n\t\t}\r\n\r\n\t\tif (count === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.values = new Uint32Array(oldValues.length - count);\r\n\t\tthis.values.set(oldValues.subarray(0, startIndex), 0);\r\n\t\tthis.values.set(oldValues.subarray(startIndex + count), startIndex);\r\n\r\n\t\tthis.prefixSum = new Uint32Array(this.values.length);\r\n\t\tif (startIndex - 1 < this.prefixSumValidIndex[0]) {\r\n\t\t\tthis.prefixSumValidIndex[0] = startIndex - 1;\r\n\t\t}\r\n\t\tif (this.prefixSumValidIndex[0] >= 0) {\r\n\t\t\tthis.prefixSum.set(oldPrefixSum.subarray(0, this.prefixSumValidIndex[0] + 1));\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tpublic getTotalSum(): number {\r\n\t\tif (this.values.length === 0) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this._getPrefixSum(this.values.length - 1);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the sum of the first `index + 1` many items.\r\n\t * @returns `SUM(0 <= j <= index, values[j])`.\r\n\t */\r\n\tpublic getPrefixSum(index: number): number {\r\n\t\tif (index < 0) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tindex = toUint32(index);\r\n\t\treturn this._getPrefixSum(index);\r\n\t}\r\n\r\n\tprivate _getPrefixSum(index: number): number {\r\n\t\tif (index <= this.prefixSumValidIndex[0]) {\r\n\t\t\treturn this.prefixSum[index];\r\n\t\t}\r\n\r\n\t\tlet startIndex = this.prefixSumValidIndex[0] + 1;\r\n\t\tif (startIndex === 0) {\r\n\t\t\tthis.prefixSum[0] = this.values[0];\r\n\t\t\tstartIndex++;\r\n\t\t}\r\n\r\n\t\tif (index >= this.values.length) {\r\n\t\t\tindex = this.values.length - 1;\r\n\t\t}\r\n\r\n\t\tfor (let i = startIndex; i <= index; i++) {\r\n\t\t\tthis.prefixSum[i] = this.prefixSum[i - 1] + this.values[i];\r\n\t\t}\r\n\t\tthis.prefixSumValidIndex[0] = Math.max(this.prefixSumValidIndex[0], index);\r\n\t\treturn this.prefixSum[index];\r\n\t}\r\n\r\n\tpublic getIndexOf(sum: number): PrefixSumIndexOfResult {\r\n\t\tsum = Math.floor(sum);\r\n\r\n\t\t// Compute all sums (to get a fully valid prefixSum)\r\n\t\tthis.getTotalSum();\r\n\r\n\t\tlet low = 0;\r\n\t\tlet high = this.values.length - 1;\r\n\t\tlet mid = 0;\r\n\t\tlet midStop = 0;\r\n\t\tlet midStart = 0;\r\n\r\n\t\twhile (low <= high) {\r\n\t\t\tmid = low + ((high - low) / 2) | 0;\r\n\r\n\t\t\tmidStop = this.prefixSum[mid];\r\n\t\t\tmidStart = midStop - this.values[mid];\r\n\r\n\t\t\tif (sum < midStart) {\r\n\t\t\t\thigh = mid - 1;\r\n\t\t\t} else if (sum >= midStop) {\r\n\t\t\t\tlow = mid + 1;\r\n\t\t\t} else {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new PrefixSumIndexOfResult(mid, sum - midStart);\r\n\t}\r\n}\r\n\r\n/**\r\n * {@link getIndexOf} has an amortized runtime complexity of O(1).\r\n *\r\n * ({@link PrefixSumComputer.getIndexOf} is just  O(log n))\r\n*/\r\nexport class ConstantTimePrefixSumComputer {\r\n\tprivate _values: number[];\r\n\tprivate _isValid: boolean;\r\n\tprivate _validEndIndex: number;\r\n\r\n\t/**\r\n\t * _prefixSum[i] = SUM(values[j]), 0 <= j <= i\r\n\t */\r\n\tprivate _prefixSum: number[];\r\n\r\n\t/**\r\n\t * _indexBySum[sum] = idx => _prefixSum[idx - 1] <= sum < _prefixSum[idx]\r\n\t*/\r\n\tprivate _indexBySum: number[];\r\n\r\n\tconstructor(values: number[]) {\r\n\t\tthis._values = values;\r\n\t\tthis._isValid = false;\r\n\t\tthis._validEndIndex = -1;\r\n\t\tthis._prefixSum = [];\r\n\t\tthis._indexBySum = [];\r\n\t}\r\n\r\n\t/**\r\n\t * @returns SUM(0 <= j < values.length, values[j])\r\n\t */\r\n\tpublic getTotalSum(): number {\r\n\t\tthis._ensureValid();\r\n\t\treturn this._indexBySum.length;\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the sum of the first `count` many items.\r\n\t * @returns `SUM(0 <= j < count, values[j])`.\r\n\t */\r\n\tpublic getPrefixSum(count: number): number {\r\n\t\tthis._ensureValid();\r\n\t\tif (count === 0) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\treturn this._prefixSum[count - 1];\r\n\t}\r\n\r\n\t/**\r\n\t * @returns `result`, such that `getPrefixSum(result.index) + result.remainder = sum`\r\n\t */\r\n\tpublic getIndexOf(sum: number): PrefixSumIndexOfResult {\r\n\t\tthis._ensureValid();\r\n\t\tconst idx = this._indexBySum[sum];\r\n\t\tconst viewLinesAbove = idx > 0 ? this._prefixSum[idx - 1] : 0;\r\n\t\treturn new PrefixSumIndexOfResult(idx, sum - viewLinesAbove);\r\n\t}\r\n\r\n\tpublic removeValues(start: number, deleteCount: number): void {\r\n\t\tthis._values.splice(start, deleteCount);\r\n\t\tthis._invalidate(start);\r\n\t}\r\n\r\n\tpublic insertValues(insertIndex: number, insertArr: number[]): void {\r\n\t\tthis._values = arrayInsert(this._values, insertIndex, insertArr);\r\n\t\tthis._invalidate(insertIndex);\r\n\t}\r\n\r\n\tprivate _invalidate(index: number): void {\r\n\t\tthis._isValid = false;\r\n\t\tthis._validEndIndex = Math.min(this._validEndIndex, index - 1);\r\n\t}\r\n\r\n\tprivate _ensureValid(): void {\r\n\t\tif (this._isValid) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (let i = this._validEndIndex + 1, len = this._values.length; i < len; i++) {\r\n\t\t\tconst value = this._values[i];\r\n\t\t\tconst sumAbove = i > 0 ? this._prefixSum[i - 1] : 0;\r\n\r\n\t\t\tthis._prefixSum[i] = sumAbove + value;\r\n\t\t\tfor (let j = 0; j < value; j++) {\r\n\t\t\t\tthis._indexBySum[sumAbove + j] = i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// trim things\r\n\t\tthis._prefixSum.length = this._values.length;\r\n\t\tthis._indexBySum.length = this._prefixSum[this._prefixSum.length - 1];\r\n\r\n\t\t// mark as valid\r\n\t\tthis._isValid = true;\r\n\t\tthis._validEndIndex = this._values.length - 1;\r\n\t}\r\n\r\n\tpublic setValue(index: number, value: number): void {\r\n\t\tif (this._values[index] === value) {\r\n\t\t\t// no change\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._values[index] = value;\r\n\t\tthis._invalidate(index);\r\n\t}\r\n}\r\n\r\n\r\nexport class PrefixSumIndexOfResult {\r\n\t_prefixSumIndexOfResultBrand: void = undefined;\r\n\r\n\tconstructor(\r\n\t\tpublic readonly index: number,\r\n\t\tpublic readonly remainder: number\r\n\t) {\r\n\t\tthis.index = index;\r\n\t\tthis.remainder = remainder;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { splitLines } from 'vs/base/common/strings';\r\nimport { URI } from 'vs/base/common/uri';\r\nimport { Position } from 'vs/editor/common/core/position';\r\nimport { IRange } from 'vs/editor/common/core/range';\r\nimport { IModelContentChange } from 'vs/editor/common/textModelEvents';\r\nimport { PrefixSumComputer } from 'vs/editor/common/model/prefixSumComputer';\r\n\r\nexport interface IModelChangedEvent {\r\n\t/**\r\n\t * The actual changes.\r\n\t */\r\n\treadonly changes: IModelContentChange[];\r\n\t/**\r\n\t * The (new) end-of-line character.\r\n\t */\r\n\treadonly eol: string;\r\n\t/**\r\n\t * The new version id the model has transitioned to.\r\n\t */\r\n\treadonly versionId: number;\r\n}\r\n\r\nexport interface IMirrorTextModel {\r\n\treadonly version: number;\r\n}\r\n\r\nexport class MirrorTextModel implements IMirrorTextModel {\r\n\r\n\tprotected _uri: URI;\r\n\tprotected _lines: string[];\r\n\tprotected _eol: string;\r\n\tprotected _versionId: number;\r\n\tprotected _lineStarts: PrefixSumComputer | null;\r\n\tprivate _cachedTextValue: string | null;\r\n\r\n\tconstructor(uri: URI, lines: string[], eol: string, versionId: number) {\r\n\t\tthis._uri = uri;\r\n\t\tthis._lines = lines;\r\n\t\tthis._eol = eol;\r\n\t\tthis._versionId = versionId;\r\n\t\tthis._lineStarts = null;\r\n\t\tthis._cachedTextValue = null;\r\n\t}\r\n\r\n\tdispose(): void {\r\n\t\tthis._lines.length = 0;\r\n\t}\r\n\r\n\tget version(): number {\r\n\t\treturn this._versionId;\r\n\t}\r\n\r\n\tgetText(): string {\r\n\t\tif (this._cachedTextValue === null) {\r\n\t\t\tthis._cachedTextValue = this._lines.join(this._eol);\r\n\t\t}\r\n\t\treturn this._cachedTextValue;\r\n\t}\r\n\r\n\tonEvents(e: IModelChangedEvent): void {\r\n\t\tif (e.eol && e.eol !== this._eol) {\r\n\t\t\tthis._eol = e.eol;\r\n\t\t\tthis._lineStarts = null;\r\n\t\t}\r\n\r\n\t\t// Update my lines\r\n\t\tconst changes = e.changes;\r\n\t\tfor (const change of changes) {\r\n\t\t\tthis._acceptDeleteRange(change.range);\r\n\t\t\tthis._acceptInsertText(new Position(change.range.startLineNumber, change.range.startColumn), change.text);\r\n\t\t}\r\n\r\n\t\tthis._versionId = e.versionId;\r\n\t\tthis._cachedTextValue = null;\r\n\t}\r\n\r\n\tprotected _ensureLineStarts(): void {\r\n\t\tif (!this._lineStarts) {\r\n\t\t\tconst eolLength = this._eol.length;\r\n\t\t\tconst linesLength = this._lines.length;\r\n\t\t\tconst lineStartValues = new Uint32Array(linesLength);\r\n\t\t\tfor (let i = 0; i < linesLength; i++) {\r\n\t\t\t\tlineStartValues[i] = this._lines[i].length + eolLength;\r\n\t\t\t}\r\n\t\t\tthis._lineStarts = new PrefixSumComputer(lineStartValues);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * All changes to a line's text go through this method\r\n\t */\r\n\tprivate _setLineText(lineIndex: number, newValue: string): void {\r\n\t\tthis._lines[lineIndex] = newValue;\r\n\t\tif (this._lineStarts) {\r\n\t\t\t// update prefix sum\r\n\t\t\tthis._lineStarts.setValue(lineIndex, this._lines[lineIndex].length + this._eol.length);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _acceptDeleteRange(range: IRange): void {\r\n\r\n\t\tif (range.startLineNumber === range.endLineNumber) {\r\n\t\t\tif (range.startColumn === range.endColumn) {\r\n\t\t\t\t// Nothing to delete\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Delete text on the affected line\r\n\t\t\tthis._setLineText(range.startLineNumber - 1,\r\n\t\t\t\tthis._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n\t\t\t\t+ this._lines[range.startLineNumber - 1].substring(range.endColumn - 1)\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Take remaining text on last line and append it to remaining text on first line\r\n\t\tthis._setLineText(range.startLineNumber - 1,\r\n\t\t\tthis._lines[range.startLineNumber - 1].substring(0, range.startColumn - 1)\r\n\t\t\t+ this._lines[range.endLineNumber - 1].substring(range.endColumn - 1)\r\n\t\t);\r\n\r\n\t\t// Delete middle lines\r\n\t\tthis._lines.splice(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n\t\tif (this._lineStarts) {\r\n\t\t\t// update prefix sum\r\n\t\t\tthis._lineStarts.removeValues(range.startLineNumber, range.endLineNumber - range.startLineNumber);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _acceptInsertText(position: Position, insertText: string): void {\r\n\t\tif (insertText.length === 0) {\r\n\t\t\t// Nothing to insert\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst insertLines = splitLines(insertText);\r\n\t\tif (insertLines.length === 1) {\r\n\t\t\t// Inserting text on one line\r\n\t\t\tthis._setLineText(position.lineNumber - 1,\r\n\t\t\t\tthis._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n\t\t\t\t+ insertLines[0]\r\n\t\t\t\t+ this._lines[position.lineNumber - 1].substring(position.column - 1)\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Append overflowing text from first line to the end of text to insert\r\n\t\tinsertLines[insertLines.length - 1] += this._lines[position.lineNumber - 1].substring(position.column - 1);\r\n\r\n\t\t// Delete overflowing text from first line and insert text on first line\r\n\t\tthis._setLineText(position.lineNumber - 1,\r\n\t\t\tthis._lines[position.lineNumber - 1].substring(0, position.column - 1)\r\n\t\t\t+ insertLines[0]\r\n\t\t);\r\n\r\n\t\t// Insert new lines & store lengths\r\n\t\tconst newLengths = new Uint32Array(insertLines.length - 1);\r\n\t\tfor (let i = 1; i < insertLines.length; i++) {\r\n\t\t\tthis._lines.splice(position.lineNumber + i - 1, 0, insertLines[i]);\r\n\t\t\tnewLengths[i - 1] = insertLines[i].length + this._eol.length;\r\n\t\t}\r\n\r\n\t\tif (this._lineStarts) {\r\n\t\t\t// update prefix sum\r\n\t\t\tthis._lineStarts.insertValues(position.lineNumber, newLengths);\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * [] export\r\n * export class SearchParams\r\n * export function isMultilineRegexSource\r\n * export function createFindMatch\r\n * export class TextModelSearch\r\n * export function isValidMatch\r\n * export class Searcher\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport * as strings from 'vs/base/common/strings';\r\nimport { WordCharacterClass, WordCharacterClassifier, getMapForWordSeparators } from 'vs/editor/common/core/wordCharacterClassifier';\r\nimport { Position } from 'vs/editor/common/core/position';\r\nimport { Range } from 'vs/editor/common/core/range';\r\nimport { EndOfLinePreference, FindMatch, SearchData } from 'vs/editor/common/model';\r\nimport { TextModel } from 'vs/editor/common/model/textModel';\r\n\r\nconst LIMIT_FIND_COUNT = 999;\r\n\r\nexport class SearchParams {\r\n\tpublic readonly searchString: string;\r\n\tpublic readonly isRegex: boolean;\r\n\tpublic readonly matchCase: boolean;\r\n\tpublic readonly wordSeparators: string | null;\r\n\r\n\tconstructor(searchString: string, isRegex: boolean, matchCase: boolean, wordSeparators: string | null) {\r\n\t\tthis.searchString = searchString;\r\n\t\tthis.isRegex = isRegex;\r\n\t\tthis.matchCase = matchCase;\r\n\t\tthis.wordSeparators = wordSeparators;\r\n\t}\r\n\r\n\tpublic parseSearchRequest(): SearchData | null {\r\n\t\tif (this.searchString === '') {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// Try to create a RegExp out of the params\r\n\t\tlet multiline: boolean;\r\n\t\tif (this.isRegex) {\r\n\t\t\tmultiline = isMultilineRegexSource(this.searchString);\r\n\t\t} else {\r\n\t\t\tmultiline = (this.searchString.indexOf('\\n') >= 0);\r\n\t\t}\r\n\r\n\t\tlet regex: RegExp | null = null;\r\n\t\ttry {\r\n\t\t\tregex = strings.createRegExp(this.searchString, this.isRegex, {\r\n\t\t\t\tmatchCase: this.matchCase,\r\n\t\t\t\twholeWord: false,\r\n\t\t\t\tmultiline: multiline,\r\n\t\t\t\tglobal: true,\r\n\t\t\t\tunicode: true\r\n\t\t\t});\r\n\t\t} catch (err) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tif (!regex) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tlet canUseSimpleSearch = (!this.isRegex && !multiline);\r\n\t\tif (canUseSimpleSearch && this.searchString.toLowerCase() !== this.searchString.toUpperCase()) {\r\n\t\t\t// casing might make a difference\r\n\t\t\tcanUseSimpleSearch = this.matchCase;\r\n\t\t}\r\n\r\n\t\treturn new SearchData(regex, this.wordSeparators ? getMapForWordSeparators(this.wordSeparators) : null, canUseSimpleSearch ? this.searchString : null);\r\n\t}\r\n}\r\n\r\nexport function isMultilineRegexSource(searchString: string): boolean {\r\n\tif (!searchString || searchString.length === 0) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tfor (let i = 0, len = searchString.length; i < len; i++) {\r\n\t\tconst chCode = searchString.charCodeAt(i);\r\n\r\n\t\tif (chCode === CharCode.LineFeed) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tif (chCode === CharCode.Backslash) {\r\n\r\n\t\t\t// move to next char\r\n\t\t\ti++;\r\n\r\n\t\t\tif (i >= len) {\r\n\t\t\t\t// string ends with a \\\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tconst nextChCode = searchString.charCodeAt(i);\r\n\t\t\tif (nextChCode === CharCode.n || nextChCode === CharCode.r || nextChCode === CharCode.W) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nexport function createFindMatch(range: Range, rawMatches: RegExpExecArray, captureMatches: boolean): FindMatch {\r\n\tif (!captureMatches) {\r\n\t\treturn new FindMatch(range, null);\r\n\t}\r\n\tconst matches: string[] = [];\r\n\tfor (let i = 0, len = rawMatches.length; i < len; i++) {\r\n\t\tmatches[i] = rawMatches[i];\r\n\t}\r\n\treturn new FindMatch(range, matches);\r\n}\r\n\r\nclass LineFeedCounter {\r\n\r\n\tprivate readonly _lineFeedsOffsets: number[];\r\n\r\n\tconstructor(text: string) {\r\n\t\tconst lineFeedsOffsets: number[] = [];\r\n\t\tlet lineFeedsOffsetsLen = 0;\r\n\t\tfor (let i = 0, textLen = text.length; i < textLen; i++) {\r\n\t\t\tif (text.charCodeAt(i) === CharCode.LineFeed) {\r\n\t\t\t\tlineFeedsOffsets[lineFeedsOffsetsLen++] = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._lineFeedsOffsets = lineFeedsOffsets;\r\n\t}\r\n\r\n\tpublic findLineFeedCountBeforeOffset(offset: number): number {\r\n\t\tconst lineFeedsOffsets = this._lineFeedsOffsets;\r\n\t\tlet min = 0;\r\n\t\tlet max = lineFeedsOffsets.length - 1;\r\n\r\n\t\tif (max === -1) {\r\n\t\t\t// no line feeds\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\tif (offset <= lineFeedsOffsets[0]) {\r\n\t\t\t// before first line feed\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\twhile (min < max) {\r\n\t\t\tconst mid = min + ((max - min) / 2 >> 0);\r\n\r\n\t\t\tif (lineFeedsOffsets[mid] >= offset) {\r\n\t\t\t\tmax = mid - 1;\r\n\t\t\t} else {\r\n\t\t\t\tif (lineFeedsOffsets[mid + 1] >= offset) {\r\n\t\t\t\t\t// bingo!\r\n\t\t\t\t\tmin = mid;\r\n\t\t\t\t\tmax = mid;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmin = mid + 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn min + 1;\r\n\t}\r\n}\r\n\r\nexport class TextModelSearch {\r\n\r\n\tpublic static findMatches(model: TextModel, searchParams: SearchParams, searchRange: Range, captureMatches: boolean, limitResultCount: number): FindMatch[] {\r\n\t\tconst searchData = searchParams.parseSearchRequest();\r\n\t\tif (!searchData) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tif (searchData.regex.multiline) {\r\n\t\t\treturn this._doFindMatchesMultiline(model, searchRange, new Searcher(searchData.wordSeparators, searchData.regex), captureMatches, limitResultCount);\r\n\t\t}\r\n\t\treturn this._doFindMatchesLineByLine(model, searchRange, searchData, captureMatches, limitResultCount);\r\n\t}\r\n\r\n\t/**\r\n\t * Multiline search always executes on the lines concatenated with \\n.\r\n\t * We must therefore compensate for the count of \\n in case the model is CRLF\r\n\t */\r\n\tprivate static _getMultilineMatchRange(model: TextModel, deltaOffset: number, text: string, lfCounter: LineFeedCounter | null, matchIndex: number, match0: string): Range {\r\n\t\tlet startOffset: number;\r\n\t\tlet lineFeedCountBeforeMatch = 0;\r\n\t\tif (lfCounter) {\r\n\t\t\tlineFeedCountBeforeMatch = lfCounter.findLineFeedCountBeforeOffset(matchIndex);\r\n\t\t\tstartOffset = deltaOffset + matchIndex + lineFeedCountBeforeMatch /* add as many \\r as there were \\n */;\r\n\t\t} else {\r\n\t\t\tstartOffset = deltaOffset + matchIndex;\r\n\t\t}\r\n\r\n\t\tlet endOffset: number;\r\n\t\tif (lfCounter) {\r\n\t\t\tconst lineFeedCountBeforeEndOfMatch = lfCounter.findLineFeedCountBeforeOffset(matchIndex + match0.length);\r\n\t\t\tconst lineFeedCountInMatch = lineFeedCountBeforeEndOfMatch - lineFeedCountBeforeMatch;\r\n\t\t\tendOffset = startOffset + match0.length + lineFeedCountInMatch /* add as many \\r as there were \\n */;\r\n\t\t} else {\r\n\t\t\tendOffset = startOffset + match0.length;\r\n\t\t}\r\n\r\n\t\tconst startPosition = model.getPositionAt(startOffset);\r\n\t\tconst endPosition = model.getPositionAt(endOffset);\r\n\t\treturn new Range(startPosition.lineNumber, startPosition.column, endPosition.lineNumber, endPosition.column);\r\n\t}\r\n\r\n\tprivate static _doFindMatchesMultiline(model: TextModel, searchRange: Range, searcher: Searcher, captureMatches: boolean, limitResultCount: number): FindMatch[] {\r\n\t\tconst deltaOffset = model.getOffsetAt(searchRange.getStartPosition());\r\n\t\t// We always execute multiline search over the lines joined with \\n\r\n\t\t// This makes it that \\n will match the EOL for both CRLF and LF models\r\n\t\t// We compensate for offset errors in `_getMultilineMatchRange`\r\n\t\tconst text = model.getValueInRange(searchRange, EndOfLinePreference.LF);\r\n\t\tconst lfCounter = (model.getEOL() === '\\r\\n' ? new LineFeedCounter(text) : null);\r\n\r\n\t\tconst result: FindMatch[] = [];\r\n\t\tlet counter = 0;\r\n\r\n\t\tlet m: RegExpExecArray | null;\r\n\t\tsearcher.reset(0);\r\n\t\twhile ((m = searcher.next(text))) {\r\n\t\t\tresult[counter++] = createFindMatch(this._getMultilineMatchRange(model, deltaOffset, text, lfCounter, m.index, m[0]), m, captureMatches);\r\n\t\t\tif (counter >= limitResultCount) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate static _doFindMatchesLineByLine(model: TextModel, searchRange: Range, searchData: SearchData, captureMatches: boolean, limitResultCount: number): FindMatch[] {\r\n\t\tconst result: FindMatch[] = [];\r\n\t\tlet resultLen = 0;\r\n\r\n\t\t// Early case for a search range that starts & stops on the same line number\r\n\t\tif (searchRange.startLineNumber === searchRange.endLineNumber) {\r\n\t\t\tconst text = model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn - 1, searchRange.endColumn - 1);\r\n\t\t\tresultLen = this._findMatchesInLine(searchData, text, searchRange.startLineNumber, searchRange.startColumn - 1, resultLen, result, captureMatches, limitResultCount);\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\t// Collect results from first line\r\n\t\tconst text = model.getLineContent(searchRange.startLineNumber).substring(searchRange.startColumn - 1);\r\n\t\tresultLen = this._findMatchesInLine(searchData, text, searchRange.startLineNumber, searchRange.startColumn - 1, resultLen, result, captureMatches, limitResultCount);\r\n\r\n\t\t// Collect results from middle lines\r\n\t\tfor (let lineNumber = searchRange.startLineNumber + 1; lineNumber < searchRange.endLineNumber && resultLen < limitResultCount; lineNumber++) {\r\n\t\t\tresultLen = this._findMatchesInLine(searchData, model.getLineContent(lineNumber), lineNumber, 0, resultLen, result, captureMatches, limitResultCount);\r\n\t\t}\r\n\r\n\t\t// Collect results from last line\r\n\t\tif (resultLen < limitResultCount) {\r\n\t\t\tconst text = model.getLineContent(searchRange.endLineNumber).substring(0, searchRange.endColumn - 1);\r\n\t\t\tresultLen = this._findMatchesInLine(searchData, text, searchRange.endLineNumber, 0, resultLen, result, captureMatches, limitResultCount);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate static _findMatchesInLine(searchData: SearchData, text: string, lineNumber: number, deltaOffset: number, resultLen: number, result: FindMatch[], captureMatches: boolean, limitResultCount: number): number {\r\n\t\tconst wordSeparators = searchData.wordSeparators;\r\n\t\tif (!captureMatches && searchData.simpleSearch) {\r\n\t\t\tconst searchString = searchData.simpleSearch;\r\n\t\t\tconst searchStringLen = searchString.length;\r\n\t\t\tconst textLength = text.length;\r\n\r\n\t\t\tlet lastMatchIndex = -searchStringLen;\r\n\t\t\twhile ((lastMatchIndex = text.indexOf(searchString, lastMatchIndex + searchStringLen)) !== -1) {\r\n\t\t\t\tif (!wordSeparators || isValidMatch(wordSeparators, text, textLength, lastMatchIndex, searchStringLen)) {\r\n\t\t\t\t\tresult[resultLen++] = new FindMatch(new Range(lineNumber, lastMatchIndex + 1 + deltaOffset, lineNumber, lastMatchIndex + 1 + searchStringLen + deltaOffset), null);\r\n\t\t\t\t\tif (resultLen >= limitResultCount) {\r\n\t\t\t\t\t\treturn resultLen;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn resultLen;\r\n\t\t}\r\n\r\n\t\tconst searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n\t\tlet m: RegExpExecArray | null;\r\n\t\t// Reset regex to search from the beginning\r\n\t\tsearcher.reset(0);\r\n\t\tdo {\r\n\t\t\tm = searcher.next(text);\r\n\t\t\tif (m) {\r\n\t\t\t\tresult[resultLen++] = createFindMatch(new Range(lineNumber, m.index + 1 + deltaOffset, lineNumber, m.index + 1 + m[0].length + deltaOffset), m, captureMatches);\r\n\t\t\t\tif (resultLen >= limitResultCount) {\r\n\t\t\t\t\treturn resultLen;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} while (m);\r\n\t\treturn resultLen;\r\n\t}\r\n\r\n\tpublic static findNextMatch(model: TextModel, searchParams: SearchParams, searchStart: Position, captureMatches: boolean): FindMatch | null {\r\n\t\tconst searchData = searchParams.parseSearchRequest();\r\n\t\tif (!searchData) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n\r\n\t\tif (searchData.regex.multiline) {\r\n\t\t\treturn this._doFindNextMatchMultiline(model, searchStart, searcher, captureMatches);\r\n\t\t}\r\n\t\treturn this._doFindNextMatchLineByLine(model, searchStart, searcher, captureMatches);\r\n\t}\r\n\r\n\tprivate static _doFindNextMatchMultiline(model: TextModel, searchStart: Position, searcher: Searcher, captureMatches: boolean): FindMatch | null {\r\n\t\tconst searchTextStart = new Position(searchStart.lineNumber, 1);\r\n\t\tconst deltaOffset = model.getOffsetAt(searchTextStart);\r\n\t\tconst lineCount = model.getLineCount();\r\n\t\t// We always execute multiline search over the lines joined with \\n\r\n\t\t// This makes it that \\n will match the EOL for both CRLF and LF models\r\n\t\t// We compensate for offset errors in `_getMultilineMatchRange`\r\n\t\tconst text = model.getValueInRange(new Range(searchTextStart.lineNumber, searchTextStart.column, lineCount, model.getLineMaxColumn(lineCount)), EndOfLinePreference.LF);\r\n\t\tconst lfCounter = (model.getEOL() === '\\r\\n' ? new LineFeedCounter(text) : null);\r\n\t\tsearcher.reset(searchStart.column - 1);\r\n\t\tconst m = searcher.next(text);\r\n\t\tif (m) {\r\n\t\t\treturn createFindMatch(\r\n\t\t\t\tthis._getMultilineMatchRange(model, deltaOffset, text, lfCounter, m.index, m[0]),\r\n\t\t\t\tm,\r\n\t\t\t\tcaptureMatches\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif (searchStart.lineNumber !== 1 || searchStart.column !== 1) {\r\n\t\t\t// Try again from the top\r\n\t\t\treturn this._doFindNextMatchMultiline(model, new Position(1, 1), searcher, captureMatches);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate static _doFindNextMatchLineByLine(model: TextModel, searchStart: Position, searcher: Searcher, captureMatches: boolean): FindMatch | null {\r\n\t\tconst lineCount = model.getLineCount();\r\n\t\tconst startLineNumber = searchStart.lineNumber;\r\n\r\n\t\t// Look in first line\r\n\t\tconst text = model.getLineContent(startLineNumber);\r\n\t\tconst r = this._findFirstMatchInLine(searcher, text, startLineNumber, searchStart.column, captureMatches);\r\n\t\tif (r) {\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\tfor (let i = 1; i <= lineCount; i++) {\r\n\t\t\tconst lineIndex = (startLineNumber + i - 1) % lineCount;\r\n\t\t\tconst text = model.getLineContent(lineIndex + 1);\r\n\t\t\tconst r = this._findFirstMatchInLine(searcher, text, lineIndex + 1, 1, captureMatches);\r\n\t\t\tif (r) {\r\n\t\t\t\treturn r;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate static _findFirstMatchInLine(searcher: Searcher, text: string, lineNumber: number, fromColumn: number, captureMatches: boolean): FindMatch | null {\r\n\t\t// Set regex to search from column\r\n\t\tsearcher.reset(fromColumn - 1);\r\n\t\tconst m: RegExpExecArray | null = searcher.next(text);\r\n\t\tif (m) {\r\n\t\t\treturn createFindMatch(\r\n\t\t\t\tnew Range(lineNumber, m.index + 1, lineNumber, m.index + 1 + m[0].length),\r\n\t\t\t\tm,\r\n\t\t\t\tcaptureMatches\r\n\t\t\t);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\tpublic static findPreviousMatch(model: TextModel, searchParams: SearchParams, searchStart: Position, captureMatches: boolean): FindMatch | null {\r\n\t\tconst searchData = searchParams.parseSearchRequest();\r\n\t\tif (!searchData) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst searcher = new Searcher(searchData.wordSeparators, searchData.regex);\r\n\r\n\t\tif (searchData.regex.multiline) {\r\n\t\t\treturn this._doFindPreviousMatchMultiline(model, searchStart, searcher, captureMatches);\r\n\t\t}\r\n\t\treturn this._doFindPreviousMatchLineByLine(model, searchStart, searcher, captureMatches);\r\n\t}\r\n\r\n\tprivate static _doFindPreviousMatchMultiline(model: TextModel, searchStart: Position, searcher: Searcher, captureMatches: boolean): FindMatch | null {\r\n\t\tconst matches = this._doFindMatchesMultiline(model, new Range(1, 1, searchStart.lineNumber, searchStart.column), searcher, captureMatches, 10 * LIMIT_FIND_COUNT);\r\n\t\tif (matches.length > 0) {\r\n\t\t\treturn matches[matches.length - 1];\r\n\t\t}\r\n\r\n\t\tconst lineCount = model.getLineCount();\r\n\t\tif (searchStart.lineNumber !== lineCount || searchStart.column !== model.getLineMaxColumn(lineCount)) {\r\n\t\t\t// Try again with all content\r\n\t\t\treturn this._doFindPreviousMatchMultiline(model, new Position(lineCount, model.getLineMaxColumn(lineCount)), searcher, captureMatches);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate static _doFindPreviousMatchLineByLine(model: TextModel, searchStart: Position, searcher: Searcher, captureMatches: boolean): FindMatch | null {\r\n\t\tconst lineCount = model.getLineCount();\r\n\t\tconst startLineNumber = searchStart.lineNumber;\r\n\r\n\t\t// Look in first line\r\n\t\tconst text = model.getLineContent(startLineNumber).substring(0, searchStart.column - 1);\r\n\t\tconst r = this._findLastMatchInLine(searcher, text, startLineNumber, captureMatches);\r\n\t\tif (r) {\r\n\t\t\treturn r;\r\n\t\t}\r\n\r\n\t\tfor (let i = 1; i <= lineCount; i++) {\r\n\t\t\tconst lineIndex = (lineCount + startLineNumber - i - 1) % lineCount;\r\n\t\t\tconst text = model.getLineContent(lineIndex + 1);\r\n\t\t\tconst r = this._findLastMatchInLine(searcher, text, lineIndex + 1, captureMatches);\r\n\t\t\tif (r) {\r\n\t\t\t\treturn r;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate static _findLastMatchInLine(searcher: Searcher, text: string, lineNumber: number, captureMatches: boolean): FindMatch | null {\r\n\t\tlet bestResult: FindMatch | null = null;\r\n\t\tlet m: RegExpExecArray | null;\r\n\t\tsearcher.reset(0);\r\n\t\twhile ((m = searcher.next(text))) {\r\n\t\t\tbestResult = createFindMatch(new Range(lineNumber, m.index + 1, lineNumber, m.index + 1 + m[0].length), m, captureMatches);\r\n\t\t}\r\n\t\treturn bestResult;\r\n\t}\r\n}\r\n\r\nfunction leftIsWordBounday(wordSeparators: WordCharacterClassifier, text: string, textLength: number, matchStartIndex: number, matchLength: number): boolean {\r\n\tif (matchStartIndex === 0) {\r\n\t\t// Match starts at start of string\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst charBefore = text.charCodeAt(matchStartIndex - 1);\r\n\tif (wordSeparators.get(charBefore) !== WordCharacterClass.Regular) {\r\n\t\t// The character before the match is a word separator\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (charBefore === CharCode.CarriageReturn || charBefore === CharCode.LineFeed) {\r\n\t\t// The character before the match is line break or carriage return.\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (matchLength > 0) {\r\n\t\tconst firstCharInMatch = text.charCodeAt(matchStartIndex);\r\n\t\tif (wordSeparators.get(firstCharInMatch) !== WordCharacterClass.Regular) {\r\n\t\t\t// The first character inside the match is a word separator\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nfunction rightIsWordBounday(wordSeparators: WordCharacterClassifier, text: string, textLength: number, matchStartIndex: number, matchLength: number): boolean {\r\n\tif (matchStartIndex + matchLength === textLength) {\r\n\t\t// Match ends at end of string\r\n\t\treturn true;\r\n\t}\r\n\r\n\tconst charAfter = text.charCodeAt(matchStartIndex + matchLength);\r\n\tif (wordSeparators.get(charAfter) !== WordCharacterClass.Regular) {\r\n\t\t// The character after the match is a word separator\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (charAfter === CharCode.CarriageReturn || charAfter === CharCode.LineFeed) {\r\n\t\t// The character after the match is line break or carriage return.\r\n\t\treturn true;\r\n\t}\r\n\r\n\tif (matchLength > 0) {\r\n\t\tconst lastCharInMatch = text.charCodeAt(matchStartIndex + matchLength - 1);\r\n\t\tif (wordSeparators.get(lastCharInMatch) !== WordCharacterClass.Regular) {\r\n\t\t\t// The last character in the match is a word separator\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nexport function isValidMatch(wordSeparators: WordCharacterClassifier, text: string, textLength: number, matchStartIndex: number, matchLength: number): boolean {\r\n\treturn (\r\n\t\tleftIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength)\r\n\t\t&& rightIsWordBounday(wordSeparators, text, textLength, matchStartIndex, matchLength)\r\n\t);\r\n}\r\n\r\nexport class Searcher {\r\n\tpublic readonly _wordSeparators: WordCharacterClassifier | null;\r\n\tprivate readonly _searchRegex: RegExp;\r\n\tprivate _prevMatchStartIndex: number;\r\n\tprivate _prevMatchLength: number;\r\n\r\n\tconstructor(wordSeparators: WordCharacterClassifier | null, searchRegex: RegExp,) {\r\n\t\tthis._wordSeparators = wordSeparators;\r\n\t\tthis._searchRegex = searchRegex;\r\n\t\tthis._prevMatchStartIndex = -1;\r\n\t\tthis._prevMatchLength = 0;\r\n\t}\r\n\r\n\tpublic reset(lastIndex: number): void {\r\n\t\tthis._searchRegex.lastIndex = lastIndex;\r\n\t\tthis._prevMatchStartIndex = -1;\r\n\t\tthis._prevMatchLength = 0;\r\n\t}\r\n\r\n\tpublic next(text: string): RegExpExecArray | null {\r\n\t\tconst textLength = text.length;\r\n\r\n\t\tlet m: RegExpExecArray | null;\r\n\t\tdo {\r\n\t\t\tif (this._prevMatchStartIndex + this._prevMatchLength === textLength) {\r\n\t\t\t\t// Reached the end of the line\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tm = this._searchRegex.exec(text);\r\n\t\t\tif (!m) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconst matchStartIndex = m.index;\r\n\t\t\tconst matchLength = m[0].length;\r\n\t\t\tif (matchStartIndex === this._prevMatchStartIndex && matchLength === this._prevMatchLength) {\r\n\t\t\t\tif (matchLength === 0) {\r\n\t\t\t\t\t// the search result is an empty string and won't advance `regex.lastIndex`, so `regex.exec` will stuck here\r\n\t\t\t\t\t// we attempt to recover from that by advancing by two if surrogate pair found and by one otherwise\r\n\t\t\t\t\tif (strings.getNextCodePoint(text, textLength, this._searchRegex.lastIndex) > 0xFFFF) {\r\n\t\t\t\t\t\tthis._searchRegex.lastIndex += 2;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis._searchRegex.lastIndex += 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// Exit early if the regex matches the same range twice\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tthis._prevMatchStartIndex = matchStartIndex;\r\n\t\t\tthis._prevMatchLength = matchLength;\r\n\r\n\t\t\tif (!this._wordSeparators || isValidMatch(this._wordSeparators, text, textLength, matchStartIndex, matchLength)) {\r\n\t\t\t\treturn m;\r\n\t\t\t}\r\n\r\n\t\t} while (m);\r\n\r\n\t\treturn null;\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { IRange, Range } from 'vs/editor/common/core/range';\r\nimport { Searcher } from 'vs/editor/common/model/textModelSearch';\r\nimport * as strings from 'vs/base/common/strings';\r\nimport { IUnicodeHighlightsResult } from 'vs/editor/common/services/editorWorker';\r\nimport { assertNever } from 'vs/base/common/assert';\r\nimport { DEFAULT_WORD_REGEXP, getWordAtText } from 'vs/editor/common/core/wordHelper';\r\n\r\nexport class UnicodeTextModelHighlighter {\r\n\tpublic static computeUnicodeHighlights(model: IUnicodeCharacterSearcherTarget, options: UnicodeHighlighterOptions, range?: IRange): IUnicodeHighlightsResult {\r\n\t\tconst startLine = range ? range.startLineNumber : 1;\r\n\t\tconst endLine = range ? range.endLineNumber : model.getLineCount();\r\n\r\n\t\tconst codePointHighlighter = new CodePointHighlighter(options);\r\n\r\n\t\tconst candidates = codePointHighlighter.getCandidateCodePoints();\r\n\t\tlet regex: RegExp;\r\n\t\tif (candidates === 'allNonBasicAscii') {\r\n\t\t\tregex = new RegExp('[^\\\\t\\\\n\\\\r\\\\x20-\\\\x7E]', 'g');\r\n\t\t} else {\r\n\t\t\tregex = new RegExp(`${buildRegExpCharClassExpr(Array.from(candidates))}`, 'g');\r\n\t\t}\r\n\r\n\t\tconst searcher = new Searcher(null, regex);\r\n\t\tconst ranges: Range[] = [];\r\n\t\tlet hasMore = false;\r\n\t\tlet m: RegExpExecArray | null;\r\n\r\n\t\tlet ambiguousCharacterCount = 0;\r\n\t\tlet invisibleCharacterCount = 0;\r\n\t\tlet nonBasicAsciiCharacterCount = 0;\r\n\r\n\t\tforLoop:\r\n\t\tfor (let lineNumber = startLine, lineCount = endLine; lineNumber <= lineCount; lineNumber++) {\r\n\t\t\tconst lineContent = model.getLineContent(lineNumber);\r\n\t\t\tconst lineLength = lineContent.length;\r\n\r\n\t\t\t// Reset regex to search from the beginning\r\n\t\t\tsearcher.reset(0);\r\n\t\t\tdo {\r\n\t\t\t\tm = searcher.next(lineContent);\r\n\t\t\t\tif (m) {\r\n\t\t\t\t\tlet startIndex = m.index;\r\n\t\t\t\t\tlet endIndex = m.index + m[0].length;\r\n\r\n\t\t\t\t\t// Extend range to entire code point\r\n\t\t\t\t\tif (startIndex > 0) {\r\n\t\t\t\t\t\tconst charCodeBefore = lineContent.charCodeAt(startIndex - 1);\r\n\t\t\t\t\t\tif (strings.isHighSurrogate(charCodeBefore)) {\r\n\t\t\t\t\t\t\tstartIndex--;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (endIndex + 1 < lineLength) {\r\n\t\t\t\t\t\tconst charCodeBefore = lineContent.charCodeAt(endIndex - 1);\r\n\t\t\t\t\t\tif (strings.isHighSurrogate(charCodeBefore)) {\r\n\t\t\t\t\t\t\tendIndex++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst str = lineContent.substring(startIndex, endIndex);\r\n\t\t\t\t\tlet word = getWordAtText(startIndex + 1, DEFAULT_WORD_REGEXP, lineContent, 0);\r\n\t\t\t\t\tif (word && word.endColumn <= startIndex + 1) {\r\n\t\t\t\t\t\t// The word does not include the problematic character, ignore the word\r\n\t\t\t\t\t\tword = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst highlightReason = codePointHighlighter.shouldHighlightNonBasicASCII(str, word ? word.word : null);\r\n\r\n\t\t\t\t\tif (highlightReason !== SimpleHighlightReason.None) {\r\n\t\t\t\t\t\tif (highlightReason === SimpleHighlightReason.Ambiguous) {\r\n\t\t\t\t\t\t\tambiguousCharacterCount++;\r\n\t\t\t\t\t\t} else if (highlightReason === SimpleHighlightReason.Invisible) {\r\n\t\t\t\t\t\t\tinvisibleCharacterCount++;\r\n\t\t\t\t\t\t} else if (highlightReason === SimpleHighlightReason.NonBasicASCII) {\r\n\t\t\t\t\t\t\tnonBasicAsciiCharacterCount++;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tassertNever(highlightReason);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconst MAX_RESULT_LENGTH = 1000;\r\n\t\t\t\t\t\tif (ranges.length >= MAX_RESULT_LENGTH) {\r\n\t\t\t\t\t\t\thasMore = true;\r\n\t\t\t\t\t\t\tbreak forLoop;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tranges.push(new Range(lineNumber, startIndex + 1, lineNumber, endIndex + 1));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} while (m);\r\n\t\t}\r\n\t\treturn {\r\n\t\t\tranges,\r\n\t\t\thasMore,\r\n\t\t\tambiguousCharacterCount,\r\n\t\t\tinvisibleCharacterCount,\r\n\t\t\tnonBasicAsciiCharacterCount\r\n\t\t};\r\n\t}\r\n\r\n\tpublic static computeUnicodeHighlightReason(char: string, options: UnicodeHighlighterOptions): UnicodeHighlighterReason | null {\r\n\t\tconst codePointHighlighter = new CodePointHighlighter(options);\r\n\r\n\t\tconst reason = codePointHighlighter.shouldHighlightNonBasicASCII(char, null);\r\n\t\tswitch (reason) {\r\n\t\t\tcase SimpleHighlightReason.None:\r\n\t\t\t\treturn null;\r\n\t\t\tcase SimpleHighlightReason.Invisible:\r\n\t\t\t\treturn { kind: UnicodeHighlighterReasonKind.Invisible };\r\n\r\n\t\t\tcase SimpleHighlightReason.Ambiguous: {\r\n\t\t\t\tconst codePoint = char.codePointAt(0)!;\r\n\t\t\t\tconst primaryConfusable = codePointHighlighter.ambiguousCharacters.getPrimaryConfusable(codePoint)!;\r\n\t\t\t\tconst notAmbiguousInLocales =\r\n\t\t\t\t\tstrings.AmbiguousCharacters.getLocales().filter(\r\n\t\t\t\t\t\t(l) =>\r\n\t\t\t\t\t\t\t!strings.AmbiguousCharacters.getInstance(\r\n\t\t\t\t\t\t\t\tnew Set([...options.allowedLocales, l])\r\n\t\t\t\t\t\t\t).isAmbiguous(codePoint)\r\n\t\t\t\t\t);\r\n\t\t\t\treturn { kind: UnicodeHighlighterReasonKind.Ambiguous, confusableWith: String.fromCodePoint(primaryConfusable), notAmbiguousInLocales };\r\n\t\t\t}\r\n\t\t\tcase SimpleHighlightReason.NonBasicASCII:\r\n\t\t\t\treturn { kind: UnicodeHighlighterReasonKind.NonBasicAscii };\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction buildRegExpCharClassExpr(codePoints: number[], flags?: string): string {\r\n\tconst src = `[${strings.escapeRegExpCharacters(\r\n\t\tcodePoints.map((i) => String.fromCodePoint(i)).join('')\r\n\t)}]`;\r\n\treturn src;\r\n}\r\n\r\nexport const enum UnicodeHighlighterReasonKind {\r\n\tAmbiguous, Invisible, NonBasicAscii\r\n}\r\n\r\nexport type UnicodeHighlighterReason = {\r\n\tkind: UnicodeHighlighterReasonKind.Ambiguous;\r\n\tconfusableWith: string;\r\n\tnotAmbiguousInLocales: string[];\r\n} | {\r\n\tkind: UnicodeHighlighterReasonKind.Invisible;\r\n} | {\r\n\tkind: UnicodeHighlighterReasonKind.NonBasicAscii;\r\n};\r\n\r\nclass CodePointHighlighter {\r\n\tprivate readonly allowedCodePoints: Set<number>;\r\n\tpublic readonly ambiguousCharacters: strings.AmbiguousCharacters;\r\n\tconstructor(private readonly options: UnicodeHighlighterOptions) {\r\n\t\tthis.allowedCodePoints = new Set(options.allowedCodePoints);\r\n\t\tthis.ambiguousCharacters = strings.AmbiguousCharacters.getInstance(new Set(options.allowedLocales));\r\n\t}\r\n\r\n\tpublic getCandidateCodePoints(): Set<number> | 'allNonBasicAscii' {\r\n\t\tif (this.options.nonBasicASCII) {\r\n\t\t\treturn 'allNonBasicAscii';\r\n\t\t}\r\n\r\n\t\tconst set = new Set<number>();\r\n\r\n\t\tif (this.options.invisibleCharacters) {\r\n\t\t\tfor (const cp of strings.InvisibleCharacters.codePoints) {\r\n\t\t\t\tif (!isAllowedInvisibleCharacter(String.fromCodePoint(cp))) {\r\n\t\t\t\t\tset.add(cp);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.options.ambiguousCharacters) {\r\n\t\t\tfor (const cp of this.ambiguousCharacters.getConfusableCodePoints()) {\r\n\t\t\t\tset.add(cp);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (const cp of this.allowedCodePoints) {\r\n\t\t\tset.delete(cp);\r\n\t\t}\r\n\r\n\t\treturn set;\r\n\t}\r\n\r\n\tpublic shouldHighlightNonBasicASCII(character: string, wordContext: string | null): SimpleHighlightReason {\r\n\t\tconst codePoint = character.codePointAt(0)!;\r\n\r\n\t\tif (this.allowedCodePoints.has(codePoint)) {\r\n\t\t\treturn SimpleHighlightReason.None;\r\n\t\t}\r\n\r\n\t\tif (this.options.nonBasicASCII) {\r\n\t\t\treturn SimpleHighlightReason.NonBasicASCII;\r\n\t\t}\r\n\r\n\t\tlet hasBasicASCIICharacters = false;\r\n\t\tlet hasNonConfusableNonBasicAsciiCharacter = false;\r\n\t\tif (wordContext) {\r\n\t\t\tfor (const char of wordContext) {\r\n\t\t\t\tconst codePoint = char.codePointAt(0)!;\r\n\t\t\t\tconst isBasicASCII = strings.isBasicASCII(char);\r\n\t\t\t\thasBasicASCIICharacters = hasBasicASCIICharacters || isBasicASCII;\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t!isBasicASCII &&\r\n\t\t\t\t\t!this.ambiguousCharacters.isAmbiguous(codePoint) &&\r\n\t\t\t\t\t!strings.InvisibleCharacters.isInvisibleCharacter(codePoint)\r\n\t\t\t\t) {\r\n\t\t\t\t\thasNonConfusableNonBasicAsciiCharacter = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t/* Don't allow mixing weird looking characters with ASCII */ !hasBasicASCIICharacters &&\r\n\t\t\t/* Is there an obviously weird looking character? */ hasNonConfusableNonBasicAsciiCharacter\r\n\t\t) {\r\n\t\t\treturn SimpleHighlightReason.None;\r\n\t\t}\r\n\r\n\t\tif (this.options.invisibleCharacters) {\r\n\t\t\t// TODO check for emojis\r\n\t\t\tif (!isAllowedInvisibleCharacter(character) && strings.InvisibleCharacters.isInvisibleCharacter(codePoint)) {\r\n\t\t\t\treturn SimpleHighlightReason.Invisible;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (this.options.ambiguousCharacters) {\r\n\t\t\tif (this.ambiguousCharacters.isAmbiguous(codePoint)) {\r\n\t\t\t\treturn SimpleHighlightReason.Ambiguous;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn SimpleHighlightReason.None;\r\n\t}\r\n}\r\n\r\nfunction isAllowedInvisibleCharacter(character: string): boolean {\r\n\treturn character === ' ' || character === '\\n' || character === '\\t';\r\n}\r\n\r\nconst enum SimpleHighlightReason {\r\n\tNone,\r\n\tNonBasicASCII,\r\n\tInvisible,\r\n\tAmbiguous\r\n}\r\n\r\nexport interface IUnicodeCharacterSearcherTarget {\r\n\tgetLineCount(): number;\r\n\tgetLineContent(lineNumber: number): string;\r\n}\r\n\r\nexport interface UnicodeHighlighterOptions {\r\n\tnonBasicASCII: boolean;\r\n\tambiguousCharacters: boolean;\r\n\tinvisibleCharacters: boolean;\r\n\tincludeComments: boolean;\r\n\tincludeStrings: boolean;\r\n\tallowedCodePoints: number[];\r\n\tallowedLocales: string[];\r\n}\r\n","/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\n// THIS IS A GENERATED FILE. DO NOT EDIT DIRECTLY.\n\n\nexport enum AccessibilitySupport {\n\t/**\n\t * This should be the browser case where it is not known if a screen reader is attached or no.\n\t */\n\tUnknown = 0,\n\tDisabled = 1,\n\tEnabled = 2\n}\n\nexport enum CodeActionTriggerType {\n\tInvoke = 1,\n\tAuto = 2\n}\n\nexport enum CompletionItemInsertTextRule {\n\tNone = 0,\n\t/**\n\t * Adjust whitespace/indentation of multiline insert texts to\n\t * match the current line indentation.\n\t */\n\tKeepWhitespace = 1,\n\t/**\n\t * `insertText` is a snippet.\n\t */\n\tInsertAsSnippet = 4\n}\n\nexport enum CompletionItemKind {\n\tMethod = 0,\n\tFunction = 1,\n\tConstructor = 2,\n\tField = 3,\n\tVariable = 4,\n\tClass = 5,\n\tStruct = 6,\n\tInterface = 7,\n\tModule = 8,\n\tProperty = 9,\n\tEvent = 10,\n\tOperator = 11,\n\tUnit = 12,\n\tValue = 13,\n\tConstant = 14,\n\tEnum = 15,\n\tEnumMember = 16,\n\tKeyword = 17,\n\tText = 18,\n\tColor = 19,\n\tFile = 20,\n\tReference = 21,\n\tCustomcolor = 22,\n\tFolder = 23,\n\tTypeParameter = 24,\n\tUser = 25,\n\tIssue = 26,\n\tSnippet = 27\n}\n\nexport enum CompletionItemTag {\n\tDeprecated = 1\n}\n\n/**\n * How a suggest provider was triggered.\n */\nexport enum CompletionTriggerKind {\n\tInvoke = 0,\n\tTriggerCharacter = 1,\n\tTriggerForIncompleteCompletions = 2\n}\n\n/**\n * A positioning preference for rendering content widgets.\n */\nexport enum ContentWidgetPositionPreference {\n\t/**\n\t * Place the content widget exactly at a position\n\t */\n\tEXACT = 0,\n\t/**\n\t * Place the content widget above a position\n\t */\n\tABOVE = 1,\n\t/**\n\t * Place the content widget below a position\n\t */\n\tBELOW = 2\n}\n\n/**\n * Describes the reason the cursor has changed its position.\n */\nexport enum CursorChangeReason {\n\t/**\n\t * Unknown or not set.\n\t */\n\tNotSet = 0,\n\t/**\n\t * A `model.setValue()` was called.\n\t */\n\tContentFlush = 1,\n\t/**\n\t * The `model` has been changed outside of this cursor and the cursor recovers its position from associated markers.\n\t */\n\tRecoverFromMarkers = 2,\n\t/**\n\t * There was an explicit user gesture.\n\t */\n\tExplicit = 3,\n\t/**\n\t * There was a Paste.\n\t */\n\tPaste = 4,\n\t/**\n\t * There was an Undo.\n\t */\n\tUndo = 5,\n\t/**\n\t * There was a Redo.\n\t */\n\tRedo = 6\n}\n\n/**\n * The default end of line to use when instantiating models.\n *\n * `LF` = 1, `CRLF` = 2\n */\nexport enum DefaultEndOfLine {\n\t/**\n\t * Use line feed (\\n) as the end of line character.\n\t */\n\tLF = 1,\n\t/**\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\n\t */\n\tCRLF = 2\n}\n\n/**\n * A document highlight kind.\n */\nexport enum DocumentHighlightKind {\n\t/**\n\t * A textual occurrence.\n\t */\n\tText = 0,\n\t/**\n\t * Read-access of a symbol, like reading a variable.\n\t */\n\tRead = 1,\n\t/**\n\t * Write-access of a symbol, like writing to a variable.\n\t */\n\tWrite = 2\n}\n\n/**\n * Configuration options for auto indentation in the editor\n */\nexport enum EditorAutoIndentStrategy {\n\tNone = 0,\n\tKeep = 1,\n\tBrackets = 2,\n\tAdvanced = 3,\n\tFull = 4\n}\n\nexport enum EditorOption {\n\tacceptSuggestionOnCommitCharacter = 0,\n\tacceptSuggestionOnEnter = 1,\n\taccessibilitySupport = 2,\n\taccessibilityPageSize = 3,\n\tariaLabel = 4,\n\tariaRequired = 5,\n\tautoClosingBrackets = 6,\n\tscreenReaderAnnounceInlineSuggestion = 7,\n\tautoClosingDelete = 8,\n\tautoClosingOvertype = 9,\n\tautoClosingQuotes = 10,\n\tautoIndent = 11,\n\tautomaticLayout = 12,\n\tautoSurround = 13,\n\tbracketPairColorization = 14,\n\tguides = 15,\n\tcodeLens = 16,\n\tcodeLensFontFamily = 17,\n\tcodeLensFontSize = 18,\n\tcolorDecorators = 19,\n\tcolorDecoratorsLimit = 20,\n\tcolumnSelection = 21,\n\tcomments = 22,\n\tcontextmenu = 23,\n\tcopyWithSyntaxHighlighting = 24,\n\tcursorBlinking = 25,\n\tcursorSmoothCaretAnimation = 26,\n\tcursorStyle = 27,\n\tcursorSurroundingLines = 28,\n\tcursorSurroundingLinesStyle = 29,\n\tcursorWidth = 30,\n\tdisableLayerHinting = 31,\n\tdisableMonospaceOptimizations = 32,\n\tdomReadOnly = 33,\n\tdragAndDrop = 34,\n\tdropIntoEditor = 35,\n\temptySelectionClipboard = 36,\n\texperimentalWhitespaceRendering = 37,\n\textraEditorClassName = 38,\n\tfastScrollSensitivity = 39,\n\tfind = 40,\n\tfixedOverflowWidgets = 41,\n\tfolding = 42,\n\tfoldingStrategy = 43,\n\tfoldingHighlight = 44,\n\tfoldingImportsByDefault = 45,\n\tfoldingMaximumRegions = 46,\n\tunfoldOnClickAfterEndOfLine = 47,\n\tfontFamily = 48,\n\tfontInfo = 49,\n\tfontLigatures = 50,\n\tfontSize = 51,\n\tfontWeight = 52,\n\tfontVariations = 53,\n\tformatOnPaste = 54,\n\tformatOnType = 55,\n\tglyphMargin = 56,\n\tgotoLocation = 57,\n\thideCursorInOverviewRuler = 58,\n\thover = 59,\n\tinDiffEditor = 60,\n\tinlineSuggest = 61,\n\tletterSpacing = 62,\n\tlightbulb = 63,\n\tlineDecorationsWidth = 64,\n\tlineHeight = 65,\n\tlineNumbers = 66,\n\tlineNumbersMinChars = 67,\n\tlinkedEditing = 68,\n\tlinks = 69,\n\tmatchBrackets = 70,\n\tminimap = 71,\n\tmouseStyle = 72,\n\tmouseWheelScrollSensitivity = 73,\n\tmouseWheelZoom = 74,\n\tmultiCursorMergeOverlapping = 75,\n\tmultiCursorModifier = 76,\n\tmultiCursorPaste = 77,\n\tmultiCursorLimit = 78,\n\toccurrencesHighlight = 79,\n\toverviewRulerBorder = 80,\n\toverviewRulerLanes = 81,\n\tpadding = 82,\n\tpasteAs = 83,\n\tparameterHints = 84,\n\tpeekWidgetDefaultFocus = 85,\n\tdefinitionLinkOpensInPeek = 86,\n\tquickSuggestions = 87,\n\tquickSuggestionsDelay = 88,\n\treadOnly = 89,\n\treadOnlyMessage = 90,\n\trenameOnType = 91,\n\trenderControlCharacters = 92,\n\trenderFinalNewline = 93,\n\trenderLineHighlight = 94,\n\trenderLineHighlightOnlyWhenFocus = 95,\n\trenderValidationDecorations = 96,\n\trenderWhitespace = 97,\n\trevealHorizontalRightPadding = 98,\n\troundedSelection = 99,\n\trulers = 100,\n\tscrollbar = 101,\n\tscrollBeyondLastColumn = 102,\n\tscrollBeyondLastLine = 103,\n\tscrollPredominantAxis = 104,\n\tselectionClipboard = 105,\n\tselectionHighlight = 106,\n\tselectOnLineNumbers = 107,\n\tshowFoldingControls = 108,\n\tshowUnused = 109,\n\tsnippetSuggestions = 110,\n\tsmartSelect = 111,\n\tsmoothScrolling = 112,\n\tstickyScroll = 113,\n\tstickyTabStops = 114,\n\tstopRenderingLineAfter = 115,\n\tsuggest = 116,\n\tsuggestFontSize = 117,\n\tsuggestLineHeight = 118,\n\tsuggestOnTriggerCharacters = 119,\n\tsuggestSelection = 120,\n\ttabCompletion = 121,\n\ttabIndex = 122,\n\tunicodeHighlighting = 123,\n\tunusualLineTerminators = 124,\n\tuseShadowDOM = 125,\n\tuseTabStops = 126,\n\twordBreak = 127,\n\twordSeparators = 128,\n\twordWrap = 129,\n\twordWrapBreakAfterCharacters = 130,\n\twordWrapBreakBeforeCharacters = 131,\n\twordWrapColumn = 132,\n\twordWrapOverride1 = 133,\n\twordWrapOverride2 = 134,\n\twrappingIndent = 135,\n\twrappingStrategy = 136,\n\tshowDeprecated = 137,\n\tinlayHints = 138,\n\teditorClassName = 139,\n\tpixelRatio = 140,\n\ttabFocusMode = 141,\n\tlayoutInfo = 142,\n\twrappingInfo = 143,\n\tdefaultColorDecorators = 144,\n\tcolorDecoratorsActivatedOn = 145,\n\tinlineCompletionsAccessibilityVerbose = 146\n}\n\n/**\n * EOL character preference.\n *\n * `TextDefined` = 0, `LF` = 1, `CRLF` = 2\n */\nexport enum EndOfLinePreference {\n\t/**\n\t * Use the end of line character identified in the text buffer.\n\t */\n\tTextDefined = 0,\n\t/**\n\t * Use line feed (\\n) as the end of line character.\n\t */\n\tLF = 1,\n\t/**\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\n\t */\n\tCRLF = 2\n}\n\n/**\n * End of line character preference.\n *\n * `LF` = 0, `CRLF` = 1\n */\nexport enum EndOfLineSequence {\n\t/**\n\t * Use line feed (\\n) as the end of line character.\n\t */\n\tLF = 0,\n\t/**\n\t * Use carriage return and line feed (\\r\\n) as the end of line character.\n\t */\n\tCRLF = 1\n}\n\n/**\n * Vertical Lane in the glyph margin of the editor.\n *\n * `Left` = 1, `Right` = 2\n * - : `glyph margin` - https://microchipdeveloper.com/mplabx:glyph-margin\n */\nexport enum GlyphMarginLane {\n\tLeft = 1,\n\tRight = 2\n}\n\n/**\n * Describes what to do with the indentation when pressing Enter.\n */\nexport enum IndentAction {\n\t/**\n\t * Insert new line and copy the previous line's indentation.\n\t */\n\tNone = 0,\n\t/**\n\t * Insert new line and indent once (relative to the previous line's indentation).\n\t */\n\tIndent = 1,\n\t/**\n\t * Insert two new lines:\n\t *  - the first one indented which will hold the cursor\n\t *  - the second one at the same indentation level\n\t */\n\tIndentOutdent = 2,\n\t/**\n\t * Insert new line and outdent once (relative to the previous line's indentation).\n\t */\n\tOutdent = 3\n}\n\nexport enum InjectedTextCursorStops {\n\tBoth = 0,\n\tRight = 1,\n\tLeft = 2,\n\tNone = 3\n}\n\nexport enum InlayHintKind {\n\tType = 1,\n\tParameter = 2\n}\n\n/**\n * How an {@link InlineCompletionsProvider inline completion provider} was triggered.\n */\nexport enum InlineCompletionTriggerKind {\n\t/**\n\t * Completion was triggered automatically while editing.\n\t * It is sufficient to return a single completion item in this case.\n\t */\n\tAutomatic = 0,\n\t/**\n\t * Completion was triggered explicitly by a user gesture.\n\t * Return multiple completion items to enable cycling through them.\n\t */\n\tExplicit = 1\n}\n/**\n * Virtual Key Codes, the value does not hold any inherent meaning.\n * Inspired somewhat from https://msdn.microsoft.com/en-us/library/windows/desktop/dd375731(v=vs.85).aspx\n * But these are \"more general\", as they should work across browsers & OS`s.\n */\nexport enum KeyCode {\n\tDependsOnKbLayout = -1,\n\t/**\n\t * Placed first to cover the 0 value of the enum.\n\t */\n\tUnknown = 0,\n\tBackspace = 1,\n\tTab = 2,\n\tEnter = 3,\n\tShift = 4,\n\tCtrl = 5,\n\tAlt = 6,\n\tPauseBreak = 7,\n\tCapsLock = 8,\n\tEscape = 9,\n\tSpace = 10,\n\tPageUp = 11,\n\tPageDown = 12,\n\tEnd = 13,\n\tHome = 14,\n\tLeftArrow = 15,\n\tUpArrow = 16,\n\tRightArrow = 17,\n\tDownArrow = 18,\n\tInsert = 19,\n\tDelete = 20,\n\tDigit0 = 21,\n\tDigit1 = 22,\n\tDigit2 = 23,\n\tDigit3 = 24,\n\tDigit4 = 25,\n\tDigit5 = 26,\n\tDigit6 = 27,\n\tDigit7 = 28,\n\tDigit8 = 29,\n\tDigit9 = 30,\n\tKeyA = 31,\n\tKeyB = 32,\n\tKeyC = 33,\n\tKeyD = 34,\n\tKeyE = 35,\n\tKeyF = 36,\n\tKeyG = 37,\n\tKeyH = 38,\n\tKeyI = 39,\n\tKeyJ = 40,\n\tKeyK = 41,\n\tKeyL = 42,\n\tKeyM = 43,\n\tKeyN = 44,\n\tKeyO = 45,\n\tKeyP = 46,\n\tKeyQ = 47,\n\tKeyR = 48,\n\tKeyS = 49,\n\tKeyT = 50,\n\tKeyU = 51,\n\tKeyV = 52,\n\tKeyW = 53,\n\tKeyX = 54,\n\tKeyY = 55,\n\tKeyZ = 56,\n\tMeta = 57,\n\tContextMenu = 58,\n\tF1 = 59,\n\tF2 = 60,\n\tF3 = 61,\n\tF4 = 62,\n\tF5 = 63,\n\tF6 = 64,\n\tF7 = 65,\n\tF8 = 66,\n\tF9 = 67,\n\tF10 = 68,\n\tF11 = 69,\n\tF12 = 70,\n\tF13 = 71,\n\tF14 = 72,\n\tF15 = 73,\n\tF16 = 74,\n\tF17 = 75,\n\tF18 = 76,\n\tF19 = 77,\n\tF20 = 78,\n\tF21 = 79,\n\tF22 = 80,\n\tF23 = 81,\n\tF24 = 82,\n\tNumLock = 83,\n\tScrollLock = 84,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ';:' key\n\t */\n\tSemicolon = 85,\n\t/**\n\t * For any country/region, the '+' key\n\t * For the US standard keyboard, the '=+' key\n\t */\n\tEqual = 86,\n\t/**\n\t * For any country/region, the ',' key\n\t * For the US standard keyboard, the ',<' key\n\t */\n\tComma = 87,\n\t/**\n\t * For any country/region, the '-' key\n\t * For the US standard keyboard, the '-_' key\n\t */\n\tMinus = 88,\n\t/**\n\t * For any country/region, the '.' key\n\t * For the US standard keyboard, the '.>' key\n\t */\n\tPeriod = 89,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '/?' key\n\t */\n\tSlash = 90,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '`~' key\n\t */\n\tBackquote = 91,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '[{' key\n\t */\n\tBracketLeft = 92,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the '\\|' key\n\t */\n\tBackslash = 93,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ']}' key\n\t */\n\tBracketRight = 94,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t * For the US standard keyboard, the ''\"' key\n\t */\n\tQuote = 95,\n\t/**\n\t * Used for miscellaneous characters; it can vary by keyboard.\n\t */\n\tOEM_8 = 96,\n\t/**\n\t * Either the angle bracket key or the backslash key on the RT 102-key keyboard.\n\t */\n\tIntlBackslash = 97,\n\tNumpad0 = 98,\n\tNumpad1 = 99,\n\tNumpad2 = 100,\n\tNumpad3 = 101,\n\tNumpad4 = 102,\n\tNumpad5 = 103,\n\tNumpad6 = 104,\n\tNumpad7 = 105,\n\tNumpad8 = 106,\n\tNumpad9 = 107,\n\tNumpadMultiply = 108,\n\tNumpadAdd = 109,\n\tNUMPAD_SEPARATOR = 110,\n\tNumpadSubtract = 111,\n\tNumpadDecimal = 112,\n\tNumpadDivide = 113,\n\t/**\n\t * Cover all key codes when IME is processing input.\n\t */\n\tKEY_IN_COMPOSITION = 114,\n\tABNT_C1 = 115,\n\tABNT_C2 = 116,\n\tAudioVolumeMute = 117,\n\tAudioVolumeUp = 118,\n\tAudioVolumeDown = 119,\n\tBrowserSearch = 120,\n\tBrowserHome = 121,\n\tBrowserBack = 122,\n\tBrowserForward = 123,\n\tMediaTrackNext = 124,\n\tMediaTrackPrevious = 125,\n\tMediaStop = 126,\n\tMediaPlayPause = 127,\n\tLaunchMediaPlayer = 128,\n\tLaunchMail = 129,\n\tLaunchApp2 = 130,\n\t/**\n\t * VK_CLEAR, 0x0C, CLEAR key\n\t */\n\tClear = 131,\n\t/**\n\t * Placed last to cover the length of the enum.\n\t * Please do not depend on this value!\n\t */\n\tMAX_VALUE = 132\n}\n\nexport enum MarkerSeverity {\n\tHint = 1,\n\tInfo = 2,\n\tWarning = 4,\n\tError = 8\n}\n\nexport enum MarkerTag {\n\tUnnecessary = 1,\n\tDeprecated = 2\n}\n\n/**\n * Position in the minimap to render the decoration.\n *\n * `Inline` = 1, `Gutter` = 2\n * - : `Gutter` - https://support.smartbear.com/testcomplete/docs/scripting/code-editor/window/gutter.html\n */\nexport enum MinimapPosition {\n\tInline = 1,\n\tGutter = 2\n}\n\n/**\n * Type of hit element with the mouse in the editor.\n */\nexport enum MouseTargetType {\n\t/**\n\t * Mouse is on top of an unknown element.\n\t */\n\tUNKNOWN = 0,\n\t/**\n\t * Mouse is on top of the textarea used for input.\n\t */\n\tTEXTAREA = 1,\n\t/**\n\t * Mouse is on top of the glyph margin\n\t */\n\tGUTTER_GLYPH_MARGIN = 2,\n\t/**\n\t * Mouse is on top of the line numbers\n\t */\n\tGUTTER_LINE_NUMBERS = 3,\n\t/**\n\t * Mouse is on top of the line decorations\n\t */\n\tGUTTER_LINE_DECORATIONS = 4,\n\t/**\n\t * Mouse is on top of the whitespace left in the gutter by a view zone.\n\t */\n\tGUTTER_VIEW_ZONE = 5,\n\t/**\n\t * Mouse is on top of text in the content.\n\t */\n\tCONTENT_TEXT = 6,\n\t/**\n\t * Mouse is on top of empty space in the content (e.g. after line text or below last line)\n\t */\n\tCONTENT_EMPTY = 7,\n\t/**\n\t * Mouse is on top of a view zone in the content.\n\t */\n\tCONTENT_VIEW_ZONE = 8,\n\t/**\n\t * Mouse is on top of a content widget.\n\t */\n\tCONTENT_WIDGET = 9,\n\t/**\n\t * Mouse is on top of the decorations overview ruler.\n\t */\n\tOVERVIEW_RULER = 10,\n\t/**\n\t * Mouse is on top of a scrollbar.\n\t */\n\tSCROLLBAR = 11,\n\t/**\n\t * Mouse is on top of an overlay widget.\n\t */\n\tOVERLAY_WIDGET = 12,\n\t/**\n\t * Mouse is outside of the editor.\n\t */\n\tOUTSIDE_EDITOR = 13\n}\n\n/**\n * A positioning preference for rendering overlay widgets.\n */\nexport enum OverlayWidgetPositionPreference {\n\t/**\n\t * Position the overlay widget in the top right corner\n\t */\n\tTOP_RIGHT_CORNER = 0,\n\t/**\n\t * Position the overlay widget in the bottom right corner\n\t */\n\tBOTTOM_RIGHT_CORNER = 1,\n\t/**\n\t * Position the overlay widget in the top center\n\t */\n\tTOP_CENTER = 2\n}\n\n/**\n * Vertical Lane in the overview ruler of the editor.\n *\n * `Left` = 1, `Center` = 2, `Right` = 4, `Full` = 7\n * - : `overview ruler` - https://stackoverflow.com/questions/50593516/colored-pixels-in-scrollbar-in-vs-code/51684408#51684408\n */\nexport enum OverviewRulerLane {\n\tLeft = 1,\n\tCenter = 2,\n\tRight = 4,\n\tFull = 7\n}\n\nexport enum PositionAffinity {\n\t/**\n\t * Prefers the left most position.\n\t*/\n\tLeft = 0,\n\t/**\n\t * Prefers the right most position.\n\t*/\n\tRight = 1,\n\t/**\n\t * No preference.\n\t*/\n\tNone = 2,\n\t/**\n\t * If the given position is on injected text, prefers the position left of it.\n\t*/\n\tLeftOfInjectedText = 3,\n\t/**\n\t * If the given position is on injected text, prefers the position right of it.\n\t*/\n\tRightOfInjectedText = 4\n}\n\nexport enum RenderLineNumbersType {\n\tOff = 0,\n\tOn = 1,\n\tRelative = 2,\n\tInterval = 3,\n\tCustom = 4\n}\n\nexport enum RenderMinimap {\n\tNone = 0,\n\tText = 1,\n\tBlocks = 2\n}\n\nexport enum ScrollType {\n\tSmooth = 0,\n\tImmediate = 1\n}\n\nexport enum ScrollbarVisibility {\n\tAuto = 1,\n\tHidden = 2,\n\tVisible = 3\n}\n\n/**\n * (selection) \n */\nexport enum SelectionDirection {\n\t/**\n\t *   \n\t */\n\tLTR = 0,\n\t/**\n\t *   \n\t */\n\tRTL = 1\n}\n\nexport enum SignatureHelpTriggerKind {\n\tInvoke = 1,\n\tTriggerCharacter = 2,\n\tContentChange = 3\n}\n\n/**\n * A symbol kind.\n */\nexport enum SymbolKind {\n\tFile = 0,\n\tModule = 1,\n\tNamespace = 2,\n\tPackage = 3,\n\tClass = 4,\n\tMethod = 5,\n\tProperty = 6,\n\tField = 7,\n\tConstructor = 8,\n\tEnum = 9,\n\tInterface = 10,\n\tFunction = 11,\n\tVariable = 12,\n\tConstant = 13,\n\tString = 14,\n\tNumber = 15,\n\tBoolean = 16,\n\tArray = 17,\n\tObject = 18,\n\tKey = 19,\n\tNull = 20,\n\tEnumMember = 21,\n\tStruct = 22,\n\tEvent = 23,\n\tOperator = 24,\n\tTypeParameter = 25\n}\n\nexport enum SymbolTag {\n\tDeprecated = 1\n}\n\n/**\n * The kind of animation in which the editor's cursor should be rendered.\n */\nexport enum TextEditorCursorBlinkingStyle {\n\t/**\n\t * Hidden\n\t */\n\tHidden = 0,\n\t/**\n\t * Blinking\n\t */\n\tBlink = 1,\n\t/**\n\t * Blinking with smooth fading\n\t */\n\tSmooth = 2,\n\t/**\n\t * Blinking with prolonged filled state and smooth fading\n\t */\n\tPhase = 3,\n\t/**\n\t * Expand collapse animation on the y axis\n\t */\n\tExpand = 4,\n\t/**\n\t * No-Blinking\n\t */\n\tSolid = 5\n}\n\n/**\n * The style in which the editor's cursor should be rendered.\n */\nexport enum TextEditorCursorStyle {\n\t/**\n\t * As a vertical line (sitting between two characters).\n\t */\n\tLine = 1,\n\t/**\n\t * As a block (sitting on top of a character).\n\t */\n\tBlock = 2,\n\t/**\n\t * As a horizontal line (sitting under a character).\n\t */\n\tUnderline = 3,\n\t/**\n\t * As a thin vertical line (sitting between two characters).\n\t */\n\tLineThin = 4,\n\t/**\n\t * As an outlined block (sitting on top of a character).\n\t */\n\tBlockOutline = 5,\n\t/**\n\t * As a thin horizontal line (sitting under a character).\n\t */\n\tUnderlineThin = 6\n}\n\n/**\n * Describes the behavior of decorations when typing/editing near their edges.\n * Note: Please do not edit the values, as they very carefully match `DecorationRangeBehavior`\n */\nexport enum TrackedRangeStickiness {\n\tAlwaysGrowsWhenTypingAtEdges = 0,\n\tNeverGrowsWhenTypingAtEdges = 1,\n\tGrowsOnlyWhenTypingBefore = 2,\n\tGrowsOnlyWhenTypingAfter = 3\n}\n\n/**\n * Describes how to indent wrapped lines.\n */\nexport enum WrappingIndent {\n\t/**\n\t * No indentation => wrapped lines begin at column 1.\n\t */\n\tNone = 0,\n\t/**\n\t * Same => wrapped lines get the same indentation as the parent.\n\t */\n\tSame = 1,\n\t/**\n\t * Indent => wrapped lines get +1 indentation toward the parent.\n\t */\n\tIndent = 2,\n\t/**\n\t * DeepIndent => wrapped lines get +2 indentation toward the parent.\n\t */\n\tDeepIndent = 3\n}","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { Color } from 'vs/base/common/color';\r\nimport { Emitter, Event } from 'vs/base/common/event';\r\nimport { Disposable, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\r\nimport { ITokenizationRegistry, ITokenizationSupport, ITokenizationSupportChangedEvent, ILazyTokenizationSupport } from 'vs/editor/common/languages';\r\nimport { ColorId } from 'vs/editor/common/encodedTokenAttributes';\r\n\r\nexport class TokenizationRegistry implements ITokenizationRegistry {\r\n\r\n\tprivate readonly _tokenizationSupports = new Map<string, ITokenizationSupport>();\r\n\tprivate readonly _factories = new Map<string, TokenizationSupportFactoryData>();\r\n\r\n\tprivate readonly _onDidChange = new Emitter<ITokenizationSupportChangedEvent>();\r\n\tpublic readonly onDidChange: Event<ITokenizationSupportChangedEvent> = this._onDidChange.event;\r\n\r\n\tprivate _colorMap: Color[] | null;\r\n\r\n\tconstructor() {\r\n\t\tthis._colorMap = null;\r\n\t}\r\n\r\n\tpublic handleChange(languageIds: string[]): void {\r\n\t\tthis._onDidChange.fire({\r\n\t\t\tchangedLanguages: languageIds,\r\n\t\t\tchangedColorMap: false\r\n\t\t});\r\n\t}\r\n\r\n\tpublic register(languageId: string, support: ITokenizationSupport): IDisposable {\r\n\t\tthis._tokenizationSupports.set(languageId, support);\r\n\t\tthis.handleChange([languageId]);\r\n\t\treturn toDisposable(() => {\r\n\t\t\tif (this._tokenizationSupports.get(languageId) !== support) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._tokenizationSupports.delete(languageId);\r\n\t\t\tthis.handleChange([languageId]);\r\n\t\t});\r\n\t}\r\n\r\n\tpublic get(languageId: string): ITokenizationSupport | null {\r\n\t\treturn this._tokenizationSupports.get(languageId) || null;\r\n\t}\r\n\r\n\tpublic registerFactory(languageId: string, factory: ILazyTokenizationSupport): IDisposable {\r\n\t\tthis._factories.get(languageId)?.dispose();\r\n\t\tconst myData = new TokenizationSupportFactoryData(this, languageId, factory);\r\n\t\tthis._factories.set(languageId, myData);\r\n\t\treturn toDisposable(() => {\r\n\t\t\tconst v = this._factories.get(languageId);\r\n\t\t\tif (!v || v !== myData) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._factories.delete(languageId);\r\n\t\t\tv.dispose();\r\n\t\t});\r\n\t}\r\n\r\n\tpublic async getOrCreate(languageId: string): Promise<ITokenizationSupport | null> {\r\n\t\t// check first if the support is already set\r\n\t\tconst tokenizationSupport = this.get(languageId);\r\n\t\tif (tokenizationSupport) {\r\n\t\t\treturn tokenizationSupport;\r\n\t\t}\r\n\r\n\t\tconst factory = this._factories.get(languageId);\r\n\t\tif (!factory || factory.isResolved) {\r\n\t\t\t// no factory or factory.resolve already finished\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tawait factory.resolve();\r\n\r\n\t\treturn this.get(languageId);\r\n\t}\r\n\r\n\tpublic isResolved(languageId: string): boolean {\r\n\t\tconst tokenizationSupport = this.get(languageId);\r\n\t\tif (tokenizationSupport) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\tconst factory = this._factories.get(languageId);\r\n\t\tif (!factory || factory.isResolved) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t}\r\n\r\n\tpublic setColorMap(colorMap: Color[]): void {\r\n\t\tthis._colorMap = colorMap;\r\n\t\tthis._onDidChange.fire({\r\n\t\t\tchangedLanguages: Array.from(this._tokenizationSupports.keys()),\r\n\t\t\tchangedColorMap: true\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getColorMap(): Color[] | null {\r\n\t\treturn this._colorMap;\r\n\t}\r\n\r\n\tpublic getDefaultBackground(): Color | null {\r\n\t\tif (this._colorMap && this._colorMap.length > ColorId.DefaultBackground) {\r\n\t\t\treturn this._colorMap[ColorId.DefaultBackground];\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\nclass TokenizationSupportFactoryData extends Disposable {\r\n\r\n\tprivate _isDisposed: boolean = false;\r\n\tprivate _resolvePromise: Promise<void> | null = null;\r\n\tprivate _isResolved: boolean = false;\r\n\r\n\tpublic get isResolved(): boolean {\r\n\t\treturn this._isResolved;\r\n\t}\r\n\r\n\tconstructor(\r\n\t\tprivate readonly _registry: TokenizationRegistry,\r\n\t\tprivate readonly _languageId: string,\r\n\t\tprivate readonly _factory: ILazyTokenizationSupport,\r\n\t) {\r\n\t\tsuper();\r\n\t}\r\n\r\n\tpublic override dispose(): void {\r\n\t\tthis._isDisposed = true;\r\n\t\tsuper.dispose();\r\n\t}\r\n\r\n\tpublic async resolve(): Promise<void> {\r\n\t\tif (!this._resolvePromise) {\r\n\t\t\tthis._resolvePromise = this._create();\r\n\t\t}\r\n\t\treturn this._resolvePromise;\r\n\t}\r\n\r\n\tprivate async _create(): Promise<void> {\r\n\t\tconst value = await this._factory.tokenizationSupport;\r\n\t\tthis._isResolved = true;\r\n\t\tif (value && !this._isDisposed) {\r\n\t\t\tthis._register(this._registry.register(this._languageId, value));\r\n\t\t}\r\n\t}\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nimport * as nls from 'vs/nls';\r\n\r\nexport const LANGUAGE_DEFAULT = 'en';\r\n\r\nlet _isWindows = false;\r\nlet _isMacintosh = false;\r\nlet _isLinux = false;\r\nlet _isLinuxSnap = false;\r\nlet _isNative = false;\r\nlet _isWeb = false;\r\nlet _isElectron = false;\r\nlet _isIOS = false;\r\nlet _isCI = false;\r\nlet _isMobile = false;\r\nlet _locale: string | undefined = undefined;\r\nlet _language: string = LANGUAGE_DEFAULT;\r\nlet _platformLocale: string = LANGUAGE_DEFAULT;\r\nlet _translationsConfigFile: string | undefined = undefined;\r\nlet _userAgent: string | undefined = undefined;\r\n\r\ninterface NLSConfig {\r\n\tlocale: string;\r\n\tosLocale: string;\r\n\tavailableLanguages: { [key: string]: string };\r\n\t_translationsConfigFile: string;\r\n}\r\n\r\nexport interface IProcessEnvironment {\r\n\t[key: string]: string | undefined;\r\n}\r\n\r\n/**\r\n * This interface is intentionally not identical to node.js\r\n * process because it also works in sandboxed environments\r\n * where the process object is implemented differently. We\r\n * define the properties here that we need for `platform`\r\n * to work and nothing else.\r\n */\r\nexport interface INodeProcess {\r\n\tplatform: string;\r\n\tarch: string;\r\n\tenv: IProcessEnvironment;\r\n\tversions?: {\r\n\t\telectron?: string;\r\n\t\tchrome?: string;\r\n\t};\r\n\ttype?: string;\r\n\tcwd: () => string;\r\n}\r\n\r\ndeclare const process: INodeProcess;\r\ndeclare const global: unknown;\r\ndeclare const self: unknown;\r\n\r\n/**\r\n * @deprecated use `globalThis` instead\r\n */\r\nexport const globals: any = (typeof self === 'object' ? self : typeof global === 'object' ? global : {});\r\n\r\nlet nodeProcess: INodeProcess | undefined = undefined;\r\nif (typeof globals.vscode !== 'undefined' && typeof globals.vscode.process !== 'undefined') {\r\n\t// Native environment (sandboxed)\r\n\tnodeProcess = globals.vscode.process;\r\n} else if (typeof process !== 'undefined') {\r\n\t// Native environment (non-sandboxed)\r\n\tnodeProcess = process;\r\n}\r\n\r\nconst isElectronProcess = typeof nodeProcess?.versions?.electron === 'string';\r\nconst isElectronRenderer = isElectronProcess && nodeProcess?.type === 'renderer';\r\n\r\ninterface INavigator {\r\n\tuserAgent: string;\r\n\tmaxTouchPoints?: number;\r\n\tlanguage: string;\r\n}\r\ndeclare const navigator: INavigator;\r\n\r\n// Web environment\r\nif (typeof navigator === 'object' && !isElectronRenderer) {\r\n\t_userAgent = navigator.userAgent;\r\n\t_isWindows = _userAgent.indexOf('Windows') >= 0;\r\n\t_isMacintosh = _userAgent.indexOf('Macintosh') >= 0;\r\n\t_isIOS = (_userAgent.indexOf('Macintosh') >= 0 || _userAgent.indexOf('iPad') >= 0 || _userAgent.indexOf('iPhone') >= 0) && !!navigator.maxTouchPoints && navigator.maxTouchPoints > 0;\r\n\t_isLinux = _userAgent.indexOf('Linux') >= 0;\r\n\t_isMobile = _userAgent?.indexOf('Mobi') >= 0;\r\n\t_isWeb = true;\r\n\r\n\tconst configuredLocale = nls.getConfiguredDefaultLocale(\r\n\t\t// This call _must_ be done in the file that calls `nls.getConfiguredDefaultLocale`\r\n\t\t// to ensure that the NLS AMD Loader plugin has been loaded and configured.\r\n\t\t// This is because the loader plugin decides what the default locale is based on\r\n\t\t// how it's able to resolve the strings.\r\n\t\tnls.localize({ key: 'ensureLoaderPluginIsLoaded', comment: ['{Locked}'] }, '_')\r\n\t);\r\n\r\n\t_locale = configuredLocale || LANGUAGE_DEFAULT;\r\n\t_language = _locale;\r\n\t_platformLocale = navigator.language;\r\n}\r\n\r\n// Native environment\r\nelse if (typeof nodeProcess === 'object') {\r\n\t_isWindows = (nodeProcess.platform === 'win32');\r\n\t_isMacintosh = (nodeProcess.platform === 'darwin');\r\n\t_isLinux = (nodeProcess.platform === 'linux');\r\n\t_isLinuxSnap = _isLinux && !!nodeProcess.env['SNAP'] && !!nodeProcess.env['SNAP_REVISION'];\r\n\t_isElectron = isElectronProcess;\r\n\t_isCI = !!nodeProcess.env['CI'] || !!nodeProcess.env['BUILD_ARTIFACTSTAGINGDIRECTORY'];\r\n\t_locale = LANGUAGE_DEFAULT;\r\n\t_language = LANGUAGE_DEFAULT;\r\n\tconst rawNlsConfig = nodeProcess.env['VSCODE_NLS_CONFIG'];\r\n\tif (rawNlsConfig) {\r\n\t\ttry {\r\n\t\t\tconst nlsConfig: NLSConfig = JSON.parse(rawNlsConfig);\r\n\t\t\tconst resolved = nlsConfig.availableLanguages['*'];\r\n\t\t\t_locale = nlsConfig.locale;\r\n\t\t\t_platformLocale = nlsConfig.osLocale;\r\n\t\t\t// VSCode's default language is 'en'\r\n\t\t\t_language = resolved ? resolved : LANGUAGE_DEFAULT;\r\n\t\t\t_translationsConfigFile = nlsConfig._translationsConfigFile;\r\n\t\t} catch (e) {\r\n\t\t}\r\n\t}\r\n\t_isNative = true;\r\n}\r\n\r\n// Unknown environment\r\nelse {\r\n\tconsole.error('Unable to resolve platform.');\r\n}\r\n\r\nexport const enum Platform {\r\n\tWeb,\r\n\tMac,\r\n\tLinux,\r\n\tWindows\r\n}\r\n\r\nlet _platform: Platform = Platform.Web;\r\nif (_isMacintosh) {\r\n\t_platform = Platform.Mac;\r\n} else if (_isWindows) {\r\n\t_platform = Platform.Windows;\r\n} else if (_isLinux) {\r\n\t_platform = Platform.Linux;\r\n}\r\n\r\nexport const isWindows = _isWindows;\r\nexport const isMacintosh = _isMacintosh;\r\nexport const isLinux = _isLinux;\r\nexport const isNative = _isNative;\r\nexport const isWeb = _isWeb;\r\nexport const isWebWorker = (_isWeb && typeof globals.importScripts === 'function');\r\nexport const isIOS = _isIOS;\r\nexport const isMobile = _isMobile;\r\nexport const userAgent = _userAgent;\r\n\r\n/**\r\n * The language used for the user interface. The format of\r\n * the string is all lower case (e.g. zh-tw for Traditional\r\n * Chinese)\r\n */\r\nexport const language = _language;\r\n\r\nexport const setTimeout0IsFaster = (typeof globals.postMessage === 'function' && !globals.importScripts);\r\n\r\n/**\r\n * See https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#:~:text=than%204%2C%20then-,set%20timeout%20to%204,-.\r\n *\r\n * Works similarly to `setTimeout(0)` but doesn't suffer from the 4ms artificial delay\r\n * that browsers set when the nesting level is > 5.\r\n */\r\nexport const setTimeout0 = (() => {\r\n\tif (setTimeout0IsFaster) {\r\n\t\tinterface IQueueElement {\r\n\t\t\tid: number;\r\n\t\t\tcallback: () => void;\r\n\t\t}\r\n\t\tconst pending: IQueueElement[] = [];\r\n\t\tglobals.addEventListener('message', (e: MessageEvent) => {\r\n\t\t\tif (e.data && e.data.vscodeScheduleAsyncWork) {\r\n\t\t\t\tfor (let i = 0, len = pending.length; i < len; i++) {\r\n\t\t\t\t\tconst candidate = pending[i];\r\n\t\t\t\t\tif (candidate.id === e.data.vscodeScheduleAsyncWork) {\r\n\t\t\t\t\t\tpending.splice(i, 1);\r\n\t\t\t\t\t\tcandidate.callback();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tlet lastId = 0;\r\n\t\treturn (callback: () => void) => {\r\n\t\t\tconst myId = ++lastId;\r\n\t\t\tpending.push({\r\n\t\t\t\tid: myId,\r\n\t\t\t\tcallback: callback\r\n\t\t\t});\r\n\t\t\tglobals.postMessage({ vscodeScheduleAsyncWork: myId }, '*');\r\n\t\t};\r\n\t}\r\n\treturn (callback: () => void) => setTimeout(callback);\r\n})();\r\n\r\nexport const enum OperatingSystem {\r\n\tWindows = 1,\r\n\tMacintosh = 2,\r\n\tLinux = 3\r\n}\r\nexport const OS = (_isMacintosh || _isIOS ? OperatingSystem.Macintosh : (_isWindows ? OperatingSystem.Windows : OperatingSystem.Linux));\r\n\r\nlet _isLittleEndian = true;\r\nlet _isLittleEndianComputed = false;\r\n/**     */\r\nexport function isLittleEndian(): boolean {\r\n\tif (!_isLittleEndianComputed) {\r\n\t\t_isLittleEndianComputed = true;\r\n\t\tconst test = new Uint8Array(2);\r\n\t\ttest[0] = 1;\r\n\t\ttest[1] = 2;\r\n\t\tconst view = new Uint16Array(test.buffer);\r\n\t\t_isLittleEndian = (view[0] === (2 << 8) + 1);\r\n\t}\r\n\treturn _isLittleEndian;\r\n}\r\n\r\nexport const isChrome = !!(userAgent && userAgent.indexOf('Chrome') >= 0);\r\nexport const isFirefox = !!(userAgent && userAgent.indexOf('Firefox') >= 0);\r\nexport const isSafari = !!(!isChrome && (userAgent && userAgent.indexOf('Safari') >= 0));\r\nexport const isEdge = !!(userAgent && userAgent.indexOf('Edg/') >= 0);\r\nexport const isAndroid = !!(userAgent && userAgent.indexOf('Android') >= 0);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { globals, INodeProcess, isMacintosh, isWindows } from 'vs/base/common/platform';\r\n\r\nlet safeProcess: Omit<INodeProcess, 'arch'> & { arch: string | undefined };\r\ndeclare const process: INodeProcess;\r\n\r\n// Native sandbox environment\r\nif (typeof globals.vscode !== 'undefined' && typeof globals.vscode.process !== 'undefined') {\r\n\tconst sandboxProcess: INodeProcess = globals.vscode.process;\r\n\tsafeProcess = {\r\n\t\tget platform() { return sandboxProcess.platform; },\r\n\t\tget arch() { return sandboxProcess.arch; },\r\n\t\tget env() { return sandboxProcess.env; },\r\n\t\tcwd() { return sandboxProcess.cwd(); }\r\n\t};\r\n}\r\n\r\n// Native node.js environment\r\nelse if (typeof process !== 'undefined') {\r\n\tsafeProcess = {\r\n\t\tget platform() { return process.platform; },\r\n\t\tget arch() { return process.arch; },\r\n\t\tget env() { return process.env; },\r\n\t\tcwd() { return process.env['VSCODE_CWD'] || process.cwd(); }\r\n\t};\r\n}\r\n\r\n// Web environment\r\nelse {\r\n\tsafeProcess = {\r\n\r\n\t\t// Supported\r\n\t\tget platform() { return isWindows ? 'win32' : isMacintosh ? 'darwin' : 'linux'; },\r\n\t\tget arch() { return undefined; /* arch is undefined in web */ },\r\n\r\n\t\t// Unsupported\r\n\t\tget env() { return {}; },\r\n\t\tcwd() { return '/'; }\r\n\t};\r\n}\r\n\r\n/**\r\n * Provides safe access to the `cwd` property in node.js, sandboxed or web\r\n * environments.\r\n *\r\n * Note: in web, this property is hardcoded to be `/`.\r\n *\r\n * @skipMangle\r\n */\r\nexport const cwd = safeProcess.cwd;\r\n\r\n/**\r\n * Provides safe access to the `env` property in node.js, sandboxed or web\r\n * environments.\r\n *\r\n * Note: in web, this property is hardcoded to be `{}`.\r\n */\r\nexport const env = safeProcess.env;\r\n\r\n/**\r\n * Provides safe access to the `platform` property in node.js, sandboxed or web\r\n * environments.\r\n */\r\nexport const platform = safeProcess.platform;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\n// NOTE: VSCode's copy of nodejs path library to be usable in common (non-node) namespace\r\n// Copied from: https://github.com/nodejs/node/blob/v16.14.2/lib/path.js\r\n\r\n/**\r\n * Copyright Joyent, Inc. and other Node contributors.\r\n *\r\n * Permission is hereby granted, free of charge, to any person obtaining a\r\n * copy of this software and associated documentation files (the\r\n * \"Software\"), to deal in the Software without restriction, including\r\n * without limitation the rights to use, copy, modify, merge, publish,\r\n * distribute, sublicense, and/or sell copies of the Software, and to permit\r\n * persons to whom the Software is furnished to do so, subject to the\r\n * following conditions:\r\n *\r\n * The above copyright notice and this permission notice shall be included\r\n * in all copies or substantial portions of the Software.\r\n *\r\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\r\n * NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\r\n * DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\r\n * OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\r\n * USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n */\r\n\r\nimport * as process from 'vs/base/common/process';\r\n\r\nconst CHAR_UPPERCASE_A = 65;/* A */\r\nconst CHAR_LOWERCASE_A = 97; /* a */\r\nconst CHAR_UPPERCASE_Z = 90; /* Z */\r\nconst CHAR_LOWERCASE_Z = 122; /* z */\r\nconst CHAR_DOT = 46; /* . */\r\nconst CHAR_FORWARD_SLASH = 47; /* / */\r\nconst CHAR_BACKWARD_SLASH = 92; /* \\ */\r\nconst CHAR_COLON = 58; /* : */\r\nconst CHAR_QUESTION_MARK = 63; /* ? */\r\n\r\nclass ErrorInvalidArgType extends Error {\r\n\tcode: 'ERR_INVALID_ARG_TYPE';\r\n\tconstructor(name: string, expected: string, actual: unknown) {\r\n\t\t// determiner: 'must be' or 'must not be'\r\n\t\tlet determiner;\r\n\t\tif (typeof expected === 'string' && expected.indexOf('not ') === 0) {\r\n\t\t\tdeterminer = 'must not be';\r\n\t\t\texpected = expected.replace(/^not /, '');\r\n\t\t} else {\r\n\t\t\tdeterminer = 'must be';\r\n\t\t}\r\n\r\n\t\tconst type = name.indexOf('.') !== -1 ? 'property' : 'argument';\r\n\t\tlet msg = `The \"${name}\" ${type} ${determiner} of type ${expected}`;\r\n\r\n\t\tmsg += `. Received type ${typeof actual}`;\r\n\t\tsuper(msg);\r\n\r\n\t\tthis.code = 'ERR_INVALID_ARG_TYPE';\r\n\t}\r\n}\r\n\r\nfunction validateObject(pathObject: object, name: string) {\r\n\tif (pathObject === null || typeof pathObject !== 'object') {\r\n\t\tthrow new ErrorInvalidArgType(name, 'Object', pathObject);\r\n\t}\r\n}\r\n\r\nfunction validateString(value: string, name: string) {\r\n\tif (typeof value !== 'string') {\r\n\t\tthrow new ErrorInvalidArgType(name, 'string', value);\r\n\t}\r\n}\r\n\r\nconst platformIsWin32 = (process.platform === 'win32');\r\n\r\nfunction isPathSeparator(code: number | undefined) {\r\n\treturn code === CHAR_FORWARD_SLASH || code === CHAR_BACKWARD_SLASH;\r\n}\r\n\r\nfunction isPosixPathSeparator(code: number | undefined) {\r\n\treturn code === CHAR_FORWARD_SLASH;\r\n}\r\n\r\nfunction isWindowsDeviceRoot(code: number) {\r\n\treturn (code >= CHAR_UPPERCASE_A && code <= CHAR_UPPERCASE_Z) ||\r\n\t\t(code >= CHAR_LOWERCASE_A && code <= CHAR_LOWERCASE_Z);\r\n}\r\n\r\n// Resolves . and .. elements in a path with directory names\r\nfunction normalizeString(path: string, allowAboveRoot: boolean, separator: string, isPathSeparator: (code?: number) => boolean) {\r\n\tlet res = '';\r\n\tlet lastSegmentLength = 0;\r\n\tlet lastSlash = -1;\r\n\tlet dots = 0;\r\n\tlet code = 0;\r\n\tfor (let i = 0; i <= path.length; ++i) {\r\n\t\tif (i < path.length) {\r\n\t\t\tcode = path.charCodeAt(i);\r\n\t\t}\r\n\t\telse if (isPathSeparator(code)) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcode = CHAR_FORWARD_SLASH;\r\n\t\t}\r\n\r\n\t\tif (isPathSeparator(code)) {\r\n\t\t\tif (lastSlash === i - 1 || dots === 1) {\r\n\t\t\t\t// NOOP\r\n\t\t\t} else if (dots === 2) {\r\n\t\t\t\tif (res.length < 2 || lastSegmentLength !== 2 ||\r\n\t\t\t\t\tres.charCodeAt(res.length - 1) !== CHAR_DOT ||\r\n\t\t\t\t\tres.charCodeAt(res.length - 2) !== CHAR_DOT) {\r\n\t\t\t\t\tif (res.length > 2) {\r\n\t\t\t\t\t\tconst lastSlashIndex = res.lastIndexOf(separator);\r\n\t\t\t\t\t\tif (lastSlashIndex === -1) {\r\n\t\t\t\t\t\t\tres = '';\r\n\t\t\t\t\t\t\tlastSegmentLength = 0;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tres = res.slice(0, lastSlashIndex);\r\n\t\t\t\t\t\t\tlastSegmentLength = res.length - 1 - res.lastIndexOf(separator);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlastSlash = i;\r\n\t\t\t\t\t\tdots = 0;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t} else if (res.length !== 0) {\r\n\t\t\t\t\t\tres = '';\r\n\t\t\t\t\t\tlastSegmentLength = 0;\r\n\t\t\t\t\t\tlastSlash = i;\r\n\t\t\t\t\t\tdots = 0;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (allowAboveRoot) {\r\n\t\t\t\t\tres += res.length > 0 ? `${separator}..` : '..';\r\n\t\t\t\t\tlastSegmentLength = 2;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (res.length > 0) {\r\n\t\t\t\t\tres += `${separator}${path.slice(lastSlash + 1, i)}`;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tres = path.slice(lastSlash + 1, i);\r\n\t\t\t\t}\r\n\t\t\t\tlastSegmentLength = i - lastSlash - 1;\r\n\t\t\t}\r\n\t\t\tlastSlash = i;\r\n\t\t\tdots = 0;\r\n\t\t} else if (code === CHAR_DOT && dots !== -1) {\r\n\t\t\t++dots;\r\n\t\t} else {\r\n\t\t\tdots = -1;\r\n\t\t}\r\n\t}\r\n\treturn res;\r\n}\r\n\r\nfunction _format(sep: string, pathObject: ParsedPath) {\r\n\tvalidateObject(pathObject, 'pathObject');\r\n\tconst dir = pathObject.dir || pathObject.root;\r\n\tconst base = pathObject.base ||\r\n\t\t`${pathObject.name || ''}${pathObject.ext || ''}`;\r\n\tif (!dir) {\r\n\t\treturn base;\r\n\t}\r\n\treturn dir === pathObject.root ? `${dir}${base}` : `${dir}${sep}${base}`;\r\n}\r\n\r\nexport interface ParsedPath {\r\n\troot: string;\r\n\tdir: string;\r\n\tbase: string;\r\n\text: string;\r\n\tname: string;\r\n}\r\n\r\nexport interface IPath {\r\n\tnormalize(path: string): string;\r\n\tisAbsolute(path: string): boolean;\r\n\tjoin(...paths: string[]): string;\r\n\tresolve(...pathSegments: string[]): string;\r\n\trelative(from: string, to: string): string;\r\n\tdirname(path: string): string;\r\n\tbasename(path: string, ext?: string): string;\r\n\textname(path: string): string;\r\n\tformat(pathObject: ParsedPath): string;\r\n\tparse(path: string): ParsedPath;\r\n\ttoNamespacedPath(path: string): string;\r\n\tsep: '\\\\' | '/';\r\n\tdelimiter: string;\r\n\twin32: IPath | null;\r\n\tposix: IPath | null;\r\n}\r\n\r\nexport const win32: IPath = {\r\n\t// path.resolve([from ...], to)\r\n\tresolve(...pathSegments: string[]): string {\r\n\t\tlet resolvedDevice = '';\r\n\t\tlet resolvedTail = '';\r\n\t\tlet resolvedAbsolute = false;\r\n\r\n\t\tfor (let i = pathSegments.length - 1; i >= -1; i--) {\r\n\t\t\tlet path;\r\n\t\t\tif (i >= 0) {\r\n\t\t\t\tpath = pathSegments[i];\r\n\t\t\t\tvalidateString(path, 'path');\r\n\r\n\t\t\t\t// Skip empty entries\r\n\t\t\t\tif (path.length === 0) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t} else if (resolvedDevice.length === 0) {\r\n\t\t\t\tpath = process.cwd();\r\n\t\t\t} else {\r\n\t\t\t\t// Windows has the concept of drive-specific current working\r\n\t\t\t\t// directories. If we've resolved a drive letter but not yet an\r\n\t\t\t\t// absolute path, get cwd for that drive, or the process cwd if\r\n\t\t\t\t// the drive cwd is not available. We're sure the device is not\r\n\t\t\t\t// a UNC path at this points, because UNC paths are always absolute.\r\n\t\t\t\tpath = process.env[`=${resolvedDevice}`] || process.cwd();\r\n\r\n\t\t\t\t// Verify that a cwd was found and that it actually points\r\n\t\t\t\t// to our drive. If not, default to the drive's root.\r\n\t\t\t\tif (path === undefined ||\r\n\t\t\t\t\t(path.slice(0, 2).toLowerCase() !== resolvedDevice.toLowerCase() &&\r\n\t\t\t\t\t\tpath.charCodeAt(2) === CHAR_BACKWARD_SLASH)) {\r\n\t\t\t\t\tpath = `${resolvedDevice}\\\\`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst len = path.length;\r\n\t\t\tlet rootEnd = 0;\r\n\t\t\tlet device = '';\r\n\t\t\tlet isAbsolute = false;\r\n\t\t\tconst code = path.charCodeAt(0);\r\n\r\n\t\t\t// Try to match a root\r\n\t\t\tif (len === 1) {\r\n\t\t\t\tif (isPathSeparator(code)) {\r\n\t\t\t\t\t// `path` contains just a path separator\r\n\t\t\t\t\trootEnd = 1;\r\n\t\t\t\t\tisAbsolute = true;\r\n\t\t\t\t}\r\n\t\t\t} else if (isPathSeparator(code)) {\r\n\t\t\t\t// Possible UNC root\r\n\r\n\t\t\t\t// If we started with a separator, we know we at least have an\r\n\t\t\t\t// absolute path of some kind (UNC or otherwise)\r\n\t\t\t\tisAbsolute = true;\r\n\r\n\t\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\r\n\t\t\t\t\t// Matched double path separator at beginning\r\n\t\t\t\t\tlet j = 2;\r\n\t\t\t\t\tlet last = j;\r\n\t\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\tj++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t\tconst firstPart = path.slice(last, j);\r\n\t\t\t\t\t\t// Matched!\r\n\t\t\t\t\t\tlast = j;\r\n\t\t\t\t\t\t// Match 1 or more path separators\r\n\t\t\t\t\t\twhile (j < len && isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t\t\t// Matched!\r\n\t\t\t\t\t\t\tlast = j;\r\n\t\t\t\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (j === len || j !== last) {\r\n\t\t\t\t\t\t\t\t// We matched a UNC root\r\n\t\t\t\t\t\t\t\tdevice = `\\\\\\\\${firstPart}\\\\${path.slice(last, j)}`;\r\n\t\t\t\t\t\t\t\trootEnd = j;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\trootEnd = 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (isWindowsDeviceRoot(code) &&\r\n\t\t\t\tpath.charCodeAt(1) === CHAR_COLON) {\r\n\t\t\t\t// Possible device root\r\n\t\t\t\tdevice = path.slice(0, 2);\r\n\t\t\t\trootEnd = 2;\r\n\t\t\t\tif (len > 2 && isPathSeparator(path.charCodeAt(2))) {\r\n\t\t\t\t\t// Treat separator following drive name as an absolute path\r\n\t\t\t\t\t// indicator\r\n\t\t\t\t\tisAbsolute = true;\r\n\t\t\t\t\trootEnd = 3;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (device.length > 0) {\r\n\t\t\t\tif (resolvedDevice.length > 0) {\r\n\t\t\t\t\tif (device.toLowerCase() !== resolvedDevice.toLowerCase()) {\r\n\t\t\t\t\t\t// This path points to another device so it is not applicable\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresolvedDevice = device;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (resolvedAbsolute) {\r\n\t\t\t\tif (resolvedDevice.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tresolvedTail = `${path.slice(rootEnd)}\\\\${resolvedTail}`;\r\n\t\t\t\tresolvedAbsolute = isAbsolute;\r\n\t\t\t\tif (isAbsolute && resolvedDevice.length > 0) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// At this point the path should be resolved to a full absolute path,\r\n\t\t// but handle relative paths to be safe (might happen when process.cwd()\r\n\t\t// fails)\r\n\r\n\t\t// Normalize the tail path\r\n\t\tresolvedTail = normalizeString(resolvedTail, !resolvedAbsolute, '\\\\',\r\n\t\t\tisPathSeparator);\r\n\r\n\t\treturn resolvedAbsolute ?\r\n\t\t\t`${resolvedDevice}\\\\${resolvedTail}` :\r\n\t\t\t`${resolvedDevice}${resolvedTail}` || '.';\r\n\t},\r\n\r\n\tnormalize(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\t\tconst len = path.length;\r\n\t\tif (len === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\t\tlet rootEnd = 0;\r\n\t\tlet device;\r\n\t\tlet isAbsolute = false;\r\n\t\tconst code = path.charCodeAt(0);\r\n\r\n\t\t// Try to match a root\r\n\t\tif (len === 1) {\r\n\t\t\t// `path` contains just a single char, exit early to avoid\r\n\t\t\t// unnecessary work\r\n\t\t\treturn isPosixPathSeparator(code) ? '\\\\' : path;\r\n\t\t}\r\n\t\tif (isPathSeparator(code)) {\r\n\t\t\t// Possible UNC root\r\n\r\n\t\t\t// If we started with a separator, we know we at least have an absolute\r\n\t\t\t// path of some kind (UNC or otherwise)\r\n\t\t\tisAbsolute = true;\r\n\r\n\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\r\n\t\t\t\t// Matched double path separator at beginning\r\n\t\t\t\tlet j = 2;\r\n\t\t\t\tlet last = j;\r\n\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\tconst firstPart = path.slice(last, j);\r\n\t\t\t\t\t// Matched!\r\n\t\t\t\t\tlast = j;\r\n\t\t\t\t\t// Match 1 or more path separators\r\n\t\t\t\t\twhile (j < len && isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\tj++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t\t// Matched!\r\n\t\t\t\t\t\tlast = j;\r\n\t\t\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j === len) {\r\n\t\t\t\t\t\t\t// We matched a UNC root only\r\n\t\t\t\t\t\t\t// Return the normalized version of the UNC root since there\r\n\t\t\t\t\t\t\t// is nothing left to process\r\n\t\t\t\t\t\t\treturn `\\\\\\\\${firstPart}\\\\${path.slice(last)}\\\\`;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j !== last) {\r\n\t\t\t\t\t\t\t// We matched a UNC root with leftovers\r\n\t\t\t\t\t\t\tdevice = `\\\\\\\\${firstPart}\\\\${path.slice(last, j)}`;\r\n\t\t\t\t\t\t\trootEnd = j;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\trootEnd = 1;\r\n\t\t\t}\r\n\t\t} else if (isWindowsDeviceRoot(code) && path.charCodeAt(1) === CHAR_COLON) {\r\n\t\t\t// Possible device root\r\n\t\t\tdevice = path.slice(0, 2);\r\n\t\t\trootEnd = 2;\r\n\t\t\tif (len > 2 && isPathSeparator(path.charCodeAt(2))) {\r\n\t\t\t\t// Treat separator following drive name as an absolute path\r\n\t\t\t\t// indicator\r\n\t\t\t\tisAbsolute = true;\r\n\t\t\t\trootEnd = 3;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet tail = rootEnd < len ?\r\n\t\t\tnormalizeString(path.slice(rootEnd), !isAbsolute, '\\\\', isPathSeparator) :\r\n\t\t\t'';\r\n\t\tif (tail.length === 0 && !isAbsolute) {\r\n\t\t\ttail = '.';\r\n\t\t}\r\n\t\tif (tail.length > 0 && isPathSeparator(path.charCodeAt(len - 1))) {\r\n\t\t\ttail += '\\\\';\r\n\t\t}\r\n\t\tif (device === undefined) {\r\n\t\t\treturn isAbsolute ? `\\\\${tail}` : tail;\r\n\t\t}\r\n\t\treturn isAbsolute ? `${device}\\\\${tail}` : `${device}${tail}`;\r\n\t},\r\n\r\n\tisAbsolute(path: string): boolean {\r\n\t\tvalidateString(path, 'path');\r\n\t\tconst len = path.length;\r\n\t\tif (len === 0) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst code = path.charCodeAt(0);\r\n\t\treturn isPathSeparator(code) ||\r\n\t\t\t// Possible device root\r\n\t\t\t(len > 2 &&\r\n\t\t\t\tisWindowsDeviceRoot(code) &&\r\n\t\t\t\tpath.charCodeAt(1) === CHAR_COLON &&\r\n\t\t\t\tisPathSeparator(path.charCodeAt(2)));\r\n\t},\r\n\r\n\tjoin(...paths: string[]): string {\r\n\t\tif (paths.length === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\r\n\t\tlet joined;\r\n\t\tlet firstPart: string | undefined;\r\n\t\tfor (let i = 0; i < paths.length; ++i) {\r\n\t\t\tconst arg = paths[i];\r\n\t\t\tvalidateString(arg, 'path');\r\n\t\t\tif (arg.length > 0) {\r\n\t\t\t\tif (joined === undefined) {\r\n\t\t\t\t\tjoined = firstPart = arg;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tjoined += `\\\\${arg}`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (joined === undefined) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\r\n\t\t// Make sure that the joined path doesn't start with two slashes, because\r\n\t\t// normalize() will mistake it for a UNC path then.\r\n\t\t//\r\n\t\t// This step is skipped when it is very clear that the user actually\r\n\t\t// intended to point at a UNC path. This is assumed when the first\r\n\t\t// non-empty string arguments starts with exactly two slashes followed by\r\n\t\t// at least one more non-slash character.\r\n\t\t//\r\n\t\t// Note that for normalize() to treat a path as a UNC path it needs to\r\n\t\t// have at least 2 components, so we don't filter for that here.\r\n\t\t// This means that the user can use join to construct UNC paths from\r\n\t\t// a server name and a share name; for example:\r\n\t\t//   path.join('//server', 'share') -> '\\\\\\\\server\\\\share\\\\')\r\n\t\tlet needsReplace = true;\r\n\t\tlet slashCount = 0;\r\n\t\tif (typeof firstPart === 'string' && isPathSeparator(firstPart.charCodeAt(0))) {\r\n\t\t\t++slashCount;\r\n\t\t\tconst firstLen = firstPart.length;\r\n\t\t\tif (firstLen > 1 && isPathSeparator(firstPart.charCodeAt(1))) {\r\n\t\t\t\t++slashCount;\r\n\t\t\t\tif (firstLen > 2) {\r\n\t\t\t\t\tif (isPathSeparator(firstPart.charCodeAt(2))) {\r\n\t\t\t\t\t\t++slashCount;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// We matched a UNC path in the first part\r\n\t\t\t\t\t\tneedsReplace = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (needsReplace) {\r\n\t\t\t// Find any more consecutive slashes we need to replace\r\n\t\t\twhile (slashCount < joined.length &&\r\n\t\t\t\tisPathSeparator(joined.charCodeAt(slashCount))) {\r\n\t\t\t\tslashCount++;\r\n\t\t\t}\r\n\r\n\t\t\t// Replace the slashes if needed\r\n\t\t\tif (slashCount >= 2) {\r\n\t\t\t\tjoined = `\\\\${joined.slice(slashCount)}`;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn win32.normalize(joined);\r\n\t},\r\n\r\n\r\n\t// It will solve the relative path from `from` to `to`, for instance:\r\n\t//  from = 'C:\\\\orandea\\\\test\\\\aaa'\r\n\t//  to = 'C:\\\\orandea\\\\impl\\\\bbb'\r\n\t// The output of the function should be: '..\\\\..\\\\impl\\\\bbb'\r\n\trelative(from: string, to: string): string {\r\n\t\tvalidateString(from, 'from');\r\n\t\tvalidateString(to, 'to');\r\n\r\n\t\tif (from === to) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tconst fromOrig = win32.resolve(from);\r\n\t\tconst toOrig = win32.resolve(to);\r\n\r\n\t\tif (fromOrig === toOrig) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tfrom = fromOrig.toLowerCase();\r\n\t\tto = toOrig.toLowerCase();\r\n\r\n\t\tif (from === to) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\t// Trim any leading backslashes\r\n\t\tlet fromStart = 0;\r\n\t\twhile (fromStart < from.length &&\r\n\t\t\tfrom.charCodeAt(fromStart) === CHAR_BACKWARD_SLASH) {\r\n\t\t\tfromStart++;\r\n\t\t}\r\n\t\t// Trim trailing backslashes (applicable to UNC paths only)\r\n\t\tlet fromEnd = from.length;\r\n\t\twhile (fromEnd - 1 > fromStart &&\r\n\t\t\tfrom.charCodeAt(fromEnd - 1) === CHAR_BACKWARD_SLASH) {\r\n\t\t\tfromEnd--;\r\n\t\t}\r\n\t\tconst fromLen = fromEnd - fromStart;\r\n\r\n\t\t// Trim any leading backslashes\r\n\t\tlet toStart = 0;\r\n\t\twhile (toStart < to.length &&\r\n\t\t\tto.charCodeAt(toStart) === CHAR_BACKWARD_SLASH) {\r\n\t\t\ttoStart++;\r\n\t\t}\r\n\t\t// Trim trailing backslashes (applicable to UNC paths only)\r\n\t\tlet toEnd = to.length;\r\n\t\twhile (toEnd - 1 > toStart &&\r\n\t\t\tto.charCodeAt(toEnd - 1) === CHAR_BACKWARD_SLASH) {\r\n\t\t\ttoEnd--;\r\n\t\t}\r\n\t\tconst toLen = toEnd - toStart;\r\n\r\n\t\t// Compare paths to find the longest common path from root\r\n\t\tconst length = fromLen < toLen ? fromLen : toLen;\r\n\t\tlet lastCommonSep = -1;\r\n\t\tlet i = 0;\r\n\t\tfor (; i < length; i++) {\r\n\t\t\tconst fromCode = from.charCodeAt(fromStart + i);\r\n\t\t\tif (fromCode !== to.charCodeAt(toStart + i)) {\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (fromCode === CHAR_BACKWARD_SLASH) {\r\n\t\t\t\tlastCommonSep = i;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// We found a mismatch before the first common path separator was seen, so\r\n\t\t// return the original `to`.\r\n\t\tif (i !== length) {\r\n\t\t\tif (lastCommonSep === -1) {\r\n\t\t\t\treturn toOrig;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (toLen > length) {\r\n\t\t\t\tif (to.charCodeAt(toStart + i) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t\t\t// We get here if `from` is the exact base path for `to`.\r\n\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\foo\\\\bar\\\\baz'\r\n\t\t\t\t\treturn toOrig.slice(toStart + i + 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (i === 2) {\r\n\t\t\t\t\t// We get here if `from` is the device root.\r\n\t\t\t\t\t// For example: from='C:\\\\'; to='C:\\\\foo'\r\n\t\t\t\t\treturn toOrig.slice(toStart + i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (fromLen > length) {\r\n\t\t\t\tif (from.charCodeAt(fromStart + i) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t\t\t// We get here if `to` is the exact base path for `from`.\r\n\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\foo'\r\n\t\t\t\t\tlastCommonSep = i;\r\n\t\t\t\t} else if (i === 2) {\r\n\t\t\t\t\t// We get here if `to` is the device root.\r\n\t\t\t\t\t// For example: from='C:\\\\foo\\\\bar'; to='C:\\\\'\r\n\t\t\t\t\tlastCommonSep = 3;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (lastCommonSep === -1) {\r\n\t\t\t\tlastCommonSep = 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet out = '';\r\n\t\t// Generate the relative path based on the path difference between `to` and\r\n\t\t// `from`\r\n\t\tfor (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\r\n\t\t\tif (i === fromEnd || from.charCodeAt(i) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t\tout += out.length === 0 ? '..' : '\\\\..';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\ttoStart += lastCommonSep;\r\n\r\n\t\t// Lastly, append the rest of the destination (`to`) path that comes after\r\n\t\t// the common path parts\r\n\t\tif (out.length > 0) {\r\n\t\t\treturn `${out}${toOrig.slice(toStart, toEnd)}`;\r\n\t\t}\r\n\r\n\t\tif (toOrig.charCodeAt(toStart) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t++toStart;\r\n\t\t}\r\n\r\n\t\treturn toOrig.slice(toStart, toEnd);\r\n\t},\r\n\r\n\ttoNamespacedPath(path: string): string {\r\n\t\t// Note: this will *probably* throw somewhere.\r\n\t\tif (typeof path !== 'string' || path.length === 0) {\r\n\t\t\treturn path;\r\n\t\t}\r\n\r\n\t\tconst resolvedPath = win32.resolve(path);\r\n\r\n\t\tif (resolvedPath.length <= 2) {\r\n\t\t\treturn path;\r\n\t\t}\r\n\r\n\t\tif (resolvedPath.charCodeAt(0) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t// Possible UNC root\r\n\t\t\tif (resolvedPath.charCodeAt(1) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t\tconst code = resolvedPath.charCodeAt(2);\r\n\t\t\t\tif (code !== CHAR_QUESTION_MARK && code !== CHAR_DOT) {\r\n\t\t\t\t\t// Matched non-long UNC root, convert the path to a long UNC path\r\n\t\t\t\t\treturn `\\\\\\\\?\\\\UNC\\\\${resolvedPath.slice(2)}`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (isWindowsDeviceRoot(resolvedPath.charCodeAt(0)) &&\r\n\t\t\tresolvedPath.charCodeAt(1) === CHAR_COLON &&\r\n\t\t\tresolvedPath.charCodeAt(2) === CHAR_BACKWARD_SLASH) {\r\n\t\t\t// Matched device root, convert the path to a long UNC path\r\n\t\t\treturn `\\\\\\\\?\\\\${resolvedPath}`;\r\n\t\t}\r\n\r\n\t\treturn path;\r\n\t},\r\n\r\n\tdirname(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\t\tconst len = path.length;\r\n\t\tif (len === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\t\tlet rootEnd = -1;\r\n\t\tlet offset = 0;\r\n\t\tconst code = path.charCodeAt(0);\r\n\r\n\t\tif (len === 1) {\r\n\t\t\t// `path` contains just a path separator, exit early to avoid\r\n\t\t\t// unnecessary work or a dot.\r\n\t\t\treturn isPathSeparator(code) ? path : '.';\r\n\t\t}\r\n\r\n\t\t// Try to match a root\r\n\t\tif (isPathSeparator(code)) {\r\n\t\t\t// Possible UNC root\r\n\r\n\t\t\trootEnd = offset = 1;\r\n\r\n\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\r\n\t\t\t\t// Matched double path separator at beginning\r\n\t\t\t\tlet j = 2;\r\n\t\t\t\tlet last = j;\r\n\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t// Matched!\r\n\t\t\t\t\tlast = j;\r\n\t\t\t\t\t// Match 1 or more path separators\r\n\t\t\t\t\twhile (j < len && isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\tj++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t\t// Matched!\r\n\t\t\t\t\t\tlast = j;\r\n\t\t\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j === len) {\r\n\t\t\t\t\t\t\t// We matched a UNC root only\r\n\t\t\t\t\t\t\treturn path;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j !== last) {\r\n\t\t\t\t\t\t\t// We matched a UNC root with leftovers\r\n\r\n\t\t\t\t\t\t\t// Offset by 1 to include the separator after the UNC root to\r\n\t\t\t\t\t\t\t// treat it as a \"normal root\" on top of a (UNC) root\r\n\t\t\t\t\t\t\trootEnd = offset = j + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// Possible device root\r\n\t\t} else if (isWindowsDeviceRoot(code) && path.charCodeAt(1) === CHAR_COLON) {\r\n\t\t\trootEnd = len > 2 && isPathSeparator(path.charCodeAt(2)) ? 3 : 2;\r\n\t\t\toffset = rootEnd;\r\n\t\t}\r\n\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tfor (let i = len - 1; i >= offset; --i) {\r\n\t\t\tif (isPathSeparator(path.charCodeAt(i))) {\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tend = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// We saw the first non-path separator\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end === -1) {\r\n\t\t\tif (rootEnd === -1) {\r\n\t\t\t\treturn '.';\r\n\t\t\t}\r\n\r\n\t\t\tend = rootEnd;\r\n\t\t}\r\n\t\treturn path.slice(0, end);\r\n\t},\r\n\r\n\tbasename(path: string, ext?: string): string {\r\n\t\tif (ext !== undefined) {\r\n\t\t\tvalidateString(ext, 'ext');\r\n\t\t}\r\n\t\tvalidateString(path, 'path');\r\n\t\tlet start = 0;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tlet i;\r\n\r\n\t\t// Check for a drive letter prefix so as not to mistake the following\r\n\t\t// path separator as an extra separator at the end of the path that can be\r\n\t\t// disregarded\r\n\t\tif (path.length >= 2 &&\r\n\t\t\tisWindowsDeviceRoot(path.charCodeAt(0)) &&\r\n\t\t\tpath.charCodeAt(1) === CHAR_COLON) {\r\n\t\t\tstart = 2;\r\n\t\t}\r\n\r\n\t\tif (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\r\n\t\t\tif (ext === path) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tlet extIdx = ext.length - 1;\r\n\t\t\tlet firstNonSlashEnd = -1;\r\n\t\t\tfor (i = path.length - 1; i >= start; --i) {\r\n\t\t\t\tconst code = path.charCodeAt(i);\r\n\t\t\t\tif (isPathSeparator(code)) {\r\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\t\tstart = i + 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (firstNonSlashEnd === -1) {\r\n\t\t\t\t\t\t// We saw the first non-path separator, remember this index in case\r\n\t\t\t\t\t\t// we need it if the extension ends up not matching\r\n\t\t\t\t\t\tmatchedSlash = false;\r\n\t\t\t\t\t\tfirstNonSlashEnd = i + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (extIdx >= 0) {\r\n\t\t\t\t\t\t// Try to match the explicit extension\r\n\t\t\t\t\t\tif (code === ext.charCodeAt(extIdx)) {\r\n\t\t\t\t\t\t\tif (--extIdx === -1) {\r\n\t\t\t\t\t\t\t\t// We matched the extension, so mark this as the end of our path\r\n\t\t\t\t\t\t\t\t// component\r\n\t\t\t\t\t\t\t\tend = i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Extension does not match, so our result is the entire path\r\n\t\t\t\t\t\t\t// component\r\n\t\t\t\t\t\t\textIdx = -1;\r\n\t\t\t\t\t\t\tend = firstNonSlashEnd;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (start === end) {\r\n\t\t\t\tend = firstNonSlashEnd;\r\n\t\t\t} else if (end === -1) {\r\n\t\t\t\tend = path.length;\r\n\t\t\t}\r\n\t\t\treturn path.slice(start, end);\r\n\t\t}\r\n\t\tfor (i = path.length - 1; i >= start; --i) {\r\n\t\t\tif (isPathSeparator(path.charCodeAt(i))) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// path component\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end === -1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn path.slice(start, end);\r\n\t},\r\n\r\n\textname(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\t\tlet start = 0;\r\n\t\tlet startDot = -1;\r\n\t\tlet startPart = 0;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\t// Track the state of characters (if any) we see before our first dot and\r\n\t\t// after any path separator we find\r\n\t\tlet preDotState = 0;\r\n\r\n\t\t// Check for a drive letter prefix so as not to mistake the following\r\n\t\t// path separator as an extra separator at the end of the path that can be\r\n\t\t// disregarded\r\n\r\n\t\tif (path.length >= 2 &&\r\n\t\t\tpath.charCodeAt(1) === CHAR_COLON &&\r\n\t\t\tisWindowsDeviceRoot(path.charCodeAt(0))) {\r\n\t\t\tstart = startPart = 2;\r\n\t\t}\r\n\r\n\t\tfor (let i = path.length - 1; i >= start; --i) {\r\n\t\t\tconst code = path.charCodeAt(i);\r\n\t\t\tif (isPathSeparator(code)) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstartPart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// extension\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t\tif (code === CHAR_DOT) {\r\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\r\n\t\t\t\tif (startDot === -1) {\r\n\t\t\t\t\tstartDot = i;\r\n\t\t\t\t}\r\n\t\t\t\telse if (preDotState !== 1) {\r\n\t\t\t\t\tpreDotState = 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (startDot !== -1) {\r\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\r\n\t\t\t\t// have a good chance at having a non-empty extension\r\n\t\t\t\tpreDotState = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startDot === -1 ||\r\n\t\t\tend === -1 ||\r\n\t\t\t// We saw a non-dot character immediately before the dot\r\n\t\t\tpreDotState === 0 ||\r\n\t\t\t// The (right-most) trimmed path component is exactly '..'\r\n\t\t\t(preDotState === 1 &&\r\n\t\t\t\tstartDot === end - 1 &&\r\n\t\t\t\tstartDot === startPart + 1)) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn path.slice(startDot, end);\r\n\t},\r\n\r\n\tformat: _format.bind(null, '\\\\'),\r\n\r\n\tparse(path) {\r\n\t\tvalidateString(path, 'path');\r\n\r\n\t\tconst ret = { root: '', dir: '', base: '', ext: '', name: '' };\r\n\t\tif (path.length === 0) {\r\n\t\t\treturn ret;\r\n\t\t}\r\n\r\n\t\tconst len = path.length;\r\n\t\tlet rootEnd = 0;\r\n\t\tlet code = path.charCodeAt(0);\r\n\r\n\t\tif (len === 1) {\r\n\t\t\tif (isPathSeparator(code)) {\r\n\t\t\t\t// `path` contains just a path separator, exit early to avoid\r\n\t\t\t\t// unnecessary work\r\n\t\t\t\tret.root = ret.dir = path;\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t\tret.base = ret.name = path;\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\t// Try to match a root\r\n\t\tif (isPathSeparator(code)) {\r\n\t\t\t// Possible UNC root\r\n\r\n\t\t\trootEnd = 1;\r\n\t\t\tif (isPathSeparator(path.charCodeAt(1))) {\r\n\t\t\t\t// Matched double path separator at beginning\r\n\t\t\t\tlet j = 2;\r\n\t\t\t\tlet last = j;\r\n\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t// Matched!\r\n\t\t\t\t\tlast = j;\r\n\t\t\t\t\t// Match 1 or more path separators\r\n\t\t\t\t\twhile (j < len && isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\tj++;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (j < len && j !== last) {\r\n\t\t\t\t\t\t// Matched!\r\n\t\t\t\t\t\tlast = j;\r\n\t\t\t\t\t\t// Match 1 or more non-path separators\r\n\t\t\t\t\t\twhile (j < len && !isPathSeparator(path.charCodeAt(j))) {\r\n\t\t\t\t\t\t\tj++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (j === len) {\r\n\t\t\t\t\t\t\t// We matched a UNC root only\r\n\t\t\t\t\t\t\trootEnd = j;\r\n\t\t\t\t\t\t} else if (j !== last) {\r\n\t\t\t\t\t\t\t// We matched a UNC root with leftovers\r\n\t\t\t\t\t\t\trootEnd = j + 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (isWindowsDeviceRoot(code) && path.charCodeAt(1) === CHAR_COLON) {\r\n\t\t\t// Possible device root\r\n\t\t\tif (len <= 2) {\r\n\t\t\t\t// `path` contains just a drive root, exit early to avoid\r\n\t\t\t\t// unnecessary work\r\n\t\t\t\tret.root = ret.dir = path;\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t\trootEnd = 2;\r\n\t\t\tif (isPathSeparator(path.charCodeAt(2))) {\r\n\t\t\t\tif (len === 3) {\r\n\t\t\t\t\t// `path` contains just a drive root, exit early to avoid\r\n\t\t\t\t\t// unnecessary work\r\n\t\t\t\t\tret.root = ret.dir = path;\r\n\t\t\t\t\treturn ret;\r\n\t\t\t\t}\r\n\t\t\t\trootEnd = 3;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (rootEnd > 0) {\r\n\t\t\tret.root = path.slice(0, rootEnd);\r\n\t\t}\r\n\r\n\t\tlet startDot = -1;\r\n\t\tlet startPart = rootEnd;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tlet i = path.length - 1;\r\n\r\n\t\t// Track the state of characters (if any) we see before our first dot and\r\n\t\t// after any path separator we find\r\n\t\tlet preDotState = 0;\r\n\r\n\t\t// Get non-dir info\r\n\t\tfor (; i >= rootEnd; --i) {\r\n\t\t\tcode = path.charCodeAt(i);\r\n\t\t\tif (isPathSeparator(code)) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstartPart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// extension\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t\tif (code === CHAR_DOT) {\r\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\r\n\t\t\t\tif (startDot === -1) {\r\n\t\t\t\t\tstartDot = i;\r\n\t\t\t\t} else if (preDotState !== 1) {\r\n\t\t\t\t\tpreDotState = 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (startDot !== -1) {\r\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\r\n\t\t\t\t// have a good chance at having a non-empty extension\r\n\t\t\t\tpreDotState = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end !== -1) {\r\n\t\t\tif (startDot === -1 ||\r\n\t\t\t\t// We saw a non-dot character immediately before the dot\r\n\t\t\t\tpreDotState === 0 ||\r\n\t\t\t\t// The (right-most) trimmed path component is exactly '..'\r\n\t\t\t\t(preDotState === 1 &&\r\n\t\t\t\t\tstartDot === end - 1 &&\r\n\t\t\t\t\tstartDot === startPart + 1)) {\r\n\t\t\t\tret.base = ret.name = path.slice(startPart, end);\r\n\t\t\t} else {\r\n\t\t\t\tret.name = path.slice(startPart, startDot);\r\n\t\t\t\tret.base = path.slice(startPart, end);\r\n\t\t\t\tret.ext = path.slice(startDot, end);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If the directory is the root, use the entire root as the `dir` including\r\n\t\t// the trailing slash if any (`C:\\abc` -> `C:\\`). Otherwise, strip out the\r\n\t\t// trailing slash (`C:\\abc\\def` -> `C:\\abc`).\r\n\t\tif (startPart > 0 && startPart !== rootEnd) {\r\n\t\t\tret.dir = path.slice(0, startPart - 1);\r\n\t\t} else {\r\n\t\t\tret.dir = ret.root;\r\n\t\t}\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\tsep: '\\\\',\r\n\tdelimiter: ';',\r\n\twin32: null,\r\n\tposix: null\r\n};\r\n\r\nconst posixCwd = (() => {\r\n\tif (platformIsWin32) {\r\n\t\t// Converts Windows' backslash path separators to POSIX forward slashes\r\n\t\t// and truncates any drive indicator\r\n\t\tconst regexp = /\\\\/g;\r\n\t\treturn () => {\r\n\t\t\tconst cwd = process.cwd().replace(regexp, '/');\r\n\t\t\treturn cwd.slice(cwd.indexOf('/'));\r\n\t\t};\r\n\t}\r\n\r\n\t// We're already on POSIX, no need for any transformations\r\n\treturn () => process.cwd();\r\n})();\r\n\r\nexport const posix: IPath = {\r\n\t// path.resolve([from ...], to)\r\n\tresolve(...pathSegments: string[]): string {\r\n\t\tlet resolvedPath = '';\r\n\t\tlet resolvedAbsolute = false;\r\n\r\n\t\tfor (let i = pathSegments.length - 1; i >= -1 && !resolvedAbsolute; i--) {\r\n\t\t\tconst path = i >= 0 ? pathSegments[i] : posixCwd();\r\n\r\n\t\t\tvalidateString(path, 'path');\r\n\r\n\t\t\t// Skip empty entries\r\n\t\t\tif (path.length === 0) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tresolvedPath = `${path}/${resolvedPath}`;\r\n\t\t\tresolvedAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\r\n\t\t}\r\n\r\n\t\t// At this point the path should be resolved to a full absolute path, but\r\n\t\t// handle relative paths to be safe (might happen when process.cwd() fails)\r\n\r\n\t\t// Normalize the path\r\n\t\tresolvedPath = normalizeString(resolvedPath, !resolvedAbsolute, '/',\r\n\t\t\tisPosixPathSeparator);\r\n\r\n\t\tif (resolvedAbsolute) {\r\n\t\t\treturn `/${resolvedPath}`;\r\n\t\t}\r\n\t\treturn resolvedPath.length > 0 ? resolvedPath : '.';\r\n\t},\r\n\r\n\tnormalize(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\r\n\t\tif (path.length === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\r\n\t\tconst isAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\r\n\t\tconst trailingSeparator =\r\n\t\t\tpath.charCodeAt(path.length - 1) === CHAR_FORWARD_SLASH;\r\n\r\n\t\t// Normalize the path\r\n\t\tpath = normalizeString(path, !isAbsolute, '/', isPosixPathSeparator);\r\n\r\n\t\tif (path.length === 0) {\r\n\t\t\tif (isAbsolute) {\r\n\t\t\t\treturn '/';\r\n\t\t\t}\r\n\t\t\treturn trailingSeparator ? './' : '.';\r\n\t\t}\r\n\t\tif (trailingSeparator) {\r\n\t\t\tpath += '/';\r\n\t\t}\r\n\r\n\t\treturn isAbsolute ? `/${path}` : path;\r\n\t},\r\n\r\n\tisAbsolute(path: string): boolean {\r\n\t\tvalidateString(path, 'path');\r\n\t\treturn path.length > 0 && path.charCodeAt(0) === CHAR_FORWARD_SLASH;\r\n\t},\r\n\r\n\tjoin(...paths: string[]): string {\r\n\t\tif (paths.length === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\t\tlet joined;\r\n\t\tfor (let i = 0; i < paths.length; ++i) {\r\n\t\t\tconst arg = paths[i];\r\n\t\t\tvalidateString(arg, 'path');\r\n\t\t\tif (arg.length > 0) {\r\n\t\t\t\tif (joined === undefined) {\r\n\t\t\t\t\tjoined = arg;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tjoined += `/${arg}`;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (joined === undefined) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\t\treturn posix.normalize(joined);\r\n\t},\r\n\r\n\trelative(from: string, to: string): string {\r\n\t\tvalidateString(from, 'from');\r\n\t\tvalidateString(to, 'to');\r\n\r\n\t\tif (from === to) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\t// Trim leading forward slashes.\r\n\t\tfrom = posix.resolve(from);\r\n\t\tto = posix.resolve(to);\r\n\r\n\t\tif (from === to) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\r\n\t\tconst fromStart = 1;\r\n\t\tconst fromEnd = from.length;\r\n\t\tconst fromLen = fromEnd - fromStart;\r\n\t\tconst toStart = 1;\r\n\t\tconst toLen = to.length - toStart;\r\n\r\n\t\t// Compare paths to find the longest common path from root\r\n\t\tconst length = (fromLen < toLen ? fromLen : toLen);\r\n\t\tlet lastCommonSep = -1;\r\n\t\tlet i = 0;\r\n\t\tfor (; i < length; i++) {\r\n\t\t\tconst fromCode = from.charCodeAt(fromStart + i);\r\n\t\t\tif (fromCode !== to.charCodeAt(toStart + i)) {\r\n\t\t\t\tbreak;\r\n\t\t\t} else if (fromCode === CHAR_FORWARD_SLASH) {\r\n\t\t\t\tlastCommonSep = i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (i === length) {\r\n\t\t\tif (toLen > length) {\r\n\t\t\t\tif (to.charCodeAt(toStart + i) === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t\t// We get here if `from` is the exact base path for `to`.\r\n\t\t\t\t\t// For example: from='/foo/bar'; to='/foo/bar/baz'\r\n\t\t\t\t\treturn to.slice(toStart + i + 1);\r\n\t\t\t\t}\r\n\t\t\t\tif (i === 0) {\r\n\t\t\t\t\t// We get here if `from` is the root\r\n\t\t\t\t\t// For example: from='/'; to='/foo'\r\n\t\t\t\t\treturn to.slice(toStart + i);\r\n\t\t\t\t}\r\n\t\t\t} else if (fromLen > length) {\r\n\t\t\t\tif (from.charCodeAt(fromStart + i) === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t\t// We get here if `to` is the exact base path for `from`.\r\n\t\t\t\t\t// For example: from='/foo/bar/baz'; to='/foo/bar'\r\n\t\t\t\t\tlastCommonSep = i;\r\n\t\t\t\t} else if (i === 0) {\r\n\t\t\t\t\t// We get here if `to` is the root.\r\n\t\t\t\t\t// For example: from='/foo/bar'; to='/'\r\n\t\t\t\t\tlastCommonSep = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet out = '';\r\n\t\t// Generate the relative path based on the path difference between `to`\r\n\t\t// and `from`.\r\n\t\tfor (i = fromStart + lastCommonSep + 1; i <= fromEnd; ++i) {\r\n\t\t\tif (i === fromEnd || from.charCodeAt(i) === CHAR_FORWARD_SLASH) {\r\n\t\t\t\tout += out.length === 0 ? '..' : '/..';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Lastly, append the rest of the destination (`to`) path that comes after\r\n\t\t// the common path parts.\r\n\t\treturn `${out}${to.slice(toStart + lastCommonSep)}`;\r\n\t},\r\n\r\n\ttoNamespacedPath(path: string): string {\r\n\t\t// Non-op on posix systems\r\n\t\treturn path;\r\n\t},\r\n\r\n\tdirname(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\t\tif (path.length === 0) {\r\n\t\t\treturn '.';\r\n\t\t}\r\n\t\tconst hasRoot = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tfor (let i = path.length - 1; i >= 1; --i) {\r\n\t\t\tif (path.charCodeAt(i) === CHAR_FORWARD_SLASH) {\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tend = i;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// We saw the first non-path separator\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end === -1) {\r\n\t\t\treturn hasRoot ? '/' : '.';\r\n\t\t}\r\n\t\tif (hasRoot && end === 1) {\r\n\t\t\treturn '//';\r\n\t\t}\r\n\t\treturn path.slice(0, end);\r\n\t},\r\n\r\n\tbasename(path: string, ext?: string): string {\r\n\t\tif (ext !== undefined) {\r\n\t\t\tvalidateString(ext, 'ext');\r\n\t\t}\r\n\t\tvalidateString(path, 'path');\r\n\r\n\t\tlet start = 0;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tlet i;\r\n\r\n\t\tif (ext !== undefined && ext.length > 0 && ext.length <= path.length) {\r\n\t\t\tif (ext === path) {\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\tlet extIdx = ext.length - 1;\r\n\t\t\tlet firstNonSlashEnd = -1;\r\n\t\t\tfor (i = path.length - 1; i >= 0; --i) {\r\n\t\t\t\tconst code = path.charCodeAt(i);\r\n\t\t\t\tif (code === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\t\tstart = i + 1;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (firstNonSlashEnd === -1) {\r\n\t\t\t\t\t\t// We saw the first non-path separator, remember this index in case\r\n\t\t\t\t\t\t// we need it if the extension ends up not matching\r\n\t\t\t\t\t\tmatchedSlash = false;\r\n\t\t\t\t\t\tfirstNonSlashEnd = i + 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (extIdx >= 0) {\r\n\t\t\t\t\t\t// Try to match the explicit extension\r\n\t\t\t\t\t\tif (code === ext.charCodeAt(extIdx)) {\r\n\t\t\t\t\t\t\tif (--extIdx === -1) {\r\n\t\t\t\t\t\t\t\t// We matched the extension, so mark this as the end of our path\r\n\t\t\t\t\t\t\t\t// component\r\n\t\t\t\t\t\t\t\tend = i;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Extension does not match, so our result is the entire path\r\n\t\t\t\t\t\t\t// component\r\n\t\t\t\t\t\t\textIdx = -1;\r\n\t\t\t\t\t\t\tend = firstNonSlashEnd;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (start === end) {\r\n\t\t\t\tend = firstNonSlashEnd;\r\n\t\t\t} else if (end === -1) {\r\n\t\t\t\tend = path.length;\r\n\t\t\t}\r\n\t\t\treturn path.slice(start, end);\r\n\t\t}\r\n\t\tfor (i = path.length - 1; i >= 0; --i) {\r\n\t\t\tif (path.charCodeAt(i) === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t} else if (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// path component\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end === -1) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn path.slice(start, end);\r\n\t},\r\n\r\n\textname(path: string): string {\r\n\t\tvalidateString(path, 'path');\r\n\t\tlet startDot = -1;\r\n\t\tlet startPart = 0;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\t// Track the state of characters (if any) we see before our first dot and\r\n\t\t// after any path separator we find\r\n\t\tlet preDotState = 0;\r\n\t\tfor (let i = path.length - 1; i >= 0; --i) {\r\n\t\t\tconst code = path.charCodeAt(i);\r\n\t\t\tif (code === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstartPart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// extension\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t\tif (code === CHAR_DOT) {\r\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\r\n\t\t\t\tif (startDot === -1) {\r\n\t\t\t\t\tstartDot = i;\r\n\t\t\t\t}\r\n\t\t\t\telse if (preDotState !== 1) {\r\n\t\t\t\t\tpreDotState = 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (startDot !== -1) {\r\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\r\n\t\t\t\t// have a good chance at having a non-empty extension\r\n\t\t\t\tpreDotState = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startDot === -1 ||\r\n\t\t\tend === -1 ||\r\n\t\t\t// We saw a non-dot character immediately before the dot\r\n\t\t\tpreDotState === 0 ||\r\n\t\t\t// The (right-most) trimmed path component is exactly '..'\r\n\t\t\t(preDotState === 1 &&\r\n\t\t\t\tstartDot === end - 1 &&\r\n\t\t\t\tstartDot === startPart + 1)) {\r\n\t\t\treturn '';\r\n\t\t}\r\n\t\treturn path.slice(startDot, end);\r\n\t},\r\n\r\n\tformat: _format.bind(null, '/'),\r\n\r\n\tparse(path: string): ParsedPath {\r\n\t\tvalidateString(path, 'path');\r\n\r\n\t\tconst ret = { root: '', dir: '', base: '', ext: '', name: '' };\r\n\t\tif (path.length === 0) {\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\tconst isAbsolute = path.charCodeAt(0) === CHAR_FORWARD_SLASH;\r\n\t\tlet start;\r\n\t\tif (isAbsolute) {\r\n\t\t\tret.root = '/';\r\n\t\t\tstart = 1;\r\n\t\t} else {\r\n\t\t\tstart = 0;\r\n\t\t}\r\n\t\tlet startDot = -1;\r\n\t\tlet startPart = 0;\r\n\t\tlet end = -1;\r\n\t\tlet matchedSlash = true;\r\n\t\tlet i = path.length - 1;\r\n\r\n\t\t// Track the state of characters (if any) we see before our first dot and\r\n\t\t// after any path separator we find\r\n\t\tlet preDotState = 0;\r\n\r\n\t\t// Get non-dir info\r\n\t\tfor (; i >= start; --i) {\r\n\t\t\tconst code = path.charCodeAt(i);\r\n\t\t\tif (code === CHAR_FORWARD_SLASH) {\r\n\t\t\t\t// If we reached a path separator that was not part of a set of path\r\n\t\t\t\t// separators at the end of the string, stop now\r\n\t\t\t\tif (!matchedSlash) {\r\n\t\t\t\t\tstartPart = i + 1;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\tif (end === -1) {\r\n\t\t\t\t// We saw the first non-path separator, mark this as the end of our\r\n\t\t\t\t// extension\r\n\t\t\t\tmatchedSlash = false;\r\n\t\t\t\tend = i + 1;\r\n\t\t\t}\r\n\t\t\tif (code === CHAR_DOT) {\r\n\t\t\t\t// If this is our first dot, mark it as the start of our extension\r\n\t\t\t\tif (startDot === -1) {\r\n\t\t\t\t\tstartDot = i;\r\n\t\t\t\t} else if (preDotState !== 1) {\r\n\t\t\t\t\tpreDotState = 1;\r\n\t\t\t\t}\r\n\t\t\t} else if (startDot !== -1) {\r\n\t\t\t\t// We saw a non-dot and non-path separator before our dot, so we should\r\n\t\t\t\t// have a good chance at having a non-empty extension\r\n\t\t\t\tpreDotState = -1;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (end !== -1) {\r\n\t\t\tconst start = startPart === 0 && isAbsolute ? 1 : startPart;\r\n\t\t\tif (startDot === -1 ||\r\n\t\t\t\t// We saw a non-dot character immediately before the dot\r\n\t\t\t\tpreDotState === 0 ||\r\n\t\t\t\t// The (right-most) trimmed path component is exactly '..'\r\n\t\t\t\t(preDotState === 1 &&\r\n\t\t\t\t\tstartDot === end - 1 &&\r\n\t\t\t\t\tstartDot === startPart + 1)) {\r\n\t\t\t\tret.base = ret.name = path.slice(start, end);\r\n\t\t\t} else {\r\n\t\t\t\tret.name = path.slice(start, startDot);\r\n\t\t\t\tret.base = path.slice(start, end);\r\n\t\t\t\tret.ext = path.slice(startDot, end);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (startPart > 0) {\r\n\t\t\tret.dir = path.slice(0, startPart - 1);\r\n\t\t} else if (isAbsolute) {\r\n\t\t\tret.dir = '/';\r\n\t\t}\r\n\r\n\t\treturn ret;\r\n\t},\r\n\r\n\tsep: '/',\r\n\tdelimiter: ':',\r\n\twin32: null,\r\n\tposix: null\r\n};\r\n\r\nposix.win32 = win32.win32 = win32;\r\nposix.posix = win32.posix = posix;\r\n\r\nexport const normalize = (platformIsWin32 ? win32.normalize : posix.normalize);\r\nexport const resolve = (platformIsWin32 ? win32.resolve : posix.resolve);\r\nexport const relative = (platformIsWin32 ? win32.relative : posix.relative);\r\nexport const dirname = (platformIsWin32 ? win32.dirname : posix.dirname);\r\nexport const basename = (platformIsWin32 ? win32.basename : posix.basename);\r\nexport const extname = (platformIsWin32 ? win32.extname : posix.extname);\r\nexport const sep = (platformIsWin32 ? win32.sep : posix.sep);\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CharCode } from 'vs/base/common/charCode';\r\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\r\nimport * as paths from 'vs/base/common/path';\r\nimport { isWindows } from 'vs/base/common/platform';\r\n\r\nconst _schemePattern = /^\\w[\\w\\d+.-]*$/;\r\nconst _singleSlashStart = /^\\//;\r\nconst _doubleSlashStart = /^\\/\\//;\r\n\r\nfunction _validateUri(ret: URI, _strict?: boolean): void {\r\n\r\n\t// scheme, must be set\r\n\tif (!ret.scheme && _strict) {\r\n\t\tthrow new Error(`[UriError]: Scheme is missing: {scheme: \"\", authority: \"${ret.authority}\", path: \"${ret.path}\", query: \"${ret.query}\", fragment: \"${ret.fragment}\"}`);\r\n\t}\r\n\r\n\t// scheme, https://tools.ietf.org/html/rfc3986#section-3.1\r\n\t// ALPHA *( ALPHA / DIGIT / \"+\" / \"-\" / \".\" )\r\n\tif (ret.scheme && !_schemePattern.test(ret.scheme)) {\r\n\t\tthrow new Error('[UriError]: Scheme contains illegal characters.');\r\n\t}\r\n\r\n\t// path, http://tools.ietf.org/html/rfc3986#section-3.3\r\n\t// If a URI contains an authority component, then the path component\r\n\t// must either be empty or begin with a slash (\"/\") character.  If a URI\r\n\t// does not contain an authority component, then the path cannot begin\r\n\t// with two slash characters (\"//\").\r\n\tif (ret.path) {\r\n\t\tif (ret.authority) {\r\n\t\t\tif (!_singleSlashStart.test(ret.path)) {\r\n\t\t\t\tthrow new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash (\"/\") character');\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (_doubleSlashStart.test(ret.path)) {\r\n\t\t\t\tthrow new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters (\"//\")');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n// for a while we allowed uris *without* schemes and this is the migration\r\n// for them, e.g. an uri without scheme and without strict-mode warns and falls\r\n// back to the file-scheme. that should cause the least carnage and still be a\r\n// clear warning\r\nfunction _schemeFix(scheme: string, _strict: boolean): string {\r\n\tif (!scheme && !_strict) {\r\n\t\treturn 'file';\r\n\t}\r\n\treturn scheme;\r\n}\r\n\r\n// implements a bit of https://tools.ietf.org/html/rfc3986#section-5\r\nfunction _referenceResolution(scheme: string, path: string): string {\r\n\r\n\t// the slash-character is our 'default base' as we don't\r\n\t// support constructing URIs relative to other URIs. This\r\n\t// also means that we alter and potentially break paths.\r\n\t// see https://tools.ietf.org/html/rfc3986#section-5.1.4\r\n\tswitch (scheme) {\r\n\t\tcase 'https':\r\n\t\tcase 'http':\r\n\t\tcase 'file':\r\n\t\t\tif (!path) {\r\n\t\t\t\tpath = _slash;\r\n\t\t\t} else if (path[0] !== _slash) {\r\n\t\t\t\tpath = _slash + path;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\treturn path;\r\n}\r\n\r\nconst _empty = '';\r\nconst _slash = '/';\r\nconst _regexp = /^(([^:/?#]+?):)?(\\/\\/([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?/;\r\n\r\n/**\r\n * Uniform Resource Identifier (URI) http://tools.ietf.org/html/rfc3986.\r\n * This class is a simple parser which creates the basic component parts\r\n * (http://tools.ietf.org/html/rfc3986#section-3) with minimal validation\r\n * and encoding.\r\n *\r\n * ```txt\r\n *       foo://example.com:8042/over/there?name=ferret#nose\r\n *       \\_/   \\______________/\\_________/ \\_________/ \\__/\r\n *        |           |            |            |        |\r\n *     scheme     authority       path        query   fragment\r\n *        |   _____________________|__\r\n *       / \\ /                        \\\r\n *       urn:example:animal:ferret:nose\r\n * ```\r\n */\r\nexport class URI implements UriComponents {\r\n\r\n\tstatic isUri(thing: any): thing is URI {\r\n\t\tif (thing instanceof URI) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (!thing) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn typeof (<URI>thing).authority === 'string'\r\n\t\t\t&& typeof (<URI>thing).fragment === 'string'\r\n\t\t\t&& typeof (<URI>thing).path === 'string'\r\n\t\t\t&& typeof (<URI>thing).query === 'string'\r\n\t\t\t&& typeof (<URI>thing).scheme === 'string'\r\n\t\t\t&& typeof (<URI>thing).fsPath === 'string'\r\n\t\t\t&& typeof (<URI>thing).with === 'function'\r\n\t\t\t&& typeof (<URI>thing).toString === 'function';\r\n\t}\r\n\r\n\t/**\r\n\t * scheme is the 'http' part of 'http://www.example.com/some/path?query#fragment'.\r\n\t * The part before the first colon.\r\n\t */\r\n\treadonly scheme: string;\r\n\r\n\t/**\r\n\t * authority is the 'www.example.com' part of 'http://www.example.com/some/path?query#fragment'.\r\n\t * The part between the first double slashes and the next slash.\r\n\t */\r\n\treadonly authority: string;\r\n\r\n\t/**\r\n\t * path is the '/some/path' part of 'http://www.example.com/some/path?query#fragment'.\r\n\t */\r\n\treadonly path: string;\r\n\r\n\t/**\r\n\t * query is the 'query' part of 'http://www.example.com/some/path?query#fragment'.\r\n\t */\r\n\treadonly query: string;\r\n\r\n\t/**\r\n\t * fragment is the 'fragment' part of 'http://www.example.com/some/path?query#fragment'.\r\n\t */\r\n\treadonly fragment: string;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected constructor(scheme: string, authority?: string, path?: string, query?: string, fragment?: string, _strict?: boolean);\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected constructor(components: UriComponents);\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tprotected constructor(schemeOrData: string | UriComponents, authority?: string, path?: string, query?: string, fragment?: string, _strict: boolean = false) {\r\n\r\n\t\tif (typeof schemeOrData === 'object') {\r\n\t\t\tthis.scheme = schemeOrData.scheme || _empty;\r\n\t\t\tthis.authority = schemeOrData.authority || _empty;\r\n\t\t\tthis.path = schemeOrData.path || _empty;\r\n\t\t\tthis.query = schemeOrData.query || _empty;\r\n\t\t\tthis.fragment = schemeOrData.fragment || _empty;\r\n\t\t\t// no validation because it's this URI\r\n\t\t\t// that creates uri components.\r\n\t\t\t// _validateUri(this);\r\n\t\t} else {\r\n\t\t\tthis.scheme = _schemeFix(schemeOrData, _strict);\r\n\t\t\tthis.authority = authority || _empty;\r\n\t\t\tthis.path = _referenceResolution(this.scheme, path || _empty);\r\n\t\t\tthis.query = query || _empty;\r\n\t\t\tthis.fragment = fragment || _empty;\r\n\r\n\t\t\t_validateUri(this, _strict);\r\n\t\t}\r\n\t}\r\n\r\n\t// ---- filesystem path -----------------------\r\n\r\n\t/**\r\n\t * Returns a string representing the corresponding file system path of this URI.\r\n\t * Will handle UNC paths, normalizes windows drive letters to lower-case, and uses the\r\n\t * platform specific path separator.\r\n\t *\r\n\t * * Will *not* validate the path for invalid characters and semantics.\r\n\t * * Will *not* look at the scheme of this URI.\r\n\t * * The result shall *not* be used for display purposes but for accessing a file on disk.\r\n\t *\r\n\t *\r\n\t * The *difference* to `URI#path` is the use of the platform specific separator and the handling\r\n\t * of UNC paths. See the below sample of a file-uri with an authority (UNC path).\r\n\t *\r\n\t * ```ts\r\n\t\tconst u = URI.parse('file://server/c$/folder/file.txt')\r\n\t\tu.authority === 'server'\r\n\t\tu.path === '/shares/c$/file.txt'\r\n\t\tu.fsPath === '\\\\server\\c$\\folder\\file.txt'\r\n\t```\r\n\t *\r\n\t * Using `URI#path` to read a file (using fs-apis) would not be enough because parts of the path,\r\n\t * namely the server name, would be missing. Therefore `URI#fsPath` exists - it's sugar to ease working\r\n\t * with URIs that represent files on disk (`file` scheme).\r\n\t */\r\n\tget fsPath(): string {\r\n\t\t// if (this.scheme !== 'file') {\r\n\t\t// \tconsole.warn(`[UriError] calling fsPath with scheme ${this.scheme}`);\r\n\t\t// }\r\n\t\treturn uriToFsPath(this, false);\r\n\t}\r\n\r\n\t// ---- modify to new -------------------------\r\n\r\n\twith(change: { scheme?: string; authority?: string | null; path?: string | null; query?: string | null; fragment?: string | null }): URI {\r\n\r\n\t\tif (!change) {\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tlet { scheme, authority, path, query, fragment } = change;\r\n\t\tif (scheme === undefined) {\r\n\t\t\tscheme = this.scheme;\r\n\t\t} else if (scheme === null) {\r\n\t\t\tscheme = _empty;\r\n\t\t}\r\n\t\tif (authority === undefined) {\r\n\t\t\tauthority = this.authority;\r\n\t\t} else if (authority === null) {\r\n\t\t\tauthority = _empty;\r\n\t\t}\r\n\t\tif (path === undefined) {\r\n\t\t\tpath = this.path;\r\n\t\t} else if (path === null) {\r\n\t\t\tpath = _empty;\r\n\t\t}\r\n\t\tif (query === undefined) {\r\n\t\t\tquery = this.query;\r\n\t\t} else if (query === null) {\r\n\t\t\tquery = _empty;\r\n\t\t}\r\n\t\tif (fragment === undefined) {\r\n\t\t\tfragment = this.fragment;\r\n\t\t} else if (fragment === null) {\r\n\t\t\tfragment = _empty;\r\n\t\t}\r\n\r\n\t\tif (scheme === this.scheme\r\n\t\t\t&& authority === this.authority\r\n\t\t\t&& path === this.path\r\n\t\t\t&& query === this.query\r\n\t\t\t&& fragment === this.fragment) {\r\n\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\treturn new Uri(scheme, authority, path, query, fragment);\r\n\t}\r\n\r\n\t// ---- parse & validate ------------------------\r\n\r\n\t/**\r\n\t * Creates a new URI from a string, e.g. `http://www.example.com/some/path`,\r\n\t * `file:///usr/home`, or `scheme:with/path`.\r\n\t *\r\n\t * @param value A string which represents an URI (see `URI#toString`).\r\n\t */\r\n\tstatic parse(value: string, _strict: boolean = false): URI {\r\n\t\tconst match = _regexp.exec(value);\r\n\t\tif (!match) {\r\n\t\t\treturn new Uri(_empty, _empty, _empty, _empty, _empty);\r\n\t\t}\r\n\t\treturn new Uri(\r\n\t\t\tmatch[2] || _empty,\r\n\t\t\tpercentDecode(match[4] || _empty),\r\n\t\t\tpercentDecode(match[5] || _empty),\r\n\t\t\tpercentDecode(match[7] || _empty),\r\n\t\t\tpercentDecode(match[9] || _empty),\r\n\t\t\t_strict\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new URI from a file system path, e.g. `c:\\my\\files`,\r\n\t * `/usr/home`, or `\\\\server\\share\\some\\path`.\r\n\t *\r\n\t * The *difference* between `URI#parse` and `URI#file` is that the latter treats the argument\r\n\t * as path, not as stringified-uri. E.g. `URI.file(path)` is **not the same as**\r\n\t * `URI.parse('file://' + path)` because the path might contain characters that are\r\n\t * interpreted (# and ?). See the following sample:\r\n\t * ```ts\r\n\tconst good = URI.file('/coding/c#/project1');\r\n\tgood.scheme === 'file';\r\n\tgood.path === '/coding/c#/project1';\r\n\tgood.fragment === '';\r\n\tconst bad = URI.parse('file://' + '/coding/c#/project1');\r\n\tbad.scheme === 'file';\r\n\tbad.path === '/coding/c'; // path is now broken\r\n\tbad.fragment === '/project1';\r\n\t```\r\n\t *\r\n\t * @param path A file system path (see `URI#fsPath`)\r\n\t */\r\n\tstatic file(path: string): URI {\r\n\r\n\t\tlet authority = _empty;\r\n\r\n\t\t// normalize to fwd-slashes on windows,\r\n\t\t// on other systems bwd-slashes are valid\r\n\t\t// filename character, eg /f\\oo/ba\\r.txt\r\n\t\tif (isWindows) {\r\n\t\t\tpath = path.replace(/\\\\/g, _slash);\r\n\t\t}\r\n\r\n\t\t// check for authority as used in UNC shares\r\n\t\t// or use the path as given\r\n\t\tif (path[0] === _slash && path[1] === _slash) {\r\n\t\t\tconst idx = path.indexOf(_slash, 2);\r\n\t\t\tif (idx === -1) {\r\n\t\t\t\tauthority = path.substring(2);\r\n\t\t\t\tpath = _slash;\r\n\t\t\t} else {\r\n\t\t\t\tauthority = path.substring(2, idx);\r\n\t\t\t\tpath = path.substring(idx) || _slash;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn new Uri('file', authority, path, _empty, _empty);\r\n\t}\r\n\r\n\t/**\r\n\t * Creates new URI from uri components.\r\n\t *\r\n\t * Unless `strict` is `true` the scheme is defaults to be `file`. This function performs\r\n\t * validation and should be used for untrusted uri components retrieved from storage,\r\n\t * user input, command arguments etc\r\n\t */\r\n\tstatic from(components: UriComponents, strict?: boolean): URI {\r\n\t\tconst result = new Uri(\r\n\t\t\tcomponents.scheme,\r\n\t\t\tcomponents.authority,\r\n\t\t\tcomponents.path,\r\n\t\t\tcomponents.query,\r\n\t\t\tcomponents.fragment,\r\n\t\t\tstrict\r\n\t\t);\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Join a URI path with path fragments and normalizes the resulting path.\r\n\t *\r\n\t * @param uri The input URI.\r\n\t * @param pathFragment The path fragment to add to the URI path.\r\n\t * @returns The resulting URI.\r\n\t */\r\n\tstatic joinPath(uri: URI, ...pathFragment: string[]): URI {\r\n\t\tif (!uri.path) {\r\n\t\t\tthrow new Error(`[UriError]: cannot call joinPath on URI without path`);\r\n\t\t}\r\n\t\tlet newPath: string;\r\n\t\tif (isWindows && uri.scheme === 'file') {\r\n\t\t\tnewPath = URI.file(paths.win32.join(uriToFsPath(uri, true), ...pathFragment)).path;\r\n\t\t} else {\r\n\t\t\tnewPath = paths.posix.join(uri.path, ...pathFragment);\r\n\t\t}\r\n\t\treturn uri.with({ path: newPath });\r\n\t}\r\n\r\n\t// ---- printing/externalize ---------------------------\r\n\r\n\t/**\r\n\t * Creates a string representation for this URI. It's guaranteed that calling\r\n\t * `URI.parse` with the result of this function creates an URI which is equal\r\n\t * to this URI.\r\n\t *\r\n\t * * The result shall *not* be used for display purposes but for externalization or transport.\r\n\t * * The result will be encoded using the percentage encoding and encoding happens mostly\r\n\t * ignore the scheme-specific encoding rules.\r\n\t *\r\n\t * @param skipEncoding Do not encode the result, default is `false`\r\n\t */\r\n\ttoString(skipEncoding: boolean = false): string {\r\n\t\treturn _asFormatted(this, skipEncoding);\r\n\t}\r\n\r\n\ttoJSON(): UriComponents {\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * A helper function to revive URIs.\r\n\t *\r\n\t * **Note** that this function should only be used when receiving URI#toJSON generated data\r\n\t * and that it doesn't do any validation. Use {@link URI.from} when received \"untrusted\"\r\n\t * uri components such as command arguments or data from storage.\r\n\t *\r\n\t * @param data The URI components or URI to revive.\r\n\t * @returns The revived URI or undefined or null.\r\n\t */\r\n\tstatic revive(data: UriComponents | URI): URI;\r\n\tstatic revive(data: UriComponents | URI | undefined): URI | undefined;\r\n\tstatic revive(data: UriComponents | URI | null): URI | null;\r\n\tstatic revive(data: UriComponents | URI | undefined | null): URI | undefined | null;\r\n\tstatic revive(data: UriComponents | URI | undefined | null): URI | undefined | null {\r\n\t\tif (!data) {\r\n\t\t\treturn data;\r\n\t\t} else if (data instanceof URI) {\r\n\t\t\treturn data;\r\n\t\t} else {\r\n\t\t\tconst result = new Uri(data);\r\n\t\t\tresult._formatted = (<UriState>data).external ?? null;\r\n\t\t\tresult._fsPath = (<UriState>data)._sep === _pathSepMarker ? (<UriState>data).fsPath ?? null : null;\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport interface UriComponents {\r\n\tscheme: string;\r\n\tauthority?: string;\r\n\tpath?: string;\r\n\tquery?: string;\r\n\tfragment?: string;\r\n}\r\n\r\ninterface UriState extends UriComponents {\r\n\t$mid: MarshalledId.Uri;\r\n\texternal?: string;\r\n\tfsPath?: string;\r\n\t_sep?: 1;\r\n}\r\n\r\nconst _pathSepMarker = isWindows ? 1 : undefined;\r\n\r\n// This class exists so that URI is compatible with vscode.Uri (API).\r\nclass Uri extends URI {\r\n\r\n\t_formatted: string | null = null;\r\n\t_fsPath: string | null = null;\r\n\r\n\toverride get fsPath(): string {\r\n\t\tif (!this._fsPath) {\r\n\t\t\tthis._fsPath = uriToFsPath(this, false);\r\n\t\t}\r\n\t\treturn this._fsPath;\r\n\t}\r\n\r\n\toverride toString(skipEncoding: boolean = false): string {\r\n\t\tif (!skipEncoding) {\r\n\t\t\tif (!this._formatted) {\r\n\t\t\t\tthis._formatted = _asFormatted(this, false);\r\n\t\t\t}\r\n\t\t\treturn this._formatted;\r\n\t\t} else {\r\n\t\t\t// we don't cache that\r\n\t\t\treturn _asFormatted(this, true);\r\n\t\t}\r\n\t}\r\n\r\n\toverride toJSON(): UriComponents {\r\n\t\tconst res = <UriState>{\r\n\t\t\t$mid: MarshalledId.Uri\r\n\t\t};\r\n\t\t// cached state\r\n\t\tif (this._fsPath) {\r\n\t\t\tres.fsPath = this._fsPath;\r\n\t\t\tres._sep = _pathSepMarker;\r\n\t\t}\r\n\t\tif (this._formatted) {\r\n\t\t\tres.external = this._formatted;\r\n\t\t}\r\n\t\t//--- uri components\r\n\t\tif (this.path) {\r\n\t\t\tres.path = this.path;\r\n\t\t}\r\n\t\t// TODO\r\n\t\t// this isn't correct and can violate the UriComponents contract but\r\n\t\t// this is part of the vscode.Uri API and we shouldn't change how that\r\n\t\t// works anymore\r\n\t\tif (this.scheme) {\r\n\t\t\tres.scheme = this.scheme;\r\n\t\t}\r\n\t\tif (this.authority) {\r\n\t\t\tres.authority = this.authority;\r\n\t\t}\r\n\t\tif (this.query) {\r\n\t\t\tres.query = this.query;\r\n\t\t}\r\n\t\tif (this.fragment) {\r\n\t\t\tres.fragment = this.fragment;\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n}\r\n\r\n// reserved characters: https://tools.ietf.org/html/rfc3986#section-2.2\r\nconst encodeTable: { [ch: number]: string } = {\r\n\t[CharCode.Colon]: '%3A', // gen-delims\r\n\t[CharCode.Slash]: '%2F',\r\n\t[CharCode.QuestionMark]: '%3F',\r\n\t[CharCode.Hash]: '%23',\r\n\t[CharCode.OpenSquareBracket]: '%5B',\r\n\t[CharCode.CloseSquareBracket]: '%5D',\r\n\t[CharCode.AtSign]: '%40',\r\n\r\n\t[CharCode.ExclamationMark]: '%21', // sub-delims\r\n\t[CharCode.DollarSign]: '%24',\r\n\t[CharCode.Ampersand]: '%26',\r\n\t[CharCode.SingleQuote]: '%27',\r\n\t[CharCode.OpenParen]: '%28',\r\n\t[CharCode.CloseParen]: '%29',\r\n\t[CharCode.Asterisk]: '%2A',\r\n\t[CharCode.Plus]: '%2B',\r\n\t[CharCode.Comma]: '%2C',\r\n\t[CharCode.Semicolon]: '%3B',\r\n\t[CharCode.Equals]: '%3D',\r\n\r\n\t[CharCode.Space]: '%20',\r\n};\r\n\r\nfunction encodeURIComponentFast(uriComponent: string, isPath: boolean, isAuthority: boolean): string {\r\n\tlet res: string | undefined = undefined;\r\n\tlet nativeEncodePos = -1;\r\n\r\n\tfor (let pos = 0; pos < uriComponent.length; pos++) {\r\n\t\tconst code = uriComponent.charCodeAt(pos);\r\n\r\n\t\t// unreserved characters: https://tools.ietf.org/html/rfc3986#section-2.3\r\n\t\tif (\r\n\t\t\t(code >= CharCode.a && code <= CharCode.z)\r\n\t\t\t|| (code >= CharCode.A && code <= CharCode.Z)\r\n\t\t\t|| (code >= CharCode.Digit0 && code <= CharCode.Digit9)\r\n\t\t\t|| code === CharCode.Dash\r\n\t\t\t|| code === CharCode.Period\r\n\t\t\t|| code === CharCode.Underline\r\n\t\t\t|| code === CharCode.Tilde\r\n\t\t\t|| (isPath && code === CharCode.Slash)\r\n\t\t\t|| (isAuthority && code === CharCode.OpenSquareBracket)\r\n\t\t\t|| (isAuthority && code === CharCode.CloseSquareBracket)\r\n\t\t\t|| (isAuthority && code === CharCode.Colon)\r\n\t\t) {\r\n\t\t\t// check if we are delaying native encode\r\n\t\t\tif (nativeEncodePos !== -1) {\r\n\t\t\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n\t\t\t\tnativeEncodePos = -1;\r\n\t\t\t}\r\n\t\t\t// check if we write into a new string (by default we try to return the param)\r\n\t\t\tif (res !== undefined) {\r\n\t\t\t\tres += uriComponent.charAt(pos);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// encoding needed, we need to allocate a new string\r\n\t\t\tif (res === undefined) {\r\n\t\t\t\tres = uriComponent.substr(0, pos);\r\n\t\t\t}\r\n\r\n\t\t\t// check with default table first\r\n\t\t\tconst escaped = encodeTable[code];\r\n\t\t\tif (escaped !== undefined) {\r\n\r\n\t\t\t\t// check if we are delaying native encode\r\n\t\t\t\tif (nativeEncodePos !== -1) {\r\n\t\t\t\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos, pos));\r\n\t\t\t\t\tnativeEncodePos = -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// append escaped variant to result\r\n\t\t\t\tres += escaped;\r\n\r\n\t\t\t} else if (nativeEncodePos === -1) {\r\n\t\t\t\t// use native encode only when needed\r\n\t\t\t\tnativeEncodePos = pos;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tif (nativeEncodePos !== -1) {\r\n\t\tres += encodeURIComponent(uriComponent.substring(nativeEncodePos));\r\n\t}\r\n\r\n\treturn res !== undefined ? res : uriComponent;\r\n}\r\n\r\nfunction encodeURIComponentMinimal(path: string): string {\r\n\tlet res: string | undefined = undefined;\r\n\tfor (let pos = 0; pos < path.length; pos++) {\r\n\t\tconst code = path.charCodeAt(pos);\r\n\t\tif (code === CharCode.Hash || code === CharCode.QuestionMark) {\r\n\t\t\tif (res === undefined) {\r\n\t\t\t\tres = path.substr(0, pos);\r\n\t\t\t}\r\n\t\t\tres += encodeTable[code];\r\n\t\t} else {\r\n\t\t\tif (res !== undefined) {\r\n\t\t\t\tres += path[pos];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn res !== undefined ? res : path;\r\n}\r\n\r\n/**\r\n * Compute `fsPath` for the given uri\r\n */\r\nexport function uriToFsPath(uri: URI, keepDriveLetterCasing: boolean): string {\r\n\r\n\tlet value: string;\r\n\tif (uri.authority && uri.path.length > 1 && uri.scheme === 'file') {\r\n\t\t// unc path: file://shares/c$/far/boo\r\n\t\tvalue = `//${uri.authority}${uri.path}`;\r\n\t} else if (\r\n\t\turi.path.charCodeAt(0) === CharCode.Slash\r\n\t\t&& (uri.path.charCodeAt(1) >= CharCode.A && uri.path.charCodeAt(1) <= CharCode.Z || uri.path.charCodeAt(1) >= CharCode.a && uri.path.charCodeAt(1) <= CharCode.z)\r\n\t\t&& uri.path.charCodeAt(2) === CharCode.Colon\r\n\t) {\r\n\t\tif (!keepDriveLetterCasing) {\r\n\t\t\t// windows drive letter: file:///c:/far/boo\r\n\t\t\tvalue = uri.path[1].toLowerCase() + uri.path.substr(2);\r\n\t\t} else {\r\n\t\t\tvalue = uri.path.substr(1);\r\n\t\t}\r\n\t} else {\r\n\t\t// other path\r\n\t\tvalue = uri.path;\r\n\t}\r\n\tif (isWindows) {\r\n\t\tvalue = value.replace(/\\//g, '\\\\');\r\n\t}\r\n\treturn value;\r\n}\r\n\r\n/**\r\n * Create the external version of a uri\r\n */\r\nfunction _asFormatted(uri: URI, skipEncoding: boolean): string {\r\n\r\n\tconst encoder = !skipEncoding\r\n\t\t? encodeURIComponentFast\r\n\t\t: encodeURIComponentMinimal;\r\n\r\n\tlet res = '';\r\n\tlet { scheme, authority, path, query, fragment } = uri;\r\n\tif (scheme) {\r\n\t\tres += scheme;\r\n\t\tres += ':';\r\n\t}\r\n\tif (authority || scheme === 'file') {\r\n\t\tres += _slash;\r\n\t\tres += _slash;\r\n\t}\r\n\tif (authority) {\r\n\t\tlet idx = authority.indexOf('@');\r\n\t\tif (idx !== -1) {\r\n\t\t\t// <user>@<auth>\r\n\t\t\tconst userinfo = authority.substr(0, idx);\r\n\t\t\tauthority = authority.substr(idx + 1);\r\n\t\t\tidx = userinfo.lastIndexOf(':');\r\n\t\t\tif (idx === -1) {\r\n\t\t\t\tres += encoder(userinfo, false, false);\r\n\t\t\t} else {\r\n\t\t\t\t// <user>:<pass>@<auth>\r\n\t\t\t\tres += encoder(userinfo.substr(0, idx), false, false);\r\n\t\t\t\tres += ':';\r\n\t\t\t\tres += encoder(userinfo.substr(idx + 1), false, true);\r\n\t\t\t}\r\n\t\t\tres += '@';\r\n\t\t}\r\n\t\tauthority = authority.toLowerCase();\r\n\t\tidx = authority.lastIndexOf(':');\r\n\t\tif (idx === -1) {\r\n\t\t\tres += encoder(authority, false, true);\r\n\t\t} else {\r\n\t\t\t// <auth>:<port>\r\n\t\t\tres += encoder(authority.substr(0, idx), false, true);\r\n\t\t\tres += authority.substr(idx);\r\n\t\t}\r\n\t}\r\n\tif (path) {\r\n\t\t// lower-case windows drive letters in /C:/fff or C:/fff\r\n\t\tif (path.length >= 3 && path.charCodeAt(0) === CharCode.Slash && path.charCodeAt(2) === CharCode.Colon) {\r\n\t\t\tconst code = path.charCodeAt(1);\r\n\t\t\tif (code >= CharCode.A && code <= CharCode.Z) {\r\n\t\t\t\tpath = `/${String.fromCharCode(code + 32)}:${path.substr(3)}`; // \"/c:\".length === 3\r\n\t\t\t}\r\n\t\t} else if (path.length >= 2 && path.charCodeAt(1) === CharCode.Colon) {\r\n\t\t\tconst code = path.charCodeAt(0);\r\n\t\t\tif (code >= CharCode.A && code <= CharCode.Z) {\r\n\t\t\t\tpath = `${String.fromCharCode(code + 32)}:${path.substr(2)}`; // \"/c:\".length === 3\r\n\t\t\t}\r\n\t\t}\r\n\t\t// encode the rest of the path\r\n\t\tres += encoder(path, true, false);\r\n\t}\r\n\tif (query) {\r\n\t\tres += '?';\r\n\t\tres += encoder(query, false, false);\r\n\t}\r\n\tif (fragment) {\r\n\t\tres += '#';\r\n\t\tres += !skipEncoding ? encodeURIComponentFast(fragment, false, false) : fragment;\r\n\t}\r\n\treturn res;\r\n}\r\n\r\n// --- decode\r\n\r\nfunction decodeURIComponentGraceful(str: string): string {\r\n\ttry {\r\n\t\treturn decodeURIComponent(str);\r\n\t} catch {\r\n\t\tif (str.length > 3) {\r\n\t\t\treturn str.substr(0, 3) + decodeURIComponentGraceful(str.substr(3));\r\n\t\t} else {\r\n\t\t\treturn str;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst _rEncodedAsHex = /(%[0-9A-Za-z][0-9A-Za-z])+/g;\r\n\r\nfunction percentDecode(str: string): string {\r\n\tif (!str.match(_rEncodedAsHex)) {\r\n\t\treturn str;\r\n\t}\r\n\treturn str.replace(_rEncodedAsHex, (match) => decodeURIComponentGraceful(match));\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { transformErrorForSerialization } from 'vs/base/common/errors';\r\nimport { Emitter, Event } from 'vs/base/common/event';\r\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\r\nimport { getAllMethodNames } from 'vs/base/common/objects';\r\nimport { isWeb } from 'vs/base/common/platform';\r\nimport * as strings from 'vs/base/common/strings';\r\n\r\nconst INITIALIZE = '$initialize';\r\n\r\nexport interface IWorker extends IDisposable {\r\n\tgetId(): number;\r\n\tpostMessage(message: Message, transfer: ArrayBuffer[]): void;\r\n}\r\n\r\nexport interface IWorkerCallback {\r\n\t(message: Message): void;\r\n}\r\n\r\nexport interface IWorkerFactory {\r\n\tcreate(moduleId: string, callback: IWorkerCallback, onErrorCallback: (err: any) => void): IWorker;\r\n}\r\n\r\nlet webWorkerWarningLogged = false;\r\nexport function logOnceWebWorkerWarning(err: any): void {\r\n\tif (!isWeb) {\r\n\t\t// running tests\r\n\t\treturn;\r\n\t}\r\n\tif (!webWorkerWarningLogged) {\r\n\t\twebWorkerWarningLogged = true;\r\n\t\tconsole.warn('Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq');\r\n\t}\r\n\tconsole.warn(err.message);\r\n}\r\n\r\nconst enum MessageType {\r\n\tRequest,\r\n\tReply,\r\n\tSubscribeEvent,\r\n\tEvent,\r\n\tUnsubscribeEvent\r\n}\r\nclass RequestMessage {\r\n\tpublic readonly type = MessageType.Request;\r\n\tconstructor(\r\n\t\tpublic readonly vsWorker: number,\r\n\t\tpublic readonly req: string,\r\n\t\tpublic readonly method: string,\r\n\t\tpublic readonly args: any[]\r\n\t) { }\r\n}\r\nclass ReplyMessage {\r\n\tpublic readonly type = MessageType.Reply;\r\n\tconstructor(\r\n\t\tpublic readonly vsWorker: number,\r\n\t\tpublic readonly seq: string,\r\n\t\tpublic readonly res: any,\r\n\t\tpublic readonly err: any\r\n\t) { }\r\n}\r\nclass SubscribeEventMessage {\r\n\tpublic readonly type = MessageType.SubscribeEvent;\r\n\tconstructor(\r\n\t\tpublic readonly vsWorker: number,\r\n\t\tpublic readonly req: string,\r\n\t\tpublic readonly eventName: string,\r\n\t\tpublic readonly arg: any\r\n\t) { }\r\n}\r\nclass EventMessage {\r\n\tpublic readonly type = MessageType.Event;\r\n\tconstructor(\r\n\t\tpublic readonly vsWorker: number,\r\n\t\tpublic readonly req: string,\r\n\t\tpublic readonly event: any\r\n\t) { }\r\n}\r\nclass UnsubscribeEventMessage {\r\n\tpublic readonly type = MessageType.UnsubscribeEvent;\r\n\tconstructor(\r\n\t\tpublic readonly vsWorker: number,\r\n\t\tpublic readonly req: string\r\n\t) { }\r\n}\r\ntype Message = RequestMessage | ReplyMessage | SubscribeEventMessage | EventMessage | UnsubscribeEventMessage;\r\n\r\ninterface IMessageReply {\r\n\tresolve: (value?: any) => void;\r\n\treject: (error?: any) => void;\r\n}\r\n\r\ninterface IMessageHandler {\r\n\tsendMessage(msg: any, transfer?: ArrayBuffer[]): void;\r\n\thandleMessage(method: string, args: any[]): Promise<any>;\r\n\thandleEvent(eventName: string, arg: any): Event<any>;\r\n}\r\n\r\nclass SimpleWorkerProtocol {\r\n\r\n\tprivate _workerId: number;\r\n\tprivate _lastSentReq: number;\r\n\tprivate _pendingReplies: { [req: string]: IMessageReply };\r\n\tprivate _pendingEmitters: Map<string, Emitter<any>>;\r\n\tprivate _pendingEvents: Map<string, IDisposable>;\r\n\tprivate _handler: IMessageHandler;\r\n\r\n\tconstructor(handler: IMessageHandler) {\r\n\t\tthis._workerId = -1;\r\n\t\tthis._handler = handler;\r\n\t\tthis._lastSentReq = 0;\r\n\t\tthis._pendingReplies = Object.create(null);\r\n\t\tthis._pendingEmitters = new Map<string, Emitter<any>>();\r\n\t\tthis._pendingEvents = new Map<string, IDisposable>();\r\n\t}\r\n\r\n\tpublic setWorkerId(workerId: number): void {\r\n\t\tthis._workerId = workerId;\r\n\t}\r\n\r\n\tpublic sendMessage(method: string, args: any[]): Promise<any> {\r\n\t\tconst req = String(++this._lastSentReq);\r\n\t\treturn new Promise<any>((resolve, reject) => {\r\n\t\t\tthis._pendingReplies[req] = {\r\n\t\t\t\tresolve: resolve,\r\n\t\t\t\treject: reject\r\n\t\t\t};\r\n\t\t\tthis._send(new RequestMessage(this._workerId, req, method, args));\r\n\t\t});\r\n\t}\r\n\r\n\tpublic listen(eventName: string, arg: any): Event<any> {\r\n\t\tlet req: string | null = null;\r\n\t\tconst emitter = new Emitter<any>({\r\n\t\t\tonWillAddFirstListener: () => {\r\n\t\t\t\treq = String(++this._lastSentReq);\r\n\t\t\t\tthis._pendingEmitters.set(req, emitter);\r\n\t\t\t\tthis._send(new SubscribeEventMessage(this._workerId, req, eventName, arg));\r\n\t\t\t},\r\n\t\t\tonDidRemoveLastListener: () => {\r\n\t\t\t\tthis._pendingEmitters.delete(req!);\r\n\t\t\t\tthis._send(new UnsubscribeEventMessage(this._workerId, req!));\r\n\t\t\t\treq = null;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn emitter.event;\r\n\t}\r\n\r\n\tpublic handleMessage(message: Message): void {\r\n\t\tif (!message || !message.vsWorker) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this._workerId !== -1 && message.vsWorker !== this._workerId) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._handleMessage(message);\r\n\t}\r\n\r\n\tprivate _handleMessage(msg: Message): void {\r\n\t\tswitch (msg.type) {\r\n\t\t\tcase MessageType.Reply:\r\n\t\t\t\treturn this._handleReplyMessage(msg);\r\n\t\t\tcase MessageType.Request:\r\n\t\t\t\treturn this._handleRequestMessage(msg);\r\n\t\t\tcase MessageType.SubscribeEvent:\r\n\t\t\t\treturn this._handleSubscribeEventMessage(msg);\r\n\t\t\tcase MessageType.Event:\r\n\t\t\t\treturn this._handleEventMessage(msg);\r\n\t\t\tcase MessageType.UnsubscribeEvent:\r\n\t\t\t\treturn this._handleUnsubscribeEventMessage(msg);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _handleReplyMessage(replyMessage: ReplyMessage): void {\r\n\t\tif (!this._pendingReplies[replyMessage.seq]) {\r\n\t\t\tconsole.warn('Got reply to unknown seq');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst reply = this._pendingReplies[replyMessage.seq];\r\n\t\tdelete this._pendingReplies[replyMessage.seq];\r\n\r\n\t\tif (replyMessage.err) {\r\n\t\t\tlet err = replyMessage.err;\r\n\t\t\tif (replyMessage.err.$isError) {\r\n\t\t\t\terr = new Error();\r\n\t\t\t\terr.name = replyMessage.err.name;\r\n\t\t\t\terr.message = replyMessage.err.message;\r\n\t\t\t\terr.stack = replyMessage.err.stack;\r\n\t\t\t}\r\n\t\t\treply.reject(err);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\treply.resolve(replyMessage.res);\r\n\t}\r\n\r\n\tprivate _handleRequestMessage(requestMessage: RequestMessage): void {\r\n\t\tconst req = requestMessage.req;\r\n\t\tconst result = this._handler.handleMessage(requestMessage.method, requestMessage.args);\r\n\t\tresult.then((r) => {\r\n\t\t\tthis._send(new ReplyMessage(this._workerId, req, r, undefined));\r\n\t\t}, (e) => {\r\n\t\t\tif (e.detail instanceof Error) {\r\n\t\t\t\t// Loading errors have a detail property that points to the actual error\r\n\t\t\t\te.detail = transformErrorForSerialization(e.detail);\r\n\t\t\t}\r\n\t\t\tthis._send(new ReplyMessage(this._workerId, req, undefined, transformErrorForSerialization(e)));\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _handleSubscribeEventMessage(msg: SubscribeEventMessage): void {\r\n\t\tconst req = msg.req;\r\n\t\tconst disposable = this._handler.handleEvent(msg.eventName, msg.arg)((event) => {\r\n\t\t\tthis._send(new EventMessage(this._workerId, req, event));\r\n\t\t});\r\n\t\tthis._pendingEvents.set(req, disposable);\r\n\t}\r\n\r\n\tprivate _handleEventMessage(msg: EventMessage): void {\r\n\t\tif (!this._pendingEmitters.has(msg.req)) {\r\n\t\t\tconsole.warn('Got event for unknown req');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._pendingEmitters.get(msg.req)!.fire(msg.event);\r\n\t}\r\n\r\n\tprivate _handleUnsubscribeEventMessage(msg: UnsubscribeEventMessage): void {\r\n\t\tif (!this._pendingEvents.has(msg.req)) {\r\n\t\t\tconsole.warn('Got unsubscribe for unknown req');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis._pendingEvents.get(msg.req)!.dispose();\r\n\t\tthis._pendingEvents.delete(msg.req);\r\n\t}\r\n\r\n\tprivate _send(msg: Message): void {\r\n\t\tconst transfer: ArrayBuffer[] = [];\r\n\t\tif (msg.type === MessageType.Request) {\r\n\t\t\tfor (let i = 0; i < msg.args.length; i++) {\r\n\t\t\t\tif (msg.args[i] instanceof ArrayBuffer) {\r\n\t\t\t\t\ttransfer.push(msg.args[i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (msg.type === MessageType.Reply) {\r\n\t\t\tif (msg.res instanceof ArrayBuffer) {\r\n\t\t\t\ttransfer.push(msg.res);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._handler.sendMessage(msg, transfer);\r\n\t}\r\n}\r\n\r\nexport interface IWorkerClient<W> {\r\n\tgetProxyObject(): Promise<W>;\r\n\tdispose(): void;\r\n}\r\n\r\n/**\r\n * Main thread side\r\n */\r\nexport class SimpleWorkerClient<W extends object, H extends object> extends Disposable implements IWorkerClient<W> {\r\n\r\n\tprivate readonly _worker: IWorker;\r\n\tprivate readonly _onModuleLoaded: Promise<string[]>;\r\n\tprivate readonly _protocol: SimpleWorkerProtocol;\r\n\tprivate readonly _lazyProxy: Promise<W>;\r\n\r\n\tconstructor(workerFactory: IWorkerFactory, moduleId: string, host: H) {\r\n\t\tsuper();\r\n\r\n\t\tlet lazyProxyReject: ((err: any) => void) | null = null;\r\n\r\n\t\tthis._worker = this._register(workerFactory.create(\r\n\t\t\t'vs/base/common/worker/simpleWorker',\r\n\t\t\t(msg: Message) => {\r\n\t\t\t\tthis._protocol.handleMessage(msg);\r\n\t\t\t},\r\n\t\t\t(err: any) => {\r\n\t\t\t\t// in Firefox, web workers fail lazily :(\r\n\t\t\t\t// we will reject the proxy\r\n\t\t\t\tlazyProxyReject?.(err);\r\n\t\t\t}\r\n\t\t));\r\n\r\n\t\tthis._protocol = new SimpleWorkerProtocol({\r\n\t\t\tsendMessage: (msg: any, transfer: ArrayBuffer[]): void => {\r\n\t\t\t\tthis._worker.postMessage(msg, transfer);\r\n\t\t\t},\r\n\t\t\thandleMessage: (method: string, args: any[]): Promise<any> => {\r\n\t\t\t\tif (typeof (host as any)[method] !== 'function') {\r\n\t\t\t\t\treturn Promise.reject(new Error('Missing method ' + method + ' on main thread host.'));\r\n\t\t\t\t}\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\treturn Promise.resolve((host as any)[method].apply(host, args));\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\treturn Promise.reject(e);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thandleEvent: (eventName: string, arg: any): Event<any> => {\r\n\t\t\t\tif (propertyIsDynamicEvent(eventName)) {\r\n\t\t\t\t\tconst event = (host as any)[eventName].call(host, arg);\r\n\t\t\t\t\tif (typeof event !== 'function') {\r\n\t\t\t\t\t\tthrow new Error(`Missing dynamic event ${eventName} on main thread host.`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn event;\r\n\t\t\t\t}\r\n\t\t\t\tif (propertyIsEvent(eventName)) {\r\n\t\t\t\t\tconst event = (host as any)[eventName];\r\n\t\t\t\t\tif (typeof event !== 'function') {\r\n\t\t\t\t\t\tthrow new Error(`Missing event ${eventName} on main thread host.`);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn event;\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error(`Malformed event name ${eventName}`);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis._protocol.setWorkerId(this._worker.getId());\r\n\r\n\t\t// Gather loader configuration\r\n\t\tlet loaderConfiguration: any = null;\r\n\r\n\t\tconst globalRequire: { getConfig?(): object } | undefined = (globalThis as any).require;\r\n\t\tif (typeof globalRequire !== 'undefined' && typeof globalRequire.getConfig === 'function') {\r\n\t\t\t// Get the configuration from the Monaco AMD Loader\r\n\t\t\tloaderConfiguration = globalRequire.getConfig();\r\n\t\t} else if (typeof (globalThis as any).requirejs !== 'undefined') {\r\n\t\t\t// Get the configuration from requirejs\r\n\t\t\tloaderConfiguration = (globalThis as any).requirejs.s.contexts._.config;\r\n\t\t}\r\n\r\n\t\tconst hostMethods = getAllMethodNames(host);\r\n\r\n\t\t// Send initialize message\r\n\t\tthis._onModuleLoaded = this._protocol.sendMessage(INITIALIZE, [\r\n\t\t\tthis._worker.getId(),\r\n\t\t\tJSON.parse(JSON.stringify(loaderConfiguration)),\r\n\t\t\tmoduleId,\r\n\t\t\thostMethods,\r\n\t\t]);\r\n\r\n\t\t// Create proxy to loaded code\r\n\t\tconst proxyMethodRequest = (method: string, args: any[]): Promise<any> => {\r\n\t\t\treturn this._request(method, args);\r\n\t\t};\r\n\t\tconst proxyListen = (eventName: string, arg: any): Event<any> => {\r\n\t\t\treturn this._protocol.listen(eventName, arg);\r\n\t\t};\r\n\r\n\t\tthis._lazyProxy = new Promise<W>((resolve, reject) => {\r\n\t\t\tlazyProxyReject = reject;\r\n\t\t\tthis._onModuleLoaded.then((availableMethods: string[]) => {\r\n\t\t\t\tresolve(createProxyObject<W>(availableMethods, proxyMethodRequest, proxyListen));\r\n\t\t\t}, (e) => {\r\n\t\t\t\treject(e);\r\n\t\t\t\tthis._onError('Worker failed to load ' + moduleId, e);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tpublic getProxyObject(): Promise<W> {\r\n\t\treturn this._lazyProxy;\r\n\t}\r\n\r\n\tprivate _request(method: string, args: any[]): Promise<any> {\r\n\t\treturn new Promise<any>((resolve, reject) => {\r\n\t\t\tthis._onModuleLoaded.then(() => {\r\n\t\t\t\tthis._protocol.sendMessage(method, args).then(resolve, reject);\r\n\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _onError(message: string, error?: any): void {\r\n\t\tconsole.error(message);\r\n\t\tconsole.info(error);\r\n\t}\r\n}\r\n\r\nfunction propertyIsEvent(name: string): boolean {\r\n\t// Assume a property is an event if it has a form of \"onSomething\"\r\n\treturn name[0] === 'o' && name[1] === 'n' && strings.isUpperAsciiLetter(name.charCodeAt(2));\r\n}\r\n\r\nfunction propertyIsDynamicEvent(name: string): boolean {\r\n\t// Assume a property is a dynamic event (a method that returns an event) if it has a form of \"onDynamicSomething\"\r\n\treturn /^onDynamic/.test(name) && strings.isUpperAsciiLetter(name.charCodeAt(9));\r\n}\r\n\r\nfunction createProxyObject<T extends object>(\r\n\tmethodNames: string[],\r\n\tinvoke: (method: string, args: unknown[]) => unknown,\r\n\tproxyListen: (eventName: string, arg: any) => Event<any>\r\n): T {\r\n\tconst createProxyMethod = (method: string): () => unknown => {\r\n\t\treturn function () {\r\n\t\t\tconst args = Array.prototype.slice.call(arguments, 0);\r\n\t\t\treturn invoke(method, args);\r\n\t\t};\r\n\t};\r\n\tconst createProxyDynamicEvent = (eventName: string): (arg: any) => Event<any> => {\r\n\t\treturn function (arg) {\r\n\t\t\treturn proxyListen(eventName, arg);\r\n\t\t};\r\n\t};\r\n\r\n\tconst result = {} as T;\r\n\tfor (const methodName of methodNames) {\r\n\t\tif (propertyIsDynamicEvent(methodName)) {\r\n\t\t\t(<any>result)[methodName] = createProxyDynamicEvent(methodName);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tif (propertyIsEvent(methodName)) {\r\n\t\t\t(<any>result)[methodName] = proxyListen(methodName, undefined);\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\t(<any>result)[methodName] = createProxyMethod(methodName);\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nexport interface IRequestHandler {\r\n\t_requestHandlerBrand: any;\r\n\t[prop: string]: any;\r\n}\r\n\r\nexport interface IRequestHandlerFactory<H> {\r\n\t(host: H): IRequestHandler;\r\n}\r\n\r\n/**\r\n * Worker side\r\n */\r\nexport class SimpleWorkerServer<H extends object> {\r\n\r\n\tprivate _requestHandlerFactory: IRequestHandlerFactory<H> | null;\r\n\tprivate _requestHandler: IRequestHandler | null;\r\n\tprivate _protocol: SimpleWorkerProtocol;\r\n\r\n\tconstructor(postMessage: (msg: Message, transfer?: ArrayBuffer[]) => void, requestHandlerFactory: IRequestHandlerFactory<H> | null) {\r\n\t\tthis._requestHandlerFactory = requestHandlerFactory;\r\n\t\tthis._requestHandler = null;\r\n\t\tthis._protocol = new SimpleWorkerProtocol({\r\n\t\t\tsendMessage: (msg: any, transfer: ArrayBuffer[]): void => {\r\n\t\t\t\tpostMessage(msg, transfer);\r\n\t\t\t},\r\n\t\t\thandleMessage: (method: string, args: any[]): Promise<any> => this._handleMessage(method, args),\r\n\t\t\thandleEvent: (eventName: string, arg: any): Event<any> => this._handleEvent(eventName, arg)\r\n\t\t});\r\n\t}\r\n\r\n\tpublic onmessage(msg: any): void {\r\n\t\tthis._protocol.handleMessage(msg);\r\n\t}\r\n\r\n\tprivate _handleMessage(method: string, args: any[]): Promise<any> {\r\n\t\tif (method === INITIALIZE) {\r\n\t\t\treturn this.initialize(<number>args[0], <any>args[1], <string>args[2], <string[]>args[3]);\r\n\t\t}\r\n\r\n\t\tif (!this._requestHandler || typeof this._requestHandler[method] !== 'function') {\r\n\t\t\treturn Promise.reject(new Error('Missing requestHandler or method: ' + method));\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\treturn Promise.resolve(this._requestHandler[method].apply(this._requestHandler, args));\r\n\t\t} catch (e) {\r\n\t\t\treturn Promise.reject(e);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _handleEvent(eventName: string, arg: any): Event<any> {\r\n\t\tif (!this._requestHandler) {\r\n\t\t\tthrow new Error(`Missing requestHandler`);\r\n\t\t}\r\n\t\tif (propertyIsDynamicEvent(eventName)) {\r\n\t\t\tconst event = (this._requestHandler as any)[eventName].call(this._requestHandler, arg);\r\n\t\t\tif (typeof event !== 'function') {\r\n\t\t\t\tthrow new Error(`Missing dynamic event ${eventName} on request handler.`);\r\n\t\t\t}\r\n\t\t\treturn event;\r\n\t\t}\r\n\t\tif (propertyIsEvent(eventName)) {\r\n\t\t\tconst event = (this._requestHandler as any)[eventName];\r\n\t\t\tif (typeof event !== 'function') {\r\n\t\t\t\tthrow new Error(`Missing event ${eventName} on request handler.`);\r\n\t\t\t}\r\n\t\t\treturn event;\r\n\t\t}\r\n\t\tthrow new Error(`Malformed event name ${eventName}`);\r\n\t}\r\n\r\n\tprivate initialize(workerId: number, loaderConfig: any, moduleId: string, hostMethods: string[]): Promise<string[]> {\r\n\t\tthis._protocol.setWorkerId(workerId);\r\n\r\n\t\tconst proxyMethodRequest = (method: string, args: any[]): Promise<any> => {\r\n\t\t\treturn this._protocol.sendMessage(method, args);\r\n\t\t};\r\n\t\tconst proxyListen = (eventName: string, arg: any): Event<any> => {\r\n\t\t\treturn this._protocol.listen(eventName, arg);\r\n\t\t};\r\n\r\n\t\tconst hostProxy = createProxyObject<H>(hostMethods, proxyMethodRequest, proxyListen);\r\n\r\n\t\tif (this._requestHandlerFactory) {\r\n\t\t\t// static request handler\r\n\t\t\tthis._requestHandler = this._requestHandlerFactory(hostProxy);\r\n\t\t\treturn Promise.resolve(getAllMethodNames(this._requestHandler));\r\n\t\t}\r\n\r\n\t\tif (loaderConfig) {\r\n\t\t\t// Remove 'baseUrl', handling it is beyond scope for now\r\n\t\t\tif (typeof loaderConfig.baseUrl !== 'undefined') {\r\n\t\t\t\tdelete loaderConfig['baseUrl'];\r\n\t\t\t}\r\n\t\t\tif (typeof loaderConfig.paths !== 'undefined') {\r\n\t\t\t\tif (typeof loaderConfig.paths.vs !== 'undefined') {\r\n\t\t\t\t\tdelete loaderConfig.paths['vs'];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (typeof loaderConfig.trustedTypesPolicy !== undefined) {\r\n\t\t\t\t// don't use, it has been destroyed during serialize\r\n\t\t\t\tdelete loaderConfig['trustedTypesPolicy'];\r\n\t\t\t}\r\n\r\n\t\t\t// Since this is in a web worker, enable catching errors\r\n\t\t\tloaderConfig.catchError = true;\r\n\t\t\tglobalThis.require.config(loaderConfig);\r\n\t\t}\r\n\r\n\t\treturn new Promise<string[]>((resolve, reject) => {\r\n\t\t\t// Use the global require to be sure to get the global config\r\n\r\n\t\t\t// ESM-comment-begin\r\n\t\t\tconst req = (globalThis.require || require);\r\n\t\t\t// ESM-comment-end\r\n\t\t\t// ESM-uncomment-begin\r\n\t\t\t// const req = globalThis.require;\r\n\t\t\t// ESM-uncomment-end\r\n\r\n\t\t\treq([moduleId], (module: { create: IRequestHandlerFactory<H> }) => {\r\n\t\t\t\tthis._requestHandler = module.create(hostProxy);\r\n\r\n\t\t\t\tif (!this._requestHandler) {\r\n\t\t\t\t\treject(new Error(`No RequestHandler!`));\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tresolve(getAllMethodNames(this._requestHandler));\r\n\t\t\t}, reject);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/**\r\n * Called on the worker side\r\n * @skipMangle\r\n */\r\nexport function create(postMessage: (msg: Message, transfer?: ArrayBuffer[]) => void): SimpleWorkerServer<any> {\r\n\treturn new SimpleWorkerServer(postMessage, null);\r\n}\r\n","\r\nimport { CancellationToken } from 'vs/base/common/cancellation';\r\nimport { Codicon } from 'vs/base/common/codicons';\r\nimport { Color } from 'vs/base/common/color';\r\nimport { IReadonlyVSDataTransfer } from 'vs/base/common/dataTransfer';\r\nimport { Event } from 'vs/base/common/event';\r\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\r\nimport { IDisposable } from 'vs/base/common/lifecycle';\r\nimport { ThemeIcon } from 'vs/base/common/themables';\r\nimport { URI } from 'vs/base/common/uri';\r\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\r\nimport { IPosition, Position } from 'vs/editor/common/core/position';\r\nimport { IRange, Range } from 'vs/editor/common/core/range';\r\nimport { ISelection, Selection } from 'vs/editor/common/core/selection';\r\nimport { LanguageId } from 'vs/editor/common/encodedTokenAttributes';\r\nimport * as model from 'vs/editor/common/model';\r\nimport { TokenizationRegistry as TokenizationRegistryImpl } from 'vs/editor/common/tokenizationRegistry';\r\nimport { ContiguousMultilineTokens } from 'vs/editor/common/tokens/contiguousMultilineTokens';\r\nimport { localize } from 'vs/nls';\r\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\r\nimport { IMarkerData } from 'vs/platform/markers/common/markers';\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ILanguageIdCodec {\r\n\tencodeLanguageId(languageId: string): LanguageId;\r\n\tdecodeLanguageId(languageId: LanguageId): string;\r\n}\r\n\r\nexport class Token {\r\n\t_tokenBrand: void = undefined;\r\n\r\n\tconstructor(\r\n\t\tpublic readonly offset: number,\r\n\t\tpublic readonly type: string,\r\n\t\tpublic readonly language: string,\r\n\t) {\r\n\t}\r\n\r\n\tpublic toString(): string {\r\n\t\treturn '(' + this.offset + ', ' + this.type + ')';\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class TokenizationResult {\r\n\t_tokenizationResultBrand: void = undefined;\r\n\r\n\tconstructor(\r\n\t\tpublic readonly tokens: Token[],\r\n\t\tpublic readonly endState: IState,\r\n\t) {\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class EncodedTokenizationResult {\r\n\t_encodedTokenizationResultBrand: void = undefined;\r\n\r\n\tconstructor(\r\n\t\t/**\r\n\t\t * The tokens in binary format. Each token occupies two array indices. For token i:\r\n\t\t *  - at offset 2*i => startIndex\r\n\t\t *  - at offset 2*i + 1 => metadata\r\n\t\t *\r\n\t\t */\r\n\t\tpublic readonly tokens: Uint32Array,\r\n\t\tpublic readonly endState: IState,\r\n\t) {\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITokenizationSupport {\r\n\t/**\r\n\t * If true, the background tokenizer will only be used to verify tokens against the default background tokenizer.\r\n\t * Used for debugging.\r\n\t */\r\n\treadonly backgroundTokenizerShouldOnlyVerifyTokens?: boolean;\r\n\r\n\tgetInitialState(): IState;\r\n\r\n\ttokenize(line: string, hasEOL: boolean, state: IState): TokenizationResult;\r\n\r\n\ttokenizeEncoded(line: string, hasEOL: boolean, state: IState): EncodedTokenizationResult;\r\n\r\n\t/**\r\n\t * Can be/return undefined if default background tokenization should be used.\r\n\t */\r\n\tcreateBackgroundTokenizer?(textModel: model.ITextModel, store: IBackgroundTokenizationStore): IBackgroundTokenizer | undefined;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IBackgroundTokenizer extends IDisposable {\r\n\t/**\r\n\t * Instructs the background tokenizer to set the tokens for the given range again.\r\n\t *\r\n\t * This might be necessary if the renderer overwrote those tokens with heuristically computed ones for some viewport,\r\n\t * when the change does not even propagate to that viewport.\r\n\t */\r\n\trequestTokens(startLineNumber: number, endLineNumberExclusive: number): void;\r\n\r\n\treportMismatchingTokens?(lineNumber: number): void;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IBackgroundTokenizationStore {\r\n\tsetTokens(tokens: ContiguousMultilineTokens[]): void;\r\n\r\n\tsetEndState(lineNumber: number, state: IState): void;\r\n\r\n\t/**\r\n\t * Should be called to indicate that the background tokenization has finished for now.\r\n\t * (This triggers bracket pair colorization to re-parse the bracket pairs with token information)\r\n\t */\r\n\tbackgroundTokenizationFinished(): void;\r\n}\r\n\r\n/**\r\n * The state of the tokenizer between two lines.\r\n * It is useful to store flags such as in multiline comment, etc.\r\n * The model will clone the previous line's state and pass it in to tokenize the next line.\r\n */\r\nexport interface IState {\r\n\tclone(): IState;\r\n\tequals(other: IState): boolean;\r\n}\r\n\r\n/**\r\n * A provider result represents the values a provider, like the {@link HoverProvider},\r\n * may return. For once this is the actual result type `T`, like `Hover`, or a thenable that resolves\r\n * to that type `T`. In addition, `null` and `undefined` can be returned - either directly or from a\r\n * thenable.\r\n */\r\nexport type ProviderResult<T> = T | undefined | null | Thenable<T | undefined | null>;\r\n\r\n/**\r\n * A hover represents additional information for a symbol or word. Hovers are\r\n * rendered in a tooltip-like widget.\r\n */\r\nexport interface Hover {\r\n\t/**\r\n\t * The contents of this hover.\r\n\t */\r\n\tcontents: IMarkdownString[];\r\n\r\n\t/**\r\n\t * The range to which this hover applies. When missing, the\r\n\t * editor will use the range at the current position or the\r\n\t * current position itself.\r\n\t */\r\n\trange?: IRange;\r\n}\r\n\r\n/**\r\n * The hover provider interface defines the contract between extensions and\r\n * the [hover](https://code.visualstudio.com/docs/editor/intellisense)-feature.\r\n */\r\nexport interface HoverProvider {\r\n\t/**\r\n\t * Provide a hover for the given position and document. Multiple hovers at the same\r\n\t * position will be merged by the editor. A hover can have a range which defaults\r\n\t * to the word range at the position when omitted.\r\n\t */\r\n\tprovideHover(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<Hover>;\r\n}\r\n\r\nexport const enum CompletionItemKind {\r\n\tMethod,\r\n\tFunction,\r\n\tConstructor,\r\n\tField,\r\n\tVariable,\r\n\tClass,\r\n\tStruct,\r\n\tInterface,\r\n\tModule,\r\n\tProperty,\r\n\tEvent,\r\n\tOperator,\r\n\tUnit,\r\n\tValue,\r\n\tConstant,\r\n\tEnum,\r\n\tEnumMember,\r\n\tKeyword,\r\n\tText,\r\n\tColor,\r\n\tFile,\r\n\tReference,\r\n\tCustomcolor,\r\n\tFolder,\r\n\tTypeParameter,\r\n\tUser,\r\n\tIssue,\r\n\tSnippet, // <- highest value (used for compare!)\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport namespace CompletionItemKinds {\r\n\r\n\tconst byKind = new Map<CompletionItemKind, ThemeIcon>();\r\n\tbyKind.set(CompletionItemKind.Method, Codicon.symbolMethod);\r\n\tbyKind.set(CompletionItemKind.Function, Codicon.symbolFunction);\r\n\tbyKind.set(CompletionItemKind.Constructor, Codicon.symbolConstructor);\r\n\tbyKind.set(CompletionItemKind.Field, Codicon.symbolField);\r\n\tbyKind.set(CompletionItemKind.Variable, Codicon.symbolVariable);\r\n\tbyKind.set(CompletionItemKind.Class, Codicon.symbolClass);\r\n\tbyKind.set(CompletionItemKind.Struct, Codicon.symbolStruct);\r\n\tbyKind.set(CompletionItemKind.Interface, Codicon.symbolInterface);\r\n\tbyKind.set(CompletionItemKind.Module, Codicon.symbolModule);\r\n\tbyKind.set(CompletionItemKind.Property, Codicon.symbolProperty);\r\n\tbyKind.set(CompletionItemKind.Event, Codicon.symbolEvent);\r\n\tbyKind.set(CompletionItemKind.Operator, Codicon.symbolOperator);\r\n\tbyKind.set(CompletionItemKind.Unit, Codicon.symbolUnit);\r\n\tbyKind.set(CompletionItemKind.Value, Codicon.symbolValue);\r\n\tbyKind.set(CompletionItemKind.Enum, Codicon.symbolEnum);\r\n\tbyKind.set(CompletionItemKind.Constant, Codicon.symbolConstant);\r\n\tbyKind.set(CompletionItemKind.Enum, Codicon.symbolEnum);\r\n\tbyKind.set(CompletionItemKind.EnumMember, Codicon.symbolEnumMember);\r\n\tbyKind.set(CompletionItemKind.Keyword, Codicon.symbolKeyword);\r\n\tbyKind.set(CompletionItemKind.Snippet, Codicon.symbolSnippet);\r\n\tbyKind.set(CompletionItemKind.Text, Codicon.symbolText);\r\n\tbyKind.set(CompletionItemKind.Color, Codicon.symbolColor);\r\n\tbyKind.set(CompletionItemKind.File, Codicon.symbolFile);\r\n\tbyKind.set(CompletionItemKind.Reference, Codicon.symbolReference);\r\n\tbyKind.set(CompletionItemKind.Customcolor, Codicon.symbolCustomColor);\r\n\tbyKind.set(CompletionItemKind.Folder, Codicon.symbolFolder);\r\n\tbyKind.set(CompletionItemKind.TypeParameter, Codicon.symbolTypeParameter);\r\n\tbyKind.set(CompletionItemKind.User, Codicon.account);\r\n\tbyKind.set(CompletionItemKind.Issue, Codicon.issues);\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function toIcon(kind: CompletionItemKind): ThemeIcon {\r\n\t\tlet codicon = byKind.get(kind);\r\n\t\tif (!codicon) {\r\n\t\t\tconsole.info('No codicon found for CompletionItemKind ' + kind);\r\n\t\t\tcodicon = Codicon.symbolProperty;\r\n\t\t}\r\n\t\treturn codicon;\r\n\t}\r\n\r\n\tconst data = new Map<string, CompletionItemKind>();\r\n\tdata.set('method', CompletionItemKind.Method);\r\n\tdata.set('function', CompletionItemKind.Function);\r\n\tdata.set('constructor', <any>CompletionItemKind.Constructor);\r\n\tdata.set('field', CompletionItemKind.Field);\r\n\tdata.set('variable', CompletionItemKind.Variable);\r\n\tdata.set('class', CompletionItemKind.Class);\r\n\tdata.set('struct', CompletionItemKind.Struct);\r\n\tdata.set('interface', CompletionItemKind.Interface);\r\n\tdata.set('module', CompletionItemKind.Module);\r\n\tdata.set('property', CompletionItemKind.Property);\r\n\tdata.set('event', CompletionItemKind.Event);\r\n\tdata.set('operator', CompletionItemKind.Operator);\r\n\tdata.set('unit', CompletionItemKind.Unit);\r\n\tdata.set('value', CompletionItemKind.Value);\r\n\tdata.set('constant', CompletionItemKind.Constant);\r\n\tdata.set('enum', CompletionItemKind.Enum);\r\n\tdata.set('enum-member', CompletionItemKind.EnumMember);\r\n\tdata.set('enumMember', CompletionItemKind.EnumMember);\r\n\tdata.set('keyword', CompletionItemKind.Keyword);\r\n\tdata.set('snippet', CompletionItemKind.Snippet);\r\n\tdata.set('text', CompletionItemKind.Text);\r\n\tdata.set('color', CompletionItemKind.Color);\r\n\tdata.set('file', CompletionItemKind.File);\r\n\tdata.set('reference', CompletionItemKind.Reference);\r\n\tdata.set('customcolor', CompletionItemKind.Customcolor);\r\n\tdata.set('folder', CompletionItemKind.Folder);\r\n\tdata.set('type-parameter', CompletionItemKind.TypeParameter);\r\n\tdata.set('typeParameter', CompletionItemKind.TypeParameter);\r\n\tdata.set('account', CompletionItemKind.User);\r\n\tdata.set('issue', CompletionItemKind.Issue);\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function fromString(value: string): CompletionItemKind;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function fromString(value: string, strict: true): CompletionItemKind | undefined;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function fromString(value: string, strict?: boolean): CompletionItemKind | undefined {\r\n\t\tlet res = data.get(value);\r\n\t\tif (typeof res === 'undefined' && !strict) {\r\n\t\t\tres = CompletionItemKind.Property;\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n}\r\n\r\nexport interface CompletionItemLabel {\r\n\tlabel: string;\r\n\tdetail?: string;\r\n\tdescription?: string;\r\n}\r\n\r\nexport const enum CompletionItemTag {\r\n\tDeprecated = 1\r\n}\r\n\r\nexport const enum CompletionItemInsertTextRule {\r\n\tNone = 0,\r\n\r\n\t/**\r\n\t * Adjust whitespace/indentation of multiline insert texts to\r\n\t * match the current line indentation.\r\n\t */\r\n\tKeepWhitespace = 0b001,\r\n\r\n\t/**\r\n\t * `insertText` is a snippet.\r\n\t */\r\n\tInsertAsSnippet = 0b100,\r\n}\r\n\r\nexport interface CompletionItemRanges {\r\n\tinsert: IRange;\r\n\treplace: IRange;\r\n}\r\n\r\n/**\r\n * A completion item represents a text snippet that is\r\n * proposed to complete text that is being typed.\r\n */\r\nexport interface CompletionItem {\r\n\t/**\r\n\t * The label of this completion item. By default\r\n\t * this is also the text that is inserted when selecting\r\n\t * this completion.\r\n\t */\r\n\tlabel: string | CompletionItemLabel;\r\n\t/**\r\n\t * The kind of this completion item. Based on the kind\r\n\t * an icon is chosen by the editor.\r\n\t */\r\n\tkind: CompletionItemKind;\r\n\t/**\r\n\t * A modifier to the `kind` which affect how the item\r\n\t * is rendered, e.g. Deprecated is rendered with a strikeout\r\n\t */\r\n\ttags?: ReadonlyArray<CompletionItemTag>;\r\n\t/**\r\n\t * A human-readable string with additional information\r\n\t * about this item, like type or symbol information.\r\n\t */\r\n\tdetail?: string;\r\n\t/**\r\n\t * A human-readable string that represents a doc-comment.\r\n\t */\r\n\tdocumentation?: string | IMarkdownString;\r\n\t/**\r\n\t * A string that should be used when comparing this item\r\n\t * with other items. When `falsy` the {@link CompletionItem.label label}\r\n\t * is used.\r\n\t */\r\n\tsortText?: string;\r\n\t/**\r\n\t * A string that should be used when filtering a set of\r\n\t * completion items. When `falsy` the {@link CompletionItem.label label}\r\n\t * is used.\r\n\t */\r\n\tfilterText?: string;\r\n\t/**\r\n\t * Select this item when showing. *Note* that only one completion item can be selected and\r\n\t * that the editor decides which item that is. The rule is that the *first* item of those\r\n\t * that match best is selected.\r\n\t */\r\n\tpreselect?: boolean;\r\n\t/**\r\n\t * A string or snippet that should be inserted in a document when selecting\r\n\t * this completion.\r\n\t */\r\n\tinsertText: string;\r\n\t/**\r\n\t * Additional rules (as bitmask) that should be applied when inserting\r\n\t * this completion.\r\n\t */\r\n\tinsertTextRules?: CompletionItemInsertTextRule;\r\n\t/**\r\n\t * A range of text that should be replaced by this completion item.\r\n\t *\r\n\t * Defaults to a range from the start of the {@link TextDocument.getWordRangeAtPosition current word} to the\r\n\t * current position.\r\n\t *\r\n\t * *Note:* The range must be a {@link Range.isSingleLine single line} and it must\r\n\t * {@link Range.contains contain} the position at which completion has been {@link CompletionItemProvider.provideCompletionItems requested}.\r\n\t */\r\n\trange: IRange | CompletionItemRanges;\r\n\t/**\r\n\t * An optional set of characters that when pressed while this completion is active will accept it first and\r\n\t * then type that character. *Note* that all commit characters should have `length=1` and that superfluous\r\n\t * characters will be ignored.\r\n\t */\r\n\tcommitCharacters?: string[];\r\n\t/**\r\n\t * An optional array of additional text edits that are applied when\r\n\t * selecting this completion. Edits must not overlap with the main edit\r\n\t * nor with themselves.\r\n\t */\r\n\tadditionalTextEdits?: ISingleEditOperation[];\r\n\t/**\r\n\t * A command that should be run upon acceptance of this item.\r\n\t */\r\n\tcommand?: Command;\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\textensionId?: ExtensionIdentifier;\r\n}\r\n\r\nexport interface CompletionList {\r\n\tsuggestions: CompletionItem[];\r\n\tincomplete?: boolean;\r\n\tdispose?(): void;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\tduration?: number;\r\n}\r\n\r\n/**\r\n * How a suggest provider was triggered.\r\n */\r\nexport const enum CompletionTriggerKind {\r\n\tInvoke = 0,\r\n\tTriggerCharacter = 1,\r\n\tTriggerForIncompleteCompletions = 2\r\n}\r\n/**\r\n * Contains additional information about the context in which\r\n * {@link CompletionItemProvider.provideCompletionItems completion provider} is triggered.\r\n */\r\nexport interface CompletionContext {\r\n\t/**\r\n\t * How the completion was triggered.\r\n\t */\r\n\ttriggerKind: CompletionTriggerKind;\r\n\t/**\r\n\t * Character that triggered the completion item provider.\r\n\t *\r\n\t * `undefined` if provider was not triggered by a character.\r\n\t */\r\n\ttriggerCharacter?: string;\r\n}\r\n/**\r\n * The completion item provider interface defines the contract between extensions and\r\n * the [IntelliSense](https://code.visualstudio.com/docs/editor/intellisense).\r\n *\r\n * When computing *complete* completion items is expensive, providers can optionally implement\r\n * the `resolveCompletionItem`-function. In that case it is enough to return completion\r\n * items with a {@link CompletionItem.label label} from the\r\n * {@link CompletionItemProvider.provideCompletionItems provideCompletionItems}-function. Subsequently,\r\n * when a completion item is shown in the UI and gains focus this provider is asked to resolve\r\n * the item, like adding {@link CompletionItem.documentation doc-comment} or {@link CompletionItem.detail details}.\r\n */\r\nexport interface CompletionItemProvider {\r\n\r\n\t/**\r\n\t * Used to identify completions in the (debug) UI and telemetry. This isn't the extension identifier because extensions\r\n\t * often contribute multiple completion item providers.\r\n\t *\r\n\t * @internal\r\n\t */\r\n\t_debugDisplayName: string;\r\n\r\n\ttriggerCharacters?: string[];\r\n\t/**\r\n\t * Provide completion items for the given position and document.\r\n\t */\r\n\tprovideCompletionItems(model: model.ITextModel, position: Position, context: CompletionContext, token: CancellationToken): ProviderResult<CompletionList>;\r\n\r\n\t/**\r\n\t * Given a completion item fill in more data, like {@link CompletionItem.documentation doc-comment}\r\n\t * or {@link CompletionItem.detail details}.\r\n\t *\r\n\t * The editor will only resolve a completion item once.\r\n\t */\r\n\tresolveCompletionItem?(item: CompletionItem, token: CancellationToken): ProviderResult<CompletionItem>;\r\n}\r\n\r\n/**\r\n * How an {@link InlineCompletionsProvider inline completion provider} was triggered.\r\n */\r\nexport enum InlineCompletionTriggerKind {\r\n\t/**\r\n\t * Completion was triggered automatically while editing.\r\n\t * It is sufficient to return a single completion item in this case.\r\n\t */\r\n\tAutomatic = 0,\r\n\r\n\t/**\r\n\t * Completion was triggered explicitly by a user gesture.\r\n\t * Return multiple completion items to enable cycling through them.\r\n\t */\r\n\tExplicit = 1,\r\n}\r\n\r\nexport interface InlineCompletionContext {\r\n\r\n\t/**\r\n\t * How the completion was triggered.\r\n\t */\r\n\treadonly triggerKind: InlineCompletionTriggerKind;\r\n\treadonly selectedSuggestionInfo: SelectedSuggestionInfo | undefined;\r\n}\r\n\r\nexport class SelectedSuggestionInfo {\r\n\tconstructor(\r\n\t\tpublic readonly range: IRange,\r\n\t\tpublic readonly text: string,\r\n\t\tpublic readonly completionKind: CompletionItemKind,\r\n\t\tpublic readonly isSnippetText: boolean,\r\n\t) {\r\n\t}\r\n\r\n\tpublic equals(other: SelectedSuggestionInfo) {\r\n\t\treturn Range.lift(this.range).equalsRange(other.range)\r\n\t\t\t&& this.text === other.text\r\n\t\t\t&& this.completionKind === other.completionKind\r\n\t\t\t&& this.isSnippetText === other.isSnippetText;\r\n\t}\r\n}\r\n\r\nexport interface InlineCompletion {\r\n\t/**\r\n\t * The text to insert.\r\n\t * If the text contains a line break, the range must end at the end of a line.\r\n\t * If existing text should be replaced, the existing text must be a prefix of the text to insert.\r\n\t *\r\n\t * The text can also be a snippet. In that case, a preview with default parameters is shown.\r\n\t * When accepting the suggestion, the full snippet is inserted.\r\n\t*/\r\n\treadonly insertText: string | { snippet: string };\r\n\r\n\t/**\r\n\t * A text that is used to decide if this inline completion should be shown.\r\n\t * An inline completion is shown if the text to replace is a subword of the filter text.\r\n\t */\r\n\treadonly filterText?: string;\r\n\r\n\t/**\r\n\t * An optional array of additional text edits that are applied when\r\n\t * selecting this completion. Edits must not overlap with the main edit\r\n\t * nor with themselves.\r\n\t */\r\n\treadonly additionalTextEdits?: ISingleEditOperation[];\r\n\r\n\t/**\r\n\t * The range to replace.\r\n\t * Must begin and end on the same line.\r\n\t*/\r\n\treadonly range?: IRange;\r\n\r\n\treadonly command?: Command;\r\n\r\n\t/**\r\n\t * If set to `true`, unopened closing brackets are removed and unclosed opening brackets are closed.\r\n\t * Defaults to `false`.\r\n\t*/\r\n\treadonly completeBracketPairs?: boolean;\r\n}\r\n\r\nexport interface InlineCompletions<TItem extends InlineCompletion = InlineCompletion> {\r\n\treadonly items: readonly TItem[];\r\n\t/**\r\n\t * A list of commands associated with the inline completions of this list.\r\n\t */\r\n\treadonly commands?: Command[];\r\n\r\n\treadonly suppressSuggestions?: boolean | undefined;\r\n\r\n\t/**\r\n\t * When set and the user types a suggestion without derivating from it, the inline suggestion is not updated.\r\n\t */\r\n\treadonly enableForwardStability?: boolean | undefined;\r\n}\r\n\r\nexport type InlineCompletionProviderGroupId = string;\r\n\r\nexport interface InlineCompletionsProvider<T extends InlineCompletions = InlineCompletions> {\r\n\tprovideInlineCompletions(model: model.ITextModel, position: Position, context: InlineCompletionContext, token: CancellationToken): ProviderResult<T>;\r\n\r\n\t/**\r\n\t * Will be called when an item is shown.\r\n\t * @param updatedInsertText Is useful to understand bracket completion.\r\n\t*/\r\n\thandleItemDidShow?(completions: T, item: T['items'][number], updatedInsertText: string): void;\r\n\r\n\t/**\r\n\t * Will be called when an item is partially accepted.\r\n\t */\r\n\thandlePartialAccept?(completions: T, item: T['items'][number], acceptedCharacters: number): void;\r\n\r\n\t/**\r\n\t * Will be called when a completions list is no longer in use and can be garbage-collected.\r\n\t*/\r\n\tfreeInlineCompletions(completions: T): void;\r\n\r\n\t/**\r\n\t * Only used for {@link yieldsToGroupIds}.\r\n\t * Multiple providers can have the same group id.\r\n\t */\r\n\tgroupId?: InlineCompletionProviderGroupId;\r\n\r\n\t/**\r\n\t * Returns a list of preferred provider {@link groupId}s.\r\n\t * The current provider is only requested for completions if no provider with a preferred group id returned a result.\r\n\t */\r\n\tyieldsToGroupIds?: InlineCompletionProviderGroupId[];\r\n\r\n\ttoString?(): string;\r\n}\r\n\r\nexport interface CodeAction {\r\n\ttitle: string;\r\n\tcommand?: Command;\r\n\tedit?: WorkspaceEdit;\r\n\tdiagnostics?: IMarkerData[];\r\n\tkind?: string;\r\n\tisPreferred?: boolean;\r\n\tdisabled?: string;\r\n}\r\n\r\nexport const enum CodeActionTriggerType {\r\n\tInvoke = 1,\r\n\tAuto = 2,\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface CodeActionContext {\r\n\tonly?: string;\r\n\ttrigger: CodeActionTriggerType;\r\n}\r\n\r\nexport interface CodeActionList extends IDisposable {\r\n\treadonly actions: ReadonlyArray<CodeAction>;\r\n}\r\n\r\n/**\r\n * The code action interface defines the contract between extensions and\r\n * the [light bulb](https://code.visualstudio.com/docs/editor/editingevolved#_code-action) feature.\r\n * @internal\r\n */\r\nexport interface CodeActionProvider {\r\n\r\n\t/**\r\n\t * Provide commands for the given document and range.\r\n\t */\r\n\tprovideCodeActions(model: model.ITextModel, range: Range | Selection, context: CodeActionContext, token: CancellationToken): ProviderResult<CodeActionList>;\r\n\r\n\t/**\r\n\t * Given a code action fill in the edit. Will only invoked when missing.\r\n\t */\r\n\tresolveCodeAction?(codeAction: CodeAction, token: CancellationToken): ProviderResult<CodeAction>;\r\n\r\n\t/**\r\n\t * Optional list of CodeActionKinds that this provider returns.\r\n\t */\r\n\treadonly providedCodeActionKinds?: ReadonlyArray<string>;\r\n\r\n\treadonly documentation?: ReadonlyArray<{ readonly kind: string; readonly command: Command }>;\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\t_getAdditionalMenuItems?(context: CodeActionContext, actions: readonly CodeAction[]): Command[];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface DocumentPasteEdit {\r\n\treadonly label: string;\r\n\treadonly detail: string;\r\n\treadonly handledMimeType?: string;\r\n\treadonly yieldTo?: readonly DropYieldTo[];\r\n\tinsertText: string | { readonly snippet: string };\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface DocumentPasteEditProvider {\r\n\r\n\treadonly id: string;\r\n\r\n\treadonly copyMimeTypes?: readonly string[];\r\n\treadonly pasteMimeTypes?: readonly string[];\r\n\r\n\tprepareDocumentPaste?(model: model.ITextModel, ranges: readonly IRange[], dataTransfer: IReadonlyVSDataTransfer, token: CancellationToken): Promise<undefined | IReadonlyVSDataTransfer>;\r\n\r\n\tprovideDocumentPasteEdits?(model: model.ITextModel, ranges: readonly IRange[], dataTransfer: IReadonlyVSDataTransfer, token: CancellationToken): Promise<DocumentPasteEdit | undefined>;\r\n}\r\n\r\n/**\r\n * Represents a parameter of a callable-signature. A parameter can\r\n * have a label and a doc-comment.\r\n */\r\nexport interface ParameterInformation {\r\n\t/**\r\n\t * The label of this signature. Will be shown in\r\n\t * the UI.\r\n\t */\r\n\tlabel: string | [number, number];\r\n\t/**\r\n\t * The human-readable doc-comment of this signature. Will be shown\r\n\t * in the UI but can be omitted.\r\n\t */\r\n\tdocumentation?: string | IMarkdownString;\r\n}\r\n/**\r\n * Represents the signature of something callable. A signature\r\n * can have a label, like a function-name, a doc-comment, and\r\n * a set of parameters.\r\n */\r\nexport interface SignatureInformation {\r\n\t/**\r\n\t * The label of this signature. Will be shown in\r\n\t * the UI.\r\n\t */\r\n\tlabel: string;\r\n\t/**\r\n\t * The human-readable doc-comment of this signature. Will be shown\r\n\t * in the UI but can be omitted.\r\n\t */\r\n\tdocumentation?: string | IMarkdownString;\r\n\t/**\r\n\t * The parameters of this signature.\r\n\t */\r\n\tparameters: ParameterInformation[];\r\n\t/**\r\n\t * Index of the active parameter.\r\n\t *\r\n\t * If provided, this is used in place of `SignatureHelp.activeSignature`.\r\n\t */\r\n\tactiveParameter?: number;\r\n}\r\n/**\r\n * Signature help represents the signature of something\r\n * callable. There can be multiple signatures but only one\r\n * active and only one active parameter.\r\n */\r\nexport interface SignatureHelp {\r\n\t/**\r\n\t * One or more signatures.\r\n\t */\r\n\tsignatures: SignatureInformation[];\r\n\t/**\r\n\t * The active signature.\r\n\t */\r\n\tactiveSignature: number;\r\n\t/**\r\n\t * The active parameter of the active signature.\r\n\t */\r\n\tactiveParameter: number;\r\n}\r\n\r\nexport interface SignatureHelpResult extends IDisposable {\r\n\tvalue: SignatureHelp;\r\n}\r\n\r\nexport enum SignatureHelpTriggerKind {\r\n\tInvoke = 1,\r\n\tTriggerCharacter = 2,\r\n\tContentChange = 3,\r\n}\r\n\r\nexport interface SignatureHelpContext {\r\n\treadonly triggerKind: SignatureHelpTriggerKind;\r\n\treadonly triggerCharacter?: string;\r\n\treadonly isRetrigger: boolean;\r\n\treadonly activeSignatureHelp?: SignatureHelp;\r\n}\r\n\r\n/**\r\n * The signature help provider interface defines the contract between extensions and\r\n * the [parameter hints](https://code.visualstudio.com/docs/editor/intellisense)-feature.\r\n */\r\nexport interface SignatureHelpProvider {\r\n\r\n\treadonly signatureHelpTriggerCharacters?: ReadonlyArray<string>;\r\n\treadonly signatureHelpRetriggerCharacters?: ReadonlyArray<string>;\r\n\r\n\t/**\r\n\t * Provide help for the signature at the given position and document.\r\n\t */\r\n\tprovideSignatureHelp(model: model.ITextModel, position: Position, token: CancellationToken, context: SignatureHelpContext): ProviderResult<SignatureHelpResult>;\r\n}\r\n\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport enum DocumentHighlightKind {\r\n\t/**\r\n\t * A textual occurrence.\r\n\t */\r\n\tText,\r\n\t/**\r\n\t * Read-access of a symbol, like reading a variable.\r\n\t */\r\n\tRead,\r\n\t/**\r\n\t * Write-access of a symbol, like writing to a variable.\r\n\t */\r\n\tWrite\r\n}\r\n/**\r\n * A document highlight is a range inside a text document which deserves\r\n * special attention. Usually a document highlight is visualized by changing\r\n * the background color of its range.\r\n */\r\nexport interface DocumentHighlight {\r\n\t/**\r\n\t * The range this highlight applies to.\r\n\t */\r\n\trange: IRange;\r\n\t/**\r\n\t * The highlight kind, default is {@link DocumentHighlightKind.Text text}.\r\n\t */\r\n\tkind?: DocumentHighlightKind;\r\n}\r\n/**\r\n * The document highlight provider interface defines the contract between extensions and\r\n * the word-highlight-feature.\r\n */\r\nexport interface DocumentHighlightProvider {\r\n\t/**\r\n\t * Provide a set of document highlights, like all occurrences of a variable or\r\n\t * all exit-points of a function.\r\n\t */\r\n\tprovideDocumentHighlights(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<DocumentHighlight[]>;\r\n}\r\n\r\n/**\r\n * The linked editing range provider interface defines the contract between extensions and\r\n * the linked editing feature.\r\n */\r\nexport interface LinkedEditingRangeProvider {\r\n\r\n\t/**\r\n\t * Provide a list of ranges that can be edited together.\r\n\t */\r\n\tprovideLinkedEditingRanges(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<LinkedEditingRanges>;\r\n}\r\n\r\n/**\r\n * Represents a list of ranges that can be edited together along with a word pattern to describe valid contents.\r\n */\r\nexport interface LinkedEditingRanges {\r\n\t/**\r\n\t * A list of ranges that can be edited together. The ranges must have\r\n\t * identical length and text content. The ranges cannot overlap\r\n\t */\r\n\tranges: IRange[];\r\n\r\n\t/**\r\n\t * An optional word pattern that describes valid contents for the given ranges.\r\n\t * If no pattern is provided, the language configuration's word pattern will be used.\r\n\t */\r\n\twordPattern?: RegExp;\r\n}\r\n\r\n/**\r\n * Value-object that contains additional information when\r\n * requesting references.\r\n */\r\nexport interface ReferenceContext {\r\n\t/**\r\n\t * Include the declaration of the current symbol.\r\n\t */\r\n\tincludeDeclaration: boolean;\r\n}\r\n/**\r\n * The reference provider interface defines the contract between extensions and\r\n * the [find references](https://code.visualstudio.com/docs/editor/editingevolved#_peek)-feature.\r\n */\r\nexport interface ReferenceProvider {\r\n\t/**\r\n\t * Provide a set of project-wide references for the given position and document.\r\n\t */\r\n\tprovideReferences(model: model.ITextModel, position: Position, context: ReferenceContext, token: CancellationToken): ProviderResult<Location[]>;\r\n}\r\n\r\n/**\r\n * Represents a location inside a resource, such as a line\r\n * inside a text file.\r\n */\r\nexport interface Location {\r\n\t/**\r\n\t * The resource identifier of this location.\r\n\t */\r\n\turi: URI;\r\n\t/**\r\n\t * The document range of this locations.\r\n\t */\r\n\trange: IRange;\r\n}\r\n\r\nexport interface LocationLink {\r\n\t/**\r\n\t * A range to select where this link originates from.\r\n\t */\r\n\toriginSelectionRange?: IRange;\r\n\r\n\t/**\r\n\t * The target uri this link points to.\r\n\t */\r\n\turi: URI;\r\n\r\n\t/**\r\n\t * The full range this link points to.\r\n\t */\r\n\trange: IRange;\r\n\r\n\t/**\r\n\t * A range to select this link points to. Must be contained\r\n\t * in `LocationLink.range`.\r\n\t */\r\n\ttargetSelectionRange?: IRange;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function isLocationLink(thing: any): thing is LocationLink {\r\n\treturn thing\r\n\t\t&& URI.isUri((thing as LocationLink).uri)\r\n\t\t&& Range.isIRange((thing as LocationLink).range)\r\n\t\t&& (Range.isIRange((thing as LocationLink).originSelectionRange) || Range.isIRange((thing as LocationLink).targetSelectionRange));\r\n}\r\n\r\nexport type Definition = Location | Location[] | LocationLink[];\r\n\r\n/**\r\n * The definition provider interface defines the contract between extensions and\r\n * the [go to definition](https://code.visualstudio.com/docs/editor/editingevolved#_go-to-definition)\r\n * and peek definition features.\r\n */\r\nexport interface DefinitionProvider {\r\n\t/**\r\n\t * Provide the definition of the symbol at the given position and document.\r\n\t */\r\n\tprovideDefinition(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<Definition | LocationLink[]>;\r\n}\r\n\r\n/**\r\n * The definition provider interface defines the contract between extensions and\r\n * the [go to definition](https://code.visualstudio.com/docs/editor/editingevolved#_go-to-definition)\r\n * and peek definition features.\r\n */\r\nexport interface DeclarationProvider {\r\n\t/**\r\n\t * Provide the declaration of the symbol at the given position and document.\r\n\t */\r\n\tprovideDeclaration(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<Definition | LocationLink[]>;\r\n}\r\n\r\n/**\r\n * The implementation provider interface defines the contract between extensions and\r\n * the go to implementation feature.\r\n */\r\nexport interface ImplementationProvider {\r\n\t/**\r\n\t * Provide the implementation of the symbol at the given position and document.\r\n\t */\r\n\tprovideImplementation(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<Definition | LocationLink[]>;\r\n}\r\n\r\n/**\r\n * The type definition provider interface defines the contract between extensions and\r\n * the go to type definition feature.\r\n */\r\nexport interface TypeDefinitionProvider {\r\n\t/**\r\n\t * Provide the type definition of the symbol at the given position and document.\r\n\t */\r\n\tprovideTypeDefinition(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<Definition | LocationLink[]>;\r\n}\r\n\r\n/**\r\n * A symbol kind.\r\n */\r\nexport const enum SymbolKind {\r\n\tFile = 0,\r\n\tModule = 1,\r\n\tNamespace = 2,\r\n\tPackage = 3,\r\n\tClass = 4,\r\n\tMethod = 5,\r\n\tProperty = 6,\r\n\tField = 7,\r\n\tConstructor = 8,\r\n\tEnum = 9,\r\n\tInterface = 10,\r\n\tFunction = 11,\r\n\tVariable = 12,\r\n\tConstant = 13,\r\n\tString = 14,\r\n\tNumber = 15,\r\n\tBoolean = 16,\r\n\tArray = 17,\r\n\tObject = 18,\r\n\tKey = 19,\r\n\tNull = 20,\r\n\tEnumMember = 21,\r\n\tStruct = 22,\r\n\tEvent = 23,\r\n\tOperator = 24,\r\n\tTypeParameter = 25\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const symbolKindNames: { [symbol: number]: string } = {\r\n\t[SymbolKind.Array]: localize('Array', \"array\"),\r\n\t[SymbolKind.Boolean]: localize('Boolean', \"boolean\"),\r\n\t[SymbolKind.Class]: localize('Class', \"class\"),\r\n\t[SymbolKind.Constant]: localize('Constant', \"constant\"),\r\n\t[SymbolKind.Constructor]: localize('Constructor', \"constructor\"),\r\n\t[SymbolKind.Enum]: localize('Enum', \"enumeration\"),\r\n\t[SymbolKind.EnumMember]: localize('EnumMember', \"enumeration member\"),\r\n\t[SymbolKind.Event]: localize('Event', \"event\"),\r\n\t[SymbolKind.Field]: localize('Field', \"field\"),\r\n\t[SymbolKind.File]: localize('File', \"file\"),\r\n\t[SymbolKind.Function]: localize('Function', \"function\"),\r\n\t[SymbolKind.Interface]: localize('Interface', \"interface\"),\r\n\t[SymbolKind.Key]: localize('Key', \"key\"),\r\n\t[SymbolKind.Method]: localize('Method', \"method\"),\r\n\t[SymbolKind.Module]: localize('Module', \"module\"),\r\n\t[SymbolKind.Namespace]: localize('Namespace', \"namespace\"),\r\n\t[SymbolKind.Null]: localize('Null', \"null\"),\r\n\t[SymbolKind.Number]: localize('Number', \"number\"),\r\n\t[SymbolKind.Object]: localize('Object', \"object\"),\r\n\t[SymbolKind.Operator]: localize('Operator', \"operator\"),\r\n\t[SymbolKind.Package]: localize('Package', \"package\"),\r\n\t[SymbolKind.Property]: localize('Property', \"property\"),\r\n\t[SymbolKind.String]: localize('String', \"string\"),\r\n\t[SymbolKind.Struct]: localize('Struct', \"struct\"),\r\n\t[SymbolKind.TypeParameter]: localize('TypeParameter', \"type parameter\"),\r\n\t[SymbolKind.Variable]: localize('Variable', \"variable\"),\r\n};\r\n\r\n/**\r\n * @internal\r\n */\r\nexport function getAriaLabelForSymbol(symbolName: string, kind: SymbolKind): string {\r\n\treturn localize('symbolAriaLabel', '{0} ({1})', symbolName, symbolKindNames[kind]);\r\n}\r\n\r\nexport const enum SymbolTag {\r\n\tDeprecated = 1,\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport namespace SymbolKinds {\r\n\r\n\tconst byKind = new Map<SymbolKind, ThemeIcon>();\r\n\tbyKind.set(SymbolKind.File, Codicon.symbolFile);\r\n\tbyKind.set(SymbolKind.Module, Codicon.symbolModule);\r\n\tbyKind.set(SymbolKind.Namespace, Codicon.symbolNamespace);\r\n\tbyKind.set(SymbolKind.Package, Codicon.symbolPackage);\r\n\tbyKind.set(SymbolKind.Class, Codicon.symbolClass);\r\n\tbyKind.set(SymbolKind.Method, Codicon.symbolMethod);\r\n\tbyKind.set(SymbolKind.Property, Codicon.symbolProperty);\r\n\tbyKind.set(SymbolKind.Field, Codicon.symbolField);\r\n\tbyKind.set(SymbolKind.Constructor, Codicon.symbolConstructor);\r\n\tbyKind.set(SymbolKind.Enum, Codicon.symbolEnum);\r\n\tbyKind.set(SymbolKind.Interface, Codicon.symbolInterface);\r\n\tbyKind.set(SymbolKind.Function, Codicon.symbolFunction);\r\n\tbyKind.set(SymbolKind.Variable, Codicon.symbolVariable);\r\n\tbyKind.set(SymbolKind.Constant, Codicon.symbolConstant);\r\n\tbyKind.set(SymbolKind.String, Codicon.symbolString);\r\n\tbyKind.set(SymbolKind.Number, Codicon.symbolNumber);\r\n\tbyKind.set(SymbolKind.Boolean, Codicon.symbolBoolean);\r\n\tbyKind.set(SymbolKind.Array, Codicon.symbolArray);\r\n\tbyKind.set(SymbolKind.Object, Codicon.symbolObject);\r\n\tbyKind.set(SymbolKind.Key, Codicon.symbolKey);\r\n\tbyKind.set(SymbolKind.Null, Codicon.symbolNull);\r\n\tbyKind.set(SymbolKind.EnumMember, Codicon.symbolEnumMember);\r\n\tbyKind.set(SymbolKind.Struct, Codicon.symbolStruct);\r\n\tbyKind.set(SymbolKind.Event, Codicon.symbolEvent);\r\n\tbyKind.set(SymbolKind.Operator, Codicon.symbolOperator);\r\n\tbyKind.set(SymbolKind.TypeParameter, Codicon.symbolTypeParameter);\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function toIcon(kind: SymbolKind): ThemeIcon {\r\n\t\tlet icon = byKind.get(kind);\r\n\t\tif (!icon) {\r\n\t\t\tconsole.info('No codicon found for SymbolKind ' + kind);\r\n\t\t\ticon = Codicon.symbolProperty;\r\n\t\t}\r\n\t\treturn icon;\r\n\t}\r\n}\r\n\r\nexport interface DocumentSymbol {\r\n\tname: string;\r\n\tdetail: string;\r\n\tkind: SymbolKind;\r\n\ttags: ReadonlyArray<SymbolTag>;\r\n\tcontainerName?: string;\r\n\trange: IRange;\r\n\tselectionRange: IRange;\r\n\tchildren?: DocumentSymbol[];\r\n}\r\n\r\n/**\r\n * The document symbol provider interface defines the contract between extensions and\r\n * the [go to symbol](https://code.visualstudio.com/docs/editor/editingevolved#_go-to-symbol)-feature.\r\n */\r\nexport interface DocumentSymbolProvider {\r\n\r\n\tdisplayName?: string;\r\n\r\n\t/**\r\n\t * Provide symbol information for the given document.\r\n\t */\r\n\tprovideDocumentSymbols(model: model.ITextModel, token: CancellationToken): ProviderResult<DocumentSymbol[]>;\r\n}\r\n\r\nexport interface TextEdit {\r\n\trange: IRange;\r\n\ttext: string;\r\n\teol?: model.EndOfLineSequence;\r\n}\r\n\r\n/** @internal */\r\nexport abstract class TextEdit {\r\n}\r\n\r\n/**\r\n * Interface used to format a model\r\n */\r\nexport interface FormattingOptions {\r\n\t/**\r\n\t * Size of a tab in spaces.\r\n\t */\r\n\ttabSize: number;\r\n\t/**\r\n\t * Prefer spaces over tabs.\r\n\t */\r\n\tinsertSpaces: boolean;\r\n\t/**\r\n\t * The list of multiple ranges to format at once, if the provider supports it.\r\n\t */\r\n\tranges?: Range[];\r\n}\r\n/**\r\n * The document formatting provider interface defines the contract between extensions and\r\n * the formatting-feature.\r\n */\r\nexport interface DocumentFormattingEditProvider {\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\treadonly extensionId?: ExtensionIdentifier;\r\n\r\n\treadonly displayName?: string;\r\n\r\n\t/**\r\n\t * Provide formatting edits for a whole document.\r\n\t */\r\n\tprovideDocumentFormattingEdits(model: model.ITextModel, options: FormattingOptions, token: CancellationToken): ProviderResult<TextEdit[]>;\r\n}\r\n/**\r\n * The document formatting provider interface defines the contract between extensions and\r\n * the formatting-feature.\r\n */\r\nexport interface DocumentRangeFormattingEditProvider {\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\treadonly extensionId?: ExtensionIdentifier;\r\n\r\n\treadonly displayName?: string;\r\n\r\n\t/**\r\n\t * Provide formatting edits for a range in a document.\r\n\t *\r\n\t * The given range is a hint and providers can decide to format a smaller\r\n\t * or larger range. Often this is done by adjusting the start and end\r\n\t * of the range to full syntax nodes.\r\n\t */\r\n\tprovideDocumentRangeFormattingEdits(model: model.ITextModel, range: Range, options: FormattingOptions, token: CancellationToken): ProviderResult<TextEdit[]>;\r\n\r\n\tprovideDocumentRangesFormattingEdits?(model: model.ITextModel, ranges: Range[], options: FormattingOptions, token: CancellationToken): ProviderResult<TextEdit[]>;\r\n}\r\n/**\r\n * The document formatting provider interface defines the contract between extensions and\r\n * the formatting-feature.\r\n */\r\nexport interface OnTypeFormattingEditProvider {\r\n\r\n\tautoFormatTriggerCharacters: string[];\r\n\r\n\t/**\r\n\t * Provide formatting edits after a character has been typed.\r\n\t *\r\n\t * The given position and character should hint to the provider\r\n\t * what range the position to expand to, like find the matching `{`\r\n\t * when `}` has been entered.\r\n\t */\r\n\tprovideOnTypeFormattingEdits(model: model.ITextModel, position: Position, ch: string, options: FormattingOptions, token: CancellationToken): ProviderResult<TextEdit[]>;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IInplaceReplaceSupportResult {\r\n\tvalue: string;\r\n\trange: IRange;\r\n}\r\n\r\n/**\r\n * A link inside the editor.\r\n */\r\nexport interface ILink {\r\n\trange: IRange;\r\n\turl?: URI | string;\r\n\ttooltip?: string;\r\n}\r\n\r\nexport interface ILinksList {\r\n\tlinks: ILink[];\r\n\tdispose?(): void;\r\n}\r\n/**\r\n * A provider of links.\r\n */\r\nexport interface LinkProvider {\r\n\tprovideLinks(model: model.ITextModel, token: CancellationToken): ProviderResult<ILinksList>;\r\n\tresolveLink?: (link: ILink, token: CancellationToken) => ProviderResult<ILink>;\r\n}\r\n\r\n/**\r\n * A color in RGBA format.\r\n */\r\nexport interface IColor {\r\n\r\n\t/**\r\n\t * The red component in the range [0-1].\r\n\t */\r\n\treadonly red: number;\r\n\r\n\t/**\r\n\t * The green component in the range [0-1].\r\n\t */\r\n\treadonly green: number;\r\n\r\n\t/**\r\n\t * The blue component in the range [0-1].\r\n\t */\r\n\treadonly blue: number;\r\n\r\n\t/**\r\n\t * The alpha component in the range [0-1].\r\n\t */\r\n\treadonly alpha: number;\r\n}\r\n\r\n/**\r\n * String representations for a color\r\n */\r\nexport interface IColorPresentation {\r\n\t/**\r\n\t * The label of this color presentation. It will be shown on the color\r\n\t * picker header. By default this is also the text that is inserted when selecting\r\n\t * this color presentation.\r\n\t */\r\n\tlabel: string;\r\n\t/**\r\n\t * An {@link TextEdit edit} which is applied to a document when selecting\r\n\t * this presentation for the color.\r\n\t */\r\n\ttextEdit?: TextEdit;\r\n\t/**\r\n\t * An optional array of additional {@link TextEdit text edits} that are applied when\r\n\t * selecting this color presentation.\r\n\t */\r\n\tadditionalTextEdits?: TextEdit[];\r\n}\r\n\r\n/**\r\n * A color range is a range in a text model which represents a color.\r\n */\r\nexport interface IColorInformation {\r\n\r\n\t/**\r\n\t * The range within the model.\r\n\t */\r\n\trange: IRange;\r\n\r\n\t/**\r\n\t * The color represented in this range.\r\n\t */\r\n\tcolor: IColor;\r\n}\r\n\r\n/**\r\n * A provider of colors for editor models.\r\n */\r\nexport interface DocumentColorProvider {\r\n\t/**\r\n\t * Provides the color ranges for a specific model.\r\n\t */\r\n\tprovideDocumentColors(model: model.ITextModel, token: CancellationToken): ProviderResult<IColorInformation[]>;\r\n\t/**\r\n\t * Provide the string representations for a color.\r\n\t */\r\n\tprovideColorPresentations(model: model.ITextModel, colorInfo: IColorInformation, token: CancellationToken): ProviderResult<IColorPresentation[]>;\r\n}\r\n\r\nexport interface SelectionRange {\r\n\trange: IRange;\r\n}\r\n\r\nexport interface SelectionRangeProvider {\r\n\t/**\r\n\t * Provide ranges that should be selected from the given position.\r\n\t */\r\n\tprovideSelectionRanges(model: model.ITextModel, positions: Position[], token: CancellationToken): ProviderResult<SelectionRange[][]>;\r\n}\r\n\r\nexport interface FoldingContext {\r\n}\r\n/**\r\n * A provider of folding ranges for editor models.\r\n */\r\nexport interface FoldingRangeProvider {\r\n\r\n\t/**\r\n\t * An optional event to signal that the folding ranges from this provider have changed.\r\n\t */\r\n\tonDidChange?: Event<this>;\r\n\r\n\t/**\r\n\t * Provides the folding ranges for a specific model.\r\n\t */\r\n\tprovideFoldingRanges(model: model.ITextModel, context: FoldingContext, token: CancellationToken): ProviderResult<FoldingRange[]>;\r\n}\r\n\r\nexport interface FoldingRange {\r\n\r\n\t/**\r\n\t * The one-based start line of the range to fold. The folded area starts after the line's last character.\r\n\t */\r\n\tstart: number;\r\n\r\n\t/**\r\n\t * The one-based end line of the range to fold. The folded area ends with the line's last character.\r\n\t */\r\n\tend: number;\r\n\r\n\t/**\r\n\t * Describes the {@link FoldingRangeKind Kind} of the folding range such as {@link FoldingRangeKind.Comment Comment} or\r\n\t * {@link FoldingRangeKind.Region Region}. The kind is used to categorize folding ranges and used by commands\r\n\t * like 'Fold all comments'. See\r\n\t * {@link FoldingRangeKind} for an enumeration of standardized kinds.\r\n\t */\r\n\tkind?: FoldingRangeKind;\r\n}\r\nexport class FoldingRangeKind {\r\n\t/**\r\n\t * Kind for folding range representing a comment. The value of the kind is 'comment'.\r\n\t */\r\n\tstatic readonly Comment = new FoldingRangeKind('comment');\r\n\t/**\r\n\t * Kind for folding range representing a import. The value of the kind is 'imports'.\r\n\t */\r\n\tstatic readonly Imports = new FoldingRangeKind('imports');\r\n\t/**\r\n\t * Kind for folding range representing regions (for example marked by `#region`, `#endregion`).\r\n\t * The value of the kind is 'region'.\r\n\t */\r\n\tstatic readonly Region = new FoldingRangeKind('region');\r\n\r\n\t/**\r\n\t * Returns a {@link FoldingRangeKind} for the given value.\r\n\t *\r\n\t * @param value of the kind.\r\n\t */\r\n\tstatic fromValue(value: string) {\r\n\t\tswitch (value) {\r\n\t\t\tcase 'comment': return FoldingRangeKind.Comment;\r\n\t\t\tcase 'imports': return FoldingRangeKind.Imports;\r\n\t\t\tcase 'region': return FoldingRangeKind.Region;\r\n\t\t}\r\n\t\treturn new FoldingRangeKind(value);\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a new {@link FoldingRangeKind}.\r\n\t *\r\n\t * @param value of the kind.\r\n\t */\r\n\tpublic constructor(public value: string) {\r\n\t}\r\n}\r\n\r\n\r\nexport interface WorkspaceEditMetadata {\r\n\tneedsConfirmation: boolean;\r\n\tlabel: string;\r\n\tdescription?: string;\r\n}\r\n\r\nexport interface WorkspaceFileEditOptions {\r\n\toverwrite?: boolean;\r\n\tignoreIfNotExists?: boolean;\r\n\tignoreIfExists?: boolean;\r\n\trecursive?: boolean;\r\n\tcopy?: boolean;\r\n\tfolder?: boolean;\r\n\tskipTrashBin?: boolean;\r\n\tmaxSize?: number;\r\n}\r\n\r\nexport interface IWorkspaceFileEdit {\r\n\toldResource?: URI;\r\n\tnewResource?: URI;\r\n\toptions?: WorkspaceFileEditOptions;\r\n\tmetadata?: WorkspaceEditMetadata;\r\n}\r\n\r\nexport interface IWorkspaceTextEdit {\r\n\tresource: URI;\r\n\ttextEdit: TextEdit & { insertAsSnippet?: boolean };\r\n\tversionId: number | undefined;\r\n\tmetadata?: WorkspaceEditMetadata;\r\n}\r\n\r\nexport interface WorkspaceEdit {\r\n\tedits: Array<IWorkspaceTextEdit | IWorkspaceFileEdit>;\r\n}\r\n\r\nexport interface Rejection {\r\n\trejectReason?: string;\r\n}\r\nexport interface RenameLocation {\r\n\trange: IRange;\r\n\ttext: string;\r\n}\r\n\r\nexport interface RenameProvider {\r\n\tprovideRenameEdits(model: model.ITextModel, position: Position, newName: string, token: CancellationToken): ProviderResult<WorkspaceEdit & Rejection>;\r\n\tresolveRenameLocation?(model: model.ITextModel, position: Position, token: CancellationToken): ProviderResult<RenameLocation & Rejection>;\r\n}\r\n\r\nexport interface Command {\r\n\tid: string;\r\n\ttitle: string;\r\n\ttooltip?: string;\r\n\targuments?: any[];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport namespace Command {\r\n\r\n\t/**\r\n\t * @internal\r\n\t */\r\n\texport function is(obj: any): obj is Command {\r\n\t\tif (!obj || typeof obj !== 'object') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn typeof (<Command>obj).id === 'string' &&\r\n\t\t\ttypeof (<Command>obj).title === 'string';\r\n\t}\r\n}\r\n\r\nexport interface CodeLens {\r\n\trange: IRange;\r\n\tid?: string;\r\n\tcommand?: Command;\r\n}\r\n\r\nexport interface CodeLensList {\r\n\tlenses: CodeLens[];\r\n\tdispose(): void;\r\n}\r\n\r\nexport interface CodeLensProvider {\r\n\tonDidChange?: Event<this>;\r\n\tprovideCodeLenses(model: model.ITextModel, token: CancellationToken): ProviderResult<CodeLensList>;\r\n\tresolveCodeLens?(model: model.ITextModel, codeLens: CodeLens, token: CancellationToken): ProviderResult<CodeLens>;\r\n}\r\n\r\n\r\nexport enum InlayHintKind {\r\n\tType = 1,\r\n\tParameter = 2,\r\n}\r\n\r\nexport interface InlayHintLabelPart {\r\n\tlabel: string;\r\n\ttooltip?: string | IMarkdownString;\r\n\t// collapsible?: boolean;\r\n\tcommand?: Command;\r\n\tlocation?: Location;\r\n}\r\n\r\nexport interface InlayHint {\r\n\tlabel: string | InlayHintLabelPart[];\r\n\ttooltip?: string | IMarkdownString;\r\n\ttextEdits?: TextEdit[];\r\n\tposition: IPosition;\r\n\tkind?: InlayHintKind;\r\n\tpaddingLeft?: boolean;\r\n\tpaddingRight?: boolean;\r\n}\r\n\r\nexport interface InlayHintList {\r\n\thints: InlayHint[];\r\n\tdispose(): void;\r\n}\r\n\r\nexport interface InlayHintsProvider {\r\n\tdisplayName?: string;\r\n\tonDidChangeInlayHints?: Event<void>;\r\n\tprovideInlayHints(model: model.ITextModel, range: Range, token: CancellationToken): ProviderResult<InlayHintList>;\r\n\tresolveInlayHint?(hint: InlayHint, token: CancellationToken): ProviderResult<InlayHint>;\r\n}\r\n\r\nexport interface SemanticTokensLegend {\r\n\treadonly tokenTypes: string[];\r\n\treadonly tokenModifiers: string[];\r\n}\r\n\r\nexport interface SemanticTokens {\r\n\treadonly resultId?: string;\r\n\treadonly data: Uint32Array;\r\n}\r\n\r\nexport interface SemanticTokensEdit {\r\n\treadonly start: number;\r\n\treadonly deleteCount: number;\r\n\treadonly data?: Uint32Array;\r\n}\r\n\r\nexport interface SemanticTokensEdits {\r\n\treadonly resultId?: string;\r\n\treadonly edits: SemanticTokensEdit[];\r\n}\r\n\r\nexport interface DocumentSemanticTokensProvider {\r\n\tonDidChange?: Event<void>;\r\n\tgetLegend(): SemanticTokensLegend;\r\n\tprovideDocumentSemanticTokens(model: model.ITextModel, lastResultId: string | null, token: CancellationToken): ProviderResult<SemanticTokens | SemanticTokensEdits>;\r\n\treleaseDocumentSemanticTokens(resultId: string | undefined): void;\r\n}\r\n\r\nexport interface DocumentRangeSemanticTokensProvider {\r\n\tgetLegend(): SemanticTokensLegend;\r\n\tprovideDocumentRangeSemanticTokens(model: model.ITextModel, range: Range, token: CancellationToken): ProviderResult<SemanticTokens>;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITokenizationSupportChangedEvent {\r\n\tchangedLanguages: string[];\r\n\tchangedColorMap: boolean;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ILazyTokenizationSupport {\r\n\tget tokenizationSupport(): Promise<ITokenizationSupport | null>;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport class LazyTokenizationSupport implements IDisposable, ILazyTokenizationSupport {\r\n\tprivate _tokenizationSupport: Promise<ITokenizationSupport & IDisposable | null> | null = null;\r\n\r\n\tconstructor(private readonly createSupport: () => Promise<ITokenizationSupport & IDisposable | null>) {\r\n\t}\r\n\r\n\tdispose(): void {\r\n\t\tif (this._tokenizationSupport) {\r\n\t\t\tthis._tokenizationSupport.then((support) => {\r\n\t\t\t\tif (support) {\r\n\t\t\t\t\tsupport.dispose();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tget tokenizationSupport(): Promise<ITokenizationSupport | null> {\r\n\t\tif (!this._tokenizationSupport) {\r\n\t\t\tthis._tokenizationSupport = this.createSupport();\r\n\t\t}\r\n\t\treturn this._tokenizationSupport;\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ITokenizationRegistry {\r\n\r\n\t/**\r\n\t * An event triggered when:\r\n\t *  - a tokenization support is registered, unregistered or changed.\r\n\t *  - the color map is changed.\r\n\t */\r\n\tonDidChange: Event<ITokenizationSupportChangedEvent>;\r\n\r\n\t/**\r\n\t * Fire a change event for a language.\r\n\t * This is useful for languages that embed other languages.\r\n\t */\r\n\thandleChange(languageIds: string[]): void;\r\n\r\n\t/**\r\n\t * Register a tokenization support.\r\n\t */\r\n\tregister(languageId: string, support: ITokenizationSupport): IDisposable;\r\n\r\n\t/**\r\n\t * Register a tokenization support factory.\r\n\t */\r\n\tregisterFactory(languageId: string, factory: ILazyTokenizationSupport): IDisposable;\r\n\r\n\t/**\r\n\t * Get or create the tokenization support for a language.\r\n\t * Returns `null` if not found.\r\n\t */\r\n\tgetOrCreate(languageId: string): Promise<ITokenizationSupport | null>;\r\n\r\n\t/**\r\n\t * Get the tokenization support for a language.\r\n\t * Returns `null` if not found.\r\n\t */\r\n\tget(languageId: string): ITokenizationSupport | null;\r\n\r\n\t/**\r\n\t * Returns false if a factory is still pending.\r\n\t */\r\n\tisResolved(languageId: string): boolean;\r\n\r\n\t/**\r\n\t * Set the new color map that all tokens will use in their ColorId binary encoded bits for foreground and background.\r\n\t */\r\n\tsetColorMap(colorMap: Color[]): void;\r\n\r\n\tgetColorMap(): Color[] | null;\r\n\r\n\tgetDefaultBackground(): Color | null;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport const TokenizationRegistry: ITokenizationRegistry = new TokenizationRegistryImpl();\r\n\r\n/**\r\n * @internal\r\n */\r\nexport type DropYieldTo = { readonly providerId: string } | { readonly mimeType: string };\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface DocumentOnDropEdit {\r\n\treadonly label: string;\r\n\treadonly handledMimeType?: string;\r\n\treadonly yieldTo?: readonly DropYieldTo[];\r\n\tinsertText: string | { readonly snippet: string };\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface DocumentOnDropEditProvider {\r\n\treadonly id?: string;\r\n\treadonly dropMimeTypes?: readonly string[];\r\n\r\n\tprovideDocumentOnDropEdits(model: model.ITextModel, position: IPosition, dataTransfer: IReadonlyVSDataTransfer, token: CancellationToken): ProviderResult<DocumentOnDropEdit>;\r\n}\r\n\r\nexport interface RelatedContextItem {\r\n\treadonly uri: URI;\r\n\treadonly range: IRange;\r\n}\r\n\r\nexport interface MappedEditsContext {\r\n\tselections: ISelection[];\r\n\trelated: RelatedContextItem[];\r\n}\r\n\r\nexport interface MappedEditsProvider {\r\n\r\n\t/**\r\n\t * Provider maps code blocks from the chat into a workspace edit.\r\n\t *\r\n\t * @param document The document to provide mapped edits for.\r\n\t * @param codeBlocks Code blocks that come from an LLM's reply.\r\n\t * \t\t\t\t\t\t\"Insert at cursor\" in the panel chat only sends one edit that the user clicks on, but inline chat can send multiple blocks and let the lang server decide what to do with them.\r\n\t * @param context The context for providing mapped edits.\r\n\t * @param token A cancellation token.\r\n\t * @returns A provider result of text edits.\r\n\t */\r\n\tprovideMappedEdits(\r\n\t\tdocument: model.ITextModel,\r\n\t\tcodeBlocks: string[],\r\n\t\tcontext: MappedEditsContext,\r\n\t\ttoken: CancellationToken\r\n\t): Promise<WorkspaceEdit | null>;\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\r\nimport { Emitter } from 'vs/base/common/event';\r\nimport { KeyChord, KeyMod as ConstKeyMod } from 'vs/base/common/keyCodes';\r\nimport { URI } from 'vs/base/common/uri';\r\nimport { Position } from 'vs/editor/common/core/position';\r\nimport { Range } from 'vs/editor/common/core/range';\r\nimport { Selection } from 'vs/editor/common/core/selection';\r\nimport { Token } from 'vs/editor/common/languages';\r\nimport * as standaloneEnums from 'vs/editor/common/standalone/standaloneEnums';\r\n\r\nexport class KeyMod {\r\n\tpublic static readonly CtrlCmd: number = ConstKeyMod.CtrlCmd;\r\n\tpublic static readonly Shift: number = ConstKeyMod.Shift;\r\n\tpublic static readonly Alt: number = ConstKeyMod.Alt;\r\n\tpublic static readonly WinCtrl: number = ConstKeyMod.WinCtrl;\r\n\r\n\tpublic static chord(firstPart: number, secondPart: number): number {\r\n\t\treturn KeyChord(firstPart, secondPart);\r\n\t}\r\n}\r\n\r\nexport function createMonacoBaseAPI(): typeof monaco {\r\n\treturn {\r\n\t\teditor: undefined!, // undefined override expected here\r\n\t\tlanguages: undefined!, // undefined override expected here\r\n\t\tCancellationTokenSource: CancellationTokenSource,\r\n\t\tEmitter: Emitter,\r\n\t\tKeyCode: standaloneEnums.KeyCode,\r\n\t\tKeyMod: KeyMod,\r\n\t\tPosition: Position,\r\n\t\tRange: Range,\r\n\t\tSelection: <any>Selection,\r\n\t\tSelectionDirection: standaloneEnums.SelectionDirection,\r\n\t\tMarkerSeverity: standaloneEnums.MarkerSeverity,\r\n\t\tMarkerTag: standaloneEnums.MarkerTag,\r\n\t\tUri: <any>URI,\r\n\t\tToken: Token\r\n\t};\r\n}\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *\r\n * [] export\r\n * export interface `IMirrorModel` extends IMirrorTextModel\r\n * export interface `IWorkerContext`\r\n * export interface `IRawModelData`\r\n * export interface `ICommonModel` extends ILinkComputerTarget, IDocumentColorComputerTarget, IMirrorModel\r\n * export interface `IForeignModuleFactory`\r\n[*]export class `EditorSimpleWorker` implements IRequestHandler, IDisposable\r\n * export function `create`\r\n *--------------------------------------------------------------------------------------------*/\r\n\r\nimport { stringDiff } from 'vs/base/common/diff/diff';\r\nimport { IDisposable } from 'vs/base/common/lifecycle';\r\nimport { URI } from 'vs/base/common/uri';\r\nimport { IRequestHandler } from 'vs/base/common/worker/simpleWorker';\r\nimport { IPosition, Position } from 'vs/editor/common/core/position';\r\nimport { IRange, Range } from 'vs/editor/common/core/range';\r\nimport { EndOfLineSequence, ITextModel } from 'vs/editor/common/model';\r\nimport { IMirrorTextModel, IModelChangedEvent, MirrorTextModel as BaseMirrorModel } from 'vs/editor/common/model/mirrorTextModel';\r\nimport { ensureValidWordDefinition, getWordAtText, IWordAtPosition } from 'vs/editor/common/core/wordHelper';\r\nimport { IColorInformation, IInplaceReplaceSupportResult, ILink, TextEdit } from 'vs/editor/common/languages';\r\nimport { ILinkComputerTarget, computeLinks } from 'vs/editor/common/languages/linkComputer';\r\nimport { BasicInplaceReplace } from 'vs/editor/common/languages/supports/inplaceReplaceSupport';\r\nimport { DiffAlgorithmName, IDiffComputationResult, ILineChange, IUnicodeHighlightsResult } from 'vs/editor/common/services/editorWorker';\r\nimport { createMonacoBaseAPI } from 'vs/editor/common/services/editorBaseApi';\r\nimport { IEditorWorkerHost } from 'vs/editor/common/services/editorWorkerHost';\r\nimport { StopWatch } from 'vs/base/common/stopwatch';\r\nimport { UnicodeTextModelHighlighter, UnicodeHighlighterOptions } from 'vs/editor/common/services/unicodeTextModelHighlighter';\r\nimport { ILinesDiffComputer, LineRangeMapping } from 'vs/editor/common/diff/linesDiffComputer';\r\nimport { linesDiffComputers } from 'vs/editor/common/diff/linesDiffComputers';\r\nimport { createProxyObject, getAllMethodNames } from 'vs/base/common/objects';\r\nimport { IDocumentDiffProviderOptions } from 'vs/editor/common/diff/documentDiffProvider';\r\nimport { IDocumentColorComputerTarget, computeDefaultDocumentColors } from 'vs/editor/common/languages/defaultDocumentColorsComputer';\r\n\r\nexport interface IMirrorModel extends IMirrorTextModel {\r\n\treadonly uri: URI;\r\n\treadonly version: number;\r\n\tgetValue(): string;\r\n}\r\n\r\nexport interface IWorkerContext<H = undefined> {\r\n\t/**\r\n\t * A proxy to the main thread host object.\r\n\t */\r\n\thost: H;\r\n\t/**\r\n\t * Get all available mirror models in this worker.\r\n\t */\r\n\tgetMirrorModels(): IMirrorModel[];\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IRawModelData {\r\n\turl: string;\r\n\tversionId: number;\r\n\tlines: string[];\r\n\tEOL: string;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface ICommonModel extends ILinkComputerTarget, IDocumentColorComputerTarget, IMirrorModel {\r\n\teol: string;\r\n\r\n\tgetLinesContent(): string[];\r\n\tgetLineCount(): number;\r\n\tgetLineContent(lineNumber: number): string;\r\n\tgetLineWords(lineNumber: number, wordDefinition: RegExp): IWordAtPosition[];\r\n\twords(wordDefinition: RegExp): Iterable<string>;\r\n\tgetValueInRange(range: IRange): string;\r\n\tgetWordAtPosition(position: IPosition, wordDefinition: RegExp): Range | null;\r\n\toffsetAt(position: IPosition): number;\r\n\tpositionAt(offset: number): IPosition;\r\n}\r\n\r\n/**\r\n *    \r\n * @internal\r\n */\r\ninterface IWordRange {\r\n\t/**\r\n\t *   \r\n\t */\r\n\treadonly start: number;\r\n\t/**\r\n\t *   \r\n\t */\r\n\treadonly end: number;\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nclass MirrorModel extends BaseMirrorModel implements ICommonModel {\r\n\r\n\tpublic get uri(): URI {\r\n\t\treturn this._uri;\r\n\t}\r\n\r\n\tpublic get eol(): string {\r\n\t\treturn this._eol;\r\n\t}\r\n\r\n\tpublic getValue(): string {\r\n\t\treturn this.getText();\r\n\t}\r\n\r\n\tpublic findMatches(regex: RegExp): RegExpMatchArray[] {\r\n\t\tconst matches = [];\r\n\t\tfor (let i = 0; i < this._lines.length; i++) {\r\n\t\t\tconst line = this._lines[i];\r\n\t\t\tconst offsetToAdd = this.offsetAt(new Position(i + 1, 1));\r\n\t\t\tconst iteratorOverMatches = line.matchAll(regex);\r\n\t\t\tfor (const match of iteratorOverMatches) {\r\n\t\t\t\tif (match.index || match.index === 0) {\r\n\t\t\t\t\tmatch.index = match.index + offsetToAdd;\r\n\t\t\t\t}\r\n\t\t\t\tmatches.push(match);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn matches;\r\n\t}\r\n\r\n\tpublic getLinesContent(): string[] {\r\n\t\treturn this._lines.slice(0);\r\n\t}\r\n\r\n\tpublic getLineCount(): number {\r\n\t\treturn this._lines.length;\r\n\t}\r\n\r\n\tpublic getLineContent(lineNumber: number): string {\r\n\t\treturn this._lines[lineNumber - 1];\r\n\t}\r\n\r\n\tpublic getWordAtPosition(position: IPosition, wordDefinition: RegExp): Range | null {\r\n\r\n\t\tconst wordAtText = getWordAtText(\r\n\t\t\tposition.column,\r\n\t\t\tensureValidWordDefinition(wordDefinition),\r\n\t\t\tthis._lines[position.lineNumber - 1],\r\n\t\t\t0\r\n\t\t);\r\n\r\n\t\tif (wordAtText) {\r\n\t\t\treturn new Range(position.lineNumber, wordAtText.startColumn, position.lineNumber, wordAtText.endColumn);\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**  `wordDefinition`      */\r\n\tpublic words(wordDefinition: RegExp): Iterable<string> {\r\n\r\n\t\tconst lines = this._lines; //       \r\n\t\tconst wordenize = this._wordenize.bind(this);\r\n\r\n\t\tlet lineNumber = 0;\r\n\t\tlet lineText = '';\r\n\t\tlet wordRangesIdx = 0;\r\n\t\tlet wordRanges: IWordRange[] = [];\r\n\r\n\t\treturn {\r\n\t\t\t*[Symbol.iterator]() {\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\tif (wordRangesIdx < wordRanges.length) {\r\n\t\t\t\t\t\tconst value = lineText.substring(wordRanges[wordRangesIdx].start, wordRanges[wordRangesIdx].end);\r\n\t\t\t\t\t\twordRangesIdx += 1;\r\n\t\t\t\t\t\tyield value;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (lineNumber < lines.length) {\r\n\t\t\t\t\t\t\tlineText = lines[lineNumber];\r\n\t\t\t\t\t\t\twordRanges = wordenize(lineText, wordDefinition);\r\n\t\t\t\t\t\t\twordRangesIdx = 0;\r\n\t\t\t\t\t\t\tlineNumber += 1;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\tpublic getLineWords(lineNumber: number, wordDefinition: RegExp): IWordAtPosition[] {\r\n\t\tconst content = this._lines[lineNumber - 1];\r\n\t\tconst ranges = this._wordenize(content, wordDefinition);\r\n\t\tconst words: IWordAtPosition[] = [];\r\n\t\tfor (const range of ranges) {\r\n\t\t\twords.push({\r\n\t\t\t\tword: content.substring(range.start, range.end),\r\n\t\t\t\tstartColumn: range.start + 1,\r\n\t\t\t\tendColumn: range.end + 1\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn words;\r\n\t}\r\n\r\n\t/** `content`   `wordDefinition`    */\r\n\tprivate _wordenize(content: string, wordDefinition: RegExp): IWordRange[] {\r\n\t\tconst result: IWordRange[] = [];\r\n\t\tlet match: RegExpExecArray | null;\r\n\r\n\t\twordDefinition.lastIndex = 0; // reset lastIndex just to be sure\r\n\r\n\t\twhile (match = wordDefinition.exec(content)) {\r\n\t\t\tif (match[0].length === 0) {\r\n\t\t\t\t// it did match the empty string\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tresult.push({ start: match.index, end: match.index + match[0].length });\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tpublic getValueInRange(range: IRange): string {\r\n\t\trange = this._validateRange(range);\r\n\r\n\t\tif (range.startLineNumber === range.endLineNumber) {\r\n\t\t\treturn this._lines[range.startLineNumber - 1].substring(range.startColumn - 1, range.endColumn - 1);\r\n\t\t}\r\n\r\n\t\tconst lineEnding = this._eol;\r\n\t\tconst startLineIndex = range.startLineNumber - 1;\r\n\t\tconst endLineIndex = range.endLineNumber - 1;\r\n\t\tconst resultLines: string[] = [];\r\n\r\n\t\tresultLines.push(this._lines[startLineIndex].substring(range.startColumn - 1));\r\n\t\tfor (let i = startLineIndex + 1; i < endLineIndex; i++) {\r\n\t\t\tresultLines.push(this._lines[i]);\r\n\t\t}\r\n\t\tresultLines.push(this._lines[endLineIndex].substring(0, range.endColumn - 1));\r\n\r\n\t\treturn resultLines.join(lineEnding);\r\n\t}\r\n\r\n\tpublic offsetAt(position: IPosition): number {\r\n\t\tposition = this._validatePosition(position);\r\n\t\tthis._ensureLineStarts();\r\n\t\treturn this._lineStarts!.getPrefixSum(position.lineNumber - 2) + (position.column - 1);\r\n\t}\r\n\r\n\tpublic positionAt(offset: number): IPosition {\r\n\t\toffset = Math.floor(offset);\r\n\t\toffset = Math.max(0, offset);\r\n\r\n\t\tthis._ensureLineStarts();\r\n\t\tconst out = this._lineStarts!.getIndexOf(offset);\r\n\t\tconst lineLength = this._lines[out.index].length;\r\n\r\n\t\t// Ensure we return a valid position\r\n\t\treturn {\r\n\t\t\tlineNumber: 1 + out.index,\r\n\t\t\tcolumn: 1 + Math.min(out.remainder, lineLength)\r\n\t\t};\r\n\t}\r\n\r\n\tprivate _validateRange(range: IRange): IRange {\r\n\r\n\t\tconst start = this._validatePosition({ lineNumber: range.startLineNumber, column: range.startColumn });\r\n\t\tconst end = this._validatePosition({ lineNumber: range.endLineNumber, column: range.endColumn });\r\n\r\n\t\tif (start.lineNumber !== range.startLineNumber\r\n\t\t\t|| start.column !== range.startColumn\r\n\t\t\t|| end.lineNumber !== range.endLineNumber\r\n\t\t\t|| end.column !== range.endColumn) {\r\n\r\n\t\t\treturn {\r\n\t\t\t\tstartLineNumber: start.lineNumber,\r\n\t\t\t\tstartColumn: start.column,\r\n\t\t\t\tendLineNumber: end.lineNumber,\r\n\t\t\t\tendColumn: end.column\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn range;\r\n\t}\r\n\r\n\tprivate _validatePosition(position: IPosition): IPosition {\r\n\t\tif (!Position.isIPosition(position)) {\r\n\t\t\tthrow new Error('bad position');\r\n\t\t}\r\n\t\tlet { lineNumber, column } = position;\r\n\t\tlet hasChanged = false;\r\n\r\n\t\tif (lineNumber < 1) {\r\n\t\t\tlineNumber = 1;\r\n\t\t\tcolumn = 1;\r\n\t\t\thasChanged = true;\r\n\r\n\t\t} else if (lineNumber > this._lines.length) {\r\n\t\t\tlineNumber = this._lines.length;\r\n\t\t\tcolumn = this._lines[lineNumber - 1].length + 1;\r\n\t\t\thasChanged = true;\r\n\r\n\t\t} else {\r\n\t\t\tconst maxCharacter = this._lines[lineNumber - 1].length + 1;\r\n\t\t\tif (column < 1) {\r\n\t\t\t\tcolumn = 1;\r\n\t\t\t\thasChanged = true;\r\n\t\t\t}\r\n\t\t\telse if (column > maxCharacter) {\r\n\t\t\t\tcolumn = maxCharacter;\r\n\t\t\t\thasChanged = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!hasChanged) {\r\n\t\t\treturn position;\r\n\t\t} else {\r\n\t\t\treturn { lineNumber, column };\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * @internal\r\n */\r\nexport interface IForeignModuleFactory {\r\n\t(ctx: IWorkerContext, createData: any): any;\r\n}\r\n\r\ndeclare const require: any;\r\n\r\n/**\r\n *   \r\n *\r\n * @internal\r\n */\r\nexport class EditorSimpleWorker implements IRequestHandler, IDisposable {\r\n\t_requestHandlerBrand: any;\r\n\r\n\tprotected readonly _host: IEditorWorkerHost;\r\n\tprivate _models: { [uri: string]: MirrorModel };\r\n\tprivate readonly _foreignModuleFactory: IForeignModuleFactory | null;\r\n\tprivate _foreignModule: any;\r\n\r\n\tconstructor(host: IEditorWorkerHost, foreignModuleFactory: IForeignModuleFactory | null) {\r\n\t\tthis._host = host;\r\n\t\tthis._models = Object.create(null);\r\n\t\tthis._foreignModuleFactory = foreignModuleFactory;\r\n\t\tthis._foreignModule = null;\r\n\t}\r\n\r\n\tpublic dispose(): void {\r\n\t\tthis._models = Object.create(null);\r\n\t}\r\n\r\n\tprotected _getModel(uri: string): ICommonModel {\r\n\t\treturn this._models[uri];\r\n\t}\r\n\r\n\tprivate _getModels(): ICommonModel[] {\r\n\t\tconst all: MirrorModel[] = [];\r\n\t\tObject.keys(this._models).forEach((key) => all.push(this._models[key]));\r\n\t\treturn all;\r\n\t}\r\n\r\n\tpublic acceptNewModel(data: IRawModelData): void {\r\n\t\tthis._models[data.url] = new MirrorModel(URI.parse(data.url), data.lines, data.EOL, data.versionId);\r\n\t}\r\n\r\n\tpublic acceptModelChanged(strURL: string, e: IModelChangedEvent): void {\r\n\t\tif (!this._models[strURL]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst model = this._models[strURL];\r\n\t\tmodel.onEvents(e);\r\n\t}\r\n\r\n\tpublic acceptRemovedModel(strURL: string): void {\r\n\t\tif (!this._models[strURL]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdelete this._models[strURL];\r\n\t}\r\n\r\n\tpublic async computeUnicodeHighlights(url: string, options: UnicodeHighlighterOptions, range?: IRange): Promise<IUnicodeHighlightsResult> {\r\n\t\tconst model = this._getModel(url);\r\n\t\tif (!model) {\r\n\t\t\treturn { ranges: [], hasMore: false, ambiguousCharacterCount: 0, invisibleCharacterCount: 0, nonBasicAsciiCharacterCount: 0 };\r\n\t\t}\r\n\t\treturn UnicodeTextModelHighlighter.computeUnicodeHighlights(model, options, range);\r\n\t}\r\n\r\n\t// ---- BEGIN diff --------------------------------------------------------------------------\r\n\r\n\tpublic async computeDiff(originalUrl: string, modifiedUrl: string, options: IDocumentDiffProviderOptions, algorithm: DiffAlgorithmName): Promise<IDiffComputationResult | null> {\r\n\t\tconst original = this._getModel(originalUrl);\r\n\t\tconst modified = this._getModel(modifiedUrl);\r\n\t\tif (!original || !modified) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn EditorSimpleWorker.computeDiff(original, modified, options, algorithm);\r\n\t}\r\n\r\n\tprivate static computeDiff(originalTextModel: ICommonModel | ITextModel, modifiedTextModel: ICommonModel | ITextModel, options: IDocumentDiffProviderOptions, algorithm: DiffAlgorithmName): IDiffComputationResult {\r\n\t\tconst diffAlgorithm: ILinesDiffComputer = algorithm === 'advanced' ? linesDiffComputers.getAdvanced() : linesDiffComputers.getLegacy();\r\n\r\n\t\tconst originalLines = originalTextModel.getLinesContent();\r\n\t\tconst modifiedLines = modifiedTextModel.getLinesContent();\r\n\r\n\t\tconst result = diffAlgorithm.computeDiff(originalLines, modifiedLines, options);\r\n\r\n\t\tconst identical = (result.changes.length > 0 ? false : this._modelsAreIdentical(originalTextModel, modifiedTextModel));\r\n\r\n\t\tfunction getLineChanges(changes: readonly LineRangeMapping[]): ILineChange[] {\r\n\t\t\treturn changes.map(m => ([m.originalRange.startLineNumber, m.originalRange.endLineNumberExclusive, m.modifiedRange.startLineNumber, m.modifiedRange.endLineNumberExclusive, m.innerChanges?.map(m => [\r\n\t\t\t\tm.originalRange.startLineNumber,\r\n\t\t\t\tm.originalRange.startColumn,\r\n\t\t\t\tm.originalRange.endLineNumber,\r\n\t\t\t\tm.originalRange.endColumn,\r\n\t\t\t\tm.modifiedRange.startLineNumber,\r\n\t\t\t\tm.modifiedRange.startColumn,\r\n\t\t\t\tm.modifiedRange.endLineNumber,\r\n\t\t\t\tm.modifiedRange.endColumn,\r\n\t\t\t])]));\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tidentical,\r\n\t\t\tquitEarly: result.hitTimeout,\r\n\t\t\tchanges: getLineChanges(result.changes),\r\n\t\t\tmoves: result.moves.map(m => ([\r\n\t\t\t\tm.lineRangeMapping.original.startLineNumber,\r\n\t\t\t\tm.lineRangeMapping.original.endLineNumberExclusive,\r\n\t\t\t\tm.lineRangeMapping.modified.startLineNumber,\r\n\t\t\t\tm.lineRangeMapping.modified.endLineNumberExclusive,\r\n\t\t\t\tgetLineChanges(m.changes)\r\n\t\t\t])),\r\n\t\t};\r\n\t}\r\n\r\n\tprivate static _modelsAreIdentical(original: ICommonModel | ITextModel, modified: ICommonModel | ITextModel): boolean {\r\n\t\tconst originalLineCount = original.getLineCount();\r\n\t\tconst modifiedLineCount = modified.getLineCount();\r\n\t\tif (originalLineCount !== modifiedLineCount) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tfor (let line = 1; line <= originalLineCount; line++) {\r\n\t\t\tconst originalLine = original.getLineContent(line);\r\n\t\t\tconst modifiedLine = modified.getLineContent(line);\r\n\t\t\tif (originalLine !== modifiedLine) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\t// ---- END diff --------------------------------------------------------------------------\r\n\r\n\r\n\t// ---- BEGIN minimal edits ---------------------------------------------------------------\r\n\r\n\tprivate static readonly _diffLimit = 100000;\r\n\r\n\tpublic async computeMoreMinimalEdits(modelUrl: string, edits: TextEdit[], pretty: boolean): Promise<TextEdit[]> {\r\n\t\tconst model = this._getModel(modelUrl);\r\n\t\tif (!model) {\r\n\t\t\treturn edits;\r\n\t\t}\r\n\r\n\t\tconst result: TextEdit[] = [];\r\n\t\tlet lastEol: EndOfLineSequence | undefined = undefined;\r\n\r\n\t\tedits = edits.slice(0).sort((a, b) => {\r\n\t\t\tif (a.range && b.range) {\r\n\t\t\t\treturn Range.compareRangesUsingStarts(a.range, b.range);\r\n\t\t\t}\r\n\t\t\t// eol only changes should go to the end\r\n\t\t\tconst aRng = a.range ? 0 : 1;\r\n\t\t\tconst bRng = b.range ? 0 : 1;\r\n\t\t\treturn aRng - bRng;\r\n\t\t});\r\n\r\n\t\tfor (let { range, text, eol } of edits) {\r\n\r\n\t\t\tif (typeof eol === 'number') {\r\n\t\t\t\tlastEol = eol;\r\n\t\t\t}\r\n\r\n\t\t\tif (Range.isEmpty(range) && !text) {\r\n\t\t\t\t// empty change\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst original = model.getValueInRange(range);\r\n\t\t\ttext = text.replace(/\\r\\n|\\n|\\r/g, model.eol);\r\n\r\n\t\t\tif (original === text) {\r\n\t\t\t\t// noop\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// make sure diff won't take too long\r\n\t\t\tif (Math.max(text.length, original.length) > EditorSimpleWorker._diffLimit) {\r\n\t\t\t\tresult.push({ range, text });\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\t// compute diff between original and edit.text\r\n\t\t\tconst changes = stringDiff(original, text, pretty);\r\n\t\t\tconst editOffset = model.offsetAt(Range.lift(range).getStartPosition());\r\n\r\n\t\t\tfor (const change of changes) {\r\n\t\t\t\tconst start = model.positionAt(editOffset + change.originalStart);\r\n\t\t\t\tconst end = model.positionAt(editOffset + change.originalStart + change.originalLength);\r\n\t\t\t\tconst newEdit: TextEdit = {\r\n\t\t\t\t\ttext: text.substr(change.modifiedStart, change.modifiedLength),\r\n\t\t\t\t\trange: { startLineNumber: start.lineNumber, startColumn: start.column, endLineNumber: end.lineNumber, endColumn: end.column }\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (model.getValueInRange(newEdit.range) !== newEdit.text) {\r\n\t\t\t\t\tresult.push(newEdit);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (typeof lastEol === 'number') {\r\n\t\t\tresult.push({ eol: lastEol, text: '', range: { startLineNumber: 0, startColumn: 0, endLineNumber: 0, endColumn: 0 } });\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// ---- END minimal edits ---------------------------------------------------------------\r\n\r\n\tpublic async computeLinks(modelUrl: string): Promise<ILink[] | null> {\r\n\t\tconst model = this._getModel(modelUrl);\r\n\t\tif (!model) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\treturn computeLinks(model);\r\n\t}\r\n\r\n\t// --- BEGIN default document colors -----------------------------------------------------------\r\n\r\n\tpublic async computeDefaultDocumentColors(modelUrl: string): Promise<IColorInformation[] | null> {\r\n\t\tconst model = this._getModel(modelUrl);\r\n\t\tif (!model) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\treturn computeDefaultDocumentColors(model);\r\n\t}\r\n\r\n\t// ---- BEGIN suggest --------------------------------------------------------------------------\r\n\r\n\tprivate static readonly _suggestionsLimit = 10000;\r\n\r\n\tpublic async textualSuggest(modelUrls: string[], leadingWord: string | undefined, wordDef: string, wordDefFlags: string): Promise<{ words: string[]; duration: number } | null> {\r\n\r\n\t\tconst sw = new StopWatch();\r\n\t\tconst wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n\t\tconst seen = new Set<string>();\r\n\r\n\t\touter: for (const url of modelUrls) {\r\n\t\t\tconst model = this._getModel(url);\r\n\t\t\tif (!model) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tfor (const word of model.words(wordDefRegExp)) {\r\n\t\t\t\tif (word === leadingWord || !isNaN(Number(word))) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tseen.add(word);\r\n\t\t\t\tif (seen.size > EditorSimpleWorker._suggestionsLimit) {\r\n\t\t\t\t\tbreak outer;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn { words: Array.from(seen), duration: sw.elapsed() };\r\n\t}\r\n\r\n\r\n\t// ---- END suggest --------------------------------------------------------------------------\r\n\r\n\t//#region -- word ranges --\r\n\r\n\tpublic async computeWordRanges(modelUrl: string, range: IRange, wordDef: string, wordDefFlags: string): Promise<{ [word: string]: IRange[] }> {\r\n\t\tconst model = this._getModel(modelUrl);\r\n\t\tif (!model) {\r\n\t\t\treturn Object.create(null);\r\n\t\t}\r\n\t\tconst wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n\t\tconst result: { [word: string]: IRange[] } = Object.create(null);\r\n\t\tfor (let line = range.startLineNumber; line < range.endLineNumber; line++) {\r\n\t\t\tconst words = model.getLineWords(line, wordDefRegExp);\r\n\t\t\tfor (const word of words) {\r\n\t\t\t\tif (!isNaN(Number(word.word))) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tlet array = result[word.word];\r\n\t\t\t\tif (!array) {\r\n\t\t\t\t\tarray = [];\r\n\t\t\t\t\tresult[word.word] = array;\r\n\t\t\t\t}\r\n\t\t\t\tarray.push({\r\n\t\t\t\t\tstartLineNumber: line,\r\n\t\t\t\t\tstartColumn: word.startColumn,\r\n\t\t\t\t\tendLineNumber: line,\r\n\t\t\t\t\tendColumn: word.endColumn\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t//#endregion\r\n\r\n\tpublic async navigateValueSet(modelUrl: string, range: IRange, up: boolean, wordDef: string, wordDefFlags: string): Promise<IInplaceReplaceSupportResult | null> {\r\n\t\tconst model = this._getModel(modelUrl);\r\n\t\tif (!model) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst wordDefRegExp = new RegExp(wordDef, wordDefFlags);\r\n\r\n\t\tif (range.startColumn === range.endColumn) {\r\n\t\t\trange = {\r\n\t\t\t\tstartLineNumber: range.startLineNumber,\r\n\t\t\t\tstartColumn: range.startColumn,\r\n\t\t\t\tendLineNumber: range.endLineNumber,\r\n\t\t\t\tendColumn: range.endColumn + 1\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tconst selectionText = model.getValueInRange(range);\r\n\r\n\t\tconst wordRange = model.getWordAtPosition({ lineNumber: range.startLineNumber, column: range.startColumn }, wordDefRegExp);\r\n\t\tif (!wordRange) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst word = model.getValueInRange(wordRange);\r\n\t\tconst result = BasicInplaceReplace.INSTANCE.navigateValueSet(range, selectionText, wordRange, word, up);\r\n\t\treturn result;\r\n\t}\r\n\r\n\t// ---- BEGIN foreign module support --------------------------------------------------------------------------\r\n\r\n\tpublic loadForeignModule(moduleId: string, createData: any, foreignHostMethods: string[]): Promise<string[]> {\r\n\t\tconst proxyMethodRequest = (method: string, args: any[]): Promise<any> => {\r\n\t\t\treturn this._host.fhr(method, args);\r\n\t\t};\r\n\r\n\t\tconst foreignHost = createProxyObject(foreignHostMethods, proxyMethodRequest);\r\n\r\n\t\tconst ctx: IWorkerContext<any> = {\r\n\t\t\thost: foreignHost,\r\n\t\t\tgetMirrorModels: (): IMirrorModel[] => {\r\n\t\t\t\treturn this._getModels();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (this._foreignModuleFactory) {\r\n\t\t\tthis._foreignModule = this._foreignModuleFactory(ctx, createData);\r\n\t\t\t// static foreing module\r\n\t\t\treturn Promise.resolve(getAllMethodNames(this._foreignModule));\r\n\t\t}\r\n\t\t// ESM-comment-begin\r\n\t\treturn new Promise<any>((resolve, reject) => {\r\n\t\t\trequire([moduleId], (foreignModule: { create: IForeignModuleFactory }) => {\r\n\t\t\t\tthis._foreignModule = foreignModule.create(ctx, createData);\r\n\r\n\t\t\t\tresolve(getAllMethodNames(this._foreignModule));\r\n\r\n\t\t\t}, reject);\r\n\t\t});\r\n\t\t// ESM-comment-end\r\n\r\n\t\t// ESM-uncomment-begin\r\n\t\t// return Promise.reject(new Error(`Unexpected usage`));\r\n\t\t// ESM-uncomment-end\r\n\t}\r\n\r\n\t// foreign method request\r\n\tpublic fmr(method: string, args: any[]): Promise<any> {\r\n\t\tif (!this._foreignModule || typeof this._foreignModule[method] !== 'function') {\r\n\t\t\treturn Promise.reject(new Error('Missing requestHandler or method: ' + method));\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\treturn Promise.resolve(this._foreignModule[method].apply(this._foreignModule, args));\r\n\t\t} catch (e) {\r\n\t\t\treturn Promise.reject(e);\r\n\t\t}\r\n\t}\r\n\r\n\t// ---- END foreign module support --------------------------------------------------------------------------\r\n}\r\n\r\n/**\r\n * Called on the worker side\r\n * @internal\r\n */\r\nexport function create(host: IEditorWorkerHost): IRequestHandler {\r\n\treturn new EditorSimpleWorker(host, null);\r\n}\r\n\r\n// This is only available in a Web Worker\r\ndeclare function importScripts(...urls: string[]): void;\r\n\r\nif (typeof importScripts === 'function') {\r\n\t// Running in a web worker\r\n\tglobalThis.monaco = createMonacoBaseAPI();\r\n}\r\n"],"mappings":"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","names":["__m","__M","deps","result","i","len","_amdLoaderGlobal","_commonjsGlobal","AMDLoader","Environment","LoaderEvent","type","detail","timestamp","LoaderEventRecorder","loaderAvailableTimestamp","NullLoaderEventRecorder","Utilities","isWindows","uri","haystack","needle","url","obj","callback","key","isEmpty","value","id","ensureError","err","ConfigurationOptionsUtil","options","defaultOnError","overwrite","base","key2","value2","Configuration","env","nodeMain","dirnameIndex","from","to","a","b","moduleId","pathRule","j","lenJ","urls","results","strModuleId","OnlyOnceScriptLoader","moduleManager","scriptSrc","errorback","WorkerScriptLoader","preferScriptTags","BrowserScriptLoader","NodeScriptLoader","scriptCallbacks","script","unbind","loadEventListener","errorEventListener","e","opts","nodeRequire","ensureRecordedNodeRequire","pieces","moduleExports","trustedTypesPolicy","cspNonce","canUseEval","response","text","nodeCachedData","that","Module","makeRequireFunction","mod","require","path","request","content","filename","scriptSource","recorder","cachedDataPath","hashData","data","compileWrapper","dirname","args","nodeInstrumenter","c","normalizedScriptSrc","vmScriptPathOrUri","wantsCachedData","cachedData","scriptOpts","contents","ret","globalDefineFunc","receivedDefineCall","localDefineFunc","driveLetterMatch","config","hash","basename","createCachedData","timeout","lastSize","iteration","createLoop","sourcePath","source","steps","step","hashDataNow","_nodeRequire","what","createScriptLoader","ModuleIdResolver","fromModuleId","lastSlash","r","pattern","strId","dependencies","moduleIdResolver","dependenciesValues","inversedependenciesProvider","producedError","ModuleIdProvider","RegularDependency","PluginDependency","pluginId","pluginParam","ModuleManager","scriptLoader","defineFunc","requireFunc","stack","normalize","str","normalizedPath","stackPieces","m","stackPath","stackLine","stackColumn","trimPathOffset","resultLen","location","defineStack","dep","dependency","bangIndex","strPluginId","dependencyId","_strModuleId","params","shouldOverwrite","oldShouldRecordStats","defineCall","_err","neededBy","intModuleId","error","seenModuleId","someoneNotified","queue","queueElement","inverseDeps","inverseDep","fromId","toId","inQueue","dependencyModule","depth","paths","scopedPackageRegex","lastPathIndex","loadNextPath","currentPath","plugin","pluginDependency","load","module","cyclePath","inversePluginDeps","inverseDependencyId","inverseDependency","define","DefineFunc","_requireFunc_config","RequireFunc","init","isPseudo","DEFAULT_TAG","_format","message","match","rest","index","arg","findLanguageForModule","name","endWithSlash","getMessagesFromTranslationsService","translationServiceUrl","language","res","createScopedLocalize","scope","idx","defaultValue","restArgs","localize","exports","getConfiguredDefaultLocale","_","setPseudoTranslation","create","_a","req","pluginConfig","useDefaultLanguage","suffix","messagesLoaded","messages","__awaiter","genericLanguage","_b","monacoEnvironment","monacoBaseUrl","createTrustedTypesPolicy","policyName","policyOptions","fnArgs","fnBody","loadAMDLoader","resolve","reject","loaderSrc","configureAMDLoader","loadCode","ws","messageHandler","msg","transfer","beforeReadyMessages","isFirstMessage","tail","array","n","tail2","arr","equals","one","other","itemEquals","removeFastWithoutKeepingOrder","last","binarySearch","comparator","binarySearch2","length","compareToKey","low","high","mid","comp","findFirstInSorted","p","quickSelect","nth","compare","pivotValue","lower","higher","pivots","val","groupBy","currentGroup","element","coalesce","coalesceInPlace","isFalsyOrEmpty","isNonEmptyArray","distinct","keyFn","seen","findLast","predicate","findLastIndex","fn","firstOrDefault","notFoundValue","range","arrayInsert","target","insertIndex","insertArr","before","after","pushToStart","pushToEnd","pushMany","items","item","asArray","x","mapFind","mapFn","mapped","insertInto","start","newItems","startIdx","getActualStartIndex","originalLength","newItemsLength","splice","deleteCount","CompareResult","isLessThan","isLessThanOrEqual","isGreaterThan","isNeitherLessOrGreaterThan","compareBy","selector","tieBreakComparators","comparators","item1","item2","numberComparator","booleanComparator","reverseOrder","findMaxBy","max","findLastMaxBy","findMinBy","findMaxIdxBy","maxIdx","ArrayQueue","endIdx","count","CallbackIterable","iterate","cb","first","_callback","LRUCachedFunction","CachedFunction","SetMap","values","roundFloat","number","decimalPoints","decimal","RGBA","g","HSLA","h","l","rgba","min","s","chroma","q","t","hsla","HSVA","v","cmax","cmin","delta","hsva","Color","hex","R","G","B","luminance","color","another","lum1","lum2","factor","opaqueBackground","of","relative","Format","CSS","formatRGB","formatRGBA","formatHSL","formatHSLA","_toTwoDigitHex","formatHex","formatHexA","compact","format","parseHex","_parseHexDigit","charCode","DiffChange","originalStart","modifiedStart","modifiedLength","ErrorHandler","ErrorNoTelemetry","listener","onUnexpectedError","isCancellationError","onUnexpectedExternalError","transformErrorForSerialization","canceledName","CancellationError","canceled","illegalArgument","illegalState","NotSupportedError","BugIndicatingError","ok","assertNever","assertFn","condition","errors_1","checkAdjacentItems","once","_this","didCall","Iterable","is","thing","_empty","empty","single","wrap","iterableOrElement","iterable","some","find","filter","map","concat","iterables","reduce","reducer","initialValue","slice","consume","atMost","consumed","iterator","next","KeyCodeStrMap","keyCode","uiMap","userSettingsUSMap","userSettingsGeneralMap","scanCodeIntToStr","scanCodeStrToInt","scanCodeLowerCaseStrToInt","mappings","seenKeyCode","seenScanCode","mapping","immutable","scanCode","scanCodeStr","keyCodeStr","eventKeyCode","vkey","usUserSettingsLabel","generalUserSettingsLabel","KeyCodeUtils","toString","fromString","toUserSettingsUS","toUserSettingsGeneral","fromUserSettings","toElectronAccelerator","KeyChord","firstPart","secondPart","chordPart","Lazy","executor","TRACK_DISPOSABLES","disposableTracker","setDisposableTracker","tracker","__is_disposable_tracked__","child","parent","Disposable","disposable","trackDisposable","markAsDisposed","setParentOfDisposable","setParentOfDisposables","children","markAsSingleton","singleton","isDisposable","dispose","iterator_1","errors","d","combinedDisposable","disposables","toDisposable","self","functional_1","DisposableStore","o","MutableDisposable","RefCountedDisposable","_disposable","ImmortalReference","object","DisposableMap","skipDisposeOnOverwrite","Node","LinkedList","node","atTheEnd","newNode","oldLast","oldFirst","didRemove","anchor","hasPerformanceNow","StopWatch","highResolution","_enableDisposeWithListenerWarning","_enableSnapshotPotentialLeakWarning","Event","lifecycle_1","_addLeakageTraceLogic","origListenerDidAdd","Stacktrace","defer","event","debounce","thisArgs","didFire","snapshot","forEach","each","signal","any","events","merge","initial","output","emitter","Emitter","delay","leading","flushOnListenerRemove","leakWarningThreshold","subscription","handle","numDebouncedCalls","doFire","cur","_output","accumulate","latch","firstCall","cache","shouldEmit","split","isT","buffer","flushAfterTimeout","_buffer","flush","ChainableEvent","chain","fromNodeEventEmitter","eventName","onFirstListenerAdd","onLastListenerRemove","fromDOMEventEmitter","toPromise","fromPromise","promise","runAndSubscribe","handler","runAndSubscribeWithStore","store","run","EmitterObserver","_observable","_change","fromObservable","obs","fromObservableLight","observable","didChange","observer","EventProfiling","listenerCount","stopwatch_1","elapsed","_globalLeakWarningThreshold","LeakageMonitor","threshold","topStack","topCount","UniqueContainer","compactionThreshold","forEachListener","listeners","_c","_d","_e","contained","removeMonitor","EventDeliveryQueuePrivate","adjustDeliveryQueue","errorHandler","dq","createEventDeliveryQueue","end","PauseableEmitter","linkedList_1","DebounceEmitter","MicrotaskEmitter","EventMultiplexer","EventBufferer","Relay","shortcutEvent","context","CancellationToken","isCancellationToken","MutableToken","event_1","CancellationTokenSource","cancel","isFalsyOrWhitespace","_formatRegexp","group","escape","html","escapeRegExpCharacters","trim","trimmed","ltrim","rtrim","needleLen","offset","haystackLen","convertSimple2RegExpPattern","stripWildcards","createRegExp","searchString","isRegex","modifiers","regExpLeadsToEndlessLoop","regexp","splitLines","firstNonWhitespaceIndex","chCode","getLeadingWhitespace","lastNonWhitespaceIndex","startIndex","compareSubstring","aStart","aEnd","bStart","bEnd","codeA","codeB","aLen","bLen","compareIgnoreCase","compareSubstringIgnoreCase","isLowerAsciiLetter","diff","isAsciiDigit","code","isUpperAsciiLetter","equalsIgnoreCase","startsWithIgnoreCase","candidate","candidateLength","commonPrefixLength","commonSuffixLength","aLastIndex","bLastIndex","isHighSurrogate","isLowSurrogate","computeCodePoint","highSurrogate","lowSurrogate","getNextCodePoint","nextCharCode","getPrevCodePoint","prevCharCode","CodePointIterator","codePoint","GraphemeIterator","graphemeBreakTree","GraphemeBreakTree","initialOffset","graphemeBreakType","nextGraphemeBreakType","breakBetweenGraphemeBreakType","prevGraphemeBreakType","nextCharLength","prevCharLength","getCharContainingOffset","endOffset","CONTAINS_RTL","makeContainsRtl","containsRTL","IS_BASIC_ASCII","isBasicASCII","containsUnusualLineTerminators","isFullWidthCharacter","isEmojiImprecise","startsWithUTF8BOM","containsUppercaseCharacter","ignoreEscapedChars","singleLetterHash","breakTypeA","breakTypeB","getGraphemeBreakRawData","nodeCount","nodeIndex","getLeftDeleteOffset","emojiOffset","getOffsetBeforeLastEmojiComponent","isEmojiModifier","resultOffset","AmbiguousCharacters","locales","confusableDictionary","lazy_1","cache_1","arrayToMap","mergeMaps","map1","map2","intersectMaps","filteredLocales","languageSpecificMap","locale","commonMap","k","InvisibleCharacters","doHash","hashVal","numberHash","arrayHash","objectHash","stringHash","booleanHash","initialHashVal","leftRotate","bits","totalBits","mask","fill","dest","leftPad","char","toHexString","bufferOrValue","bitsize","StringSHA1","strLen","buff","buffLen","leftoverHighSurrogate","strings","ml","bigBlock32","f","temp","StringDiffSequence","characters","stringDiff","original","modified","pretty","LcsDiff","Debug","MyArray","sourceArray","sourceIndex","destinationArray","destinationIndex","DiffChangeHelper","diffChange_1","originalIndex","modifiedIndex","originalSequence","modifiedSequence","continueProcessingPredicate","originalStringElements","originalElementsOrHash","originalHasStrings","modifiedStringElements","modifiedElementsOrHash","modifiedHasStrings","sequence","elements","hashes","hash_1","newIndex","originalElement","modifiedElement","index1","index2","originalEnd","modifiedEnd","quitEarlyArr","changes","midOriginalArr","midModifiedArr","midOriginal","midModified","leftChanges","rightChanges","diagonalForwardBase","diagonalForwardStart","diagonalForwardEnd","diagonalForwardOffset","diagonalReverseBase","diagonalReverseStart","diagonalReverseEnd","diagonalReverseOffset","forwardPoints","reversePoints","deltaIsEven","forwardChanges","reverseChanges","changeHelper","diagonalMin","diagonalMax","diagonalRelative","lastOriginalIndex","historyIndex","diagonal","originalStartPoint","modifiedStartPoint","lastForwardChange","maxDifferences","numDiagonals","numDifferences","furthestOriginalIndex","furthestModifiedIndex","tempOriginalIndex","matchLengthOfLongest","change","originalStop","modifiedStop","checkOriginal","checkModified","startStrictEqual","mergedChangeArr","prevChange","bestDelta","bestScore","score","aChange","bChange","matchedLength","aOriginalStart","bOriginalEnd","abOriginalLength","aModifiedStart","bModifiedEnd","abModifiedLength","originalMatchStart","modifiedMatchStart","desiredLength","originalMax","modifiedMax","bestOriginalStart","bestModifiedStart","originalScore","modifiedScore","left","right","diagonalBaseIndex","diagonalsBelow","diagonalsAbove","diffEven","lowerBoundEven","upperBoundEven","isString","isObject","isTypedArray","TypedArray","isNumber","isIterable","isBoolean","isUndefined","isDefined","isUndefinedOrNull","assertType","assertIsDefined","isFunction","validateConstraints","constraints","validateConstraint","constraint","_codiconFontCharacters","register","fontCharacter","types_1","getCodiconFontCharacters","deepClone","deepFreeze","_hasOwnProperty","prop","cloneAndChange","changer","_cloneAndChange","changed","r1","r2","i2","mixin","destination","oneKeys","otherKeys","getAllPropertyNames","getAllMethodNames","methods","createProxyObject","methodNames","invoke","createProxyMethod","method","methodName","toUint8","toUint32","CharacterClassifier","_defaultValue","uint_1","asciiMap","_value","CharacterSet","OffsetRange","sortedRanges","endExclusive","OffsetRangeSet","intersection","prev","Position","lineNumber","column","newLineNumber","newColumn","deltaLineNumber","deltaColumn","aLineNumber","bLineNumber","aColumn","bColumn","pos","Range","startLineNumber","startColumn","endLineNumber","endColumn","position","otherRange","resultStartLineNumber","resultStartColumn","resultEndLineNumber","resultEndColumn","otherStartLineNumber","otherStartColumn","otherEndLineNumber","otherEndColumn","position_1","lineCount","aStartLineNumber","bStartLineNumber","aStartColumn","bStartColumn","aEndLineNumber","bEndLineNumber","aEndColumn","bEndColumn","LineRange","lineRanges","lineRanges1","lineRanges2","i1","current","lineRange1","lineRange2","lineRange","endLineNumberExclusive","range_1","offsetRange_1","Selection","selectionStartLineNumber","selectionStartColumn","positionLineNumber","positionColumn","direction","sel","WordCharacterClassifier","characterClassifier_1","wordSeparators","computeFn","input","createWordRegExp","allowInWords","sep","ensureValidWordDefinition","wordDefinition","flags","_defaultConfig","getWordAtText","textOffset","t1","prevRegexIndex","regexIndex","thisMatch","_findRegexMatchEnclosingPosition","stopPos","matchIndex","DiffAlgorithmResult","seq1","seq2","SequenceDiff","diffs","hitTimeout","seq1Range","seq2Range","InfiniteTimeout","DateTimeout","optimizeSequenceDiffs","sequence1","sequence2","sequenceDiffs","joinSequenceDiffs","shiftSequenceDiffs","smoothenSequenceDiffs","diffAlgorithm_1","removeRandomLineMatches","_sequence2","counter","shouldRepeat","shouldJoinDiffs","unchangedRange","lastResult","removeRandomMatches","unchangedText","beforeLineCount1","beforeSeq1Length","beforeLineCount2","beforeSeq2Length","afterLineCount1","afterSeq1Length","afterLineCount2","afterSeq2Length","cap","range1","range2","fullRange1","prefix","prevResult","result2","nextResult","prevDiff","nextDiff","seq1ValidRange","seq2ValidRange","shiftDiffToBetterPosition","deltaBefore","deltaAfter","seq2OffsetStart","seq2OffsetEndExclusive","seq1Offset","MyersDiffAlgorithm","getXAfterSnake","y","V","FastInt32Array","FastArrayNegativeIndices","SnakePath","loop","lowerBound","upperBound","maxXofDLineTop","maxXofDLineLeft","newMaxX","lastPath","lastAligningPosS1","lastAligningPosS2","endX","endY","Array2D","width","height","DynamicProgrammingDiffing","equalityScore","lcsLengths","utils_1","directions","lengths","s1","s2","horizontalLen","verticalLen","extendedSeqScore","newValue","prevLen","reportDecreasingAligningPositions","LinesDiff","moves","LineRangeMapping","originalLineCount","modifiedLineCount","lastOriginalEndLineNumber","lastModifiedEndLineNumber","lineRange_1","originalRange","modifiedRange","innerChanges","RangeMapping","SimpleLineRangeMapping","MovedText","lineRangeMapping","AdvancedLinesDiffComputer","dynamicProgrammingDiffing_1","myersDiffAlgorithm_1","originalLines","modifiedLines","arrays_1","linesDiffComputer_1","considerWhitespaceChanges","perfectHashes","getOrCreateHash","srcDocLines","tgtDocLines","LineSequence","lineAlignmentResult","offset1","offset2","lineAlignments","joinSequenceDiffs_1","alignments","scanForWhitespaceChanges","equalLinesCount","seq1LastStart","seq2Offset","seq2LastStart","characterDiffs","assert_1","lineRangeMappingFromRangeMappings","validatePosition","lines","line","validateRange","ic","hashedOriginalLines","hashedModifiedLines","deletions","LineRangeFragment","insertions","excludedChanges","deletion","highestSimilarity","best","insertion","similarity","original3LineHashes","collections_1","possibleMappings","lastMappings","currentModifiedRange","nextMappings","lastMapping","modifiedSet","LineRangeSet","originalSet","diffOrigToMod","modifiedSections","originalTranslatedSections","modifiedIntersectedSections","intersectRanges","modifiedLineRange","originalLineRange","joinedMoves","originalDist","modifiedDist","originalChanges","MonotonousFinder","diffBeforeOriginalMove","modifiedDistToPrevDiff","originalDistToPrevDiff","moveChanges","slice1","LinesSliceCharSequence","slice2","diffResult","coverFullWords","itemToDomain","domainComparator","_items","_itemToDomain","_domainComparator","ranges1","ranges2","joinRangeStartIdx","mapMinusOne","joinRangeEndIdxExclusive","joinRange","mapTo","additional","lastModifiedWord","maybePushWordToAdditional","originalLength1","originalLength2","processWord","s1Range","s2Range","s1Added","s2Added","changedS1","changedS2","w1Before","w2Before","w1After","w2After","mergeSequenceDiffs","sequenceDiffs1","sequenceDiffs2","sd1","sd2","dontAssertStartLine","getLineRangeMapping","a1","a2","m1","m2","rangeMapping","lineStartDelta","lineEndDelta","shouldBeGrouped","trimmedHash","indentationBefore","getIndentation","indentationAfter","trimFirstLineFully","trimmedStartLine","prevCategory","getCategory","nextCategory","getCategoryBoundaryScore","offsetOfFirstCharInLine","isWordChar","findLastMonotonous","findFirstMonotonous","findLastIdxMonotonous","findFirstIdxMonotonous","category","isSpace","chrKeys","getKey","chr","sumDifferences","maxLength","MINIMUM_MATCHING_CHARACTER_LENGTH","LegacyLinesDiffComputer","DiffComputer","lastChange","computeDiff","diff_1","startColumns","endColumns","getFirstNonBlankColumn","getLastNonBlankColumn","shouldIgnoreTrimWhitespace","endIndex","charCodes","lineNumbers","columns","lineContent","col","CharSequence","CharChange","originalStartLineNumber","originalStartColumn","originalEndLineNumber","originalEndColumn","modifiedStartLineNumber","modifiedStartColumn","modifiedEndLineNumber","modifiedEndColumn","diffChange","originalCharSequence","modifiedCharSequence","postProcessCharChanges","rawChanges","currChange","originalMatchingLength","modifiedMatchingLength","LineChange","charChanges","originalLineSequence","modifiedLineSequence","continueCharDiff","shouldComputeCharChanges","shouldPostProcessCharChanges","createContinueProcessingPredicate","quitEarly","lineChanges","originalLineIndex","modifiedLineIndex","nextChange","originalLine","modifiedLine","originalChar","modifiedChar","originalMaxColumn","modifiedMaxColumn","originalLineNumber","modifiedLineNumber","txt","maximumRuntime","startTime","legacyLinesDiffComputer_1","advancedLinesDiffComputer_1","_parseCaptureGroups","captureGroups","captureGroup","parsedNumber","_toIColor","_findRange","model","startPosition","_findHexColorInformation","hexValue","parsedHexColor","color_1","_findRGBColorInformation","matches","isAlpha","parsedRegex","_findHSLColorInformation","colorEquivalent","_findMatches","regex","computeColors","initialValidationMatches","initialMatch","initialCaptureGroups","colorScheme","colorParameters","colorInformation","regexParameters","computeDefaultDocumentColors","Uint8Matrix","rows","cols","row","StateMachine","edges","maxCharCode","maxState","states","currentState","_stateMachine","getStateMachine","_classifier","getClassifier","FORCE_TERMINATION_CHARACTERS","CANNOT_END_WITH_CHARACTERS","LinkComputer","classifier","linkBeginIndex","linkEndIndex","lastIncludedCharIndex","charCodeBeforeLink","lastCharCodeInLink","stateMachine","linkBeginChCode","state","hasOpenParens","hasOpenSquareBracket","inSquareBrackets","hasOpenCurlyBracket","resetStateMachine","chClass","computeLinks","BasicInplaceReplace","text1","text2","up","numberResult","precision","n1","n2","valueSets","valueSet","OverviewRulerLane","GlyphMarginLane","MinimapPosition","InjectedTextCursorStops","TextModelResolvedOptions","src","objects_1","newOpts","FindMatch","isITextSnapshot","ValidAnnotatedEditOperation","identifier","forceMoveMarkers","isAutoWhitespaceEdit","_isTracked","SearchData","simpleSearch","ApplyEditsResult","reverseEdits","trimAutoWhitespaceLineNumbers","shouldSynchronizeModel","PrefixSumComputer","insertValues","oldValues","oldPrefixSum","insertValuesLen","maxCount","sum","midStop","midStart","PrefixSumIndexOfResult","ConstantTimePrefixSumComputer","viewLinesAbove","sumAbove","remainder","MirrorTextModel","eol","versionId","eolLength","linesLength","lineStartValues","prefixSumComputer_1","lineIndex","insertText","insertLines","strings_1","newLengths","LIMIT_FIND_COUNT","SearchParams","matchCase","multiline","isMultilineRegexSource","canUseSimpleSearch","model_1","wordCharacterClassifier_1","nextChCode","createFindMatch","rawMatches","captureMatches","LineFeedCounter","lineFeedsOffsets","lineFeedsOffsetsLen","textLen","TextModelSearch","searchParams","searchRange","limitResultCount","searchData","Searcher","deltaOffset","lfCounter","match0","startOffset","lineFeedCountBeforeMatch","lineFeedCountInMatch","endPosition","searcher","searchStringLen","textLength","lastMatchIndex","isValidMatch","searchStart","searchTextStart","fromColumn","bestResult","leftIsWordBounday","matchStartIndex","matchLength","charBefore","firstCharInMatch","rightIsWordBounday","charAfter","lastCharInMatch","searchRegex","lastIndex","UnicodeTextModelHighlighter","startLine","endLine","codePointHighlighter","CodePointHighlighter","candidates","buildRegExpCharClassExpr","textModelSearch_1","ranges","hasMore","ambiguousCharacterCount","invisibleCharacterCount","nonBasicAsciiCharacterCount","forLoop","lineLength","charCodeBefore","word","wordHelper_1","highlightReason","MAX_RESULT_LENGTH","primaryConfusable","notAmbiguousInLocales","codePoints","set","cp","isAllowedInvisibleCharacter","character","wordContext","hasBasicASCIICharacters","hasNonConfusableNonBasicAsciiCharacter","AccessibilitySupport","CodeActionTriggerType","CompletionItemInsertTextRule","CompletionItemKind","CompletionItemTag","CompletionTriggerKind","ContentWidgetPositionPreference","CursorChangeReason","DefaultEndOfLine","DocumentHighlightKind","EditorAutoIndentStrategy","EditorOption","EndOfLinePreference","EndOfLineSequence","IndentAction","InlayHintKind","InlineCompletionTriggerKind","KeyCode","MarkerSeverity","MarkerTag","MouseTargetType","OverlayWidgetPositionPreference","PositionAffinity","RenderLineNumbersType","RenderMinimap","ScrollType","ScrollbarVisibility","SelectionDirection","SignatureHelpTriggerKind","SymbolKind","SymbolTag","TextEditorCursorBlinkingStyle","TextEditorCursorStyle","TrackedRangeStickiness","WrappingIndent","TokenizationRegistry","languageIds","languageId","support","factory","myData","TokenizationSupportFactoryData","tokenizationSupport","colorMap","_registry","_languageId","_factory","nls","_isWindows","_isMacintosh","_isLinux","_isLinuxSnap","_isNative","_isWeb","_isElectron","_isIOS","_isCI","_isMobile","_locale","_language","_platformLocale","_translationsConfigFile","_userAgent","nodeProcess","isElectronProcess","isElectronRenderer","rawNlsConfig","nlsConfig","resolved","_platform","pending","lastId","myId","_isLittleEndian","_isLittleEndianComputed","isLittleEndian","test","safeProcess","platform_1","sandboxProcess","CHAR_UPPERCASE_A","CHAR_LOWERCASE_A","CHAR_UPPERCASE_Z","CHAR_LOWERCASE_Z","CHAR_DOT","CHAR_FORWARD_SLASH","CHAR_BACKWARD_SLASH","CHAR_COLON","CHAR_QUESTION_MARK","ErrorInvalidArgType","expected","actual","determiner","validateObject","pathObject","validateString","platformIsWin32","process","isPathSeparator","isPosixPathSeparator","isWindowsDeviceRoot","normalizeString","allowAboveRoot","separator","lastSegmentLength","dots","lastSlashIndex","dir","pathSegments","resolvedDevice","resolvedTail","resolvedAbsolute","rootEnd","device","isAbsolute","joined","needsReplace","slashCount","firstLen","fromOrig","toOrig","fromStart","fromEnd","fromLen","toStart","toEnd","toLen","lastCommonSep","fromCode","out","resolvedPath","matchedSlash","ext","extIdx","firstNonSlashEnd","startDot","startPart","preDotState","posixCwd","cwd","trailingSeparator","hasRoot","_schemePattern","_singleSlashStart","_doubleSlashStart","_validateUri","_strict","_schemeFix","scheme","_referenceResolution","_slash","_regexp","URI","schemeOrData","authority","query","fragment","uriToFsPath","Uri","percentDecode","components","strict","pathFragment","newPath","skipEncoding","_asFormatted","_pathSepMarker","encodeTable","encodeURIComponentFast","uriComponent","isPath","isAuthority","nativeEncodePos","escaped","encodeURIComponentMinimal","keepDriveLetterCasing","encoder","userinfo","decodeURIComponentGraceful","_rEncodedAsHex","INITIALIZE","webWorkerWarningLogged","logOnceWebWorkerWarning","RequestMessage","vsWorker","ReplyMessage","seq","SubscribeEventMessage","EventMessage","UnsubscribeEventMessage","SimpleWorkerProtocol","workerId","replyMessage","reply","requestMessage","SimpleWorkerClient","workerFactory","host","lazyProxyReject","propertyIsDynamicEvent","propertyIsEvent","loaderConfiguration","globalRequire","hostMethods","proxyMethodRequest","proxyListen","availableMethods","createProxyDynamicEvent","SimpleWorkerServer","postMessage","requestHandlerFactory","loaderConfig","hostProxy","Token","TokenizationResult","tokens","endState","EncodedTokenizationResult","CompletionItemKinds","byKind","codicons_1","toIcon","kind","codicon","SelectedSuggestionInfo","completionKind","isSnippetText","isLocationLink","uri_1","nls_1","getAriaLabelForSymbol","symbolName","SymbolKinds","icon","TextEdit","FoldingRangeKind","Command","LazyTokenizationSupport","createSupport","tokenizationRegistry_1","KeyMod","keyCodes_1","createMonacoBaseAPI","cancellation_1","standaloneEnums","selection_1","languages_1","MirrorModel","mirrorTextModel_1","offsetToAdd","iteratorOverMatches","wordAtText","wordenize","lineText","wordRangesIdx","wordRanges","words","lineEnding","startLineIndex","endLineIndex","resultLines","hasChanged","maxCharacter","EditorSimpleWorker","foreignModuleFactory","all","strURL","unicodeTextModelHighlighter_1","originalUrl","modifiedUrl","algorithm","originalTextModel","modifiedTextModel","diffAlgorithm","linesDiffComputers_1","identical","getLineChanges","modelUrl","edits","lastEol","aRng","bRng","editOffset","newEdit","linkComputer_1","defaultDocumentColorsComputer_1","modelUrls","leadingWord","wordDef","wordDefFlags","sw","wordDefRegExp","outer","selectionText","wordRange","inplaceReplaceSupport_1","createData","foreignHostMethods","ctx","foreignModule","editorBaseApi_1"],"file":"workerMain.js"}